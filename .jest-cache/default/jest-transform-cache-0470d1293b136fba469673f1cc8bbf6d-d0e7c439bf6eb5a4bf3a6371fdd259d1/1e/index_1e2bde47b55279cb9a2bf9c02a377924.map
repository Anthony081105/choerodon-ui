{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components/affix/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { Component, CSSProperties } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport shallowequal from 'lodash/isEqual';\nimport omit from 'lodash/omit';\nimport noop from 'lodash/noop';\nimport getScroll from '../_util/getScroll';\nimport { throttleByAnimationFrameDecorator } from '../_util/throttleByAnimationFrame';\nimport addEventListener from '../_util/addEventListener';\nimport { getPrefixCls } from '../configure';\n\nfunction getTargetRect(target: HTMLElement | Window | null): ClientRect {\n  return target !== window\n    ? (target as HTMLElement).getBoundingClientRect()\n    : ({ top: 0, left: 0, bottom: 0 } as ClientRect);\n}\n\nfunction getOffset(element: HTMLElement, target: HTMLElement | Window | null) {\n  const elemRect = element.getBoundingClientRect();\n  const targetRect = getTargetRect(target);\n\n  const scrollTop = getScroll(target, true);\n  const scrollLeft = getScroll(target, false);\n\n  const docElem = window.document.body;\n  const clientTop = docElem.clientTop || 0;\n  const clientLeft = docElem.clientLeft || 0;\n\n  return {\n    top: elemRect.top - targetRect.top + scrollTop - clientTop,\n    left: elemRect.left - targetRect.left + scrollLeft - clientLeft,\n    width: elemRect.width,\n    height: elemRect.height,\n  };\n}\n\nfunction getDefaultTarget() {\n  return typeof window !== 'undefined' ? window : null;\n}\n\n// Affix\nexport interface AffixProps {\n  /**\n   * 距离窗口顶部达到指定偏移量后触发\n   */\n  offsetTop?: number;\n  offset?: number;\n  /** 距离窗口底部达到指定偏移量后触发 */\n  offsetBottom?: number;\n  style?: CSSProperties;\n  /** 固定状态改变时触发的回调函数 */\n  onChange?: (affixed?: boolean) => void;\n  /** 设置 Affix 需要监听其滚动事件的元素，值为一个返回对应 DOM 元素的函数 */\n  target?: () => Window | HTMLElement | null;\n  prefixCls?: string;\n  className?: string;\n}\n\nexport interface AffixState {\n  affixStyle: CSSProperties | undefined;\n  placeholderStyle: CSSProperties | undefined;\n}\n\nexport default class Affix extends Component<AffixProps, AffixState> {\n  static displayName = 'Affix';\n\n  static propTypes = {\n    offsetTop: PropTypes.number,\n    offsetBottom: PropTypes.number,\n    target: PropTypes.func,\n  };\n\n  state: AffixState = {\n    affixStyle: undefined,\n    placeholderStyle: undefined,\n  };\n\n  private timeout: number;\n\n  private eventHandlers: Record<string, any> = {};\n\n  private fixedNode: HTMLElement;\n\n  private placeholderNode: HTMLElement;\n\n  private readonly events = [\n    'resize',\n    'scroll',\n    'touchstart',\n    'touchmove',\n    'touchend',\n    'pageshow',\n    'load',\n  ];\n\n  setAffixStyle(e: Event, affixStyle: CSSProperties | null) {\n    const { onChange = noop, target = getDefaultTarget } = this.props;\n    const { affixStyle: originalAffixStyle } = this.state;\n    const isWindow = target() === window;\n    if (e.type === 'scroll' && originalAffixStyle && affixStyle && isWindow) {\n      return;\n    }\n    if (shallowequal(affixStyle, originalAffixStyle)) {\n      return;\n    }\n\n    this.setState({ affixStyle: affixStyle as React.CSSProperties }, () => {\n      if ((affixStyle && !originalAffixStyle) || (!affixStyle && originalAffixStyle)) {\n        const { state } = this;\n        onChange(!!state.affixStyle);\n      }\n    });\n  }\n\n  setPlaceholderStyle(placeholderStyle: CSSProperties | null) {\n    const { placeholderStyle: originalPlaceholderStyle } = this.state;\n    if (shallowequal(placeholderStyle, originalPlaceholderStyle)) {\n      return;\n    }\n    this.setState({ placeholderStyle: placeholderStyle as CSSProperties });\n  }\n\n  syncPlaceholderStyle(e: Event) {\n    const { affixStyle } = this.state;\n    if (!affixStyle) {\n      return;\n    }\n    this.placeholderNode.style.cssText = '';\n    this.setAffixStyle(e, {\n      ...affixStyle,\n      width: this.placeholderNode.offsetWidth,\n    });\n    this.setPlaceholderStyle({\n      width: this.placeholderNode.offsetWidth,\n    });\n  }\n\n  @throttleByAnimationFrameDecorator()\n  updatePosition(e: Event) {\n    const { offsetBottom, offset, target = getDefaultTarget } = this.props;\n    let { offsetTop } = this.props;\n    const targetNode = target();\n\n    // Backwards support\n    offsetTop = typeof offsetTop === 'undefined' ? offset : offsetTop;\n    const scrollTop = getScroll(targetNode, true);\n    const affixNode = findDOMNode(this) as HTMLElement;\n    const elemOffset = getOffset(affixNode, targetNode);\n    const elemSize = {\n      width: this.fixedNode.offsetWidth,\n      height: this.fixedNode.offsetHeight,\n    };\n\n    const offsetMode = {\n      top: false,\n      bottom: false,\n    };\n    // Default to `offsetTop=0`.\n    if (typeof offsetTop !== 'number' && typeof offsetBottom !== 'number') {\n      offsetMode.top = true;\n      offsetTop = 0;\n    } else {\n      offsetMode.top = typeof offsetTop === 'number';\n      offsetMode.bottom = typeof offsetBottom === 'number';\n    }\n\n    const targetRect = getTargetRect(targetNode);\n    const targetInnerHeight =\n      (targetNode as Window).innerHeight || (targetNode as HTMLElement).clientHeight;\n    if (scrollTop >= elemOffset.top - (offsetTop as number) && offsetMode.top) {\n      // Fixed Top\n      const width = elemOffset.width;\n      const top = targetRect.top + (offsetTop as number);\n      this.setAffixStyle(e, {\n        position: 'fixed',\n        top,\n        left: targetRect.left + elemOffset.left,\n        width,\n      });\n      this.setPlaceholderStyle({\n        width,\n        height: elemSize.height,\n      });\n    } else if (\n      scrollTop <=\n        elemOffset.top + elemSize.height + (offsetBottom as number) - targetInnerHeight &&\n      offsetMode.bottom\n    ) {\n      // Fixed Bottom\n      const targetBottomOffet = targetNode === window ? 0 : window.innerHeight - targetRect.bottom;\n      const width = elemOffset.width;\n      this.setAffixStyle(e, {\n        position: 'fixed',\n        bottom: targetBottomOffet + (offsetBottom as number),\n        left: targetRect.left + elemOffset.left,\n        width,\n      });\n      this.setPlaceholderStyle({\n        width,\n        height: elemOffset.height,\n      });\n    } else {\n      const { affixStyle } = this.state;\n      if (\n        e.type === 'resize' &&\n        affixStyle &&\n        affixStyle.position === 'fixed' &&\n        affixNode.offsetWidth\n      ) {\n        this.setAffixStyle(e, { ...affixStyle, width: affixNode.offsetWidth });\n      } else {\n        this.setAffixStyle(e, null);\n      }\n      this.setPlaceholderStyle(null);\n    }\n\n    if (e.type === 'resize') {\n      this.syncPlaceholderStyle(e);\n    }\n  }\n\n  componentDidMount() {\n    const { props } = this;\n    const target = props.target || getDefaultTarget;\n    // Wait for parent component ref has its value\n    this.timeout = setTimeout(() => {\n      this.setTargetEventListeners(target);\n      // Mock Event object.\n      this.updatePosition({} as Event);\n    });\n  }\n\n  componentWillReceiveProps(nextProps: AffixProps) {\n    const { offsetTop, offsetBottom, target } = this.props;\n    if (target !== nextProps.target) {\n      this.clearEventListeners();\n      this.setTargetEventListeners(nextProps.target!);\n\n      // Mock Event object.\n      this.updatePosition({} as Event);\n    }\n    if (offsetTop !== nextProps.offsetTop || offsetBottom !== nextProps.offsetBottom) {\n      this.updatePosition({} as Event);\n    }\n  }\n\n  componentWillUnmount() {\n    this.clearEventListeners();\n    clearTimeout(this.timeout);\n    (this.updatePosition as any).cancel();\n  }\n\n  setTargetEventListeners(getTarget: () => HTMLElement | Window | null) {\n    const target = getTarget();\n    if (!target) {\n      return;\n    }\n    this.clearEventListeners();\n\n    this.events.forEach(eventName => {\n      this.eventHandlers[eventName] = addEventListener(target, eventName, this.updatePosition);\n    });\n  }\n\n  clearEventListeners() {\n    this.events.forEach(eventName => {\n      const handler = this.eventHandlers[eventName];\n      if (handler && handler.remove) {\n        handler.remove();\n      }\n    });\n  }\n\n  saveFixedNode = (node: HTMLDivElement) => {\n    this.fixedNode = node;\n  };\n\n  savePlaceholderNode = (node: HTMLDivElement) => {\n    this.placeholderNode = node;\n  };\n\n  render() {\n    const { prefixCls, style, children } = this.props;\n    const { affixStyle, placeholderStyle } = this.state;\n    const className = classNames({\n      [getPrefixCls('affix', prefixCls)]: affixStyle,\n    });\n\n    const props = omit<AffixProps, keyof AffixProps>(this.props, [\n      'prefixCls',\n      'offsetTop',\n      'offsetBottom',\n      'target',\n      'onChange',\n    ]);\n    return (\n      <div {...props} style={{ ...placeholderStyle, ...style }} ref={this.savePlaceholderNode}>\n        <div className={className} ref={this.saveFixedNode} style={affixStyle}>\n          {children}\n        </div>\n      </div>\n    );\n  }\n}\n"]}