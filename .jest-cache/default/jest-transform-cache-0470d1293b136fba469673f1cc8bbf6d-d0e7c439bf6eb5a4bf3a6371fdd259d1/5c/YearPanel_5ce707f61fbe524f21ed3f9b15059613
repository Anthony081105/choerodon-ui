e40cef1ab56fc60dca0b6aeb805468a8
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var ROW = 4;
var COL = 3;

function goYear(direction) {
  var value = this.state.value.clone();
  value.add(direction, 'year');
  this.setState({
    value: value
  });
}

function chooseYear(year) {
  var value = this.state.value.clone();
  value.year(year);
  value.month(this.state.value.month());
  this.props.onSelect(value);
}

var YearPanel =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(YearPanel, _Component);

  function YearPanel(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, YearPanel);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(YearPanel).call(this, props));
    _this.prefixCls = "".concat(props.rootPrefixCls, "-year-panel");
    _this.state = {
      value: props.value || props.defaultValue
    };
    _this.nextDecade = goYear.bind((0, _assertThisInitialized2["default"])(_this), 10);
    _this.previousDecade = goYear.bind((0, _assertThisInitialized2["default"])(_this), -10);
    return _this;
  }

  (0, _createClass2["default"])(YearPanel, [{
    key: "years",
    value: function years() {
      var value = this.state.value;
      var currentYear = value.year();
      var startYear = parseInt(currentYear / 10, 10) * 10;
      var previousYear = startYear - 1;
      var years = [];
      var index = 0;

      for (var rowIndex = 0; rowIndex < ROW; rowIndex++) {
        years[rowIndex] = [];

        for (var colIndex = 0; colIndex < COL; colIndex++) {
          var year = previousYear + index;
          var content = String(year);
          years[rowIndex][colIndex] = {
            content: content,
            year: year,
            title: content
          };
          index++;
        }
      }

      return years;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var props = this.props;
      var value = this.state.value;
      var locale = props.locale;
      var years = this.years();
      var currentYear = value.year();
      var startYear = parseInt(currentYear / 10, 10) * 10;
      var endYear = startYear + 9;
      var prefixCls = this.prefixCls;
      var yeasEls = years.map(function (row, index) {
        var tds = row.map(function (yearData) {
          var _classNameMap;

          var classNameMap = (_classNameMap = {}, (0, _defineProperty2["default"])(_classNameMap, "".concat(prefixCls, "-cell"), 1), (0, _defineProperty2["default"])(_classNameMap, "".concat(prefixCls, "-selected-cell"), yearData.year === currentYear), (0, _defineProperty2["default"])(_classNameMap, "".concat(prefixCls, "-last-decade-cell"), yearData.year < startYear), (0, _defineProperty2["default"])(_classNameMap, "".concat(prefixCls, "-next-decade-cell"), yearData.year > endYear), _classNameMap);
          var clickHandler;

          if (yearData.year < startYear) {
            clickHandler = _this2.previousDecade;
          } else if (yearData.year > endYear) {
            clickHandler = _this2.nextDecade;
          } else {
            clickHandler = chooseYear.bind(_this2, yearData.year);
          }

          return _react["default"].createElement("td", {
            role: "gridcell",
            title: yearData.title,
            key: yearData.content,
            onClick: clickHandler,
            className: (0, _classnames["default"])(classNameMap)
          }, _react["default"].createElement("a", {
            className: "".concat(prefixCls, "-year")
          }, yearData.content));
        });
        return _react["default"].createElement("tr", {
          key: index,
          role: "row"
        }, tds);
      });
      return _react["default"].createElement("div", {
        className: this.prefixCls
      }, _react["default"].createElement("div", null, _react["default"].createElement("div", {
        className: "".concat(prefixCls, "-header")
      }, _react["default"].createElement("a", {
        className: "".concat(prefixCls, "-prev-decade-btn"),
        role: "button",
        onClick: this.previousDecade,
        title: locale.previousDecade
      }), _react["default"].createElement("a", {
        className: "".concat(prefixCls, "-decade-select"),
        role: "button",
        onClick: props.onDecadePanelShow,
        title: locale.decadeSelect
      }, _react["default"].createElement("span", {
        className: "".concat(prefixCls, "-decade-select-content")
      }, startYear, "-", endYear), _react["default"].createElement("span", {
        className: "".concat(prefixCls, "-decade-select-arrow")
      }, "x")), _react["default"].createElement("a", {
        className: "".concat(prefixCls, "-next-decade-btn"),
        role: "button",
        onClick: this.nextDecade,
        title: locale.nextDecade
      })), _react["default"].createElement("div", {
        className: "".concat(prefixCls, "-body")
      }, _react["default"].createElement("table", {
        className: "".concat(prefixCls, "-table"),
        cellSpacing: "0",
        role: "grid"
      }, _react["default"].createElement("tbody", {
        className: "".concat(prefixCls, "-tbody")
      }, yeasEls)))));
    }
  }]);
  return YearPanel;
}(_react.Component);

exports["default"] = YearPanel;
(0, _defineProperty2["default"])(YearPanel, "propTypes", {
  rootPrefixCls: _propTypes["default"].string,
  value: _propTypes["default"].object,
  defaultValue: _propTypes["default"].object
});
(0, _defineProperty2["default"])(YearPanel, "defaultProps", {
  onSelect: function onSelect() {}
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlllYXJQYW5lbC5qc3giXSwibmFtZXMiOlsiUk9XIiwiQ09MIiwiZ29ZZWFyIiwiZGlyZWN0aW9uIiwidmFsdWUiLCJzdGF0ZSIsImNsb25lIiwiYWRkIiwic2V0U3RhdGUiLCJjaG9vc2VZZWFyIiwieWVhciIsIm1vbnRoIiwicHJvcHMiLCJvblNlbGVjdCIsIlllYXJQYW5lbCIsInByZWZpeENscyIsInJvb3RQcmVmaXhDbHMiLCJkZWZhdWx0VmFsdWUiLCJuZXh0RGVjYWRlIiwiYmluZCIsInByZXZpb3VzRGVjYWRlIiwiY3VycmVudFllYXIiLCJzdGFydFllYXIiLCJwYXJzZUludCIsInByZXZpb3VzWWVhciIsInllYXJzIiwiaW5kZXgiLCJyb3dJbmRleCIsImNvbEluZGV4IiwiY29udGVudCIsIlN0cmluZyIsInRpdGxlIiwibG9jYWxlIiwiZW5kWWVhciIsInllYXNFbHMiLCJtYXAiLCJyb3ciLCJ0ZHMiLCJ5ZWFyRGF0YSIsImNsYXNzTmFtZU1hcCIsImNsaWNrSGFuZGxlciIsIm9uRGVjYWRlUGFuZWxTaG93IiwiZGVjYWRlU2VsZWN0IiwiQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwic3RyaW5nIiwib2JqZWN0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUEsSUFBTUEsR0FBRyxHQUFHLENBQVo7QUFDQSxJQUFNQyxHQUFHLEdBQUcsQ0FBWjs7QUFFQSxTQUFTQyxNQUFULENBQWdCQyxTQUFoQixFQUEyQjtBQUN6QixNQUFNQyxLQUFLLEdBQUcsS0FBS0MsS0FBTCxDQUFXRCxLQUFYLENBQWlCRSxLQUFqQixFQUFkO0FBQ0FGLEVBQUFBLEtBQUssQ0FBQ0csR0FBTixDQUFVSixTQUFWLEVBQXFCLE1BQXJCO0FBQ0EsT0FBS0ssUUFBTCxDQUFjO0FBQ1pKLElBQUFBLEtBQUssRUFBTEE7QUFEWSxHQUFkO0FBR0Q7O0FBRUQsU0FBU0ssVUFBVCxDQUFvQkMsSUFBcEIsRUFBMEI7QUFD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QUFFd0Msc0JBQVVFLE1BRkE7QUFHakI3QixFQUFBQSxZQUFZLEVBQUUyQixzQkFBVUU7QUFIUCxDO2lDQURBaEMsUyxrQkFPRztBQUNwQkQsRUFBQUEsUUFEb0Isc0JBQ1QsQ0FDVjtBQUZtQixDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuY29uc3QgUk9XID0gNDtcbmNvbnN0IENPTCA9IDM7XG5cbmZ1bmN0aW9uIGdvWWVhcihkaXJlY3Rpb24pIHtcbiAgY29uc3QgdmFsdWUgPSB0aGlzLnN0YXRlLnZhbHVlLmNsb25lKCk7XG4gIHZhbHVlLmFkZChkaXJlY3Rpb24sICd5ZWFyJyk7XG4gIHRoaXMuc2V0U3RhdGUoe1xuICAgIHZhbHVlLFxuICB9KTtcbn1cblxuZnVuY3Rpb24gY2hvb3NlWWVhcih5ZWFyKSB7XG4gIGNvbnN0IHZhbHVlID0gdGhpcy5zdGF0ZS52YWx1ZS5jbG9uZSgpO1xuICB2YWx1ZS55ZWFyKHllYXIpO1xuICB2YWx1ZS5tb250aCh0aGlzLnN0YXRlLnZhbHVlLm1vbnRoKCkpO1xuICB0aGlzLnByb3BzLm9uU2VsZWN0KHZhbHVlKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWWVhclBhbmVsIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICByb290UHJlZml4Q2xzOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHZhbHVlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGRlZmF1bHRWYWx1ZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgfTtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIG9uU2VsZWN0KCkge1xuICAgIH0sXG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5wcmVmaXhDbHMgPSBgJHtwcm9wcy5yb290UHJlZml4Q2xzfS15ZWFyLXBhbmVsYDtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdmFsdWU6IHByb3BzLnZhbHVlIHx8IHByb3BzLmRlZmF1bHRWYWx1ZSxcbiAgICB9O1xuICAgIHRoaXMubmV4dERlY2FkZSA9IGdvWWVhci5iaW5kKHRoaXMsIDEwKTtcbiAgICB0aGlzLnByZXZpb3VzRGVjYWRlID0gZ29ZZWFyLmJpbmQodGhpcywgLTEwKTtcbiAgfVxuXG4gIHllYXJzKCkge1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zdGF0ZS52YWx1ZTtcbiAgICBjb25zdCBjdXJyZW50WWVhciA9IHZhbHVlLnllYXIoKTtcbiAgICBjb25zdCBzdGFydFllYXIgPSBwYXJzZUludChjdXJyZW50WWVhciAvIDEwLCAxMCkgKiAxMDtcbiAgICBjb25zdCBwcmV2aW91c1llYXIgPSBzdGFydFllYXIgLSAxO1xuICAgIGNvbnN0IHllYXJzID0gW107XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICBmb3IgKGxldCByb3dJbmRleCA9IDA7IHJvd0luZGV4IDwgUk9XOyByb3dJbmRleCsrKSB7XG4gICAgICB5ZWFyc1tyb3dJbmRleF0gPSBbXTtcbiAgICAgIGZvciAobGV0IGNvbEluZGV4ID0gMDsgY29sSW5kZXggPCBDT0w7IGNvbEluZGV4KyspIHtcbiAgICAgICAgY29uc3QgeWVhciA9IHByZXZpb3VzWWVhciArIGluZGV4O1xuICAgICAgICBjb25zdCBjb250ZW50ID0gU3RyaW5nKHllYXIpO1xuICAgICAgICB5ZWFyc1tyb3dJbmRleF1bY29sSW5kZXhdID0ge1xuICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgeWVhcixcbiAgICAgICAgICB0aXRsZTogY29udGVudCxcbiAgICAgICAgfTtcbiAgICAgICAgaW5kZXgrKztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHllYXJzO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnN0YXRlLnZhbHVlO1xuICAgIGNvbnN0IGxvY2FsZSA9IHByb3BzLmxvY2FsZTtcbiAgICBjb25zdCB5ZWFycyA9IHRoaXMueWVhcnMoKTtcbiAgICBjb25zdCBjdXJyZW50WWVhciA9IHZhbHVlLnllYXIoKTtcbiAgICBjb25zdCBzdGFydFllYXIgPSBwYXJzZUludChjdXJyZW50WWVhciAvIDEwLCAxMCkgKiAxMDtcbiAgICBjb25zdCBlbmRZZWFyID0gc3RhcnRZZWFyICsgOTtcbiAgICBjb25zdCBwcmVmaXhDbHMgPSB0aGlzLnByZWZpeENscztcblxuICAgIGNvbnN0IHllYXNFbHMgPSB5ZWFycy5tYXAoKHJvdywgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHRkcyA9IHJvdy5tYXAoeWVhckRhdGEgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc05hbWVNYXAgPSB7XG4gICAgICAgICAgW2Ake3ByZWZpeENsc30tY2VsbGBdOiAxLFxuICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LXNlbGVjdGVkLWNlbGxgXTogeWVhckRhdGEueWVhciA9PT0gY3VycmVudFllYXIsXG4gICAgICAgICAgW2Ake3ByZWZpeENsc30tbGFzdC1kZWNhZGUtY2VsbGBdOiB5ZWFyRGF0YS55ZWFyIDwgc3RhcnRZZWFyLFxuICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LW5leHQtZGVjYWRlLWNlbGxgXTogeWVhckRhdGEueWVhciA+IGVuZFllYXIsXG4gICAgICAgIH07XG4gICAgICAgIGxldCBjbGlja0hhbmRsZXI7XG4gICAgICAgIGlmICh5ZWFyRGF0YS55ZWFyIDwgc3RhcnRZZWFyKSB7XG4gICAgICAgICAgY2xpY2tIYW5kbGVyID0gdGhpcy5wcmV2aW91c0RlY2FkZTtcbiAgICAgICAgfSBlbHNlIGlmICh5ZWFyRGF0YS55ZWFyID4gZW5kWWVhcikge1xuICAgICAgICAgIGNsaWNrSGFuZGxlciA9IHRoaXMubmV4dERlY2FkZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjbGlja0hhbmRsZXIgPSBjaG9vc2VZZWFyLmJpbmQodGhpcywgeWVhckRhdGEueWVhcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8dGRcbiAgICAgICAgICAgIHJvbGU9XCJncmlkY2VsbFwiXG4gICAgICAgICAgICB0aXRsZT17eWVhckRhdGEudGl0bGV9XG4gICAgICAgICAgICBrZXk9e3llYXJEYXRhLmNvbnRlbnR9XG4gICAgICAgICAgICBvbkNsaWNrPXtjbGlja0hhbmRsZXJ9XG4gICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoY2xhc3NOYW1lTWFwKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8YVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30teWVhcmB9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHt5ZWFyRGF0YS5jb250ZW50fVxuICAgICAgICAgICAgPC9hPlxuICAgICAgICAgIDwvdGQ+KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuICg8dHIga2V5PXtpbmRleH0gcm9sZT1cInJvd1wiPnt0ZHN9PC90cj4pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXt0aGlzLnByZWZpeENsc30+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30taGVhZGVyYH0+XG4gICAgICAgICAgICA8YVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tcHJldi1kZWNhZGUtYnRuYH1cbiAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJldmlvdXNEZWNhZGV9XG4gICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGUucHJldmlvdXNEZWNhZGV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LWRlY2FkZS1zZWxlY3RgfVxuICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgb25DbGljaz17cHJvcHMub25EZWNhZGVQYW5lbFNob3d9XG4gICAgICAgICAgICAgIHRpdGxlPXtsb2NhbGUuZGVjYWRlU2VsZWN0fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tZGVjYWRlLXNlbGVjdC1jb250ZW50YH0+XG4gICAgICAgICAgICAgICAge3N0YXJ0WWVhcn0te2VuZFllYXJ9XG4gICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LWRlY2FkZS1zZWxlY3QtYXJyb3dgfT54PC9zcGFuPlxuICAgICAgICAgICAgPC9hPlxuXG4gICAgICAgICAgICA8YVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tbmV4dC1kZWNhZGUtYnRuYH1cbiAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMubmV4dERlY2FkZX1cbiAgICAgICAgICAgICAgdGl0bGU9e2xvY2FsZS5uZXh0RGVjYWRlfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1ib2R5YH0+XG4gICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXRhYmxlYH0gY2VsbFNwYWNpbmc9XCIwXCIgcm9sZT1cImdyaWRcIj5cbiAgICAgICAgICAgICAgPHRib2R5IGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS10Ym9keWB9PlxuICAgICAgICAgICAgICB7eWVhc0Vsc31cbiAgICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+KTtcbiAgfVxufVxuIl19