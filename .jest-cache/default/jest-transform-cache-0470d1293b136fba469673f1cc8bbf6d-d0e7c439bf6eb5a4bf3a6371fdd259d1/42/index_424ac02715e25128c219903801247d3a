ac4f15b196d0abaecda077829b6d646e
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _placements = _interopRequireDefault(require("./placements"));

var _tooltip = _interopRequireDefault(require("../rc-components/tooltip"));

var _configure = require("../configure");

var splitObject = function splitObject(obj, keys) {
  var picked = {};
  var omited = (0, _objectSpread2["default"])({}, obj);
  keys.forEach(function (key) {
    if (obj && key in obj) {
      picked[key] = obj[key];
      delete omited[key];
    }
  });
  return {
    picked: picked,
    omited: omited
  };
};

var Tooltip =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Tooltip, _Component);

  function Tooltip(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, Tooltip);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(Tooltip).call(this, props));

    _this.onVisibleChange = function (visible) {
      var onVisibleChange = _this.props.onVisibleChange;

      if (!('visible' in _this.props)) {
        _this.setState({
          visible: _this.isNoTitle() ? false : visible
        });
      }

      if (onVisibleChange && !_this.isNoTitle()) {
        onVisibleChange(visible);
      }
    }; // 动态设置动画点


    _this.onPopupAlign = function (domNode, align) {
      var placements = _this.getPlacements(); // 当前返回的位置


      var placement = Object.keys(placements).filter(function (key) {
        return placements[key].points[0] === align.points[0] && placements[key].points[1] === align.points[1];
      })[0];

      if (!placement) {
        return;
      } // 根据当前坐标设置动画点


      var rect = domNode.getBoundingClientRect();
      var transformOrigin = {
        top: '50%',
        left: '50%'
      };

      if (placement.indexOf('top') >= 0 || placement.indexOf('Bottom') >= 0) {
        transformOrigin.top = "".concat(rect.height - align.offset[1], "px");
      } else if (placement.indexOf('Top') >= 0 || placement.indexOf('bottom') >= 0) {
        transformOrigin.top = "".concat(-align.offset[1], "px");
      }

      if (placement.indexOf('left') >= 0 || placement.indexOf('Right') >= 0) {
        transformOrigin.left = "".concat(rect.width - align.offset[0], "px");
      } else if (placement.indexOf('right') >= 0 || placement.indexOf('Left') >= 0) {
        transformOrigin.left = "".concat(-align.offset[0], "px");
      }

      domNode.style.transformOrigin = "".concat(transformOrigin.left, " ").concat(transformOrigin.top);
    };

    _this.saveTooltip = function (node) {
      _this.tooltip = node;
    };

    _this.state = {
      visible: !!props.visible || !!props.defaultVisible
    };
    return _this;
  }

  (0, _createClass2["default"])(Tooltip, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if ('visible' in nextProps) {
        this.setState({
          visible: nextProps.visible
        });
      }
    }
  }, {
    key: "getPopupDomNode",
    value: function getPopupDomNode() {
      return this.tooltip.getPopupDomNode();
    }
  }, {
    key: "getPlacements",
    value: function getPlacements() {
      var _this$props = this.props,
          builtinPlacements = _this$props.builtinPlacements,
          arrowPointAtCenter = _this$props.arrowPointAtCenter,
          autoAdjustOverflow = _this$props.autoAdjustOverflow;
      return builtinPlacements || (0, _placements["default"])({
        arrowPointAtCenter: arrowPointAtCenter,
        verticalArrowShift: 8,
        autoAdjustOverflow: autoAdjustOverflow
      });
    }
  }, {
    key: "isHoverTrigger",
    value: function isHoverTrigger() {
      var trigger = this.props.trigger;

      if (!trigger || trigger === 'hover') {
        return true;
      }

      if (Array.isArray(trigger)) {
        return trigger.indexOf('hover') >= 0;
      }

      return false;
    } // Fix Tooltip won't hide at disabled button
    // mouse events don't trigger at disabled button in Chrome
    // https://github.com/react-component/tooltip/issues/18

  }, {
    key: "getDisabledCompatibleChildren",
    value: function getDisabledCompatibleChildren(element) {
      if ((element.type.__ANT_BUTTON || element.type === 'button') && element.props.disabled && this.isHoverTrigger()) {
        // Pick some layout related style properties up to span
        var _splitObject = splitObject(element.props.style, ['position', 'left', 'right', 'top', 'bottom', 'float', 'display', 'zIndex']),
            picked = _splitObject.picked,
            omited = _splitObject.omited;

        var spanStyle = (0, _objectSpread2["default"])({
          display: 'inline-block'
        }, picked, {
          cursor: 'not-allowed'
        });
        var buttonStyle = (0, _objectSpread2["default"])({}, omited, {
          pointerEvents: 'none'
        });
        var child = (0, _react.cloneElement)(element, {
          style: buttonStyle,
          className: null
        });
        return _react["default"].createElement("span", {
          style: spanStyle,
          className: element.props.className
        }, child);
      }

      return element;
    }
  }, {
    key: "isNoTitle",
    value: function isNoTitle() {
      var _this$props2 = this.props,
          title = _this$props2.title,
          overlay = _this$props2.overlay;
      return !title && !overlay; // overlay for old version compatibility
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props,
          state = this.state;
      var customizePrefixCls = props.prefixCls,
          title = props.title,
          overlay = props.overlay,
          openClassName = props.openClassName,
          getPopupContainer = props.getPopupContainer,
          getTooltipContainer = props.getTooltipContainer;
      var prefixCls = (0, _configure.getPrefixCls)('tooltip', customizePrefixCls);
      var children = props.children;
      var visible = state.visible; // Hide tooltip when there is no title

      if (!('visible' in props) && this.isNoTitle()) {
        visible = false;
      }

      var child = this.getDisabledCompatibleChildren((0, _react.isValidElement)(children) ? children : _react["default"].createElement("span", null, children));
      var childProps = child.props;
      var childCls = (0, _classnames["default"])(childProps.className, (0, _defineProperty2["default"])({}, openClassName || "".concat(prefixCls, "-open"), true));
      return _react["default"].createElement(_tooltip["default"], (0, _extends2["default"])({}, this.props, {
        prefixCls: prefixCls,
        getTooltipContainer: getPopupContainer || getTooltipContainer,
        ref: this.saveTooltip,
        builtinPlacements: this.getPlacements(),
        overlay: overlay || title || '',
        visible: visible,
        onVisibleChange: this.onVisibleChange,
        onPopupAlign: this.onPopupAlign
      }), visible ? (0, _react.cloneElement)(child, {
        className: childCls
      }) : child);
    }
  }]);
  return Tooltip;
}(_react.Component);

exports["default"] = Tooltip;
Tooltip.displayName = 'Tooltip';
Tooltip.defaultProps = {
  placement: 'top',
  transitionName: 'zoom-big-fast',
  mouseEnterDelay: 0.1,
  mouseLeaveDelay: 0.1,
  arrowPointAtCenter: false,
  autoAdjustOverflow: true
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvb2x0aXAvaW5kZXguanN4Il0sIm5hbWVzIjpbInNwbGl0T2JqZWN0IiwicGlja2VkIiwib21pdGVkIiwia2V5cyIsIm9iaiIsImtleSIsIlRvb2x0aXAiLCJDb21wb25lbnQiLCJvblZpc2libGVDaGFuZ2UiLCJ2aXNpYmxlIiwicGxhY2VtZW50cyIsInBsYWNlbWVudCIsImFsaWduIiwicmVjdCIsImRvbU5vZGUiLCJ0cmFuc2Zvcm1PcmlnaW4iLCJ0b3AiLCJsZWZ0IiwicHJvcHMiLCJkZWZhdWx0VmlzaWJsZSIsIm5leHRQcm9wcyIsImJ1aWx0aW5QbGFjZW1lbnRzIiwiYXJyb3dQb2ludEF0Q2VudGVyIiwiYXV0b0FkanVzdE92ZXJmbG93IiwidmVydGljYWxBcnJvd1NoaWZ0IiwidHJpZ2dlciIsIkFycmF5IiwiZWxlbWVudCIsInNwYW5TdHlsZSIsImRpc3BsYXkiLCJjdXJzb3IiLCJidXR0b25TdHlsZSIsInBvaW50ZXJFdmVudHMiLCJjaGlsZCIsInN0eWxlIiwiY2xhc3NOYW1lIiwidGl0bGUiLCJvdmVybGF5Iiwic3RhdGUiLCJjdXN0b21pemVQcmVmaXhDbHMiLCJvcGVuQ2xhc3NOYW1lIiwiZ2V0UG9wdXBDb250YWluZXIiLCJnZXRUb29sdGlwQ29udGFpbmVyIiwicHJlZml4Q2xzIiwiY2hpbGRyZW4iLCJjaGlsZFByb3BzIiwiY2hpbGRDbHMiLCJvblBvcHVwQWxpZ24iLCJ0cmFuc2l0aW9uTmFtZSIsIm1vdXNlRW50ZXJEZWxheSIsIm1vdXNlTGVhdmVEZWxheSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQSxNQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxXQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxXQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsY0FBQSxDQUFBLENB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TixRQUFBLE9BQU8sRUFBeE4sT0FBQTtBQUFtTyxRQUFBLGVBQWUsRUFBRSxLQUFwUCxlQUFBO0FBQTBRLFFBQUEsWUFBWSxFQUFFLEtBQUtVO0FBQTdSLE9BQUEsQ0FBQSxFQUNQdEMsT0FBTyxHQUFHLENBQUEsR0FBQSxNQUFBLENBQUEsWUFBQSxFQUFBLEtBQUEsRUFBb0I7QUFBRTBCLFFBQUFBLFNBQVMsRUFBRVc7QUFBYixPQUFwQixDQUFILEdBRFIsS0FBUSxDQUFSO0FBR0g7OztFQXRJZ0N2QyxNQUFBQSxDQUFBQSxTOzs7QUF3SXJDRCxPQUFPLENBQVBBLFdBQUFBLEdBQUFBLFNBQUFBO0FBQ0FBLE9BQU8sQ0FBUEEsWUFBQUEsR0FBdUI7QUFDbkJLLEVBQUFBLFNBQVMsRUFEVSxLQUFBO0FBRW5CcUMsRUFBQUEsY0FBYyxFQUZLLGVBQUE7QUFHbkJDLEVBQUFBLGVBQWUsRUFISSxHQUFBO0FBSW5CQyxFQUFBQSxlQUFlLEVBSkksR0FBQTtBQUtuQjVCLEVBQUFBLGtCQUFrQixFQUxDLEtBQUE7QUFNbkJDLEVBQUFBLGtCQUFrQixFQUFFO0FBTkQsQ0FBdkJqQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBjbG9uZUVsZW1lbnQsIENvbXBvbmVudCwgaXNWYWxpZEVsZW1lbnQsIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgZ2V0UGxhY2VtZW50cyBmcm9tICcuL3BsYWNlbWVudHMnO1xuaW1wb3J0IFJjVG9vbHRpcCBmcm9tICcuLi9yYy1jb21wb25lbnRzL3Rvb2x0aXAnO1xuaW1wb3J0IHsgZ2V0UHJlZml4Q2xzIH0gZnJvbSAnLi4vY29uZmlndXJlJztcbmNvbnN0IHNwbGl0T2JqZWN0ID0gKG9iaiwga2V5cykgPT4ge1xuICAgIGNvbnN0IHBpY2tlZCA9IHt9O1xuICAgIGNvbnN0IG9taXRlZCA9IHsgLi4ub2JqIH07XG4gICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmIChvYmogJiYga2V5IGluIG9iaikge1xuICAgICAgICAgICAgcGlja2VkW2tleV0gPSBvYmpba2V5XTtcbiAgICAgICAgICAgIGRlbGV0ZSBvbWl0ZWRba2V5XTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7IHBpY2tlZCwgb21pdGVkIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9vbHRpcCBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLm9uVmlzaWJsZUNoYW5nZSA9ICh2aXNpYmxlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IG9uVmlzaWJsZUNoYW5nZSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgICAgIGlmICghKCd2aXNpYmxlJyBpbiB0aGlzLnByb3BzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB2aXNpYmxlOiB0aGlzLmlzTm9UaXRsZSgpID8gZmFsc2UgOiB2aXNpYmxlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9uVmlzaWJsZUNoYW5nZSAmJiAhdGhpcy5pc05vVGl0bGUoKSkge1xuICAgICAgICAgICAgICAgIG9uVmlzaWJsZUNoYW5nZSh2aXNpYmxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8g5Yqo5oCB6K6+572u5Yqo55S754K5XG4gICAgICAgIHRoaXMub25Qb3B1cEFsaWduID0gKGRvbU5vZGUsIGFsaWduKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwbGFjZW1lbnRzID0gdGhpcy5nZXRQbGFjZW1lbnRzKCk7XG4gICAgICAgICAgICAvLyDlvZPliY3ov5Tlm57nmoTkvY3nva5cbiAgICAgICAgICAgIGNvbnN0IHBsYWNlbWVudCA9IE9iamVjdC5rZXlzKHBsYWNlbWVudHMpLmZpbHRlcihrZXkgPT4gcGxhY2VtZW50c1trZXldLnBvaW50c1swXSA9PT0gYWxpZ24ucG9pbnRzWzBdICYmXG4gICAgICAgICAgICAgICAgcGxhY2VtZW50c1trZXldLnBvaW50c1sxXSA9PT0gYWxpZ24ucG9pbnRzWzFdKVswXTtcbiAgICAgICAgICAgIGlmICghcGxhY2VtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8g5qC55o2u5b2T5YmN5Z2Q5qCH6K6+572u5Yqo55S754K5XG4gICAgICAgICAgICBjb25zdCByZWN0ID0gZG9tTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZm9ybU9yaWdpbiA9IHtcbiAgICAgICAgICAgICAgICB0b3A6ICc1MCUnLFxuICAgICAgICAgICAgICAgIGxlZnQ6ICc1MCUnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChwbGFjZW1lbnQuaW5kZXhPZigndG9wJykgPj0gMCB8fCBwbGFjZW1lbnQuaW5kZXhPZignQm90dG9tJykgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbi50b3AgPSBgJHtyZWN0LmhlaWdodCAtIGFsaWduLm9mZnNldFsxXX1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwbGFjZW1lbnQuaW5kZXhPZignVG9wJykgPj0gMCB8fCBwbGFjZW1lbnQuaW5kZXhPZignYm90dG9tJykgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbi50b3AgPSBgJHstYWxpZ24ub2Zmc2V0WzFdfXB4YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwbGFjZW1lbnQuaW5kZXhPZignbGVmdCcpID49IDAgfHwgcGxhY2VtZW50LmluZGV4T2YoJ1JpZ2h0JykgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbi5sZWZ0ID0gYCR7cmVjdC53aWR0aCAtIGFsaWduLm9mZnNldFswXX1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwbGFjZW1lbnQuaW5kZXhPZigncmlnaHQnKSA+PSAwIHx8IHBsYWNlbWVudC5pbmRleE9mKCdMZWZ0JykgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbi5sZWZ0ID0gYCR7LWFsaWduLm9mZnNldFswXX1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb21Ob2RlLnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9IGAke3RyYW5zZm9ybU9yaWdpbi5sZWZ0fSAke3RyYW5zZm9ybU9yaWdpbi50b3B9YDtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zYXZlVG9vbHRpcCA9IChub2RlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAgPSBub2RlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgdmlzaWJsZTogISFwcm9wcy52aXNpYmxlIHx8ICEhcHJvcHMuZGVmYXVsdFZpc2libGUsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmICgndmlzaWJsZScgaW4gbmV4dFByb3BzKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogbmV4dFByb3BzLnZpc2libGUgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0UG9wdXBEb21Ob2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b29sdGlwLmdldFBvcHVwRG9tTm9kZSgpO1xuICAgIH1cbiAgICBnZXRQbGFjZW1lbnRzKCkge1xuICAgICAgICBjb25zdCB7IGJ1aWx0aW5QbGFjZW1lbnRzLCBhcnJvd1BvaW50QXRDZW50ZXIsIGF1dG9BZGp1c3RPdmVyZmxvdyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuIChidWlsdGluUGxhY2VtZW50cyB8fFxuICAgICAgICAgICAgZ2V0UGxhY2VtZW50cyh7XG4gICAgICAgICAgICAgICAgYXJyb3dQb2ludEF0Q2VudGVyLFxuICAgICAgICAgICAgICAgIHZlcnRpY2FsQXJyb3dTaGlmdDogOCxcbiAgICAgICAgICAgICAgICBhdXRvQWRqdXN0T3ZlcmZsb3csXG4gICAgICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlzSG92ZXJUcmlnZ2VyKCkge1xuICAgICAgICBjb25zdCB7IHRyaWdnZXIgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmICghdHJpZ2dlciB8fCB0cmlnZ2VyID09PSAnaG92ZXInKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0cmlnZ2VyKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRyaWdnZXIuaW5kZXhPZignaG92ZXInKSA+PSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gRml4IFRvb2x0aXAgd29uJ3QgaGlkZSBhdCBkaXNhYmxlZCBidXR0b25cbiAgICAvLyBtb3VzZSBldmVudHMgZG9uJ3QgdHJpZ2dlciBhdCBkaXNhYmxlZCBidXR0b24gaW4gQ2hyb21lXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0LWNvbXBvbmVudC90b29sdGlwL2lzc3Vlcy8xOFxuICAgIGdldERpc2FibGVkQ29tcGF0aWJsZUNoaWxkcmVuKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKChlbGVtZW50LnR5cGUuX19BTlRfQlVUVE9OIHx8IGVsZW1lbnQudHlwZSA9PT0gJ2J1dHRvbicpICYmXG4gICAgICAgICAgICBlbGVtZW50LnByb3BzLmRpc2FibGVkICYmXG4gICAgICAgICAgICB0aGlzLmlzSG92ZXJUcmlnZ2VyKCkpIHtcbiAgICAgICAgICAgIC8vIFBpY2sgc29tZSBsYXlvdXQgcmVsYXRlZCBzdHlsZSBwcm9wZXJ0aWVzIHVwIHRvIHNwYW5cbiAgICAgICAgICAgIGNvbnN0IHsgcGlja2VkLCBvbWl0ZWQgfSA9IHNwbGl0T2JqZWN0KGVsZW1lbnQucHJvcHMuc3R5bGUsIFtcbiAgICAgICAgICAgICAgICAncG9zaXRpb24nLFxuICAgICAgICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAgICAgICAncmlnaHQnLFxuICAgICAgICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICAgICAgICdib3R0b20nLFxuICAgICAgICAgICAgICAgICdmbG9hdCcsXG4gICAgICAgICAgICAgICAgJ2Rpc3BsYXknLFxuICAgICAgICAgICAgICAgICd6SW5kZXgnLFxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBjb25zdCBzcGFuU3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ2lubGluZS1ibG9jaycsXG4gICAgICAgICAgICAgICAgLi4ucGlja2VkLFxuICAgICAgICAgICAgICAgIGN1cnNvcjogJ25vdC1hbGxvd2VkJyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBidXR0b25TdHlsZSA9IHtcbiAgICAgICAgICAgICAgICAuLi5vbWl0ZWQsXG4gICAgICAgICAgICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2xvbmVFbGVtZW50KGVsZW1lbnQsIHtcbiAgICAgICAgICAgICAgICBzdHlsZTogYnV0dG9uU3R5bGUsXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBudWxsLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gKDxzcGFuIHN0eWxlPXtzcGFuU3R5bGV9IGNsYXNzTmFtZT17ZWxlbWVudC5wcm9wcy5jbGFzc05hbWV9PlxuICAgICAgICAgIHtjaGlsZH1cbiAgICAgICAgPC9zcGFuPik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxuICAgIGlzTm9UaXRsZSgpIHtcbiAgICAgICAgY29uc3QgeyB0aXRsZSwgb3ZlcmxheSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuICF0aXRsZSAmJiAhb3ZlcmxheTsgLy8gb3ZlcmxheSBmb3Igb2xkIHZlcnNpb24gY29tcGF0aWJpbGl0eVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgcHJvcHMsIHN0YXRlIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IHByZWZpeENsczogY3VzdG9taXplUHJlZml4Q2xzLCB0aXRsZSwgb3ZlcmxheSwgb3BlbkNsYXNzTmFtZSwgZ2V0UG9wdXBDb250YWluZXIsIGdldFRvb2x0aXBDb250YWluZXIsIH0gPSBwcm9wcztcbiAgICAgICAgY29uc3QgcHJlZml4Q2xzID0gZ2V0UHJlZml4Q2xzKCd0b29sdGlwJywgY3VzdG9taXplUHJlZml4Q2xzKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbjtcbiAgICAgICAgbGV0IHZpc2libGUgPSBzdGF0ZS52aXNpYmxlO1xuICAgICAgICAvLyBIaWRlIHRvb2x0aXAgd2hlbiB0aGVyZSBpcyBubyB0aXRsZVxuICAgICAgICBpZiAoISgndmlzaWJsZScgaW4gcHJvcHMpICYmIHRoaXMuaXNOb1RpdGxlKCkpIHtcbiAgICAgICAgICAgIHZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuZ2V0RGlzYWJsZWRDb21wYXRpYmxlQ2hpbGRyZW4oaXNWYWxpZEVsZW1lbnQoY2hpbGRyZW4pID8gY2hpbGRyZW4gOiA8c3Bhbj57Y2hpbGRyZW59PC9zcGFuPik7XG4gICAgICAgIGNvbnN0IGNoaWxkUHJvcHMgPSBjaGlsZC5wcm9wcztcbiAgICAgICAgY29uc3QgY2hpbGRDbHMgPSBjbGFzc05hbWVzKGNoaWxkUHJvcHMuY2xhc3NOYW1lLCB7XG4gICAgICAgICAgICBbb3BlbkNsYXNzTmFtZSB8fCBgJHtwcmVmaXhDbHN9LW9wZW5gXTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAoPFJjVG9vbHRpcCB7Li4udGhpcy5wcm9wc30gcHJlZml4Q2xzPXtwcmVmaXhDbHN9IGdldFRvb2x0aXBDb250YWluZXI9e2dldFBvcHVwQ29udGFpbmVyIHx8IGdldFRvb2x0aXBDb250YWluZXJ9IHJlZj17dGhpcy5zYXZlVG9vbHRpcH0gYnVpbHRpblBsYWNlbWVudHM9e3RoaXMuZ2V0UGxhY2VtZW50cygpfSBvdmVybGF5PXtvdmVybGF5IHx8IHRpdGxlIHx8ICcnfSB2aXNpYmxlPXt2aXNpYmxlfSBvblZpc2libGVDaGFuZ2U9e3RoaXMub25WaXNpYmxlQ2hhbmdlfSBvblBvcHVwQWxpZ249e3RoaXMub25Qb3B1cEFsaWdufT5cbiAgICAgICAge3Zpc2libGUgPyBjbG9uZUVsZW1lbnQoY2hpbGQsIHsgY2xhc3NOYW1lOiBjaGlsZENscyB9KSA6IGNoaWxkfVxuICAgICAgPC9SY1Rvb2x0aXA+KTtcbiAgICB9XG59XG5Ub29sdGlwLmRpc3BsYXlOYW1lID0gJ1Rvb2x0aXAnO1xuVG9vbHRpcC5kZWZhdWx0UHJvcHMgPSB7XG4gICAgcGxhY2VtZW50OiAndG9wJyxcbiAgICB0cmFuc2l0aW9uTmFtZTogJ3pvb20tYmlnLWZhc3QnLFxuICAgIG1vdXNlRW50ZXJEZWxheTogMC4xLFxuICAgIG1vdXNlTGVhdmVEZWxheTogMC4xLFxuICAgIGFycm93UG9pbnRBdENlbnRlcjogZmFsc2UsXG4gICAgYXV0b0FkanVzdE92ZXJmbG93OiB0cnVlLFxufTtcbiJdfQ==