{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components/calendar/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { Component, CSSProperties, ReactNode } from 'react';\nimport PropTypes from 'prop-types';\nimport moment, { Moment } from 'moment';\nimport noop from 'lodash/noop';\nimport LocaleReceiver from '../locale-provider/LocaleReceiver';\nimport Header from './Header';\nimport interopDefault from '../_util/interopDefault';\nimport enUS from './locale/en_US';\nimport FullCalendar from '../rc-components/calendar/FullCalendar';\nimport { getPrefixCls } from '../configure';\n\nexport { HeaderProps } from './Header';\n\nfunction zerofixed(v: number) {\n  if (v < 10) {\n    return `0${v}`;\n  }\n  return `${v}`;\n}\n\nexport type CalendarMode = 'month' | 'year';\n\nexport interface CalendarProps {\n  prefixCls?: string;\n  className?: string;\n  value?: Moment;\n  defaultValue?: Moment;\n  mode?: CalendarMode;\n  fullscreen?: boolean;\n  dateCellRender?: (date: Moment) => ReactNode;\n  monthCellRender?: (date: Moment) => ReactNode;\n  dateFullCellRender?: (date: Moment) => ReactNode;\n  monthFullCellRender?: (date: Moment) => ReactNode;\n  locale?: any;\n  style?: CSSProperties;\n  onPanelChange?: (date?: Moment, mode?: CalendarMode) => void;\n  onSelect?: (date?: Moment) => void;\n  disabledDate?: (current: Moment) => boolean;\n  validRange?: [Moment, Moment];\n}\n\nexport interface CalendarState {\n  value: Moment;\n  mode?: CalendarMode;\n}\n\nexport default class Calendar extends Component<CalendarProps, CalendarState> {\n  static displayName = 'Calendar';\n\n  static defaultProps = {\n    locale: {},\n    fullscreen: true,\n    mode: 'month',\n    onSelect: noop,\n    onPanelChange: noop,\n  };\n\n  static propTypes = {\n    monthCellRender: PropTypes.func,\n    dateCellRender: PropTypes.func,\n    monthFullCellRender: PropTypes.func,\n    dateFullCellRender: PropTypes.func,\n    fullscreen: PropTypes.bool,\n    locale: PropTypes.object,\n    prefixCls: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    onPanelChange: PropTypes.func,\n    value: PropTypes.object,\n    onSelect: PropTypes.func,\n    mode: PropTypes.string,\n  };\n\n  constructor(props: CalendarProps) {\n    super(props);\n\n    const value = props.value || props.defaultValue || interopDefault(moment)();\n    if (!interopDefault(moment).isMoment(value)) {\n      throw new Error('The value/defaultValue of Calendar must be a moment object');\n    }\n    this.state = {\n      value,\n      mode: props.mode,\n    };\n  }\n\n  componentWillReceiveProps(nextProps: CalendarProps) {\n    if ('value' in nextProps) {\n      this.setState({\n        value: nextProps.value!,\n      });\n    }\n    const { mode } = this.props;\n    if ('mode' in nextProps && nextProps.mode !== mode) {\n      this.setState({\n        mode: nextProps.mode!,\n      });\n    }\n  }\n\n  getPrefixCls() {\n    const { prefixCls } = this.props;\n    return getPrefixCls('fullcalendar', prefixCls);\n  }\n\n  monthCellRender = (value: Moment) => {\n    const { monthCellRender = noop as Function } = this.props;\n    const prefixCls = this.getPrefixCls();\n    return (\n      <div className={`${prefixCls}-month`}>\n        <div className={`${prefixCls}-value`}>{value.localeData().monthsShort(value)}</div>\n        <div className={`${prefixCls}-content`}>{monthCellRender(value)}</div>\n      </div>\n    );\n  };\n\n  dateCellRender = (value: Moment) => {\n    const { dateCellRender = noop as Function } = this.props;\n    const prefixCls = this.getPrefixCls();\n    return (\n      <div className={`${prefixCls}-date`}>\n        <div className={`${prefixCls}-value`}>{zerofixed(value.date())}</div>\n        <div className={`${prefixCls}-content`}>{dateCellRender(value)}</div>\n      </div>\n    );\n  };\n\n  setValue = (value: Moment, way: 'select' | 'changePanel') => {\n    if (!('value' in this.props)) {\n      this.setState({ value });\n    }\n    if (way === 'select') {\n      const { onSelect } = this.props;\n      if (onSelect) {\n        onSelect(value);\n      }\n    } else if (way === 'changePanel') {\n      const { mode } = this.state;\n      this.onPanelChange(value, mode);\n    }\n  };\n\n  setType = (type: string) => {\n    const mode = type === 'date' ? 'month' : 'year';\n    const { mode: stateMode, value } = this.state;\n    if (stateMode !== mode) {\n      this.setState({ mode });\n      this.onPanelChange(value, mode);\n    }\n  };\n\n  onHeaderValueChange = (value: Moment) => {\n    this.setValue(value, 'changePanel');\n  };\n\n  onHeaderTypeChange = (type: string) => {\n    this.setType(type);\n  };\n\n  onPanelChange(value: Moment, mode: CalendarMode | undefined) {\n    const { onPanelChange } = this.props;\n    if (onPanelChange) {\n      onPanelChange(value, mode);\n    }\n  }\n\n  onSelect = (value: Moment) => {\n    this.setValue(value, 'select');\n  };\n\n  getDateRange = (validRange: [Moment, Moment], disabledDate?: (current: Moment) => boolean) => (\n    current: Moment,\n  ) => {\n    if (!current) {\n      return false;\n    }\n    const [startDate, endDate] = validRange;\n    const inRange = !current.isBetween(startDate, endDate, 'days', '[]');\n    if (disabledDate) {\n      return disabledDate(current) || inRange;\n    }\n    return inRange;\n  };\n\n  renderCalendar = (locale: any, localeCode: string) => {\n    const { state, props } = this;\n    const { value, mode } = state;\n    if (value && localeCode) {\n      value.locale(localeCode);\n    }\n    const { style, className, fullscreen, dateFullCellRender, monthFullCellRender } = props;\n    const prefixCls = this.getPrefixCls();\n    const type = mode === 'year' ? 'month' : 'date';\n\n    let cls = className || '';\n    if (fullscreen) {\n      cls += ` ${prefixCls}-fullscreen`;\n    }\n\n    const monthCellRender = monthFullCellRender || this.monthCellRender;\n    const dateCellRender = dateFullCellRender || this.dateCellRender;\n\n    let disabledDate = props.disabledDate;\n\n    if (props.validRange) {\n      disabledDate = this.getDateRange(props.validRange, disabledDate);\n    }\n\n    return (\n      <div className={cls} style={style}>\n        <Header\n          fullscreen={fullscreen}\n          type={type}\n          value={value}\n          locale={locale.lang}\n          prefixCls={prefixCls}\n          onTypeChange={this.onHeaderTypeChange}\n          onValueChange={this.onHeaderValueChange}\n          validRange={props.validRange}\n        />\n        <FullCalendar\n          {...props}\n          disabledDate={disabledDate}\n          Select={noop}\n          locale={locale.lang}\n          type={type}\n          prefixCls={prefixCls}\n          showHeader={false}\n          value={value}\n          monthCellRender={monthCellRender}\n          dateCellRender={dateCellRender}\n          onSelect={this.onSelect}\n        />\n      </div>\n    );\n  };\n\n  render() {\n    return (\n      <LocaleReceiver componentName=\"Calendar\" defaultLocale={enUS}>\n        {this.renderCalendar}\n      </LocaleReceiver>\n    );\n  }\n}\n"]}