af8c50b2535b49815a745365ada7db11
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getActiveKey = getActiveKey;
exports.saveRef = saveRef;
exports["default"] = exports.SubPopupMenu = void 0;

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectSpread4 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var _noop = _interopRequireDefault(require("lodash/noop"));

var _miniStore = require("mini-store");

var _KeyCode = _interopRequireDefault(require("../../_util/KeyCode"));

var _createChainedFunction = _interopRequireDefault(require("../util/createChainedFunction"));

var _util = require("./util");

var _DOMWrap = _interopRequireDefault(require("./DOMWrap"));

function allDisabled(arr) {
  if (!arr.length) {
    return true;
  }

  return arr.every(function (c) {
    return !!c.props.disabled;
  });
}

function updateActiveKey(store, menuId, activeKey) {
  var state = store.getState();
  store.setState({
    activeKey: (0, _objectSpread4["default"])({}, state.activeKey, (0, _defineProperty2["default"])({}, menuId, activeKey))
  });
}

function getEventKey(props) {
  // when eventKey not available ,it's menu and return menu id '0-menu-'
  return props.eventKey || '0-menu-';
}

function getActiveKey(props, originalActiveKey) {
  var activeKey = originalActiveKey;
  var children = props.children,
      eventKey = props.eventKey;

  if (activeKey) {
    var found;
    (0, _util.loopMenuItem)(children, function (c, i) {
      if (c && !c.props.disabled && activeKey === (0, _util.getKeyFromChildrenIndex)(c, eventKey, i)) {
        found = true;
      }
    });

    if (found) {
      return activeKey;
    }
  }

  activeKey = null;

  if (props.defaultActiveFirst) {
    (0, _util.loopMenuItem)(children, function (c, i) {
      if (!activeKey && c && !c.props.disabled) {
        activeKey = (0, _util.getKeyFromChildrenIndex)(c, eventKey, i);
      }
    });
    return activeKey;
  }

  return activeKey;
}

function saveRef(c) {
  if (c) {
    var index = this.instanceArray.indexOf(c);

    if (index !== -1) {
      // update component if it's already inside instanceArray
      this.instanceArray[index] = c;
    } else {
      // add component if it's not in instanceArray yet;
      this.instanceArray.push(c);
    }
  }
}

var SubPopupMenu =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(SubPopupMenu, _Component);

  function SubPopupMenu(_props) {
    var _this;

    (0, _classCallCheck2["default"])(this, SubPopupMenu);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(SubPopupMenu).call(this, _props));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onKeyDown", function (e, callback) {
      var keyCode = e.keyCode;
      var handled;

      _this.getFlatInstanceArray().forEach(function (obj) {
        if (obj && obj.props.active && obj.onKeyDown) {
          handled = obj.onKeyDown(e);
        }
      });

      if (handled) {
        return 1;
      }

      var activeItem = null;

      if (keyCode === _KeyCode["default"].UP || keyCode === _KeyCode["default"].DOWN) {
        activeItem = _this.step(keyCode === _KeyCode["default"].UP ? -1 : 1);
      }

      if (activeItem) {
        e.preventDefault();
        updateActiveKey(_this.props.store, getEventKey(_this.props), activeItem.props.eventKey);

        if (typeof callback === 'function') {
          callback(activeItem);
        }

        return 1;
      }
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onItemHover", function (e) {
      var key = e.key,
          hover = e.hover;
      updateActiveKey(_this.props.store, getEventKey(_this.props), hover ? key : null);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onDeselect", function (selectInfo) {
      _this.props.onDeselect(selectInfo);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onSelect", function (selectInfo) {
      _this.props.onSelect(selectInfo);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onClick", function (e) {
      _this.props.onClick(e);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onOpenChange", function (e) {
      _this.props.onOpenChange(e);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onDestroy", function (key) {
      /* istanbul ignore next */
      _this.props.onDestroy(key);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getFlatInstanceArray", function () {
      return _this.instanceArray;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getOpenTransitionName", function () {
      return _this.props.openTransitionName;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "step", function (direction) {
      var children = _this.getFlatInstanceArray();

      var activeKey = _this.props.store.getState().activeKey[getEventKey(_this.props)];

      var len = children.length;

      if (!len) {
        return null;
      }

      if (direction < 0) {
        children = children.concat().reverse();
      } // find current activeIndex


      var activeIndex = -1;
      children.every(function (c, ci) {
        if (c && c.props.eventKey === activeKey) {
          activeIndex = ci;
          return false;
        }

        return true;
      });

      if (!_this.props.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {
        return undefined;
      }

      var start = (activeIndex + 1) % len;
      var i = start;

      do {
        var child = children[i];

        if (!child || child.props.disabled) {
          i = (i + 1) % len;
        } else {
          return child;
        }
      } while (i !== start);

      return null;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "renderCommonMenuItem", function (child, i, extraProps) {
      var state = _this.props.store.getState();

      var props = _this.props;
      var key = (0, _util.getKeyFromChildrenIndex)(child, props.eventKey, i);
      var childProps = child.props;
      var isActive = key === state.activeKey;
      var newChildProps = (0, _objectSpread4["default"])({
        mode: childProps.mode || props.mode,
        level: props.level,
        inlineIndent: props.inlineIndent,
        renderMenuItem: _this.renderMenuItem,
        rootPrefixCls: props.prefixCls,
        index: i,
        parentMenu: props.parentMenu,
        // customized ref function, need to be invoked manually in child's componentDidMount
        manualRef: childProps.disabled ? undefined : (0, _createChainedFunction["default"])(child.ref, saveRef.bind((0, _assertThisInitialized2["default"])(_this))),
        eventKey: key,
        active: !childProps.disabled && isActive,
        multiple: props.multiple,
        onClick: function onClick(e) {
          (childProps.onClick || _noop["default"])(e);

          _this.onClick(e);
        },
        onItemHover: _this.onItemHover,
        openTransitionName: _this.getOpenTransitionName(),
        openAnimation: props.openAnimation,
        subMenuOpenDelay: props.subMenuOpenDelay,
        subMenuCloseDelay: props.subMenuCloseDelay,
        forceSubMenuRender: props.forceSubMenuRender,
        onOpenChange: _this.onOpenChange,
        onDeselect: _this.onDeselect,
        onSelect: _this.onSelect,
        builtinPlacements: props.builtinPlacements,
        itemIcon: childProps.itemIcon || _this.props.itemIcon,
        expandIcon: childProps.expandIcon || _this.props.expandIcon
      }, extraProps);

      if (props.mode === 'inline') {
        newChildProps.triggerSubMenuAction = 'click';
      }

      return (0, _react.cloneElement)(child, newChildProps);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "renderMenuItem", function (c, i, subMenuKey) {
      /* istanbul ignore if */
      if (!c) {
        return null;
      }

      var props = _this.props;
      var extraProps = {
        openKeys: props.openKeys,
        selectedKeys: props.selectedKeys,
        triggerSubMenuAction: props.triggerSubMenuAction,
        subMenuKey: subMenuKey
      };
      return _this.renderCommonMenuItem(c, i, extraProps);
    });

    _props.store.setState({
      activeKey: (0, _objectSpread4["default"])({}, _props.store.getState().activeKey, (0, _defineProperty2["default"])({}, _props.eventKey, getActiveKey(_props, _props.activeKey)))
    });

    _this.instanceArray = [];
    return _this;
  }

  (0, _createClass2["default"])(SubPopupMenu, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      // invoke customized ref to expose component to mixin
      if (this.props.manualRef) {
        this.props.manualRef(this);
      }
    }
  }, {
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps) {
      return !this.props.hidden || !nextProps.hidden;
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      var props = this.props;
      var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];
      var activeKey = getActiveKey(props, originalActiveKey);

      if (activeKey !== originalActiveKey) {
        updateActiveKey(props.store, getEventKey(props), activeKey);
      }
    } // all keyboard events callbacks run from here at first

  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var props = (0, _extends2["default"])({}, this.props);
      this.instanceArray = [];
      var className = (0, _classnames["default"])(props.prefixCls, props.className, "".concat(props.prefixCls, "-").concat(props.mode));
      var haveRendered = this.haveRendered;
      this.haveRendered = true;
      this.haveOpened = this.haveOpened || !props.hidden || props.forceSubMenuRender;

      if (!this.haveOpened) {
        return null;
      }

      var domProps = {
        className: className,
        // role could be 'select' and by default set to menu
        role: props.role || 'menu'
      };

      if (props.id) {
        domProps.id = props.id;
      }

      if (props.focusable) {
        domProps.tabIndex = '0';
        domProps.onKeyDown = this.onKeyDown;
      }

      var prefixCls = props.prefixCls,
          eventKey = props.eventKey,
          hidden = props.hidden,
          level = props.level,
          mode = props.mode,
          overflowedIndicator = props.overflowedIndicator,
          theme = props.theme;

      _util.menuAllProps.forEach(function (key) {
        return delete props[key];
      });

      var transitionAppear = !(!haveRendered && !props.hidden && props.mode === 'inline');
      props.className += " ".concat(props.prefixCls, "-sub");
      delete props.onClick;
      var animProps = {};

      if (props.openTransitionName) {
        animProps.transitionName = props.openTransitionName;
      } else if ((0, _typeof2["default"])(props.openAnimation) === 'object') {
        animProps.animation = (0, _objectSpread4["default"])({}, props.openAnimation);

        if (!transitionAppear) {
          delete animProps.animation.appear;
        }
      }

      return (
        /* eslint-disable */
        _react["default"].createElement(_DOMWrap["default"], (0, _extends2["default"])({}, props, {
          prefixCls: prefixCls,
          mode: mode,
          tag: "ul",
          level: level,
          theme: theme,
          hiddenClassName: "".concat(prefixCls, "-hidden"),
          hidden: hidden,
          overflowedIndicator: overflowedIndicator
        }, domProps), _react.Children.map(props.children, function (c, i) {
          return _this2.renderMenuItem(c, i, eventKey || '0-menu-');
        }))
        /*eslint-enable */

      );
    }
  }]);
  return SubPopupMenu;
}(_react.Component);

exports.SubPopupMenu = SubPopupMenu;
(0, _defineProperty2["default"])(SubPopupMenu, "propTypes", {
  onSelect: _propTypes["default"].func,
  onClick: _propTypes["default"].func,
  onDeselect: _propTypes["default"].func,
  onOpenChange: _propTypes["default"].func,
  onDestroy: _propTypes["default"].func,
  openTransitionName: _propTypes["default"].string,
  openAnimation: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].object]),
  openKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  hidden: _propTypes["default"].bool,
  children: _propTypes["default"].any,
  parentMenu: _propTypes["default"].object,
  eventKey: _propTypes["default"].string,
  store: _propTypes["default"].shape({
    getState: _propTypes["default"].func,
    setState: _propTypes["default"].func
  }),
  // adding in refactor
  focusable: _propTypes["default"].bool,
  multiple: _propTypes["default"].bool,
  style: _propTypes["default"].object,
  defaultActiveFirst: _propTypes["default"].bool,
  activeKey: _propTypes["default"].string,
  selectedKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  defaultSelectedKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  defaultOpenKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  level: _propTypes["default"].number,
  mode: _propTypes["default"].oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),
  triggerSubMenuAction: _propTypes["default"].oneOf(['click', 'hover']),
  inlineIndent: _propTypes["default"].oneOfType([_propTypes["default"].number, _propTypes["default"].string]),
  manualRef: _propTypes["default"].func,
  itemIcon: _propTypes["default"].oneOfType([_propTypes["default"].func, _propTypes["default"].node]),
  expandIcon: _propTypes["default"].oneOfType([_propTypes["default"].func, _propTypes["default"].node])
});
(0, _defineProperty2["default"])(SubPopupMenu, "defaultProps", {
  prefixCls: 'rc-menu',
  className: '',
  mode: 'vertical',
  level: 1,
  inlineIndent: 24,
  hidden: false,
  focusable: true,
  style: {},
  manualRef: _noop["default"]
});
var connected = (0, _miniStore.connect)()(SubPopupMenu);
var _default = connected;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUvU3ViUG9wdXBNZW51LmpzeCJdLCJuYW1lcyI6WyJhcnIiLCJjIiwic3RhdGUiLCJzdG9yZSIsImFjdGl2ZUtleSIsInByb3BzIiwiY2hpbGRyZW4iLCJldmVudEtleSIsImZvdW5kIiwiaW5kZXgiLCJTdWJQb3B1cE1lbnUiLCJDb21wb25lbnQiLCJvblNlbGVjdCIsIlByb3BUeXBlcyIsIm9uQ2xpY2siLCJvbkRlc2VsZWN0Iiwib25PcGVuQ2hhbmdlIiwib25EZXN0cm95Iiwib3BlblRyYW5zaXRpb25OYW1lIiwib3BlbkFuaW1hdGlvbiIsIm9wZW5LZXlzIiwiaGlkZGVuIiwicGFyZW50TWVudSIsImdldFN0YXRlIiwic2V0U3RhdGUiLCJmdW5jIiwiZm9jdXNhYmxlIiwibXVsdGlwbGUiLCJzdHlsZSIsImRlZmF1bHRBY3RpdmVGaXJzdCIsInNlbGVjdGVkS2V5cyIsImRlZmF1bHRTZWxlY3RlZEtleXMiLCJkZWZhdWx0T3BlbktleXMiLCJsZXZlbCIsIm1vZGUiLCJ0cmlnZ2VyU3ViTWVudUFjdGlvbiIsImlubGluZUluZGVudCIsIm1hbnVhbFJlZiIsIml0ZW1JY29uIiwiZXhwYW5kSWNvbiIsInByZWZpeENscyIsImNsYXNzTmFtZSIsIm5vb3AiLCJnZXRBY3RpdmVLZXkiLCJuZXh0UHJvcHMiLCJvcmlnaW5hbEFjdGl2ZUtleSIsImdldEV2ZW50S2V5IiwidXBkYXRlQWN0aXZlS2V5Iiwia2V5Q29kZSIsImUiLCJvYmoiLCJoYW5kbGVkIiwiYWN0aXZlSXRlbSIsIktleUNvZGUiLCJjYWxsYmFjayIsImtleSIsImhvdmVyIiwibGVuIiwiZGlyZWN0aW9uIiwiYWN0aXZlSW5kZXgiLCJhbGxEaXNhYmxlZCIsInN0YXJ0IiwiaSIsImNoaWxkIiwiY2hpbGRQcm9wcyIsImlzQWN0aXZlIiwibmV3Q2hpbGRQcm9wcyIsInJlbmRlck1lbnVJdGVtIiwicm9vdFByZWZpeENscyIsInNhdmVSZWYiLCJhY3RpdmUiLCJvbkl0ZW1Ib3ZlciIsInN1Yk1lbnVPcGVuRGVsYXkiLCJzdWJNZW51Q2xvc2VEZWxheSIsImZvcmNlU3ViTWVudVJlbmRlciIsImJ1aWx0aW5QbGFjZW1lbnRzIiwiZXh0cmFQcm9wcyIsInN1Yk1lbnVLZXkiLCJoYXZlUmVuZGVyZWQiLCJkb21Qcm9wcyIsInJvbGUiLCJvdmVyZmxvd2VkSW5kaWNhdG9yIiwidGhlbWUiLCJtZW51QWxsUHJvcHMiLCJ0cmFuc2l0aW9uQXBwZWFyIiwiYW5pbVByb3BzIiwiY29ubmVjdGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBLE1BQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFVBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFdBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLEtBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxhQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFVBQUEsR0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLHFCQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLHNCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsK0JBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsS0FBQSxHQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUE7O0FBQ0EsSUFBQSxRQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7O0FBRUEsU0FBQSxXQUFBLENBQUEsR0FBQSxFQUEwQjtBQUN4QixNQUFJLENBQUNBLEdBQUcsQ0FBUixNQUFBLEVBQWlCO0FBQ2YsV0FBQSxJQUFBO0FBQ0Q7O0FBQ0QsU0FBTyxHQUFHLENBQUgsS0FBQSxDQUFVLFVBQUEsQ0FBQSxFQUFDO0FBQUEsV0FBSSxDQUFDLENBQUNDLENBQUMsQ0FBREEsS0FBQUEsQ0FBTixRQUFBO0FBQWxCLEdBQU8sQ0FBUDtBQUNEOztBQUVELFNBQUEsZUFBQSxDQUFBLEtBQUEsRUFBQSxNQUFBLEVBQUEsU0FBQSxFQUFtRDtBQUNqRCxNQUFNQyxLQUFLLEdBQUdDLEtBQUssQ0FBbkIsUUFBY0EsRUFBZDtBQUNBQSxFQUFBQSxLQUFLLENBQUxBLFFBQUFBLENBQWU7QUFDYkMsSUFBQUEsU0FBUyxFQUFBLENBQUEsR0FBQSxjQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsRUFBQSxFQUNKRixLQUFLLENBREQsU0FBQSxFQUFBLENBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxNQUFBLEVBQUEsU0FBQSxDQUFBO0FBREksR0FBZkM7QUFNRDs7QUFFRCxTQUFBLFdBQUEsQ0FBQSxLQUFBLEVBQTRCO0FBQzFCO0FBQ0EsU0FBT0UsS0FBSyxDQUFMQSxRQUFBQSxJQUFQLFNBQUE7QUFDRDs7QUFFTSxTQUFBLFlBQUEsQ0FBQSxLQUFBLEVBQUEsaUJBQUEsRUFBZ0Q7QUFDckQsTUFBSUQsU0FBUyxHQUFiLGlCQUFBO0FBRHFELE1BRTdDRSxRQUY2QyxHQUV0QkQsS0FGc0IsQ0FBQSxRQUFBO0FBQUEsTUFFbkNFLFFBRm1DLEdBRXRCRixLQUZzQixDQUFBLFFBQUE7O0FBR3JELE1BQUEsU0FBQSxFQUFlO0FBQ2IsUUFBQSxLQUFBO0FBQ0EsS0FBQSxHQUFBLEtBQUEsQ0FBQSxZQUFBLEVBQUEsUUFBQSxFQUF1QixVQUFBLENBQUEsRUFBQSxDQUFBLEVBQVU7QUFDL0IsVUFBSUosQ0FBQyxJQUFJLENBQUNBLENBQUMsQ0FBREEsS0FBQUEsQ0FBTkEsUUFBQUEsSUFBMEJHLFNBQVMsS0FBSyxDQUFBLEdBQUEsS0FBQSxDQUFBLHVCQUFBLEVBQUEsQ0FBQSxFQUFBLFFBQUEsRUFBNUMsQ0FBNEMsQ0FBNUMsRUFBcUY7QUFDbkZJLFFBQUFBLEtBQUssR0FBTEEsSUFBQUE7QUFDRDtBQUhILEtBQUE7O0FBS0EsUUFBQSxLQUFBLEVBQVc7QUFDVCxhQUFBLFNBQUE7QUFDRDtBQUNGOztBQUNESixFQUFBQSxTQUFTLEdBQVRBLElBQUFBOztBQUNBLE1BQUlDLEtBQUssQ0FBVCxrQkFBQSxFQUE4QjtBQUM1QixLQUFBLEdBQUEsS0FBQSxDQUFBLFlBQUEsRUFBQSxRQUFBLEVBQXVCLFVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBVTtBQUMvQixVQUFJLENBQUEsU0FBQSxJQUFBLENBQUEsSUFBbUIsQ0FBQ0osQ0FBQyxDQUFEQSxLQUFBQSxDQUF4QixRQUFBLEVBQTBDO0FBQ3hDRyxRQUFBQSxTQUFTLEdBQUcsQ0FBQSxHQUFBLEtBQUEsQ0FBQSx1QkFBQSxFQUFBLENBQUEsRUFBQSxRQUFBLEVBQVpBLENBQVksQ0FBWkE7QUFDRDtBQUhILEtBQUE7QUFLQSxXQUFBLFNBQUE7QUFDRDs7QUFDRCxTQUFBLFNBQUE7QUFDRDs7QUFFTSxTQUFBLE9BQUEsQ0FBQSxDQUFBLEVBQW9CO0FBQ3pCLE1BQUEsQ0FBQSxFQUFPO0FBQ0wsUUFBTUssS0FBSyxHQUFHLEtBQUEsYUFBQSxDQUFBLE9BQUEsQ0FBZCxDQUFjLENBQWQ7O0FBQ0EsUUFBSUEsS0FBSyxLQUFLLENBQWQsQ0FBQSxFQUFrQjtBQUNoQjtBQUNBLFdBQUEsYUFBQSxDQUFBLEtBQUEsSUFBQSxDQUFBO0FBRkYsS0FBQSxNQUdPO0FBQ0w7QUFDQSxXQUFBLGFBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtBQUNEO0FBQ0Y7QUFDRjs7SUFFWUMsWTs7Ozs7QUFpRFgsV0FBQSxZQUFBLENBQUEsTUFBQSxFQUFtQjtBQUFBLFFBQUEsS0FBQTs7QUFBQSxLQUFBLEdBQUEsZ0JBQUEsQ0FBQSxTQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsWUFBQTtBQUNqQixJQUFBLEtBQUEsR0FBQSxDQUFBLEdBQUEsMkJBQUEsQ0FBQSxTQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsQ0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsWUFBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7QUFEaUIsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsV0FBQSxFQWtDUCxVQUFBLENBQUEsRUFBQSxRQUFBLEVBQWlCO0FBQzNCLFVBQU1zQyxPQUFPLEdBQUdDLENBQUMsQ0FBakIsT0FBQTtBQUNBLFVBQUEsT0FBQTs7QUFDQSxNQUFBLEtBQUEsQ0FBQSxvQkFBQSxHQUFBLE9BQUEsQ0FBb0MsVUFBQSxHQUFBLEVBQVM7QUFDM0MsWUFBSUMsR0FBRyxJQUFJQSxHQUFHLENBQUhBLEtBQUFBLENBQVBBLE1BQUFBLElBQTJCQSxHQUFHLENBQWxDLFNBQUEsRUFBOEM7QUFDNUNDLFVBQUFBLE9BQU8sR0FBR0QsR0FBRyxDQUFIQSxTQUFBQSxDQUFWQyxDQUFVRCxDQUFWQztBQUNEO0FBSEgsT0FBQTs7QUFLQSxVQUFBLE9BQUEsRUFBYTtBQUNYLGVBQUEsQ0FBQTtBQUNEOztBQUNELFVBQUlDLFVBQVUsR0FBZCxJQUFBOztBQUNBLFVBQUlKLE9BQU8sS0FBS0ssUUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBWkwsRUFBQUEsSUFBMEJBLE9BQU8sS0FBS0ssUUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBMUMsSUFBQSxFQUF3RDtBQUN0REQsUUFBQUEsVUFBVSxHQUFHLEtBQUEsQ0FBQSxJQUFBLENBQVVKLE9BQU8sS0FBS0ssUUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBWkwsRUFBQUEsR0FBeUIsQ0FBekJBLENBQUFBLEdBQXZCSSxDQUFhLENBQWJBO0FBQ0Q7O0FBQ0QsVUFBQSxVQUFBLEVBQWdCO0FBQ2RILFFBQUFBLENBQUMsQ0FBREEsY0FBQUE7QUFDQUYsUUFBQUEsZUFBZSxDQUFDLEtBQUEsQ0FBQSxLQUFBLENBQUQsS0FBQSxFQUFtQkQsV0FBVyxDQUFDLEtBQUEsQ0FBL0IsS0FBOEIsQ0FBOUIsRUFBNENNLFVBQVUsQ0FBVkEsS0FBQUEsQ0FBM0RMLFFBQWUsQ0FBZkE7O0FBRUEsWUFBSSxPQUFBLFFBQUEsS0FBSixVQUFBLEVBQW9DO0FBQ2xDTyxVQUFBQSxRQUFRLENBQVJBLFVBQVEsQ0FBUkE7QUFDRDs7QUFFRCxlQUFBLENBQUE7QUFDRDtBQTFEZ0IsS0FBQTtBQUFBLEtBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSx1QkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEtBQUEsQ0FBQSxFQUFBLGFBQUEsRUE2REwsVUFBQSxDQUFBLEVBQU87QUFBQSxVQUNYQyxHQURXLEdBQ0lOLENBREosQ0FBQSxHQUFBO0FBQUEsVUFDTk8sS0FETSxHQUNJUCxDQURKLENBQUEsS0FBQTtBQUVuQkYsTUFBQUEsZUFBZSxDQUFDLEtBQUEsQ0FBQSxLQUFBLENBQUQsS0FBQSxFQUFtQkQsV0FBVyxDQUFDLEtBQUEsQ0FBL0IsS0FBOEIsQ0FBOUIsRUFBNENVLEtBQUssR0FBQSxHQUFBLEdBQWhFVCxJQUFlLENBQWZBO0FBL0RpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsWUFBQSxFQWtFTixVQUFBLFVBQUEsRUFBZ0I7QUFDM0IsTUFBQSxLQUFBLENBQUEsS0FBQSxDQUFBLFVBQUEsQ0FBQSxVQUFBO0FBbkVpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsVUFBQSxFQXNFUixVQUFBLFVBQUEsRUFBZ0I7QUFDekIsTUFBQSxLQUFBLENBQUEsS0FBQSxDQUFBLFFBQUEsQ0FBQSxVQUFBO0FBdkVpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsU0FBQSxFQTBFVCxVQUFBLENBQUEsRUFBTztBQUNmLE1BQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQTNFaUIsS0FBQTtBQUFBLEtBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSx1QkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEtBQUEsQ0FBQSxFQUFBLGNBQUEsRUE4RUosVUFBQSxDQUFBLEVBQU87QUFDcEIsTUFBQSxLQUFBLENBQUEsS0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBO0FBL0VpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsV0FBQSxFQWtGUCxVQUFBLEdBQUEsRUFBUztBQUNuQjtBQUNBLE1BQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxTQUFBLENBQUEsR0FBQTtBQXBGaUIsS0FBQTtBQUFBLEtBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSx1QkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEtBQUEsQ0FBQSxFQUFBLHNCQUFBLEVBdUZJLFlBQU07QUFDM0IsYUFBTyxLQUFBLENBQVAsYUFBQTtBQXhGaUIsS0FBQTtBQUFBLEtBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSx1QkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEtBQUEsQ0FBQSxFQUFBLHVCQUFBLEVBMkZLLFlBQU07QUFDNUIsYUFBTyxLQUFBLENBQUEsS0FBQSxDQUFQLGtCQUFBO0FBNUZpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsTUFBQSxFQStGWixVQUFBLFNBQUEsRUFBZTtBQUNwQixVQUFJekMsUUFBUSxHQUFHLEtBQUEsQ0FBZixvQkFBZSxFQUFmOztBQUNBLFVBQU1GLFNBQVMsR0FBRyxLQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxRQUFBLEdBQUEsU0FBQSxDQUFzQzBDLFdBQVcsQ0FBQyxLQUFBLENBQXBFLEtBQW1FLENBQWpELENBQWxCOztBQUNBLFVBQU1XLEdBQUcsR0FBR25ELFFBQVEsQ0FBcEIsTUFBQTs7QUFDQSxVQUFJLENBQUosR0FBQSxFQUFVO0FBQ1IsZUFBQSxJQUFBO0FBQ0Q7O0FBQ0QsVUFBSW9ELFNBQVMsR0FBYixDQUFBLEVBQW1CO0FBQ2pCcEQsUUFBQUEsUUFBUSxHQUFHQSxRQUFRLENBQVJBLE1BQUFBLEdBQVhBLE9BQVdBLEVBQVhBO0FBUmtCLE9BQUEsQ0FVcEI7OztBQUNBLFVBQUlxRCxXQUFXLEdBQUcsQ0FBbEIsQ0FBQTtBQUNBckQsTUFBQUEsUUFBUSxDQUFSQSxLQUFBQSxDQUFlLFVBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBVztBQUN4QixZQUFJTCxDQUFDLElBQUlBLENBQUMsQ0FBREEsS0FBQUEsQ0FBQUEsUUFBQUEsS0FBVCxTQUFBLEVBQXlDO0FBQ3ZDMEQsVUFBQUEsV0FBVyxHQUFYQSxFQUFBQTtBQUNBLGlCQUFBLEtBQUE7QUFDRDs7QUFDRCxlQUFBLElBQUE7QUFMRnJELE9BQUFBOztBQU9BLFVBQ0UsQ0FBQyxLQUFBLENBQUEsS0FBQSxDQUFELGtCQUFBLElBQWtDcUQsV0FBVyxLQUFLLENBQWxELENBQUEsSUFFQUMsV0FBVyxDQUFDdEQsUUFBUSxDQUFSQSxLQUFBQSxDQUFBQSxXQUFBQSxFQUE0Qm1ELEdBQUcsR0FIN0MsQ0FHY25ELENBQUQsQ0FIYixFQUlFO0FBQ0EsZUFBQSxTQUFBO0FBQ0Q7O0FBQ0QsVUFBTXVELEtBQUssR0FBRyxDQUFDRixXQUFXLEdBQVosQ0FBQSxJQUFkLEdBQUE7QUFDQSxVQUFJRyxDQUFDLEdBQUwsS0FBQTs7QUFFQSxTQUFHO0FBQ0QsWUFBTUMsS0FBSyxHQUFHekQsUUFBUSxDQUF0QixDQUFzQixDQUF0Qjs7QUFDQSxZQUFJLENBQUEsS0FBQSxJQUFVeUQsS0FBSyxDQUFMQSxLQUFBQSxDQUFkLFFBQUEsRUFBb0M7QUFDbENELFVBQUFBLENBQUMsR0FBRyxDQUFDQSxDQUFDLEdBQUYsQ0FBQSxJQUFKQSxHQUFBQTtBQURGLFNBQUEsTUFFTztBQUNMLGlCQUFBLEtBQUE7QUFDRDtBQU5ILE9BQUEsUUFPU0EsQ0FBQyxLQVBWLEtBQUE7O0FBU0EsYUFBQSxJQUFBO0FBcklpQixLQUFBO0FBQUEsS0FBQSxHQUFBLGdCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLHVCQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQUEsc0JBQUEsRUF3SUksVUFBQSxLQUFBLEVBQUEsQ0FBQSxFQUFBLFVBQUEsRUFBMEI7QUFDL0MsVUFBTTVELEtBQUssR0FBRyxLQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBZCxRQUFjLEVBQWQ7O0FBQ0EsVUFBTUcsS0FBSyxHQUFHLEtBQUEsQ0FBZCxLQUFBO0FBQ0EsVUFBTWtELEdBQUcsR0FBRyxDQUFBLEdBQUEsS0FBQSxDQUFBLHVCQUFBLEVBQUEsS0FBQSxFQUErQmxELEtBQUssQ0FBcEMsUUFBQSxFQUFaLENBQVksQ0FBWjtBQUNBLFVBQU0yRCxVQUFVLEdBQUdELEtBQUssQ0FBeEIsS0FBQTtBQUNBLFVBQU1FLFFBQVEsR0FBR1YsR0FBRyxLQUFLckQsS0FBSyxDQUE5QixTQUFBO0FBQ0EsVUFBTWdFLGFBQWEsR0FBQSxDQUFBLEdBQUEsY0FBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBO0FBQ2pCaEMsUUFBQUEsSUFBSSxFQUFFOEIsVUFBVSxDQUFWQSxJQUFBQSxJQUFtQjNELEtBQUssQ0FEYixJQUFBO0FBRWpCNEIsUUFBQUEsS0FBSyxFQUFFNUIsS0FBSyxDQUZLLEtBQUE7QUFHakIrQixRQUFBQSxZQUFZLEVBQUUvQixLQUFLLENBSEYsWUFBQTtBQUlqQjhELFFBQUFBLGNBQWMsRUFBRSxLQUFBLENBSkMsY0FBQTtBQUtqQkMsUUFBQUEsYUFBYSxFQUFFL0QsS0FBSyxDQUxILFNBQUE7QUFNakJJLFFBQUFBLEtBQUssRUFOWSxDQUFBO0FBT2pCYSxRQUFBQSxVQUFVLEVBQUVqQixLQUFLLENBUEEsVUFBQTtBQVFqQjtBQUNBZ0MsUUFBQUEsU0FBUyxFQUFFMkIsVUFBVSxDQUFWQSxRQUFBQSxHQUFBQSxTQUFBQSxHQUFrQyxDQUFBLEdBQUEsc0JBQUEsQ0FBQSxTQUFBLENBQUEsRUFBc0JELEtBQUssQ0FBM0IsR0FBQSxFQUFpQ00sT0FBTyxDQUFQQSxJQUFBQSxDQUFBQSxDQUFBQSxHQUFBQSx1QkFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsRUFUN0QsS0FTNkRBLENBQUFBLENBQWpDLENBVDVCO0FBVWpCOUQsUUFBQUEsUUFBUSxFQVZTLEdBQUE7QUFXakIrRCxRQUFBQSxNQUFNLEVBQUUsQ0FBQ04sVUFBVSxDQUFYLFFBQUEsSUFYUyxRQUFBO0FBWWpCckMsUUFBQUEsUUFBUSxFQUFFdEIsS0FBSyxDQVpFLFFBQUE7QUFhakJTLFFBQUFBLE9BQU8sRUFBRSxTQUFBLE9BQUEsQ0FBQSxDQUFBLEVBQU87QUFDZCxXQUFDa0QsVUFBVSxDQUFWQSxPQUFBQSxJQUFzQnRCLEtBQUFBLENBQXZCLFNBQXVCQSxDQUF2QixFQUFBLENBQUE7O0FBQ0EsVUFBQSxLQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7QUFmZSxTQUFBO0FBaUJqQjZCLFFBQUFBLFdBQVcsRUFBRSxLQUFBLENBakJJLFdBQUE7QUFrQmpCckQsUUFBQUEsa0JBQWtCLEVBQUUsS0FBQSxDQWxCSCxxQkFrQkcsRUFsQkg7QUFtQmpCQyxRQUFBQSxhQUFhLEVBQUVkLEtBQUssQ0FuQkgsYUFBQTtBQW9CakJtRSxRQUFBQSxnQkFBZ0IsRUFBRW5FLEtBQUssQ0FwQk4sZ0JBQUE7QUFxQmpCb0UsUUFBQUEsaUJBQWlCLEVBQUVwRSxLQUFLLENBckJQLGlCQUFBO0FBc0JqQnFFLFFBQUFBLGtCQUFrQixFQUFFckUsS0FBSyxDQXRCUixrQkFBQTtBQXVCakJXLFFBQUFBLFlBQVksRUFBRSxLQUFBLENBdkJHLFlBQUE7QUF3QmpCRCxRQUFBQSxVQUFVLEVBQUUsS0FBQSxDQXhCSyxVQUFBO0FBeUJqQkgsUUFBQUEsUUFBUSxFQUFFLEtBQUEsQ0F6Qk8sUUFBQTtBQTBCakIrRCxRQUFBQSxpQkFBaUIsRUFBRXRFLEtBQUssQ0ExQlAsaUJBQUE7QUEyQmpCaUMsUUFBQUEsUUFBUSxFQUFFMEIsVUFBVSxDQUFWQSxRQUFBQSxJQUF1QixLQUFBLENBQUEsS0FBQSxDQTNCaEIsUUFBQTtBQTRCakJ6QixRQUFBQSxVQUFVLEVBQUV5QixVQUFVLENBQVZBLFVBQUFBLElBQXlCLEtBQUEsQ0FBQSxLQUFBLENBQVd6QjtBQTVCL0IsT0FBQSxFQUFuQixVQUFtQixDQUFuQjs7QUErQkEsVUFBSWxDLEtBQUssQ0FBTEEsSUFBQUEsS0FBSixRQUFBLEVBQTZCO0FBQzNCNkQsUUFBQUEsYUFBYSxDQUFiQSxvQkFBQUEsR0FBQUEsT0FBQUE7QUFDRDs7QUFDRCxhQUFPLENBQUEsR0FBQSxNQUFBLENBQUEsWUFBQSxFQUFBLEtBQUEsRUFBUCxhQUFPLENBQVA7QUFoTGlCLEtBQUE7QUFBQSxLQUFBLEdBQUEsZ0JBQUEsQ0FBQSxTQUFBLENBQUEsRUFBQSxDQUFBLEdBQUEsdUJBQUEsQ0FBQSxTQUFBLENBQUEsRUFBQSxLQUFBLENBQUEsRUFBQSxnQkFBQSxFQW1MRixVQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsVUFBQSxFQUFzQjtBQUNyQztBQUNBLFVBQUksQ0FBSixDQUFBLEVBQVE7QUFDTixlQUFBLElBQUE7QUFDRDs7QUFDRCxVQUFNN0QsS0FBSyxHQUFHLEtBQUEsQ0FBZCxLQUFBO0FBQ0EsVUFBTXVFLFVBQVUsR0FBRztBQUNqQnhELFFBQUFBLFFBQVEsRUFBRWYsS0FBSyxDQURFLFFBQUE7QUFFakJ5QixRQUFBQSxZQUFZLEVBQUV6QixLQUFLLENBRkYsWUFBQTtBQUdqQjhCLFFBQUFBLG9CQUFvQixFQUFFOUIsS0FBSyxDQUhWLG9CQUFBO0FBSWpCd0UsUUFBQUEsVUFBVSxFQUFWQTtBQUppQixPQUFuQjtBQU1BLGFBQU8sS0FBQSxDQUFBLG9CQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsRUFBUCxVQUFPLENBQVA7QUEvTGlCLEtBQUE7O0FBR2pCeEUsSUFBQUEsTUFBSyxDQUFMQSxLQUFBQSxDQUFBQSxRQUFBQSxDQUFxQjtBQUNuQkQsTUFBQUEsU0FBUyxFQUFBLENBQUEsR0FBQSxjQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsRUFBQSxFQUNKQyxNQUFLLENBQUxBLEtBQUFBLENBQUFBLFFBQUFBLEdBREksU0FBQSxFQUFBLENBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLEVBQUEsRUFFTkEsTUFBSyxDQUZDLFFBQUEsRUFFV3NDLFlBQVksQ0FBQSxNQUFBLEVBQVF0QyxNQUFLLENBRnBDLFNBRXVCLENBRnZCLENBQUE7QUFEVSxLQUFyQkE7O0FBT0EsSUFBQSxLQUFBLENBQUEsYUFBQSxHQUFBLEVBQUE7QUFWaUIsV0FBQSxLQUFBO0FBV2xCOzs7O3dDQUVtQjtBQUNsQjtBQUNBLFVBQUksS0FBQSxLQUFBLENBQUosU0FBQSxFQUEwQjtBQUN4QixhQUFBLEtBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQTtBQUNEO0FBQ0Y7OzswQ0FFcUJ1QyxTLEVBQVc7QUFDL0IsYUFBTyxDQUFDLEtBQUEsS0FBQSxDQUFELE1BQUEsSUFBc0IsQ0FBQ0EsU0FBUyxDQUF2QyxNQUFBO0FBQ0Q7Ozt5Q0FFb0I7QUFDbkIsVUFBTXZDLEtBQUssR0FBRyxLQUFkLEtBQUE7QUFDQSxVQUFNd0MsaUJBQWlCLEdBQUcsZUFBQSxLQUFBLEdBQXVCeEMsS0FBSyxDQUE1QixTQUFBLEdBQXlDQSxLQUFLLENBQUxBLEtBQUFBLENBQUFBLFFBQUFBLEdBQUFBLFNBQUFBLENBQWlDeUMsV0FBVyxDQUEvRyxLQUErRyxDQUE1Q3pDLENBQW5FO0FBQ0EsVUFBTUQsU0FBUyxHQUFHdUMsWUFBWSxDQUFBLEtBQUEsRUFBOUIsaUJBQThCLENBQTlCOztBQUNBLFVBQUl2QyxTQUFTLEtBQWIsaUJBQUEsRUFBcUM7QUFDbkMyQyxRQUFBQSxlQUFlLENBQUMxQyxLQUFLLENBQU4sS0FBQSxFQUFjeUMsV0FBVyxDQUF6QixLQUF5QixDQUF6QixFQUFmQyxTQUFlLENBQWZBO0FBQ0Q7TUFHSDs7Ozs2QkFpS1M7QUFBQSxVQUFBLE1BQUEsR0FBQSxJQUFBOztBQUFBLFVBQ0kxQyxLQURKLEdBQUEsQ0FBQSxHQUFBLFNBQUEsQ0FBQSxTQUFBLENBQUEsRUFBQSxFQUFBLEVBQ2MsS0FEZCxLQUFBLENBQUE7QUFHUCxXQUFBLGFBQUEsR0FBQSxFQUFBO0FBQ0EsVUFBTW9DLFNBQVMsR0FBRyxDQUFBLEdBQUEsV0FBQSxDQUFBLFNBQUEsQ0FBQSxFQUNoQnBDLEtBQUssQ0FEVyxTQUFBLEVBRWhCQSxLQUFLLENBRlcsU0FBQSxFQUFBLEdBQUEsTUFBQSxDQUdiQSxLQUFLLENBSFEsU0FBQSxFQUFBLEdBQUEsRUFBQSxNQUFBLENBR01BLEtBQUssQ0FIN0IsSUFBa0IsQ0FBQSxDQUFsQjtBQUtBLFVBQU15RSxZQUFZLEdBQUcsS0FBckIsWUFBQTtBQUNBLFdBQUEsWUFBQSxHQUFBLElBQUE7QUFDQSxXQUFBLFVBQUEsR0FBa0IsS0FBQSxVQUFBLElBQW1CLENBQUN6RSxLQUFLLENBQXpCLE1BQUEsSUFBb0NBLEtBQUssQ0FBM0Qsa0JBQUE7O0FBQ0EsVUFBSSxDQUFDLEtBQUwsVUFBQSxFQUFzQjtBQUNwQixlQUFBLElBQUE7QUFDRDs7QUFDRCxVQUFNMEUsUUFBUSxHQUFHO0FBQ2Z0QyxRQUFBQSxTQUFTLEVBRE0sU0FBQTtBQUVmO0FBQ0F1QyxRQUFBQSxJQUFJLEVBQUUzRSxLQUFLLENBQUxBLElBQUFBLElBQWM7QUFITCxPQUFqQjs7QUFLQSxVQUFJQSxLQUFLLENBQVQsRUFBQSxFQUFjO0FBQ1owRSxRQUFBQSxRQUFRLENBQVJBLEVBQUFBLEdBQWMxRSxLQUFLLENBQW5CMEUsRUFBQUE7QUFDRDs7QUFDRCxVQUFJMUUsS0FBSyxDQUFULFNBQUEsRUFBcUI7QUFDbkIwRSxRQUFBQSxRQUFRLENBQVJBLFFBQUFBLEdBQUFBLEdBQUFBO0FBQ0FBLFFBQUFBLFFBQVEsQ0FBUkEsU0FBQUEsR0FBcUIsS0FBckJBLFNBQUFBO0FBQ0Q7O0FBMUJNLFVBMkJDdkMsU0EzQkQsR0EyQjBFbkMsS0EzQjFFLENBQUEsU0FBQTtBQUFBLFVBMkJZRSxRQTNCWixHQTJCMEVGLEtBM0IxRSxDQUFBLFFBQUE7QUFBQSxVQTJCc0JnQixNQTNCdEIsR0EyQjBFaEIsS0EzQjFFLENBQUEsTUFBQTtBQUFBLFVBMkI4QjRCLEtBM0I5QixHQTJCMEU1QixLQTNCMUUsQ0FBQSxLQUFBO0FBQUEsVUEyQnFDNkIsSUEzQnJDLEdBMkIwRTdCLEtBM0IxRSxDQUFBLElBQUE7QUFBQSxVQTJCMkM0RSxtQkEzQjNDLEdBMkIwRTVFLEtBM0IxRSxDQUFBLG1CQUFBO0FBQUEsVUEyQmdFNkUsS0EzQmhFLEdBMkIwRTdFLEtBM0IxRSxDQUFBLEtBQUE7O0FBNEJQOEUsTUFBQUEsS0FBQUEsQ0FBQUEsWUFBQUEsQ0FBQUEsT0FBQUEsQ0FBcUIsVUFBQSxHQUFBLEVBQUc7QUFBQSxlQUFJLE9BQU85RSxLQUFLLENBQWhCLEdBQWdCLENBQWhCO0FBQXhCOEUsT0FBQUE7O0FBRUEsVUFBTUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFBLFlBQUEsSUFBaUIsQ0FBQy9FLEtBQUssQ0FBdkIsTUFBQSxJQUFrQ0EsS0FBSyxDQUFMQSxJQUFBQSxLQUE3RCxRQUF5QixDQUF6QjtBQUVBQSxNQUFBQSxLQUFLLENBQUxBLFNBQUFBLElBQUFBLElBQUFBLE1BQUFBLENBQXVCQSxLQUFLLENBQTVCQSxTQUFBQSxFQUFBQSxNQUFBQSxDQUFBQTtBQUNBLGFBQU9BLEtBQUssQ0FBWixPQUFBO0FBQ0EsVUFBTWdGLFNBQVMsR0FBZixFQUFBOztBQUNBLFVBQUloRixLQUFLLENBQVQsa0JBQUEsRUFBOEI7QUFDNUJnRixRQUFBQSxTQUFTLENBQVRBLGNBQUFBLEdBQTJCaEYsS0FBSyxDQUFoQ2dGLGtCQUFBQTtBQURGLE9BQUEsTUFFTyxJQUFJLENBQUEsR0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLEVBQU9oRixLQUFLLENBQVosYUFBQSxNQUFKLFFBQUEsRUFBNkM7QUFDbERnRixRQUFBQSxTQUFTLENBQVRBLFNBQUFBLEdBQUFBLENBQUFBLEdBQUFBLGNBQUFBLENBQUFBLFNBQUFBLENBQUFBLEVBQUFBLEVBQUFBLEVBQTJCaEYsS0FBSyxDQUFoQ2dGLGFBQUFBLENBQUFBOztBQUNBLFlBQUksQ0FBSixnQkFBQSxFQUF1QjtBQUNyQixpQkFBT0EsU0FBUyxDQUFUQSxTQUFBQSxDQUFQLE1BQUE7QUFDRDtBQUNGOztBQUNEO0FBQ0U7QUFDQSxRQUFBLE1BQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxhQUFBLENBQUMsUUFBQSxDQUFELFNBQUMsQ0FBRCxFQUFBLENBQUEsR0FBQSxTQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLEtBQUEsRUFBQTtBQUVFLFVBQUEsU0FBUyxFQUZYLFNBQUE7QUFHRSxVQUFBLElBQUksRUFITixJQUFBO0FBSUUsVUFBQSxHQUFHLEVBSkwsSUFBQTtBQUtFLFVBQUEsS0FBSyxFQUxQLEtBQUE7QUFNRSxVQUFBLEtBQUssRUFOUCxLQUFBO0FBT0UsVUFBQSxlQUFlLEVBQUEsR0FBQSxNQUFBLENBQUEsU0FBQSxFQVBqQixTQU9pQixDQVBqQjtBQVFFLFVBQUEsTUFBTSxFQVJSLE1BQUE7QUFTRSxVQUFBLG1CQUFtQixFQUFFSjtBQVR2QixTQUFBLEVBQUEsUUFBQSxDQUFBLEVBWUcsTUFBQSxDQUFBLFFBQUEsQ0FBQSxHQUFBLENBQ0M1RSxLQUFLLENBRE4sUUFBQSxFQUVDLFVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQTtBQUFBLGlCQUFVLE1BQUksQ0FBSixjQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsRUFBMEJFLFFBQVEsSUFBNUMsU0FBVSxDQUFWO0FBZEosU0FZRyxDQVpIO0FBaUJBOztBQW5CRjtBQXFCRDs7O0VBblQrQkksTUFBQUEsQ0FBQUEsUzs7O2lDQUFyQkQsWSxlQUNRO0FBQ2pCRSxFQUFBQSxRQUFRLEVBQUVDLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBRE8sSUFBQTtBQUVqQkMsRUFBQUEsT0FBTyxFQUFFRCxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUZRLElBQUE7QUFHakJFLEVBQUFBLFVBQVUsRUFBRUYsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FISyxJQUFBO0FBSWpCRyxFQUFBQSxZQUFZLEVBQUVILFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBSkcsSUFBQTtBQUtqQkksRUFBQUEsU0FBUyxFQUFFSixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUxNLElBQUE7QUFNakJLLEVBQUFBLGtCQUFrQixFQUFFTCxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQU5ILE1BQUE7QUFPakJNLEVBQUFBLGFBQWEsRUFBRU4sVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBQUEsU0FBQUEsQ0FBb0IsQ0FBQ0EsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBRCxNQUFBLEVBQW1CQSxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQVByQyxNQU9rQixDQUFwQkEsQ0FQRTtBQVFqQk8sRUFBQUEsUUFBUSxFQUFFUCxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFBQSxPQUFBQSxDQUFrQkEsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FSWCxNQVFQQSxDQVJPO0FBU2pCUSxFQUFBQSxNQUFNLEVBQUVSLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBVFMsSUFBQTtBQVVqQlAsRUFBQUEsUUFBUSxFQUFFTyxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQVZPLEdBQUE7QUFXakJTLEVBQUFBLFVBQVUsRUFBRVQsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FYSyxNQUFBO0FBWWpCTixFQUFBQSxRQUFRLEVBQUVNLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBWk8sTUFBQTtBQWFqQlYsRUFBQUEsS0FBSyxFQUFFLFVBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxLQUFBLENBQWdCO0FBQ3JCb0IsSUFBQUEsUUFBUSxFQUFFVixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQURXLElBQUE7QUFFckJXLElBQUFBLFFBQVEsRUFBRVgsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBVVk7QUFGQyxHQUFoQixDQWJVO0FBa0JqQjtBQUNBQyxFQUFBQSxTQUFTLEVBQUViLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBbkJNLElBQUE7QUFvQmpCYyxFQUFBQSxRQUFRLEVBQUVkLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBcEJPLElBQUE7QUFxQmpCZSxFQUFBQSxLQUFLLEVBQUVmLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBckJVLE1BQUE7QUFzQmpCZ0IsRUFBQUEsa0JBQWtCLEVBQUVoQixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQXRCSCxJQUFBO0FBdUJqQlQsRUFBQUEsU0FBUyxFQUFFUyxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQXZCTSxNQUFBO0FBd0JqQmlCLEVBQUFBLFlBQVksRUFBRWpCLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQUFBLE9BQUFBLENBQWtCQSxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQXhCZixNQXdCSEEsQ0F4Qkc7QUF5QmpCa0IsRUFBQUEsbUJBQW1CLEVBQUVsQixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFBQSxPQUFBQSxDQUFrQkEsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0F6QnRCLE1BeUJJQSxDQXpCSjtBQTBCakJtQixFQUFBQSxlQUFlLEVBQUVuQixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFBQSxPQUFBQSxDQUFrQkEsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0ExQmxCLE1BMEJBQSxDQTFCQTtBQTJCakJvQixFQUFBQSxLQUFLLEVBQUVwQixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQTNCVSxNQUFBO0FBNEJqQnFCLEVBQUFBLElBQUksRUFBRXJCLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQUFBLEtBQUFBLENBQWdCLENBQUEsWUFBQSxFQUFBLFVBQUEsRUFBQSxlQUFBLEVBQUEsZ0JBQUEsRUE1QkwsUUE0QkssQ0FBaEJBLENBNUJXO0FBNkJqQnNCLEVBQUFBLG9CQUFvQixFQUFFdEIsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBQUEsS0FBQUEsQ0FBZ0IsQ0FBQSxPQUFBLEVBN0JyQixPQTZCcUIsQ0FBaEJBLENBN0JMO0FBOEJqQnVCLEVBQUFBLFlBQVksRUFBRXZCLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQUFBLFNBQUFBLENBQW9CLENBQUNBLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQUQsTUFBQSxFQUFtQkEsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0E5QnBDLE1BOEJpQixDQUFwQkEsQ0E5Qkc7QUErQmpCd0IsRUFBQUEsU0FBUyxFQUFFeEIsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0EvQk0sSUFBQTtBQWdDakJ5QixFQUFBQSxRQUFRLEVBQUV6QixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFBQSxTQUFBQSxDQUFvQixDQUFDQSxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFELElBQUEsRUFBaUJBLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBaEM5QixJQWdDYSxDQUFwQkEsQ0FoQ087QUFpQ2pCMEIsRUFBQUEsVUFBVSxFQUFFMUIsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBQUEsU0FBQUEsQ0FBb0IsQ0FBQ0EsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBRCxJQUFBLEVBQWlCQSxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUFyQ0EsSUFBb0IsQ0FBcEJBO0FBakNLLEM7aUNBRFJILFksa0JBcUNXO0FBQ3BCOEIsRUFBQUEsU0FBUyxFQURXLFNBQUE7QUFFcEJDLEVBQUFBLFNBQVMsRUFGVyxFQUFBO0FBR3BCUCxFQUFBQSxJQUFJLEVBSGdCLFVBQUE7QUFJcEJELEVBQUFBLEtBQUssRUFKZSxDQUFBO0FBS3BCRyxFQUFBQSxZQUFZLEVBTFEsRUFBQTtBQU1wQmYsRUFBQUEsTUFBTSxFQU5jLEtBQUE7QUFPcEJLLEVBQUFBLFNBQVMsRUFQVyxJQUFBO0FBUXBCRSxFQUFBQSxLQUFLLEVBUmUsRUFBQTtBQVNwQlMsRUFBQUEsU0FBUyxFQUFFSyxLQUFBQSxDQUFBQSxTQUFBQTtBQVRTLEM7QUFpUnhCLElBQU00QyxTQUFTLEdBQUcsQ0FBQSxHQUFBLFVBQUEsQ0FBQSxPQUFBLElBQWxCLFlBQWtCLENBQWxCO2VBRWVBLFMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ2hpbGRyZW4sIGNsb25lRWxlbWVudCwgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IG5vb3AgZnJvbSAnbG9kYXNoL25vb3AnO1xuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ21pbmktc3RvcmUnO1xuaW1wb3J0IEtleUNvZGUgZnJvbSAnLi4vLi4vX3V0aWwvS2V5Q29kZSc7XG5pbXBvcnQgY3JlYXRlQ2hhaW5lZEZ1bmN0aW9uIGZyb20gJy4uL3V0aWwvY3JlYXRlQ2hhaW5lZEZ1bmN0aW9uJztcbmltcG9ydCB7IGdldEtleUZyb21DaGlsZHJlbkluZGV4LCBsb29wTWVudUl0ZW0sIG1lbnVBbGxQcm9wcyB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgRE9NV3JhcCBmcm9tICcuL0RPTVdyYXAnO1xuXG5mdW5jdGlvbiBhbGxEaXNhYmxlZChhcnIpIHtcbiAgaWYgKCFhcnIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGFyci5ldmVyeShjID0+ICEhYy5wcm9wcy5kaXNhYmxlZCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUFjdGl2ZUtleShzdG9yZSwgbWVudUlkLCBhY3RpdmVLZXkpIHtcbiAgY29uc3Qgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpO1xuICBzdG9yZS5zZXRTdGF0ZSh7XG4gICAgYWN0aXZlS2V5OiB7XG4gICAgICAuLi5zdGF0ZS5hY3RpdmVLZXksXG4gICAgICBbbWVudUlkXTogYWN0aXZlS2V5LFxuICAgIH0sXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRFdmVudEtleShwcm9wcykge1xuICAvLyB3aGVuIGV2ZW50S2V5IG5vdCBhdmFpbGFibGUgLGl0J3MgbWVudSBhbmQgcmV0dXJuIG1lbnUgaWQgJzAtbWVudS0nXG4gIHJldHVybiBwcm9wcy5ldmVudEtleSB8fCAnMC1tZW51LSc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY3RpdmVLZXkocHJvcHMsIG9yaWdpbmFsQWN0aXZlS2V5KSB7XG4gIGxldCBhY3RpdmVLZXkgPSBvcmlnaW5hbEFjdGl2ZUtleTtcbiAgY29uc3QgeyBjaGlsZHJlbiwgZXZlbnRLZXkgfSA9IHByb3BzO1xuICBpZiAoYWN0aXZlS2V5KSB7XG4gICAgbGV0IGZvdW5kO1xuICAgIGxvb3BNZW51SXRlbShjaGlsZHJlbiwgKGMsIGkpID0+IHtcbiAgICAgIGlmIChjICYmICFjLnByb3BzLmRpc2FibGVkICYmIGFjdGl2ZUtleSA9PT0gZ2V0S2V5RnJvbUNoaWxkcmVuSW5kZXgoYywgZXZlbnRLZXksIGkpKSB7XG4gICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZm91bmQpIHtcbiAgICAgIHJldHVybiBhY3RpdmVLZXk7XG4gICAgfVxuICB9XG4gIGFjdGl2ZUtleSA9IG51bGw7XG4gIGlmIChwcm9wcy5kZWZhdWx0QWN0aXZlRmlyc3QpIHtcbiAgICBsb29wTWVudUl0ZW0oY2hpbGRyZW4sIChjLCBpKSA9PiB7XG4gICAgICBpZiAoIWFjdGl2ZUtleSAmJiBjICYmICFjLnByb3BzLmRpc2FibGVkKSB7XG4gICAgICAgIGFjdGl2ZUtleSA9IGdldEtleUZyb21DaGlsZHJlbkluZGV4KGMsIGV2ZW50S2V5LCBpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gYWN0aXZlS2V5O1xuICB9XG4gIHJldHVybiBhY3RpdmVLZXk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlUmVmKGMpIHtcbiAgaWYgKGMpIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5zdGFuY2VBcnJheS5pbmRleE9mKGMpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIC8vIHVwZGF0ZSBjb21wb25lbnQgaWYgaXQncyBhbHJlYWR5IGluc2lkZSBpbnN0YW5jZUFycmF5XG4gICAgICB0aGlzLmluc3RhbmNlQXJyYXlbaW5kZXhdID0gYztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYWRkIGNvbXBvbmVudCBpZiBpdCdzIG5vdCBpbiBpbnN0YW5jZUFycmF5IHlldDtcbiAgICAgIHRoaXMuaW5zdGFuY2VBcnJheS5wdXNoKGMpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3ViUG9wdXBNZW51IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICBvblNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25DbGljazogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25EZXNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25PcGVuQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbkRlc3Ryb3k6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9wZW5UcmFuc2l0aW9uTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBvcGVuQW5pbWF0aW9uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMub2JqZWN0XSksXG4gICAgb3BlbktleXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zdHJpbmcpLFxuICAgIGhpZGRlbjogUHJvcFR5cGVzLmJvb2wsXG4gICAgY2hpbGRyZW46IFByb3BUeXBlcy5hbnksXG4gICAgcGFyZW50TWVudTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBldmVudEtleTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBzdG9yZTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIGdldFN0YXRlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAgIHNldFN0YXRlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICB9KSxcblxuICAgIC8vIGFkZGluZyBpbiByZWZhY3RvclxuICAgIGZvY3VzYWJsZTogUHJvcFR5cGVzLmJvb2wsXG4gICAgbXVsdGlwbGU6IFByb3BUeXBlcy5ib29sLFxuICAgIHN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGRlZmF1bHRBY3RpdmVGaXJzdDogUHJvcFR5cGVzLmJvb2wsXG4gICAgYWN0aXZlS2V5OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHNlbGVjdGVkS2V5czogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnN0cmluZyksXG4gICAgZGVmYXVsdFNlbGVjdGVkS2V5czogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnN0cmluZyksXG4gICAgZGVmYXVsdE9wZW5LZXlzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuc3RyaW5nKSxcbiAgICBsZXZlbDogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtb2RlOiBQcm9wVHlwZXMub25lT2YoWydob3Jpem9udGFsJywgJ3ZlcnRpY2FsJywgJ3ZlcnRpY2FsLWxlZnQnLCAndmVydGljYWwtcmlnaHQnLCAnaW5saW5lJ10pLFxuICAgIHRyaWdnZXJTdWJNZW51QWN0aW9uOiBQcm9wVHlwZXMub25lT2YoWydjbGljaycsICdob3ZlciddKSxcbiAgICBpbmxpbmVJbmRlbnQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5udW1iZXIsIFByb3BUeXBlcy5zdHJpbmddKSxcbiAgICBtYW51YWxSZWY6IFByb3BUeXBlcy5mdW5jLFxuICAgIGl0ZW1JY29uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuYywgUHJvcFR5cGVzLm5vZGVdKSxcbiAgICBleHBhbmRJY29uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuYywgUHJvcFR5cGVzLm5vZGVdKSxcbiAgfTtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHByZWZpeENsczogJ3JjLW1lbnUnLFxuICAgIGNsYXNzTmFtZTogJycsXG4gICAgbW9kZTogJ3ZlcnRpY2FsJyxcbiAgICBsZXZlbDogMSxcbiAgICBpbmxpbmVJbmRlbnQ6IDI0LFxuICAgIGhpZGRlbjogZmFsc2UsXG4gICAgZm9jdXNhYmxlOiB0cnVlLFxuICAgIHN0eWxlOiB7fSxcbiAgICBtYW51YWxSZWY6IG5vb3AsXG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICBwcm9wcy5zdG9yZS5zZXRTdGF0ZSh7XG4gICAgICBhY3RpdmVLZXk6IHtcbiAgICAgICAgLi4ucHJvcHMuc3RvcmUuZ2V0U3RhdGUoKS5hY3RpdmVLZXksXG4gICAgICAgIFtwcm9wcy5ldmVudEtleV06IGdldEFjdGl2ZUtleShwcm9wcywgcHJvcHMuYWN0aXZlS2V5KSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLmluc3RhbmNlQXJyYXkgPSBbXTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIC8vIGludm9rZSBjdXN0b21pemVkIHJlZiB0byBleHBvc2UgY29tcG9uZW50IHRvIG1peGluXG4gICAgaWYgKHRoaXMucHJvcHMubWFudWFsUmVmKSB7XG4gICAgICB0aGlzLnByb3BzLm1hbnVhbFJlZih0aGlzKTtcbiAgICB9XG4gIH1cblxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzKSB7XG4gICAgcmV0dXJuICF0aGlzLnByb3BzLmhpZGRlbiB8fCAhbmV4dFByb3BzLmhpZGRlbjtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qgb3JpZ2luYWxBY3RpdmVLZXkgPSAnYWN0aXZlS2V5JyBpbiBwcm9wcyA/IHByb3BzLmFjdGl2ZUtleSA6IHByb3BzLnN0b3JlLmdldFN0YXRlKCkuYWN0aXZlS2V5W2dldEV2ZW50S2V5KHByb3BzKV07XG4gICAgY29uc3QgYWN0aXZlS2V5ID0gZ2V0QWN0aXZlS2V5KHByb3BzLCBvcmlnaW5hbEFjdGl2ZUtleSk7XG4gICAgaWYgKGFjdGl2ZUtleSAhPT0gb3JpZ2luYWxBY3RpdmVLZXkpIHtcbiAgICAgIHVwZGF0ZUFjdGl2ZUtleShwcm9wcy5zdG9yZSwgZ2V0RXZlbnRLZXkocHJvcHMpLCBhY3RpdmVLZXkpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGFsbCBrZXlib2FyZCBldmVudHMgY2FsbGJhY2tzIHJ1biBmcm9tIGhlcmUgYXQgZmlyc3RcbiAgb25LZXlEb3duID0gKGUsIGNhbGxiYWNrKSA9PiB7XG4gICAgY29uc3Qga2V5Q29kZSA9IGUua2V5Q29kZTtcbiAgICBsZXQgaGFuZGxlZDtcbiAgICB0aGlzLmdldEZsYXRJbnN0YW5jZUFycmF5KCkuZm9yRWFjaCgob2JqKSA9PiB7XG4gICAgICBpZiAob2JqICYmIG9iai5wcm9wcy5hY3RpdmUgJiYgb2JqLm9uS2V5RG93bikge1xuICAgICAgICBoYW5kbGVkID0gb2JqLm9uS2V5RG93bihlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoaGFuZGxlZCkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGxldCBhY3RpdmVJdGVtID0gbnVsbDtcbiAgICBpZiAoa2V5Q29kZSA9PT0gS2V5Q29kZS5VUCB8fCBrZXlDb2RlID09PSBLZXlDb2RlLkRPV04pIHtcbiAgICAgIGFjdGl2ZUl0ZW0gPSB0aGlzLnN0ZXAoa2V5Q29kZSA9PT0gS2V5Q29kZS5VUCA/IC0xIDogMSk7XG4gICAgfVxuICAgIGlmIChhY3RpdmVJdGVtKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB1cGRhdGVBY3RpdmVLZXkodGhpcy5wcm9wcy5zdG9yZSwgZ2V0RXZlbnRLZXkodGhpcy5wcm9wcyksIGFjdGl2ZUl0ZW0ucHJvcHMuZXZlbnRLZXkpO1xuXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNhbGxiYWNrKGFjdGl2ZUl0ZW0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gIH07XG5cbiAgb25JdGVtSG92ZXIgPSAoZSkgPT4ge1xuICAgIGNvbnN0IHsga2V5LCBob3ZlciB9ID0gZTtcbiAgICB1cGRhdGVBY3RpdmVLZXkodGhpcy5wcm9wcy5zdG9yZSwgZ2V0RXZlbnRLZXkodGhpcy5wcm9wcyksIGhvdmVyID8ga2V5IDogbnVsbCk7XG4gIH07XG5cbiAgb25EZXNlbGVjdCA9IChzZWxlY3RJbmZvKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vbkRlc2VsZWN0KHNlbGVjdEluZm8pO1xuICB9O1xuXG4gIG9uU2VsZWN0ID0gKHNlbGVjdEluZm8pID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2VsZWN0KHNlbGVjdEluZm8pO1xuICB9O1xuXG4gIG9uQ2xpY2sgPSAoZSkgPT4ge1xuICAgIHRoaXMucHJvcHMub25DbGljayhlKTtcbiAgfTtcblxuICBvbk9wZW5DaGFuZ2UgPSAoZSkgPT4ge1xuICAgIHRoaXMucHJvcHMub25PcGVuQ2hhbmdlKGUpO1xuICB9O1xuXG4gIG9uRGVzdHJveSA9IChrZXkpID0+IHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIHRoaXMucHJvcHMub25EZXN0cm95KGtleSk7XG4gIH07XG5cbiAgZ2V0RmxhdEluc3RhbmNlQXJyYXkgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VBcnJheTtcbiAgfTtcblxuICBnZXRPcGVuVHJhbnNpdGlvbk5hbWUgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMub3BlblRyYW5zaXRpb25OYW1lO1xuICB9O1xuXG4gIHN0ZXAgPSAoZGlyZWN0aW9uKSA9PiB7XG4gICAgbGV0IGNoaWxkcmVuID0gdGhpcy5nZXRGbGF0SW5zdGFuY2VBcnJheSgpO1xuICAgIGNvbnN0IGFjdGl2ZUtleSA9IHRoaXMucHJvcHMuc3RvcmUuZ2V0U3RhdGUoKS5hY3RpdmVLZXlbZ2V0RXZlbnRLZXkodGhpcy5wcm9wcyldO1xuICAgIGNvbnN0IGxlbiA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICBpZiAoIWxlbikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChkaXJlY3Rpb24gPCAwKSB7XG4gICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmNvbmNhdCgpLnJldmVyc2UoKTtcbiAgICB9XG4gICAgLy8gZmluZCBjdXJyZW50IGFjdGl2ZUluZGV4XG4gICAgbGV0IGFjdGl2ZUluZGV4ID0gLTE7XG4gICAgY2hpbGRyZW4uZXZlcnkoKGMsIGNpKSA9PiB7XG4gICAgICBpZiAoYyAmJiBjLnByb3BzLmV2ZW50S2V5ID09PSBhY3RpdmVLZXkpIHtcbiAgICAgICAgYWN0aXZlSW5kZXggPSBjaTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gICAgaWYgKFxuICAgICAgIXRoaXMucHJvcHMuZGVmYXVsdEFjdGl2ZUZpcnN0ICYmIGFjdGl2ZUluZGV4ICE9PSAtMVxuICAgICAgJiZcbiAgICAgIGFsbERpc2FibGVkKGNoaWxkcmVuLnNsaWNlKGFjdGl2ZUluZGV4LCBsZW4gLSAxKSlcbiAgICApIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IHN0YXJ0ID0gKGFjdGl2ZUluZGV4ICsgMSkgJSBsZW47XG4gICAgbGV0IGkgPSBzdGFydDtcblxuICAgIGRvIHtcbiAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICBpZiAoIWNoaWxkIHx8IGNoaWxkLnByb3BzLmRpc2FibGVkKSB7XG4gICAgICAgIGkgPSAoaSArIDEpICUgbGVuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgICAgfVxuICAgIH0gd2hpbGUgKGkgIT09IHN0YXJ0KTtcblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIHJlbmRlckNvbW1vbk1lbnVJdGVtID0gKGNoaWxkLCBpLCBleHRyYVByb3BzKSA9PiB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLnByb3BzLnN0b3JlLmdldFN0YXRlKCk7XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGtleSA9IGdldEtleUZyb21DaGlsZHJlbkluZGV4KGNoaWxkLCBwcm9wcy5ldmVudEtleSwgaSk7XG4gICAgY29uc3QgY2hpbGRQcm9wcyA9IGNoaWxkLnByb3BzO1xuICAgIGNvbnN0IGlzQWN0aXZlID0ga2V5ID09PSBzdGF0ZS5hY3RpdmVLZXk7XG4gICAgY29uc3QgbmV3Q2hpbGRQcm9wcyA9IHtcbiAgICAgIG1vZGU6IGNoaWxkUHJvcHMubW9kZSB8fCBwcm9wcy5tb2RlLFxuICAgICAgbGV2ZWw6IHByb3BzLmxldmVsLFxuICAgICAgaW5saW5lSW5kZW50OiBwcm9wcy5pbmxpbmVJbmRlbnQsXG4gICAgICByZW5kZXJNZW51SXRlbTogdGhpcy5yZW5kZXJNZW51SXRlbSxcbiAgICAgIHJvb3RQcmVmaXhDbHM6IHByb3BzLnByZWZpeENscyxcbiAgICAgIGluZGV4OiBpLFxuICAgICAgcGFyZW50TWVudTogcHJvcHMucGFyZW50TWVudSxcbiAgICAgIC8vIGN1c3RvbWl6ZWQgcmVmIGZ1bmN0aW9uLCBuZWVkIHRvIGJlIGludm9rZWQgbWFudWFsbHkgaW4gY2hpbGQncyBjb21wb25lbnREaWRNb3VudFxuICAgICAgbWFudWFsUmVmOiBjaGlsZFByb3BzLmRpc2FibGVkID8gdW5kZWZpbmVkIDogY3JlYXRlQ2hhaW5lZEZ1bmN0aW9uKGNoaWxkLnJlZiwgc2F2ZVJlZi5iaW5kKHRoaXMpKSxcbiAgICAgIGV2ZW50S2V5OiBrZXksXG4gICAgICBhY3RpdmU6ICFjaGlsZFByb3BzLmRpc2FibGVkICYmIGlzQWN0aXZlLFxuICAgICAgbXVsdGlwbGU6IHByb3BzLm11bHRpcGxlLFxuICAgICAgb25DbGljazogKGUpID0+IHtcbiAgICAgICAgKGNoaWxkUHJvcHMub25DbGljayB8fCBub29wKShlKTtcbiAgICAgICAgdGhpcy5vbkNsaWNrKGUpO1xuICAgICAgfSxcbiAgICAgIG9uSXRlbUhvdmVyOiB0aGlzLm9uSXRlbUhvdmVyLFxuICAgICAgb3BlblRyYW5zaXRpb25OYW1lOiB0aGlzLmdldE9wZW5UcmFuc2l0aW9uTmFtZSgpLFxuICAgICAgb3BlbkFuaW1hdGlvbjogcHJvcHMub3BlbkFuaW1hdGlvbixcbiAgICAgIHN1Yk1lbnVPcGVuRGVsYXk6IHByb3BzLnN1Yk1lbnVPcGVuRGVsYXksXG4gICAgICBzdWJNZW51Q2xvc2VEZWxheTogcHJvcHMuc3ViTWVudUNsb3NlRGVsYXksXG4gICAgICBmb3JjZVN1Yk1lbnVSZW5kZXI6IHByb3BzLmZvcmNlU3ViTWVudVJlbmRlcixcbiAgICAgIG9uT3BlbkNoYW5nZTogdGhpcy5vbk9wZW5DaGFuZ2UsXG4gICAgICBvbkRlc2VsZWN0OiB0aGlzLm9uRGVzZWxlY3QsXG4gICAgICBvblNlbGVjdDogdGhpcy5vblNlbGVjdCxcbiAgICAgIGJ1aWx0aW5QbGFjZW1lbnRzOiBwcm9wcy5idWlsdGluUGxhY2VtZW50cyxcbiAgICAgIGl0ZW1JY29uOiBjaGlsZFByb3BzLml0ZW1JY29uIHx8IHRoaXMucHJvcHMuaXRlbUljb24sXG4gICAgICBleHBhbmRJY29uOiBjaGlsZFByb3BzLmV4cGFuZEljb24gfHwgdGhpcy5wcm9wcy5leHBhbmRJY29uLFxuICAgICAgLi4uZXh0cmFQcm9wcyxcbiAgICB9O1xuICAgIGlmIChwcm9wcy5tb2RlID09PSAnaW5saW5lJykge1xuICAgICAgbmV3Q2hpbGRQcm9wcy50cmlnZ2VyU3ViTWVudUFjdGlvbiA9ICdjbGljayc7XG4gICAgfVxuICAgIHJldHVybiBjbG9uZUVsZW1lbnQoY2hpbGQsIG5ld0NoaWxkUHJvcHMpO1xuICB9O1xuXG4gIHJlbmRlck1lbnVJdGVtID0gKGMsIGksIHN1Yk1lbnVLZXkpID0+IHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICBpZiAoIWMpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgZXh0cmFQcm9wcyA9IHtcbiAgICAgIG9wZW5LZXlzOiBwcm9wcy5vcGVuS2V5cyxcbiAgICAgIHNlbGVjdGVkS2V5czogcHJvcHMuc2VsZWN0ZWRLZXlzLFxuICAgICAgdHJpZ2dlclN1Yk1lbnVBY3Rpb246IHByb3BzLnRyaWdnZXJTdWJNZW51QWN0aW9uLFxuICAgICAgc3ViTWVudUtleSxcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLnJlbmRlckNvbW1vbk1lbnVJdGVtKGMsIGksIGV4dHJhUHJvcHMpO1xuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IC4uLnByb3BzIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgdGhpcy5pbnN0YW5jZUFycmF5ID0gW107XG4gICAgY29uc3QgY2xhc3NOYW1lID0gY2xhc3NOYW1lcyhcbiAgICAgIHByb3BzLnByZWZpeENscyxcbiAgICAgIHByb3BzLmNsYXNzTmFtZSxcbiAgICAgIGAke3Byb3BzLnByZWZpeENsc30tJHtwcm9wcy5tb2RlfWAsXG4gICAgKTtcbiAgICBjb25zdCBoYXZlUmVuZGVyZWQgPSB0aGlzLmhhdmVSZW5kZXJlZDtcbiAgICB0aGlzLmhhdmVSZW5kZXJlZCA9IHRydWU7XG4gICAgdGhpcy5oYXZlT3BlbmVkID0gdGhpcy5oYXZlT3BlbmVkIHx8ICFwcm9wcy5oaWRkZW4gfHwgcHJvcHMuZm9yY2VTdWJNZW51UmVuZGVyO1xuICAgIGlmICghdGhpcy5oYXZlT3BlbmVkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgZG9tUHJvcHMgPSB7XG4gICAgICBjbGFzc05hbWUsXG4gICAgICAvLyByb2xlIGNvdWxkIGJlICdzZWxlY3QnIGFuZCBieSBkZWZhdWx0IHNldCB0byBtZW51XG4gICAgICByb2xlOiBwcm9wcy5yb2xlIHx8ICdtZW51JyxcbiAgICB9O1xuICAgIGlmIChwcm9wcy5pZCkge1xuICAgICAgZG9tUHJvcHMuaWQgPSBwcm9wcy5pZDtcbiAgICB9XG4gICAgaWYgKHByb3BzLmZvY3VzYWJsZSkge1xuICAgICAgZG9tUHJvcHMudGFiSW5kZXggPSAnMCc7XG4gICAgICBkb21Qcm9wcy5vbktleURvd24gPSB0aGlzLm9uS2V5RG93bjtcbiAgICB9XG4gICAgY29uc3QgeyBwcmVmaXhDbHMsIGV2ZW50S2V5LCBoaWRkZW4sIGxldmVsLCBtb2RlLCBvdmVyZmxvd2VkSW5kaWNhdG9yLCB0aGVtZSB9ID0gcHJvcHM7XG4gICAgbWVudUFsbFByb3BzLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBwcm9wc1trZXldKTtcblxuICAgIGNvbnN0IHRyYW5zaXRpb25BcHBlYXIgPSAhKCFoYXZlUmVuZGVyZWQgJiYgIXByb3BzLmhpZGRlbiAmJiBwcm9wcy5tb2RlID09PSAnaW5saW5lJyk7XG5cbiAgICBwcm9wcy5jbGFzc05hbWUgKz0gYCAke3Byb3BzLnByZWZpeENsc30tc3ViYDtcbiAgICBkZWxldGUgcHJvcHMub25DbGljaztcbiAgICBjb25zdCBhbmltUHJvcHMgPSB7fTtcbiAgICBpZiAocHJvcHMub3BlblRyYW5zaXRpb25OYW1lKSB7XG4gICAgICBhbmltUHJvcHMudHJhbnNpdGlvbk5hbWUgPSBwcm9wcy5vcGVuVHJhbnNpdGlvbk5hbWU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvcHMub3BlbkFuaW1hdGlvbiA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGFuaW1Qcm9wcy5hbmltYXRpb24gPSB7IC4uLnByb3BzLm9wZW5BbmltYXRpb24gfTtcbiAgICAgIGlmICghdHJhbnNpdGlvbkFwcGVhcikge1xuICAgICAgICBkZWxldGUgYW5pbVByb3BzLmFuaW1hdGlvbi5hcHBlYXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICAvKiBlc2xpbnQtZGlzYWJsZSAqL1xuICAgICAgPERPTVdyYXBcbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgICBwcmVmaXhDbHM9e3ByZWZpeENsc31cbiAgICAgICAgbW9kZT17bW9kZX1cbiAgICAgICAgdGFnPVwidWxcIlxuICAgICAgICBsZXZlbD17bGV2ZWx9XG4gICAgICAgIHRoZW1lPXt0aGVtZX1cbiAgICAgICAgaGlkZGVuQ2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LWhpZGRlbmB9XG4gICAgICAgIGhpZGRlbj17aGlkZGVufVxuICAgICAgICBvdmVyZmxvd2VkSW5kaWNhdG9yPXtvdmVyZmxvd2VkSW5kaWNhdG9yfVxuICAgICAgICB7Li4uZG9tUHJvcHN9XG4gICAgICA+XG4gICAgICAgIHtDaGlsZHJlbi5tYXAoXG4gICAgICAgICAgcHJvcHMuY2hpbGRyZW4sXG4gICAgICAgICAgKGMsIGkpID0+IHRoaXMucmVuZGVyTWVudUl0ZW0oYywgaSwgZXZlbnRLZXkgfHwgJzAtbWVudS0nKSxcbiAgICAgICAgKX1cbiAgICAgIDwvRE9NV3JhcD5cbiAgICAgIC8qZXNsaW50LWVuYWJsZSAqL1xuICAgICk7XG4gIH1cbn1cblxuY29uc3QgY29ubmVjdGVkID0gY29ubmVjdCgpKFN1YlBvcHVwTWVudSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3RlZDtcbiJdfQ==