bb6d5444c83c22b35bbaee4eedb55e33
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _ = _interopRequireDefault(require(".."));

describe('Table.sorter', function () {
  var sorterFn = function sorterFn(a, b) {
    return a.name[0].charCodeAt() - b.name[0].charCodeAt();
  };

  var column = {
    title: 'Name',
    dataIndex: 'name',
    sorter: sorterFn
  };
  var data = [{
    key: 0,
    name: 'Jack'
  }, {
    key: 1,
    name: 'Lucy'
  }, {
    key: 2,
    name: 'Tom'
  }, {
    key: 3,
    name: 'Jerry'
  }];

  function createTable(tableProps) {
    var columnProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    return _react["default"].createElement(_["default"], (0, _extends2["default"])({
      columns: [(0, _objectSpread2["default"])({}, column, {}, columnProps)],
      dataSource: data,
      pagination: false
    }, tableProps));
  }

  function renderedNames(wrapper) {
    return wrapper.find('TableRow').map(function (row) {
      return row.props().record.name;
    });
  }

  it('renders sorter icon correctly', function () {
    var wrapper = (0, _enzyme.render)(createTable());
    expect(wrapper.find('thead')).toMatchSnapshot();
  });
  it('default sort order ascend', function () {
    var wrapper = (0, _enzyme.mount)(createTable({}, {
      defaultSortOrder: 'ascend'
    }));
    expect(renderedNames(wrapper)).toEqual(['Jack', 'Jerry', 'Lucy', 'Tom']);
  });
  it('default sort order descend', function () {
    var wrapper = (0, _enzyme.mount)(createTable({}, {
      defaultSortOrder: 'descend'
    }));
    expect(renderedNames(wrapper)).toEqual(['Tom', 'Lucy', 'Jack', 'Jerry']);
  });
  it('sort records', function () {
    var wrapper = (0, _enzyme.mount)(createTable());
    var columnHead = wrapper.find('th.c7n-table-column-has-filters');
    columnHead.simulate('click');
    expect(renderedNames(wrapper)).toEqual(['Jack', 'Jerry', 'Lucy', 'Tom']);
    columnHead.simulate('click');
    expect(renderedNames(wrapper)).toEqual(['Tom', 'Lucy', 'Jack', 'Jerry']);
  });
  it('can be controlled by sortOrder', function () {
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        sortOrder: 'ascend'
      })]
    }));
    expect(renderedNames(wrapper)).toEqual(['Jack', 'Jerry', 'Lucy', 'Tom']);
  });
  it('fires change event', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(createTable({
      onChange: handleChange
    }));
    wrapper.find('th.c7n-table-column-has-filters').simulate('click');
    var sorter = handleChange.mock.calls[0][2];
    expect(sorter.column.dataIndex).toBe('name');
    expect(sorter.order).toBe('ascend');
    expect(sorter.field).toBe('name');
    expect(sorter.columnKey).toBe('name');
  });
  it('works with grouping columns in controlled mode', function () {
    var columns = [{
      title: 'group',
      key: 'group',
      children: [{
        title: 'Name',
        dataIndex: 'name',
        key: 'name',
        sorter: sorterFn,
        sortOrder: 'descend'
      }, {
        title: 'Age',
        dataIndex: 'age',
        key: 'age'
      }]
    }];
    var testData = [{
      key: 0,
      name: 'Jack',
      age: 11
    }, {
      key: 1,
      name: 'Lucy',
      age: 20
    }, {
      key: 2,
      name: 'Tom',
      age: 21
    }, {
      key: 3,
      name: 'Jerry',
      age: 22
    }];
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      columns: columns,
      dataSource: testData
    }));
    expect(renderedNames(wrapper)).toEqual(['Tom', 'Lucy', 'Jack', 'Jerry']);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRhYmxlLnNvcnRlci50ZXN0LmpzIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwic29ydGVyRm4iLCJhIiwiYiIsIm5hbWUiLCJjaGFyQ29kZUF0IiwiY29sdW1uIiwidGl0bGUiLCJkYXRhSW5kZXgiLCJzb3J0ZXIiLCJkYXRhIiwia2V5IiwiY3JlYXRlVGFibGUiLCJ0YWJsZVByb3BzIiwiY29sdW1uUHJvcHMiLCJyZW5kZXJlZE5hbWVzIiwid3JhcHBlciIsImZpbmQiLCJtYXAiLCJyb3ciLCJwcm9wcyIsInJlY29yZCIsIml0IiwiZXhwZWN0IiwidG9NYXRjaFNuYXBzaG90IiwiZGVmYXVsdFNvcnRPcmRlciIsInRvRXF1YWwiLCJjb2x1bW5IZWFkIiwic2ltdWxhdGUiLCJjb2x1bW5zIiwic29ydE9yZGVyIiwiaGFuZGxlQ2hhbmdlIiwiamVzdCIsImZuIiwib25DaGFuZ2UiLCJtb2NrIiwiY2FsbHMiLCJ0b0JlIiwib3JkZXIiLCJmaWVsZCIsImNvbHVtbktleSIsImNoaWxkcmVuIiwidGVzdERhdGEiLCJhZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUFBLFFBQVEsQ0FBQyxjQUFELEVBQWlCLFlBQU07QUFDN0IsTUFBTUMsUUFBUSxHQUFHLFNBQVhBLFFBQVcsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKO0FBQUEsV0FBVUQsQ0FBQyxDQUFDRSxJQUFGLENBQU8sQ0FBUCxFQUFVQyxVQUFWLEtBQXlCRixDQUFDLENBQUNDLElBQUYsQ0FBTyxDQUFQLEVBQVVDLFVBQVYsRUFBbkM7QUFBQSxHQUFqQjs7QUFFQSxNQUFNQyxNQUFNLEdBQUc7QUFDYkMsSUFBQUEsS0FBSyxFQUFFLE1BRE07QUFFYkMsSUFBQUEsU0FBUyxFQUFFLE1BRkU7QUFHYkMsSUFBQUEsTUFBTSxFQUFFUjtBQUhLLEdBQWY7QUFNQSxNQUFNUyxJQUFJLEdBQUcsQ0FDWDtBQUFFQyxJQUFBQSxHQUFHLEVBQUUsQ0FBUDtBQUFVUCxJQUFBQSxJQUFJLEVB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LE1BQU4sQ0FBaEI7QUFFQW5CLElBQUFBLE1BQU0sQ0FBQ1IsYUFBYSxDQUFDQyxPQUFELENBQWQsQ0FBTixDQUErQlUsT0FBL0IsQ0FBdUMsQ0FBQyxLQUFELEVBQVEsTUFBUixFQUFnQixNQUFoQixFQUF3QixPQUF4QixDQUF2QztBQUNELEdBOUJDLENBQUY7QUErQkQsQ0FsSU8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIG1vdW50IH0gZnJvbSAnZW56eW1lJztcbmltcG9ydCBUYWJsZSBmcm9tICcuLic7XG5cbmRlc2NyaWJlKCdUYWJsZS5zb3J0ZXInLCAoKSA9PiB7XG4gIGNvbnN0IHNvcnRlckZuID0gKGEsIGIpID0+IGEubmFtZVswXS5jaGFyQ29kZUF0KCkgLSBiLm5hbWVbMF0uY2hhckNvZGVBdCgpO1xuXG4gIGNvbnN0IGNvbHVtbiA9IHtcbiAgICB0aXRsZTogJ05hbWUnLFxuICAgIGRhdGFJbmRleDogJ25hbWUnLFxuICAgIHNvcnRlcjogc29ydGVyRm4sXG4gIH07XG5cbiAgY29uc3QgZGF0YSA9IFtcbiAgICB7IGtleTogMCwgbmFtZTogJ0phY2snIH0sXG4gICAgeyBrZXk6IDEsIG5hbWU6ICdMdWN5JyB9LFxuICAgIHsga2V5OiAyLCBuYW1lOiAnVG9tJyB9LFxuICAgIHsga2V5OiAzLCBuYW1lOiAnSmVycnknIH0sXG4gIF07XG5cbiAgZnVuY3Rpb24gY3JlYXRlVGFibGUodGFibGVQcm9wcywgY29sdW1uUHJvcHMgPSB7fSkge1xuICAgIHJldHVybiAoXG4gICAgICA8VGFibGVcbiAgICAgICAgY29sdW1ucz17W1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICAgIC4uLmNvbHVtblByb3BzLFxuICAgICAgICAgIH0sXG4gICAgICAgIF19XG4gICAgICAgIGRhdGFTb3VyY2U9e2RhdGF9XG4gICAgICAgIHBhZ2luYXRpb249e2ZhbHNlfVxuICAgICAgICB7Li4udGFibGVQcm9wc31cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlcmVkTmFtZXMod3JhcHBlcikge1xuICAgIHJldHVybiB3cmFwcGVyLmZpbmQoJ1RhYmxlUm93JykubWFwKHJvdyA9PiByb3cucHJvcHMoKS5yZWNvcmQubmFtZSk7XG4gIH1cblxuICBpdCgncmVuZGVycyBzb3J0ZXIgaWNvbiBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IHJlbmRlcihjcmVhdGVUYWJsZSgpKTtcbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCd0aGVhZCcpKS50b01hdGNoU25hcHNob3QoKTtcbiAgfSk7XG5cbiAgaXQoJ2RlZmF1bHQgc29ydCBvcmRlciBhc2NlbmQnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgY3JlYXRlVGFibGUoXG4gICAgICAgIHt9LFxuICAgICAgICB7XG4gICAgICAgICAgZGVmYXVsdFNvcnRPcmRlcjogJ2FzY2VuZCcsXG4gICAgICAgIH0sXG4gICAgICApLFxuICAgICk7XG5cbiAgICBleHBlY3QocmVuZGVyZWROYW1lcyh3cmFwcGVyKSkudG9FcXVhbChbJ0phY2snLCAnSmVycnknLCAnTHVjeScsICdUb20nXSk7XG4gIH0pO1xuXG4gIGl0KCdkZWZhdWx0IHNvcnQgb3JkZXIgZGVzY2VuZCcsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoXG4gICAgICBjcmVhdGVUYWJsZShcbiAgICAgICAge30sXG4gICAgICAgIHtcbiAgICAgICAgICBkZWZhdWx0U29ydE9yZGVyOiAnZGVzY2VuZCcsXG4gICAgICAgIH0sXG4gICAgICApLFxuICAgICk7XG5cbiAgICBleHBlY3QocmVuZGVyZWROYW1lcyh3cmFwcGVyKSkudG9FcXVhbChbJ1RvbScsICdMdWN5JywgJ0phY2snLCAnSmVycnknXSk7XG4gIH0pO1xuXG4gIGl0KCdzb3J0IHJlY29yZHMnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KGNyZWF0ZVRhYmxlKCkpO1xuICAgIGNvbnN0IGNvbHVtbkhlYWQgPSB3cmFwcGVyLmZpbmQoJ3RoLmM3bi10YWJsZS1jb2x1bW4taGFzLWZpbHRlcnMnKTtcbiAgICBjb2x1bW5IZWFkLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGV4cGVjdChyZW5kZXJlZE5hbWVzKHdyYXBwZXIpKS50b0VxdWFsKFsnSmFjaycsICdKZXJyeScsICdMdWN5JywgJ1RvbSddKTtcblxuICAgIGNvbHVtbkhlYWQuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgZXhwZWN0KHJlbmRlcmVkTmFtZXMod3JhcHBlcikpLnRvRXF1YWwoWydUb20nLCAnTHVjeScsICdKYWNrJywgJ0plcnJ5J10pO1xuICB9KTtcblxuICBpdCgnY2FuIGJlIGNvbnRyb2xsZWQgYnkgc29ydE9yZGVyJywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIGNyZWF0ZVRhYmxlKHtcbiAgICAgICAgY29sdW1uczogW3sgLi4uY29sdW1uLCBzb3J0T3JkZXI6ICdhc2NlbmQnIH1dLFxuICAgICAgfSksXG4gICAgKTtcbiAgICBleHBlY3QocmVuZGVyZWROYW1lcyh3cmFwcGVyKSkudG9FcXVhbChbJ0phY2snLCAnSmVycnknLCAnTHVjeScsICdUb20nXSk7XG4gIH0pO1xuXG4gIGl0KCdmaXJlcyBjaGFuZ2UgZXZlbnQnLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChjcmVhdGVUYWJsZSh7IG9uQ2hhbmdlOiBoYW5kbGVDaGFuZ2UgfSkpO1xuXG4gICAgd3JhcHBlci5maW5kKCd0aC5jN24tdGFibGUtY29sdW1uLWhhcy1maWx0ZXJzJykuc2ltdWxhdGUoJ2NsaWNrJyk7XG5cbiAgICBjb25zdCBzb3J0ZXIgPSBoYW5kbGVDaGFuZ2UubW9jay5jYWxsc1swXVsyXTtcbiAgICBleHBlY3Qoc29ydGVyLmNvbHVtbi5kYXRhSW5kZXgpLnRvQmUoJ25hbWUnKTtcbiAgICBleHBlY3Qoc29ydGVyLm9yZGVyKS50b0JlKCdhc2NlbmQnKTtcbiAgICBleHBlY3Qoc29ydGVyLmZpZWxkKS50b0JlKCduYW1lJyk7XG4gICAgZXhwZWN0KHNvcnRlci5jb2x1bW5LZXkpLnRvQmUoJ25hbWUnKTtcbiAgfSk7XG5cbiAgaXQoJ3dvcmtzIHdpdGggZ3JvdXBpbmcgY29sdW1ucyBpbiBjb250cm9sbGVkIG1vZGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY29sdW1ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgdGl0bGU6ICdncm91cCcsXG4gICAgICAgIGtleTogJ2dyb3VwJyxcbiAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZTogJ05hbWUnLFxuICAgICAgICAgICAgZGF0YUluZGV4OiAnbmFtZScsXG4gICAgICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgICAgIHNvcnRlcjogc29ydGVyRm4sXG4gICAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjZW5kJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnQWdlJyxcbiAgICAgICAgICAgIGRhdGFJbmRleDogJ2FnZScsXG4gICAgICAgICAgICBrZXk6ICdhZ2UnLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIF07XG4gICAgY29uc3QgdGVzdERhdGEgPSBbXG4gICAgICB7IGtleTogMCwgbmFtZTogJ0phY2snLCBhZ2U6IDExIH0sXG4gICAgICB7IGtleTogMSwgbmFtZTogJ0x1Y3knLCBhZ2U6IDIwIH0sXG4gICAgICB7IGtleTogMiwgbmFtZTogJ1RvbScsIGFnZTogMjEgfSxcbiAgICAgIHsga2V5OiAzLCBuYW1lOiAnSmVycnknLCBhZ2U6IDIyIH0sXG4gICAgXTtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPFRhYmxlIGNvbHVtbnM9e2NvbHVtbnN9IGRhdGFTb3VyY2U9e3Rlc3REYXRhfSAvPik7XG5cbiAgICBleHBlY3QocmVuZGVyZWROYW1lcyh3cmFwcGVyKSkudG9FcXVhbChbJ1RvbScsICdMdWN5JywgJ0phY2snLCAnSmVycnknXSk7XG4gIH0pO1xufSk7XG4iXX0=