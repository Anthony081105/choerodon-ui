02da6d9e2aa66852db478ac4841ceeb8
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _getOffset = _interopRequireDefault(require("../utils/getOffset"));

var SuggestionPortal =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(SuggestionPortal, _Component);

  function SuggestionPortal() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2["default"])(this, SuggestionPortal);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(SuggestionPortal)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "matchDecorates", function (props) {
      var callbacks = props.callbacks,
          suggestionRegex = props.suggestionRegex,
          decoratedText = props.decoratedText;
      var matches = suggestionRegex.exec(decoratedText);
      _this.trigger = matches[2];

      _this.updatePortalPosition(_this.props);

      callbacks.setEditorState(callbacks.getEditorState());
    });
    return _this;
  }

  (0, _createClass2["default"])(SuggestionPortal, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      this.matchDecorates(this.props);
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if (nextProps.decoratedText !== this.props.decoratedText) {
        this.matchDecorates(nextProps);
      }

      this.updatePortalPosition(nextProps);
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      var _this$props = this.props,
          offsetKey = _this$props.offsetKey,
          mentionStore = _this$props.mentionStore;
      mentionStore.inActiveSuggestion({
        offsetKey: offsetKey
      });
    }
  }, {
    key: "updatePortalPosition",
    value: function updatePortalPosition(props) {
      var _this2 = this;

      var offsetKey = props.offsetKey,
          mentionStore = props.mentionStore;
      mentionStore.updateSuggestion({
        offsetKey: offsetKey,
        trigger: this.trigger,
        position: function position() {
          var element = _this2.searchPortal;
          var rect = (0, _getOffset["default"])(element);
          return {
            left: rect.left,
            top: rect.top,
            width: element.offsetWidth,
            height: element.offsetHeight
          };
        }
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      return _react["default"].createElement("span", {
        ref: function ref(node) {
          _this3.searchPortal = node;
        },
        style: this.props.style
      }, this.props.children);
    }
  }]);
  return SuggestionPortal;
}(_react.Component);

exports["default"] = SuggestionPortal;
(0, _defineProperty2["default"])(SuggestionPortal, "propTypes", {
  offsetKey: _propTypes["default"].any,
  mentionStore: _propTypes["default"].object,
  decoratedText: _propTypes["default"].string,
  children: _propTypes["default"].any,
  callbacks: _propTypes["default"].any,
  suggestionRegex: _propTypes["default"].any
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN1Z2dlc3Rpb25Qb3J0YWwucmVhY3QuanN4Il0sIm5hbWVzIjpbIlN1Z2dlc3Rpb25Qb3J0YWwiLCJwcm9wcyIsImNhbGxiYWNrcyIsInN1Z2dlc3Rpb25SZWdleCIsImRlY29yYXRlZFRleHQiLCJtYXRjaGVzIiwiZXhlYyIsInRyaWdnZXIiLCJ1cGRhdGVQb3J0YWxQb3NpdGlvbiIsInNldEVkaXRvclN0YXRlIiwiZ2V0RWRpdG9yU3RhdGUiLCJtYXRjaERlY29yYXRlcyIsIm5leHRQcm9wcyIsIm9mZnNldEtleSIsIm1lbnRpb25TdG9yZSIsImluQWN0aXZlU3VnZ2VzdGlvbiIsInVwZGF0ZVN1Z2dlc3Rpb24iLCJwb3NpdGlvbiIsImVsZW1lbnQiLCJzZWFyY2hQb3J0YWwiLCJyZWN0IiwibGVmdCIsInRvcCIsIndpZHRoIiwib2Zmc2V0V2lkdGgiLCJoZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJub2RlIiwic3R5bGUiLCJjaGlsZHJlbiIsIkNvbXBvbmVudCIsIlByb3BUeXBlcyIsImFueSIsIm9iamVjdCIsInN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztJQUVxQkEsZ0I7Ozs7Ozs7Ozs7Ozs7Ozs7O3VHQXFCRixVQUFDQyxLQUFELEVBQVc7QUFBQSxVQUNsQkMsU0FEa0IsR0FDNEJELEtBRDVCLENBQ2xCQyxTQURrQjtBQUFBLFVBQ1BDLGVBRE8sR0FDNEJGLEtBRDVCLENBQ1BFLGVBRE87QUFBQSxVQUNVQyxhQURWLEdBQzRCSCxLQUQ1QixDQUNVRyxhQURWO0FBRTFCLFVBQU1DLE9BQU8sR0FBR0YsZUFBZSxDQUFDRyxJQUFoQixDQUFxQkYsYUFBckIsQ0FBaEI7QUFDQSxZQUFLRyxPQUFMLEdBQWVGLE9BQU8sQ0FBQyxDQUFELENBQXRCOztBQUNBLFlBQUtHLG9CQUFMLENBQTBCLE1BQUtQLEtBQS9COztBQUNBQyxNQUFBQSxTQUFTLENBQUNPLGNBQVYsQ0FBeUJQLFNBQVMsQ0FBQ1EsY0FBVixFQUF6QjtBQUNELEs7Ozs7Ozt5Q0FqQm9CO0FBQ25CLFdBQUtDLGNBQUwsQ0FBb0IsS0FBS1YsS0FBekI7QUFDRDs7OzhDQUV5QlcsUyxFQUFXO0FBQ25DLFVBQUlBLFNBQVMsQ0FBQ1IsYUFBVixLQUE0QixLQUFLSCxLQUFMLENBQVdHLGFBQTNDLEVBQTBEO0FBQ3hELGFBQUtPLGNBQUwsQ0FBb0JDLFNBQXBCO0FBQ0Q7O0FBQ0QsV0FBS0osb0JBQUwsQ0FBMEJJLFNBQTFCO0FBQ0Q7OzsyQ0FVc0I7QUFBQSx3QkFDZSxLQUFLWCxLQURwQjtBQUFBLFVBQ2JZLFNBRGEsZUFDYkEsU0FEYTtBQUFBLFVBQ0ZDLFlBREUsZUFDRkEsWUFERTtBQUVyQkEsTUFBQUEsWUFBWSxDQUFDQyxrQkFBYixDQUFnQztBQUFFRixRQUFBQSxTQUFTLEVBQVRBO0FBQUYsT0FBaEM7QUFDRDs7O3lDQUVvQlosSyxFQUFPO0FBQUE7O0FBQUEsVUFDbEJZLFNBRGtCLEdBQ1VaLEtBRFYsQ0FDbEJZLFNBRGtCO0FBQUEsVUFDUEMsWUFETyxHQUNVYixLQURWLENBQ1BhLFlBRE87QUFFMUJBLE1BQUFBLFlBQVksQ0FBQ0UsZ0JBQWIsQ0FBOEI7QUFDNUJILFFBQUFBLFNBQVMsRUFBVEEsU0FENEI7QUFFNUJOLFFBQUFBLE9BQU8sRUFBRSxLQUFLQSxPQUZjO0FBRzVCVSxRQUFBQSxRQUFRLEVBQUUsb0JBQU07QUFDZCxjQUFNQyxPQUFPLEdBQUcsTUFBSSxDQUFDQyxZQUFyQjtBQUNBLGNBQU1DLElBQUksR0FBRywyQkFBVUYsT0FBVixDQUFiO0FBQ0EsaUJBQU87QUFDTEcsWUFBQUEsSUFBSSxFQUFFRCxJQUFJLENBQUNDLElBRE47QUFFTEMsWUFBQUEsR0FBRyxFQUFFRixJQUFJLENBQUNFLEdBRkw7QUFHTEMsWUFBQUEsS0FBSyxFQUFFTCxPQUFPLENBQUNNLFdBSFY7QUFJTEMsWUFBQUEsTUFBTSxFQUFFUCxPQUFPLENBQUNRO0FBSlgsV0FBUDtBQU1EO0FBWjJCLE9BQTlCO0FBY0Q7Ozs2QkFFUTtBQUFBOztBQUNQLGFBQ0U7QUFBTSxRQUFBLEdBQUcsRUFBRSxhQUFDQyxJQUFELEVBQVU7QUFDbkIsVUFBQSxNQUFJLENBQUNSLFlBQUwsR0FBb0JRLElBQXBCO0FBQ0QsU0FGRDtBQUVHLFFBQUEsS0FBSyxFQUFFLEtBQUsxQixLQUFMLENBQVcyQjtBQUZyQixTQUdHLEtBQUszQixLQUFMLENBQVc0QixRQUhkLENBREY7QUFPRDs7O0VBNUQyQ0MsZ0I7OztpQ0FBekI5QixnQixlQUNBO0FBQ2pCYSxFQUFBQSxTQUFTLEVBQUVrQixzQkFBVUMsR0FESjtBQUVqQmxCLEVBQUFBLFlBQVksRUFBRWlCLHNCQUFVRSxNQUZQO0FBR2pCN0IsRUFBQUEsYUFBYSxFQUFFMkIsc0JBQVVHLE1BSFI7QUFJakJMLEVBQUFBLFFBQVEsRUFBRUUsc0JBQVVDLEdBSkg7QUFLakI5QixFQUFBQSxTQUFTLEVBQUU2QixzQkFBVUMsR0FMSjtBQU1qQjdCLEVBQUFBLGVBQWUsRUFBRTRCLHNCQUFVQztBQU5WLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBnZXRPZmZzZXQgZnJvbSAnLi4vdXRpbHMvZ2V0T2Zmc2V0JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3VnZ2VzdGlvblBvcnRhbCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgb2Zmc2V0S2V5OiBQcm9wVHlwZXMuYW55LFxuICAgIG1lbnRpb25TdG9yZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBkZWNvcmF0ZWRUZXh0OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgIGNhbGxiYWNrczogUHJvcFR5cGVzLmFueSxcbiAgICBzdWdnZXN0aW9uUmVnZXg6IFByb3BUeXBlcy5hbnksXG4gIH07XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMubWF0Y2hEZWNvcmF0ZXModGhpcy5wcm9wcyk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMuZGVjb3JhdGVkVGV4dCAhPT0gdGhpcy5wcm9wcy5kZWNvcmF0ZWRUZXh0KSB7XG4gICAgICB0aGlzLm1hdGNoRGVjb3JhdGVzKG5leHRQcm9wcyk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlUG9ydGFsUG9zaXRpb24obmV4dFByb3BzKTtcbiAgfVxuXG4gIG1hdGNoRGVjb3JhdGVzID0gKHByb3BzKSA9PiB7XG4gICAgY29uc3QgeyBjYWxsYmFja3MsIHN1Z2dlc3Rpb25SZWdleCwgZGVjb3JhdGVkVGV4dCB9ID0gcHJvcHM7XG4gICAgY29uc3QgbWF0Y2hlcyA9IHN1Z2dlc3Rpb25SZWdleC5leGVjKGRlY29yYXRlZFRleHQpO1xuICAgIHRoaXMudHJpZ2dlciA9IG1hdGNoZXNbMl07XG4gICAgdGhpcy51cGRhdGVQb3J0YWxQb3NpdGlvbih0aGlzLnByb3BzKTtcbiAgICBjYWxsYmFja3Muc2V0RWRpdG9yU3RhdGUoY2FsbGJhY2tzLmdldEVkaXRvclN0YXRlKCkpO1xuICB9O1xuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGNvbnN0IHsgb2Zmc2V0S2V5LCBtZW50aW9uU3RvcmUgfSA9IHRoaXMucHJvcHM7XG4gICAgbWVudGlvblN0b3JlLmluQWN0aXZlU3VnZ2VzdGlvbih7IG9mZnNldEtleSB9KTtcbiAgfVxuXG4gIHVwZGF0ZVBvcnRhbFBvc2l0aW9uKHByb3BzKSB7XG4gICAgY29uc3QgeyBvZmZzZXRLZXksIG1lbnRpb25TdG9yZSB9ID0gcHJvcHM7XG4gICAgbWVudGlvblN0b3JlLnVwZGF0ZVN1Z2dlc3Rpb24oe1xuICAgICAgb2Zmc2V0S2V5LFxuICAgICAgdHJpZ2dlcjogdGhpcy50cmlnZ2VyLFxuICAgICAgcG9zaXRpb246ICgpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc2VhcmNoUG9ydGFsO1xuICAgICAgICBjb25zdCByZWN0ID0gZ2V0T2Zmc2V0KGVsZW1lbnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxlZnQ6IHJlY3QubGVmdCxcbiAgICAgICAgICB0b3A6IHJlY3QudG9wLFxuICAgICAgICAgIHdpZHRoOiBlbGVtZW50Lm9mZnNldFdpZHRoLFxuICAgICAgICAgIGhlaWdodDogZWxlbWVudC5vZmZzZXRIZWlnaHQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8c3BhbiByZWY9eyhub2RlKSA9PiB7XG4gICAgICAgIHRoaXMuc2VhcmNoUG9ydGFsID0gbm9kZTtcbiAgICAgIH19IHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cbiAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICA8L3NwYW4+XG4gICAgKTtcbiAgfVxufVxuIl19