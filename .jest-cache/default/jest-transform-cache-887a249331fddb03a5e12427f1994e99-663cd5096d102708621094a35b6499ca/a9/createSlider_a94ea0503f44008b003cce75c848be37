46fdf76710a068a34f8980ac7ae7160e
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = createSlider;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _addEventListener = _interopRequireDefault(require("../../../_util/addEventListener"));

var _classnames = _interopRequireDefault(require("classnames"));

var _noop = _interopRequireDefault(require("lodash/noop"));

var _warning = _interopRequireDefault(require("../../../_util/warning"));

var _Steps = _interopRequireDefault(require("./Steps"));

var _Marks = _interopRequireDefault(require("./Marks"));

var _Handle = _interopRequireDefault(require("../Handle"));

var utils = _interopRequireWildcard(require("../utils"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

function createSlider(Component) {
  var _class, _temp;

  return _temp = _class =
  /*#__PURE__*/
  function (_Component) {
    (0, _inherits2["default"])(ComponentEnhancer, _Component);

    var _super = _createSuper(ComponentEnhancer);

    function ComponentEnhancer(props) {
      var _this;

      (0, _classCallCheck2["default"])(this, ComponentEnhancer);
      _this = _super.call(this, props);
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onMouseDown", function (e) {
        if (e.button !== 0) {
          return;
        }

        var isVertical = _this.props.vertical;
        var position = utils.getMousePosition(isVertical, e);

        if (!utils.isEventFromHandle(e, _this.handlesRefs)) {
          _this.dragOffset = 0;
        } else {
          var handlePosition = utils.getHandleCenterPosition(isVertical, e.target);
          _this.dragOffset = position - handlePosition;
          position = handlePosition;
        }

        _this.removeDocumentEvents();

        _this.onStart(position);

        _this.addDocumentMouseEvents();
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onTouchStart", function (e) {
        if (utils.isNotTouchEvent(e)) return;
        var isVertical = _this.props.vertical;
        var position = utils.getTouchPosition(isVertical, e);

        if (!utils.isEventFromHandle(e, _this.handlesRefs)) {
          _this.dragOffset = 0;
        } else {
          var handlePosition = utils.getHandleCenterPosition(isVertical, e.target);
          _this.dragOffset = position - handlePosition;
          position = handlePosition;
        }

        _this.onStart(position);

        _this.addDocumentTouchEvents();

        utils.pauseEvent(e);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onFocus", function (e) {
        var _this$props = _this.props,
            onFocus = _this$props.onFocus,
            vertical = _this$props.vertical;

        if (utils.isEventFromHandle(e, _this.handlesRefs)) {
          var handlePosition = utils.getHandleCenterPosition(vertical, e.target);
          _this.dragOffset = 0;

          _this.onStart(handlePosition);

          utils.pauseEvent(e);

          if (onFocus) {
            onFocus(e);
          }
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onBlur", function (e) {
        var onBlur = _this.props.onBlur;

        _this.onEnd(e);

        if (onBlur) {
          onBlur(e);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onMouseUp", function () {
        if (_this.handlesRefs[_this.prevMovedHandleIndex]) {
          _this.handlesRefs[_this.prevMovedHandleIndex].clickFocus();
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onMouseMove", function (e) {
        if (!_this.sliderRef) {
          _this.onEnd();

          return;
        }

        var position = utils.getMousePosition(_this.props.vertical, e);

        _this.onMove(e, position - _this.dragOffset);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onTouchMove", function (e) {
        if (utils.isNotTouchEvent(e) || !_this.sliderRef) {
          _this.onEnd();

          return;
        }

        var position = utils.getTouchPosition(_this.props.vertical, e);

        _this.onMove(e, position - _this.dragOffset);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onKeyDown", function (e) {
        if (_this.sliderRef && utils.isEventFromHandle(e, _this.handlesRefs)) {
          _this.onKeyboard(e);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "saveSlider", function (slider) {
        _this.sliderRef = slider;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onClickMarkLabel", function (e, value) {
        e.stopPropagation();

        _this.onChange({
          value: value
        });
      });

      if (process.env.NODE_ENV !== 'production') {
        var step = props.step,
            max = props.max,
            min = props.min;
        (0, _warning["default"])(step && Math.floor(step) === step ? (max - min) % step === 0 : true, 'Slider[max] - Slider[min] (%s) should be a multiple of Slider[step] (%s)', max - min, step);
      }

      _this.handlesRefs = {};
      return _this;
    }

    (0, _createClass2["default"])(ComponentEnhancer, [{
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        if ((0, _get2["default"])((0, _getPrototypeOf2["default"])(ComponentEnhancer.prototype), "componentWillUnmount", this)) (0, _get2["default"])((0, _getPrototypeOf2["default"])(ComponentEnhancer.prototype), "componentWillUnmount", this).call(this);
        this.removeDocumentEvents();
      }
    }, {
      key: "componentDidMount",
      value: function componentDidMount() {
        // Snapshot testing cannot handle refs, so be sure to null-check this.
        this.document = this.sliderRef && this.sliderRef.ownerDocument;
      }
    }, {
      key: "addDocumentTouchEvents",
      value: function addDocumentTouchEvents() {
        // just work for Chrome iOS Safari and Android Browser
        this.onTouchMoveListener = (0, _addEventListener["default"])(this.document, 'touchmove', this.onTouchMove);
        this.onTouchUpListener = (0, _addEventListener["default"])(this.document, 'touchend', this.onEnd);
      }
    }, {
      key: "addDocumentMouseEvents",
      value: function addDocumentMouseEvents() {
        this.onMouseMoveListener = (0, _addEventListener["default"])(this.document, 'mousemove', this.onMouseMove);
        this.onMouseUpListener = (0, _addEventListener["default"])(this.document, 'mouseup', this.onEnd);
      }
    }, {
      key: "removeDocumentEvents",
      value: function removeDocumentEvents() {
        /* eslint-disable no-unused-expressions */
        this.onTouchMoveListener && this.onTouchMoveListener.remove();
        this.onTouchUpListener && this.onTouchUpListener.remove();
        this.onMouseMoveListener && this.onMouseMoveListener.remove();
        this.onMouseUpListener && this.onMouseUpListener.remove();
        /* eslint-enable no-unused-expressions */
      }
    }, {
      key: "focus",
      value: function focus() {
        if (!this.props.disabled) {
          this.handlesRefs[0].focus();
        }
      }
    }, {
      key: "blur",
      value: function blur() {
        if (!this.props.disabled) {
          this.handlesRefs[0].blur();
        }
      }
    }, {
      key: "getSliderStart",
      value: function getSliderStart() {
        var slider = this.sliderRef;
        var rect = slider.getBoundingClientRect();
        return this.props.vertical ? rect.top : rect.left;
      }
    }, {
      key: "getSliderLength",
      value: function getSliderLength() {
        var slider = this.sliderRef;

        if (!slider) {
          return 0;
        }

        var coords = slider.getBoundingClientRect();
        return this.props.vertical ? coords.height : coords.width;
      }
    }, {
      key: "calcValue",
      value: function calcValue(offset) {
        var _this$props2 = this.props,
            vertical = _this$props2.vertical,
            min = _this$props2.min,
            max = _this$props2.max;
        var ratio = Math.abs(Math.max(offset, 0) / this.getSliderLength());
        var value = vertical ? (1 - ratio) * (max - min) + min : ratio * (max - min) + min;
        return value;
      }
    }, {
      key: "calcValueByPos",
      value: function calcValueByPos(position) {
        var pixelOffset = position - this.getSliderStart();
        var nextValue = this.trimAlignValue(this.calcValue(pixelOffset));
        return nextValue;
      }
    }, {
      key: "calcOffset",
      value: function calcOffset(value) {
        var _this$props3 = this.props,
            min = _this$props3.min,
            max = _this$props3.max;
        var ratio = (value - min) / (max - min);
        return ratio * 100;
      }
    }, {
      key: "saveHandle",
      value: function saveHandle(index, handle) {
        this.handlesRefs[index] = handle;
      }
    }, {
      key: "render",
      value: function render() {
        var _classNames;

        var _this$props4 = this.props,
            prefixCls = _this$props4.prefixCls,
            className = _this$props4.className,
            marks = _this$props4.marks,
            dots = _this$props4.dots,
            step = _this$props4.step,
            included = _this$props4.included,
            disabled = _this$props4.disabled,
            vertical = _this$props4.vertical,
            min = _this$props4.min,
            max = _this$props4.max,
            children = _this$props4.children,
            maximumTrackStyle = _this$props4.maximumTrackStyle,
            style = _this$props4.style,
            railStyle = _this$props4.railStyle,
            dotStyle = _this$props4.dotStyle,
            activeDotStyle = _this$props4.activeDotStyle;

        var _get$call = (0, _get2["default"])((0, _getPrototypeOf2["default"])(ComponentEnhancer.prototype), "render", this).call(this),
            tracks = _get$call.tracks,
            handles = _get$call.handles;

        var sliderClassName = (0, _classnames["default"])(prefixCls, (_classNames = {}, (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-with-marks"), Object.keys(marks).length), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-disabled"), disabled), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-vertical"), vertical), (0, _defineProperty2["default"])(_classNames, className, className), _classNames));
        return _react["default"].createElement("div", {
          ref: this.saveSlider,
          className: sliderClassName,
          onTouchStart: disabled ? _noop["default"] : this.onTouchStart,
          onMouseDown: disabled ? _noop["default"] : this.onMouseDown,
          onMouseUp: disabled ? _noop["default"] : this.onMouseUp,
          onKeyDown: disabled ? _noop["default"] : this.onKeyDown,
          onFocus: disabled ? _noop["default"] : this.onFocus,
          onBlur: disabled ? _noop["default"] : this.onBlur,
          style: style
        }, _react["default"].createElement("div", {
          className: "".concat(prefixCls, "-rail"),
          style: (0, _objectSpread2["default"])({}, maximumTrackStyle, {}, railStyle)
        }), tracks, _react["default"].createElement(_Steps["default"], {
          prefixCls: prefixCls,
          vertical: vertical,
          marks: marks,
          dots: dots,
          step: step,
          included: included,
          lowerBound: this.getLowerBound(),
          upperBound: this.getUpperBound(),
          max: max,
          min: min,
          dotStyle: dotStyle,
          activeDotStyle: activeDotStyle
        }), handles, _react["default"].createElement(_Marks["default"], {
          className: "".concat(prefixCls, "-mark"),
          onClickLabel: disabled ? _noop["default"] : this.onClickMarkLabel,
          vertical: vertical,
          marks: marks,
          included: included,
          lowerBound: this.getLowerBound(),
          upperBound: this.getUpperBound(),
          max: max,
          min: min
        }), children);
      }
    }]);
    return ComponentEnhancer;
  }(Component), (0, _defineProperty2["default"])(_class, "displayName", "ComponentEnhancer(".concat(Component.displayName, ")")), (0, _defineProperty2["default"])(_class, "propTypes", (0, _objectSpread2["default"])({}, Component.propTypes, {
    min: _propTypes["default"].number,
    max: _propTypes["default"].number,
    step: _propTypes["default"].number,
    marks: _propTypes["default"].object,
    included: _propTypes["default"].bool,
    className: _propTypes["default"].string,
    prefixCls: _propTypes["default"].string,
    disabled: _propTypes["default"].bool,
    children: _propTypes["default"].any,
    onBeforeChange: _propTypes["default"].func,
    onChange: _propTypes["default"].func,
    onAfterChange: _propTypes["default"].func,
    handle: _propTypes["default"].func,
    dots: _propTypes["default"].bool,
    vertical: _propTypes["default"].bool,
    style: _propTypes["default"].object,
    minimumTrackStyle: _propTypes["default"].object,
    // just for compatibility, will be deperecate
    maximumTrackStyle: _propTypes["default"].object,
    // just for compatibility, will be deperecate
    handleStyle: _propTypes["default"].oneOfType([_propTypes["default"].object, _propTypes["default"].arrayOf(_propTypes["default"].object)]),
    trackStyle: _propTypes["default"].oneOfType([_propTypes["default"].object, _propTypes["default"].arrayOf(_propTypes["default"].object)]),
    railStyle: _propTypes["default"].object,
    dotStyle: _propTypes["default"].object,
    activeDotStyle: _propTypes["default"].object,
    autoFocus: _propTypes["default"].bool,
    onFocus: _propTypes["default"].func,
    onBlur: _propTypes["default"].func
  })), (0, _defineProperty2["default"])(_class, "defaultProps", (0, _objectSpread2["default"])({}, Component.defaultProps, {
    prefixCls: 'rc-slider',
    className: '',
    min: 0,
    max: 100,
    step: 1,
    marks: {},
    handle: function handle(_ref) {
      var index = _ref.index,
          restProps = (0, _objectWithoutProperties2["default"])(_ref, ["index"]);
      delete restProps.dragging;
      return _react["default"].createElement(_Handle["default"], (0, _extends2["default"])({}, restProps, {
        key: index
      }));
    },
    onBeforeChange: _noop["default"],
    onChange: _noop["default"],
    onAfterChange: _noop["default"],
    included: true,
    disabled: false,
    dots: false,
    vertical: false,
    trackStyle: [{}],
    handleStyle: [{}],
    railStyle: {},
    dotStyle: {},
    activeDotStyle: {}
  })), _temp;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZVNsaWRlci5qc3giXSwibmFtZXMiOlsiY3JlYXRlU2xpZGVyIiwiQ29tcG9uZW50IiwicHJvcHMiLCJlIiwiYnV0dG9uIiwiaXNWZXJ0aWNhbCIsInZlcnRpY2FsIiwicG9zaXRpb24iLCJ1dGlscyIsImdldE1vdXNlUG9zaXRpb24iLCJpc0V2ZW50RnJvbUhhbmRsZSIsImhhbmRsZXNSZWZzIiwiZHJhZ09mZnNldCIsImhhbmRsZVBvc2l0aW9uIiwiZ2V0SGFuZGxlQ2VudGVyUG9zaXRpb24iLCJ0YXJnZXQiLCJyZW1vdmVEb2N1bWVudEV2ZW50cyIsIm9uU3RhcnQiLCJhZGREb2N1bWVudE1vdXNlRXZlbnRzIiwiaXNOb3RUb3VjaEV2ZW50IiwiZ2V0VG91Y2hQb3NpdGlvbiIsImFkZERvY3VtZW50VG91Y2hFdmVudHMiLCJwYXVzZUV2ZW50Iiwib25Gb2N1cyIsIm9uQmx1ciIsIm9uRW5kIiwicHJldk1vdmVkSGFuZGxlSW5kZXgiLCJjbGlja0ZvY3VzIiwic2xpZGVyUmVmIiwib25Nb3ZlIiwib25LZXlib2FyZCIsInNsaWRlciIsInZhbHVlIiwic3RvcFByb3BhZ2F0aW9uIiwib25DaGFuZ2UiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzdGVwIiwibWF4IiwibWluIiwiTWF0aCIsImZsb29yIiwiZG9jdW1lbnQiLCJvd25lckRvY3VtZW50Iiwib25Ub3VjaE1vdmVMaXN0ZW5lciIsIm9uVG91Y2hNb3ZlIiwib25Ub3VjaFVwTGlzdGVuZXIiLCJvbk1vdXNlTW92ZUxpc3RlbmVyIiwib25Nb3VzZU1vdmUiLCJvbk1vdXNlVXBMaXN0ZW5lciIsInJlbW92ZSIsImRpc2FibGVkIiwiZm9jdXMiLCJibHVyIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsImxlZnQiLCJjb29yZHMiLCJoZWlnaHQiLCJ3aWR0aCIsIm9mZnNldCIsInJhdGlvIiwiYWJzIiwiZ2V0U2xpZGVyTGVuZ3RoIiwicGl4ZWxPZmZzZXQiLCJnZXRTbGlkZXJTdGFydCIsIm5leHRWYWx1ZSIsInRyaW1BbGlnblZhbHVlIiwiY2FsY1ZhbHVlIiwiaW5kZXgiLCJoYW5kbGUiLCJwcmVmaXhDbHMiLCJjbGFzc05hbWUiLCJtYXJrcyIsImRvdHMiLCJpbmNsdWRlZCIsImNoaWxkcmVuIiwibWF4aW11bVRyYWNrU3R5bGUiLCJzdHlsZSIsInJhaWxTdHlsZSIsImRvdFN0eWxlIiwiYWN0aXZlRG90U3R5bGUiLCJ0cmFja3MiLCJoYW5kbGVzIiwic2xpZGVyQ2xhc3NOYW1lIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInNhdmVTbGlkZXIiLCJub29wIiwib25Ub3VjaFN0YXJ0Iiwib25Nb3VzZURvd24iLCJvbk1vdXNlVXAiLCJvbktleURvd24iLCJnZXRMb3dlckJvdW5kIiwiZ2V0VXBwZXJCb3VuZCIsIm9uQ2xpY2tNYXJrTGFiZWwiLCJkaXNwbGF5TmFtZSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsIm51bWJlciIsIm9iamVjdCIsImJvb2wiLCJzdHJpbmciLCJhbnkiLCJvbkJlZm9yZUNoYW5nZSIsImZ1bmMiLCJvbkFmdGVyQ2hhbmdlIiwibWluaW11bVRyYWNrU3R5bGUiLCJoYW5kbGVTdHlsZSIsIm9uZU9mVHlwZSIsImFycmF5T2YiLCJ0cmFja1N0eWxlIiwiYXV0b0ZvY3VzIiwiZGVmYXVsdFByb3BzIiwicmVzdFByb3BzIiwiZHJhZ2dpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRWUsU0FBU0EsWUFBVCxDQUFzQkMsU0FBdEIsRUFBaUM7QUFBQTs7QUFDOUM7QUFBQTtBQUFBO0FBQUE7O0FBQUE7O0FBMERFLCtCQUFZQyxLQUFaLEVBQW1CO0FBQUE7O0FBQUE7QUFDakIsZ0NBQU1BLEtBQU47QUFEaUIsc0dBeUJMLFVBQUND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LEdBQUcsRUFBRSxDQXBDVDtBQXFDSUQsSUFBQUEsR0FBRyxFQUFFLEdBckNUO0FBc0NJRCxJQUFBQSxJQUFJLEVBQUUsQ0F0Q1Y7QUF1Q0lxQyxJQUFBQSxLQUFLLEVBQUUsRUF2Q1g7QUF3Q0lILElBQUFBLE1BeENKLHdCQXdDb0M7QUFBQSxVQUF2QkQsS0FBdUIsUUFBdkJBLEtBQXVCO0FBQUEsVUFBYjhDLFNBQWE7QUFDOUIsYUFBT0EsU0FBUyxDQUFDQyxRQUFqQjtBQUNBLGFBQU8sZ0NBQUMsa0JBQUQsZ0NBQVlELFNBQVo7QUFBdUIsUUFBQSxHQUFHLEVBQUU5QztBQUE1QixTQUFQO0FBQ0QsS0EzQ0w7QUE0Q0lvQyxJQUFBQSxjQUFjLEVBQUVoQixnQkE1Q3BCO0FBNkNJekQsSUFBQUEsUUFBUSxFQUFFeUQsZ0JBN0NkO0FBOENJa0IsSUFBQUEsYUFBYSxFQUFFbEIsZ0JBOUNuQjtBQStDSWQsSUFBQUEsUUFBUSxFQUFFLElBL0NkO0FBZ0RJekIsSUFBQUEsUUFBUSxFQUFFLEtBaERkO0FBaURJd0IsSUFBQUEsSUFBSSxFQUFFLEtBakRWO0FBa0RJdEUsSUFBQUEsUUFBUSxFQUFFLEtBbERkO0FBbURJNEcsSUFBQUEsVUFBVSxFQUFFLENBQUMsRUFBRCxDQW5EaEI7QUFvRElILElBQUFBLFdBQVcsRUFBRSxDQUFDLEVBQUQsQ0FwRGpCO0FBcURJOUIsSUFBQUEsU0FBUyxFQUFFLEVBckRmO0FBc0RJQyxJQUFBQSxRQUFRLEVBQUUsRUF0RGQ7QUF1RElDLElBQUFBLGNBQWMsRUFBRTtBQXZEcEI7QUF5VUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBhZGRFdmVudExpc3RlbmVyIGZyb20gJy4uLy4uLy4uL191dGlsL2FkZEV2ZW50TGlzdGVuZXInO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgbm9vcCBmcm9tICdsb2Rhc2gvbm9vcCc7XG5pbXBvcnQgd2FybmluZyBmcm9tICcuLi8uLi8uLi9fdXRpbC93YXJuaW5nJztcbmltcG9ydCBTdGVwcyBmcm9tICcuL1N0ZXBzJztcbmltcG9ydCBNYXJrcyBmcm9tICcuL01hcmtzJztcbmltcG9ydCBIYW5kbGUgZnJvbSAnLi4vSGFuZGxlJztcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlU2xpZGVyKENvbXBvbmVudCkge1xuICByZXR1cm4gY2xhc3MgQ29tcG9uZW50RW5oYW5jZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIHN0YXRpYyBkaXNwbGF5TmFtZSA9IGBDb21wb25lbnRFbmhhbmNlcigke0NvbXBvbmVudC5kaXNwbGF5TmFtZX0pYDtcbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgLi4uQ29tcG9uZW50LnByb3BUeXBlcyxcbiAgICAgIG1pbjogUHJvcFR5cGVzLm51bWJlcixcbiAgICAgIG1heDogUHJvcFR5cGVzLm51bWJlcixcbiAgICAgIHN0ZXA6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgICBtYXJrczogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAgIGluY2x1ZGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgIHByZWZpeENsczogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgICAgb25CZWZvcmVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgICAgb25BZnRlckNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBoYW5kbGU6IFByb3BUeXBlcy5mdW5jLFxuICAgICAgZG90czogUHJvcFR5cGVzLmJvb2wsXG4gICAgICB2ZXJ0aWNhbDogUHJvcFR5cGVzLmJvb2wsXG4gICAgICBzdHlsZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAgIG1pbmltdW1UcmFja1N0eWxlOiBQcm9wVHlwZXMub2JqZWN0LCAvLyBqdXN0IGZvciBjb21wYXRpYmlsaXR5LCB3aWxsIGJlIGRlcGVyZWNhdGVcbiAgICAgIG1heGltdW1UcmFja1N0eWxlOiBQcm9wVHlwZXMub2JqZWN0LCAvLyBqdXN0IGZvciBjb21wYXRpYmlsaXR5LCB3aWxsIGJlIGRlcGVyZWNhdGVcbiAgICAgIGhhbmRsZVN0eWxlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMub2JqZWN0LCBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMub2JqZWN0KV0pLFxuICAgICAgdHJhY2tTdHlsZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm9iamVjdCwgUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm9iamVjdCldKSxcbiAgICAgIHJhaWxTdHlsZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAgIGRvdFN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgICAgYWN0aXZlRG90U3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgICBhdXRvRm9jdXM6IFByb3BUeXBlcy5ib29sLFxuICAgICAgb25Gb2N1czogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBvbkJsdXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgLi4uQ29tcG9uZW50LmRlZmF1bHRQcm9wcyxcbiAgICAgIHByZWZpeENsczogJ3JjLXNsaWRlcicsXG4gICAgICBjbGFzc05hbWU6ICcnLFxuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiAxMDAsXG4gICAgICBzdGVwOiAxLFxuICAgICAgbWFya3M6IHt9LFxuICAgICAgaGFuZGxlKHsgaW5kZXgsIC4uLnJlc3RQcm9wcyB9KSB7XG4gICAgICAgIGRlbGV0ZSByZXN0UHJvcHMuZHJhZ2dpbmc7XG4gICAgICAgIHJldHVybiA8SGFuZGxlIHsuLi5yZXN0UHJvcHN9IGtleT17aW5kZXh9IC8+O1xuICAgICAgfSxcbiAgICAgIG9uQmVmb3JlQ2hhbmdlOiBub29wLFxuICAgICAgb25DaGFuZ2U6IG5vb3AsXG4gICAgICBvbkFmdGVyQ2hhbmdlOiBub29wLFxuICAgICAgaW5jbHVkZWQ6IHRydWUsXG4gICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICBkb3RzOiBmYWxzZSxcbiAgICAgIHZlcnRpY2FsOiBmYWxzZSxcbiAgICAgIHRyYWNrU3R5bGU6IFt7fV0sXG4gICAgICBoYW5kbGVTdHlsZTogW3t9XSxcbiAgICAgIHJhaWxTdHlsZToge30sXG4gICAgICBkb3RTdHlsZToge30sXG4gICAgICBhY3RpdmVEb3RTdHlsZToge30sXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWF4LCBtaW4gfSA9IHByb3BzO1xuICAgICAgICB3YXJuaW5nKFxuICAgICAgICAgIHN0ZXAgJiYgTWF0aC5mbG9vcihzdGVwKSA9PT0gc3RlcCA/IChtYXggLSBtaW4pICUgc3RlcCA9PT0gMCA6IHRydWUsXG4gICAgICAgICAgJ1NsaWRlclttYXhdIC0gU2xpZGVyW21pbl0gKCVzKSBzaG91bGQgYmUgYSBtdWx0aXBsZSBvZiBTbGlkZXJbc3RlcF0gKCVzKScsXG4gICAgICAgICAgbWF4IC0gbWluLFxuICAgICAgICAgIHN0ZXBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaGFuZGxlc1JlZnMgPSB7fTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIGlmIChzdXBlci5jb21wb25lbnRXaWxsVW5tb3VudCkgc3VwZXIuY29tcG9uZW50V2lsbFVubW91bnQoKTtcbiAgICAgIHRoaXMucmVtb3ZlRG9jdW1lbnRFdmVudHMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgIC8vIFNuYXBzaG90IHRlc3RpbmcgY2Fubm90IGhhbmRsZSByZWZzLCBzbyBiZSBzdXJlIHRvIG51bGwtY2hlY2sgdGhpcy5cbiAgICAgIHRoaXMuZG9jdW1lbnQgPSB0aGlzLnNsaWRlclJlZiAmJiB0aGlzLnNsaWRlclJlZi5vd25lckRvY3VtZW50O1xuICAgIH1cblxuICAgIG9uTW91c2VEb3duID0gKGUpID0+IHtcbiAgICAgIGlmIChlLmJ1dHRvbiAhPT0gMCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgaXNWZXJ0aWNhbCA9IHRoaXMucHJvcHMudmVydGljYWw7XG4gICAgICBsZXQgcG9zaXRpb24gPSB1dGlscy5nZXRNb3VzZVBvc2l0aW9uKGlzVmVydGljYWwsIGUpO1xuICAgICAgaWYgKCF1dGlscy5pc0V2ZW50RnJvbUhhbmRsZShlLCB0aGlzLmhhbmRsZXNSZWZzKSkge1xuICAgICAgICB0aGlzLmRyYWdPZmZzZXQgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgaGFuZGxlUG9zaXRpb24gPSB1dGlscy5nZXRIYW5kbGVDZW50ZXJQb3NpdGlvbihpc1ZlcnRpY2FsLCBlLnRhcmdldCk7XG4gICAgICAgIHRoaXMuZHJhZ09mZnNldCA9IHBvc2l0aW9uIC0gaGFuZGxlUG9zaXRpb247XG4gICAgICAgIHBvc2l0aW9uID0gaGFuZGxlUG9zaXRpb247XG4gICAgICB9XG4gICAgICB0aGlzLnJlbW92ZURvY3VtZW50RXZlbnRzKCk7XG4gICAgICB0aGlzLm9uU3RhcnQocG9zaXRpb24pO1xuICAgICAgdGhpcy5hZGREb2N1bWVudE1vdXNlRXZlbnRzKCk7XG4gICAgfVxuXG4gICAgb25Ub3VjaFN0YXJ0ID0gKGUpID0+IHtcbiAgICAgIGlmICh1dGlscy5pc05vdFRvdWNoRXZlbnQoZSkpIHJldHVybjtcblxuICAgICAgY29uc3QgaXNWZXJ0aWNhbCA9IHRoaXMucHJvcHMudmVydGljYWw7XG4gICAgICBsZXQgcG9zaXRpb24gPSB1dGlscy5nZXRUb3VjaFBvc2l0aW9uKGlzVmVydGljYWwsIGUpO1xuICAgICAgaWYgKCF1dGlscy5pc0V2ZW50RnJvbUhhbmRsZShlLCB0aGlzLmhhbmRsZXNSZWZzKSkge1xuICAgICAgICB0aGlzLmRyYWdPZmZzZXQgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgaGFuZGxlUG9zaXRpb24gPSB1dGlscy5nZXRIYW5kbGVDZW50ZXJQb3NpdGlvbihpc1ZlcnRpY2FsLCBlLnRhcmdldCk7XG4gICAgICAgIHRoaXMuZHJhZ09mZnNldCA9IHBvc2l0aW9uIC0gaGFuZGxlUG9zaXRpb247XG4gICAgICAgIHBvc2l0aW9uID0gaGFuZGxlUG9zaXRpb247XG4gICAgICB9XG4gICAgICB0aGlzLm9uU3RhcnQocG9zaXRpb24pO1xuICAgICAgdGhpcy5hZGREb2N1bWVudFRvdWNoRXZlbnRzKCk7XG4gICAgICB1dGlscy5wYXVzZUV2ZW50KGUpO1xuICAgIH1cblxuICAgIG9uRm9jdXMgPSAoZSkgPT4ge1xuICAgICAgY29uc3QgeyBvbkZvY3VzLCB2ZXJ0aWNhbCB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGlmICh1dGlscy5pc0V2ZW50RnJvbUhhbmRsZShlLCB0aGlzLmhhbmRsZXNSZWZzKSkge1xuICAgICAgICBjb25zdCBoYW5kbGVQb3NpdGlvbiA9IHV0aWxzLmdldEhhbmRsZUNlbnRlclBvc2l0aW9uKHZlcnRpY2FsLCBlLnRhcmdldCk7XG4gICAgICAgIHRoaXMuZHJhZ09mZnNldCA9IDA7XG4gICAgICAgIHRoaXMub25TdGFydChoYW5kbGVQb3NpdGlvbik7XG4gICAgICAgIHV0aWxzLnBhdXNlRXZlbnQoZSk7XG4gICAgICAgIGlmIChvbkZvY3VzKSB7XG4gICAgICAgICAgb25Gb2N1cyhlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIG9uQmx1ciA9IChlKSA9PiB7XG4gICAgICBjb25zdCB7IG9uQmx1ciB9ID0gdGhpcy5wcm9wcztcbiAgICAgIHRoaXMub25FbmQoZSk7XG4gICAgICBpZiAob25CbHVyKSB7XG4gICAgICAgIG9uQmx1cihlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgYWRkRG9jdW1lbnRUb3VjaEV2ZW50cygpIHtcbiAgICAgIC8vIGp1c3Qgd29yayBmb3IgQ2hyb21lIGlPUyBTYWZhcmkgYW5kIEFuZHJvaWQgQnJvd3NlclxuICAgICAgdGhpcy5vblRvdWNoTW92ZUxpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRvY3VtZW50LCAndG91Y2htb3ZlJywgdGhpcy5vblRvdWNoTW92ZSk7XG4gICAgICB0aGlzLm9uVG91Y2hVcExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRvY3VtZW50LCAndG91Y2hlbmQnLCB0aGlzLm9uRW5kKTtcbiAgICB9XG5cbiAgICBhZGREb2N1bWVudE1vdXNlRXZlbnRzKCkge1xuICAgICAgdGhpcy5vbk1vdXNlTW92ZUxpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZSk7XG4gICAgICB0aGlzLm9uTW91c2VVcExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmRvY3VtZW50LCAnbW91c2V1cCcsIHRoaXMub25FbmQpO1xuICAgIH1cblxuICAgIHJlbW92ZURvY3VtZW50RXZlbnRzKCkge1xuICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG4gICAgICB0aGlzLm9uVG91Y2hNb3ZlTGlzdGVuZXIgJiYgdGhpcy5vblRvdWNoTW92ZUxpc3RlbmVyLnJlbW92ZSgpO1xuICAgICAgdGhpcy5vblRvdWNoVXBMaXN0ZW5lciAmJiB0aGlzLm9uVG91Y2hVcExpc3RlbmVyLnJlbW92ZSgpO1xuXG4gICAgICB0aGlzLm9uTW91c2VNb3ZlTGlzdGVuZXIgJiYgdGhpcy5vbk1vdXNlTW92ZUxpc3RlbmVyLnJlbW92ZSgpO1xuICAgICAgdGhpcy5vbk1vdXNlVXBMaXN0ZW5lciAmJiB0aGlzLm9uTW91c2VVcExpc3RlbmVyLnJlbW92ZSgpO1xuICAgICAgLyogZXNsaW50LWVuYWJsZSBuby11bnVzZWQtZXhwcmVzc2lvbnMgKi9cbiAgICB9XG5cbiAgICBvbk1vdXNlVXAgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5oYW5kbGVzUmVmc1t0aGlzLnByZXZNb3ZlZEhhbmRsZUluZGV4XSkge1xuICAgICAgICB0aGlzLmhhbmRsZXNSZWZzW3RoaXMucHJldk1vdmVkSGFuZGxlSW5kZXhdLmNsaWNrRm9jdXMoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvbk1vdXNlTW92ZSA9IChlKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuc2xpZGVyUmVmKSB7XG4gICAgICAgIHRoaXMub25FbmQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgcG9zaXRpb24gPSB1dGlscy5nZXRNb3VzZVBvc2l0aW9uKHRoaXMucHJvcHMudmVydGljYWwsIGUpO1xuICAgICAgdGhpcy5vbk1vdmUoZSwgcG9zaXRpb24gLSB0aGlzLmRyYWdPZmZzZXQpO1xuICAgIH1cblxuICAgIG9uVG91Y2hNb3ZlID0gKGUpID0+IHtcbiAgICAgIGlmICh1dGlscy5pc05vdFRvdWNoRXZlbnQoZSkgfHwgIXRoaXMuc2xpZGVyUmVmKSB7XG4gICAgICAgIHRoaXMub25FbmQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwb3NpdGlvbiA9IHV0aWxzLmdldFRvdWNoUG9zaXRpb24odGhpcy5wcm9wcy52ZXJ0aWNhbCwgZSk7XG4gICAgICB0aGlzLm9uTW92ZShlLCBwb3NpdGlvbiAtIHRoaXMuZHJhZ09mZnNldCk7XG4gICAgfVxuXG4gICAgb25LZXlEb3duID0gKGUpID0+IHtcbiAgICAgIGlmICh0aGlzLnNsaWRlclJlZiAmJiB1dGlscy5pc0V2ZW50RnJvbUhhbmRsZShlLCB0aGlzLmhhbmRsZXNSZWZzKSkge1xuICAgICAgICB0aGlzLm9uS2V5Ym9hcmQoZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9jdXMoKSB7XG4gICAgICBpZiAoIXRoaXMucHJvcHMuZGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVzUmVmc1swXS5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGJsdXIoKSB7XG4gICAgICBpZiAoIXRoaXMucHJvcHMuZGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVzUmVmc1swXS5ibHVyKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2V0U2xpZGVyU3RhcnQoKSB7XG4gICAgICBjb25zdCBzbGlkZXIgPSB0aGlzLnNsaWRlclJlZjtcbiAgICAgIGNvbnN0IHJlY3QgPSBzbGlkZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgIHJldHVybiB0aGlzLnByb3BzLnZlcnRpY2FsID8gcmVjdC50b3AgOiByZWN0LmxlZnQ7XG4gICAgfVxuXG4gICAgZ2V0U2xpZGVyTGVuZ3RoKCkge1xuICAgICAgY29uc3Qgc2xpZGVyID0gdGhpcy5zbGlkZXJSZWY7XG4gICAgICBpZiAoIXNsaWRlcikge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29vcmRzID0gc2xpZGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMudmVydGljYWwgPyBjb29yZHMuaGVpZ2h0IDogY29vcmRzLndpZHRoO1xuICAgIH1cblxuICAgIGNhbGNWYWx1ZShvZmZzZXQpIHtcbiAgICAgIGNvbnN0IHsgdmVydGljYWwsIG1pbiwgbWF4IH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3QgcmF0aW8gPSBNYXRoLmFicyhNYXRoLm1heChvZmZzZXQsIDApIC8gdGhpcy5nZXRTbGlkZXJMZW5ndGgoKSk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHZlcnRpY2FsID8gKDEgLSByYXRpbykgKiAobWF4IC0gbWluKSArIG1pbiA6IHJhdGlvICogKG1heCAtIG1pbikgKyBtaW47XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgY2FsY1ZhbHVlQnlQb3MocG9zaXRpb24pIHtcbiAgICAgIGNvbnN0IHBpeGVsT2Zmc2V0ID0gcG9zaXRpb24gLSB0aGlzLmdldFNsaWRlclN0YXJ0KCk7XG4gICAgICBjb25zdCBuZXh0VmFsdWUgPSB0aGlzLnRyaW1BbGlnblZhbHVlKHRoaXMuY2FsY1ZhbHVlKHBpeGVsT2Zmc2V0KSk7XG4gICAgICByZXR1cm4gbmV4dFZhbHVlO1xuICAgIH1cblxuICAgIGNhbGNPZmZzZXQodmFsdWUpIHtcbiAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMucHJvcHM7XG4gICAgICBjb25zdCByYXRpbyA9ICh2YWx1ZSAtIG1pbikgLyAobWF4IC0gbWluKTtcbiAgICAgIHJldHVybiByYXRpbyAqIDEwMDtcbiAgICB9XG5cbiAgICBzYXZlU2xpZGVyID0gKHNsaWRlcikgPT4ge1xuICAgICAgdGhpcy5zbGlkZXJSZWYgPSBzbGlkZXI7XG4gICAgfVxuXG4gICAgc2F2ZUhhbmRsZShpbmRleCwgaGFuZGxlKSB7XG4gICAgICB0aGlzLmhhbmRsZXNSZWZzW2luZGV4XSA9IGhhbmRsZTtcbiAgICB9XG5cbiAgICBvbkNsaWNrTWFya0xhYmVsID0gKGUsIHZhbHVlKSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5vbkNoYW5nZSh7IHZhbHVlIH0pO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgcHJlZml4Q2xzLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgIG1hcmtzLFxuICAgICAgICBkb3RzLFxuICAgICAgICBzdGVwLFxuICAgICAgICBpbmNsdWRlZCxcbiAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgIHZlcnRpY2FsLFxuICAgICAgICBtaW4sXG4gICAgICAgIG1heCxcbiAgICAgICAgY2hpbGRyZW4sXG4gICAgICAgIG1heGltdW1UcmFja1N0eWxlLFxuICAgICAgICBzdHlsZSxcbiAgICAgICAgcmFpbFN0eWxlLFxuICAgICAgICBkb3RTdHlsZSxcbiAgICAgICAgYWN0aXZlRG90U3R5bGUsXG4gICAgICB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IHsgdHJhY2tzLCBoYW5kbGVzIH0gPSBzdXBlci5yZW5kZXIoKTtcblxuICAgICAgY29uc3Qgc2xpZGVyQ2xhc3NOYW1lID0gY2xhc3NOYW1lcyhwcmVmaXhDbHMsIHtcbiAgICAgICAgW2Ake3ByZWZpeENsc30td2l0aC1tYXJrc2BdOiBPYmplY3Qua2V5cyhtYXJrcykubGVuZ3RoLFxuICAgICAgICBbYCR7cHJlZml4Q2xzfS1kaXNhYmxlZGBdOiBkaXNhYmxlZCxcbiAgICAgICAgW2Ake3ByZWZpeENsc30tdmVydGljYWxgXTogdmVydGljYWwsXG4gICAgICAgIFtjbGFzc05hbWVdOiBjbGFzc05hbWUsXG4gICAgICB9KTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXZcbiAgICAgICAgICByZWY9e3RoaXMuc2F2ZVNsaWRlcn1cbiAgICAgICAgICBjbGFzc05hbWU9e3NsaWRlckNsYXNzTmFtZX1cbiAgICAgICAgICBvblRvdWNoU3RhcnQ9e2Rpc2FibGVkID8gbm9vcCA6IHRoaXMub25Ub3VjaFN0YXJ0fVxuICAgICAgICAgIG9uTW91c2VEb3duPXtkaXNhYmxlZCA/IG5vb3AgOiB0aGlzLm9uTW91c2VEb3dufVxuICAgICAgICAgIG9uTW91c2VVcD17ZGlzYWJsZWQgPyBub29wIDogdGhpcy5vbk1vdXNlVXB9XG4gICAgICAgICAgb25LZXlEb3duPXtkaXNhYmxlZCA/IG5vb3AgOiB0aGlzLm9uS2V5RG93bn1cbiAgICAgICAgICBvbkZvY3VzPXtkaXNhYmxlZCA/IG5vb3AgOiB0aGlzLm9uRm9jdXN9XG4gICAgICAgICAgb25CbHVyPXtkaXNhYmxlZCA/IG5vb3AgOiB0aGlzLm9uQmx1cn1cbiAgICAgICAgICBzdHlsZT17c3R5bGV9XG4gICAgICAgID5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tcmFpbGB9XG4gICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAuLi5tYXhpbXVtVHJhY2tTdHlsZSxcbiAgICAgICAgICAgICAgLi4ucmFpbFN0eWxlLFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPlxuICAgICAgICAgIHt0cmFja3N9XG4gICAgICAgICAgPFN0ZXBzXG4gICAgICAgICAgICBwcmVmaXhDbHM9e3ByZWZpeENsc31cbiAgICAgICAgICAgIHZlcnRpY2FsPXt2ZXJ0aWNhbH1cbiAgICAgICAgICAgIG1hcmtzPXttYXJrc31cbiAgICAgICAgICAgIGRvdHM9e2RvdHN9XG4gICAgICAgICAgICBzdGVwPXtzdGVwfVxuICAgICAgICAgICAgaW5jbHVkZWQ9e2luY2x1ZGVkfVxuICAgICAgICAgICAgbG93ZXJCb3VuZD17dGhpcy5nZXRMb3dlckJvdW5kKCl9XG4gICAgICAgICAgICB1cHBlckJvdW5kPXt0aGlzLmdldFVwcGVyQm91bmQoKX1cbiAgICAgICAgICAgIG1heD17bWF4fVxuICAgICAgICAgICAgbWluPXttaW59XG4gICAgICAgICAgICBkb3RTdHlsZT17ZG90U3R5bGV9XG4gICAgICAgICAgICBhY3RpdmVEb3RTdHlsZT17YWN0aXZlRG90U3R5bGV9XG4gICAgICAgICAgLz5cbiAgICAgICAgICB7aGFuZGxlc31cbiAgICAgICAgICA8TWFya3NcbiAgICAgICAgICAgIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1tYXJrYH1cbiAgICAgICAgICAgIG9uQ2xpY2tMYWJlbD17ZGlzYWJsZWQgPyBub29wIDogdGhpcy5vbkNsaWNrTWFya0xhYmVsfVxuICAgICAgICAgICAgdmVydGljYWw9e3ZlcnRpY2FsfVxuICAgICAgICAgICAgbWFya3M9e21hcmtzfVxuICAgICAgICAgICAgaW5jbHVkZWQ9e2luY2x1ZGVkfVxuICAgICAgICAgICAgbG93ZXJCb3VuZD17dGhpcy5nZXRMb3dlckJvdW5kKCl9XG4gICAgICAgICAgICB1cHBlckJvdW5kPXt0aGlzLmdldFVwcGVyQm91bmQoKX1cbiAgICAgICAgICAgIG1heD17bWF4fVxuICAgICAgICAgICAgbWluPXttaW59XG4gICAgICAgICAgLz5cbiAgICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG4gIH07XG59XG4iXX0=