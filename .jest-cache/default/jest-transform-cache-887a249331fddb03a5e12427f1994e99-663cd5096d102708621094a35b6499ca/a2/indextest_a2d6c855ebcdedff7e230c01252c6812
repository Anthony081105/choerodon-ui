9ef4f57c34d0094d0a6952e208ba8608
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _ = _interopRequireDefault(require(".."));

var _dataSet = _interopRequireDefault(require("../../data-set"));

var _focusTest = _interopRequireDefault(require("../../../tests/shared/focusTest"));

(0, _focusTest["default"])(_["default"]);
describe('Password input', function () {
  beforeEach(function () {
    jest.useFakeTimers();
  });
  afterEach(function () {
    jest.useRealTimers();
  });
  it('renders Password correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], null));
    expect(wrapper).toMatchSnapshot();
  });
  it('renders Password reveal correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], null));
    expect(wrapper.props().reveal).toEqual(true);
    expect(wrapper.find('.c7n-pro-password-inner-button')).toHaveLength(1);
    wrapper.setProps({
      reveal: false
    });
    wrapper.update();
    expect(wrapper.props().reveal).toEqual(false);
    expect(wrapper.find('.c7n-pro-password-inner-button')).toHaveLength(0);
  });
  it('renders input correctly', function () {
    var handleInput = jest.fn();
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      value: "reveal",
      onInput: handleInput
    }));
    wrapper.find('.c7n-pro-password').at(0).simulate('input', {
      target: {
        value: 'revealValue'
      }
    });
    jest.runAllTimers();
    expect(handleInput).toHaveBeenCalled();
  });
  it('renders reveal correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      value: "reveal"
    }));
    expect(wrapper.find('.c7n-pro-password').at(0).prop('type')).toBe('password');
    wrapper.instance().doReveal(wrapper.instance());
    jest.runAllTimers();
    wrapper.update();
    expect(wrapper.find('.c7n-pro-password').at(0).prop('type')).toBe('text');
    wrapper.instance().resetReveal(wrapper.instance());
    jest.runAllTimers();
    wrapper.update();
    expect(wrapper.find('.c7n-pro-password').at(0).prop('type')).toBe('password');
  });
  it('the value will be controlled', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      value: "password"
    }));
    expect(wrapper.find('.c7n-pro-password').at(0).prop('value')).toBe('password');
    wrapper.setProps({
      value: 'setPass'
    });
    wrapper.update();
    expect(wrapper.find('.c7n-pro-password').at(0).prop('value')).toBe('setPass');
  });
  it('the icon should be changed when icon can click', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      value: "password"
    }));
    expect(wrapper.find('.icon-visibility_off')).toHaveLength(1);
    expect(wrapper.find('.icon-visibility')).toHaveLength(0);
    wrapper.find('.icon').simulate('click');
    jest.runAllTimers();
    wrapper.update();
    expect(wrapper.find('.icon-visibility_off')).toHaveLength(0);
    expect(wrapper.find('.icon-visibility')).toHaveLength(1);
  });
  it('the dataset  will be render correctly', function () {
    var handleDataSetChange = jest.fn();
    var ds = new _dataSet["default"]({
      autoCreate: true,
      fields: [{
        name: 'test',
        type: 'string',
        defaultValue: 'password',
        required: true
      }],
      events: {
        update: handleDataSetChange
      }
    });
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      dataSet: ds,
      name: "test"
    }));
    expect(wrapper.find('Password').props().name).toEqual('test');
    expect(wrapper.find('.c7n-pro-password').at(0).prop('value')).toBe('password');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRlc3QuanMiXSwibmFtZXMiOlsiUGFzc3dvcmQiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJqZXN0IiwidXNlRmFrZVRpbWVycyIsImFmdGVyRWFjaCIsInVzZVJlYWxUaW1lcnMiLCJpdCIsIndyYXBwZXIiLCJleHBlY3QiLCJ0b01hdGNoU25hcHNob3QiLCJwcm9wcyIsInJldmVhbCIsInRvRXF1YWwiLCJmaW5kIiwidG9IYXZlTGVuZ3RoIiwic2V0UHJvcHMiLCJ1cGRhdGUiLCJoYW5kbGVJbnB1dCIsImZuIiwiYXQiLCJzaW11bGF0ZSIsInRhcmdldCIsInZhbHVlIiwicnVuQWxsVGltZXJzIiwidG9IYXZlQmVlbkNhbGxlZCIsInByb3AiLCJ0b0JlIiwiaW5zdGFuY2UiLCJkb1JldmVhbCIsInJlc2V0UmV2ZWFsIiwiaGFuZGxlRGF0YVNldENoYW5nZSIsImRzIiwiRGF0YVNldCIsImF1dG9DcmVhdGUiLCJmaWVsZHMiLCJuYW1lIiwidHlwZSIsImRlZmF1bHRWYWx1ZSIsInJlcXVpcmVkIiwiZXZlbnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsMkJBQVVBLFlBQVY7QUFFQUMsUUFBUSxDQUFDLGdCQUFELEVBQW1CLFlBQU07QUFDL0JDLEVBQUFBLFVBQVUsQ0FBQyxZQUFNO0FBQ2ZDLElBQUFBLElBQUksQ0FBQ0MsYUFBTDtBQUNELEdBRlMsQ0FBVjtBQUlBQyxFQUFBQSxTQUFTLENBQUMsWUFBTTtBQUNkRixJQUFBQSxJQUFJLENBQUNHLGFBQUw7QUFDRCxHQUZRLENBQVQ7QUFJQUMsRUFBQUEsRUFBRSxDQUFDLDRCQUFELEVBQStCLFlBQU07QUFDckMsUUFBTUMsT0FBTyxHQUFHLG1CQUFNLGdDQUFDLFlBQUQsT0FBTixDQUFoQjtBQUNBQyxJQUFBQSxNQUFNLENBQUNELE9BQUQsQ0FBTixDQUFnQkUsZUFBaEI7QUFDRCxHQUhDLENBQUY7QUFLQUgsRUFBQUEsRUFBRSxDQUFD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QU8sQ0FBQ00sSUFBUixDQUFhLGtCQUFiLENBQUQsQ0FBTixDQUF5Q0MsWUFBekMsQ0FBc0QsQ0FBdEQ7QUFDRCxHQVRDLENBQUY7QUFXQVIsRUFBQUEsRUFBRSxDQUFDLHVDQUFELEVBQTBDLFlBQU07QUFDaEQsUUFBTXdCLG1CQUFtQixHQUFHNUIsSUFBSSxDQUFDZ0IsRUFBTCxFQUE1QjtBQUNBLFFBQU1hLEVBQUUsR0FBRyxJQUFJQyxtQkFBSixDQUFZO0FBQ3JCQyxNQUFBQSxVQUFVLEVBQUUsSUFEUztBQUVyQkMsTUFBQUEsTUFBTSxFQUFFLENBQ047QUFDRUMsUUFBQUEsSUFBSSxFQUFFLE1BRFI7QUFFRUMsUUFBQUEsSUFBSSxFQUFFLFFBRlI7QUFHRUMsUUFBQUEsWUFBWSxFQUFFLFVBSGhCO0FBSUVDLFFBQUFBLFFBQVEsRUFBRTtBQUpaLE9BRE0sQ0FGYTtBQVVyQkMsTUFBQUEsTUFBTSxFQUFFO0FBQ052QixRQUFBQSxNQUFNLEVBQUVjO0FBREY7QUFWYSxLQUFaLENBQVg7QUFjQSxRQUFNdkIsT0FBTyxHQUFHLG1CQUFNLGdDQUFDLFlBQUQ7QUFBVSxNQUFBLE9BQU8sRUFBRXdCLEVBQW5CO0FBQXVCLE1BQUEsSUFBSSxFQUFDO0FBQTVCLE1BQU4sQ0FBaEI7QUFDQXZCLElBQUFBLE1BQU0sQ0FBQ0QsT0FBTyxDQUFDTSxJQUFSLENBQWEsVUFBYixFQUF5QkgsS0FBekIsR0FBaUN5QixJQUFsQyxDQUFOLENBQThDdkIsT0FBOUMsQ0FBc0QsTUFBdEQ7QUFDQUosSUFBQUEsTUFBTSxDQUNKRCxPQUFPLENBQ0pNLElBREgsQ0FDUSxtQkFEUixFQUVHTSxFQUZILENBRU0sQ0FGTixFQUdHTSxJQUhILENBR1EsT0FIUixDQURJLENBQU4sQ0FLRUMsSUFMRixDQUtPLFVBTFA7QUFNRCxHQXhCQyxDQUFGO0FBeUJELENBckhPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbW91bnQgfSBmcm9tICdlbnp5bWUnO1xuaW1wb3J0IFBhc3N3b3JkIGZyb20gJy4uJztcbmltcG9ydCBEYXRhU2V0IGZyb20gJy4uLy4uL2RhdGEtc2V0JztcbmltcG9ydCBmb2N1c1Rlc3QgZnJvbSAnLi4vLi4vLi4vdGVzdHMvc2hhcmVkL2ZvY3VzVGVzdCc7XG5cbmZvY3VzVGVzdChQYXNzd29yZCk7XG5cbmRlc2NyaWJlKCdQYXNzd29yZCBpbnB1dCcsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gIH0pO1xuXG4gIGl0KCdyZW5kZXJzIFBhc3N3b3JkIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPFBhc3N3b3JkIC8+KTtcbiAgICBleHBlY3Qod3JhcHBlcikudG9NYXRjaFNuYXBzaG90KCk7XG4gIH0pO1xuXG4gIGl0KCdyZW5kZXJzIFBhc3N3b3JkIHJldmVhbCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxQYXNzd29yZCAvPik7XG4gICAgZXhwZWN0KHdyYXBwZXIucHJvcHMoKS5yZXZlYWwpLnRvRXF1YWwodHJ1ZSk7XG4gICAgZXhwZWN0KHdyYXBwZXIuZmluZCgnLmM3bi1wcm8tcGFzc3dvcmQtaW5uZXItYnV0dG9uJykpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICB3cmFwcGVyLnNldFByb3BzKHsgcmV2ZWFsOiBmYWxzZSB9KTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgIGV4cGVjdCh3cmFwcGVyLnByb3BzKCkucmV2ZWFsKS50b0VxdWFsKGZhbHNlKTtcbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCcuYzduLXByby1wYXNzd29yZC1pbm5lci1idXR0b24nKSkudG9IYXZlTGVuZ3RoKDApO1xuICB9KTtcblxuICBpdCgncmVuZGVycyBpbnB1dCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlSW5wdXQgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxQYXNzd29yZCB2YWx1ZT1cInJldmVhbFwiIG9uSW5wdXQ9e2hhbmRsZUlucHV0fSAvPik7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJy5jN24tcHJvLXBhc3N3b3JkJylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdpbnB1dCcsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncmV2ZWFsVmFsdWUnIH0gfSk7XG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICBleHBlY3QoaGFuZGxlSW5wdXQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ3JlbmRlcnMgcmV2ZWFsIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPFBhc3N3b3JkIHZhbHVlPVwicmV2ZWFsXCIgLz4pO1xuICAgIGV4cGVjdChcbiAgICAgIHdyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5jN24tcHJvLXBhc3N3b3JkJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5wcm9wKCd0eXBlJyksXG4gICAgKS50b0JlKCdwYXNzd29yZCcpO1xuICAgIHdyYXBwZXIuaW5zdGFuY2UoKS5kb1JldmVhbCh3cmFwcGVyLmluc3RhbmNlKCkpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICBleHBlY3QoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCcuYzduLXByby1wYXNzd29yZCcpXG4gICAgICAgIC5hdCgwKVxuICAgICAgICAucHJvcCgndHlwZScpLFxuICAgICkudG9CZSgndGV4dCcpO1xuICAgIHdyYXBwZXIuaW5zdGFuY2UoKS5yZXNldFJldmVhbCh3cmFwcGVyLmluc3RhbmNlKCkpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICBleHBlY3QoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCcuYzduLXByby1wYXNzd29yZCcpXG4gICAgICAgIC5hdCgwKVxuICAgICAgICAucHJvcCgndHlwZScpLFxuICAgICkudG9CZSgncGFzc3dvcmQnKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSB2YWx1ZSB3aWxsIGJlIGNvbnRyb2xsZWQnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxQYXNzd29yZCB2YWx1ZT1cInBhc3N3b3JkXCIgLz4pO1xuICAgIGV4cGVjdChcbiAgICAgIHdyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5jN24tcHJvLXBhc3N3b3JkJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5wcm9wKCd2YWx1ZScpLFxuICAgICkudG9CZSgncGFzc3dvcmQnKTtcbiAgICB3cmFwcGVyLnNldFByb3BzKHsgdmFsdWU6ICdzZXRQYXNzJyB9KTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgIGV4cGVjdChcbiAgICAgIHdyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5jN24tcHJvLXBhc3N3b3JkJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5wcm9wKCd2YWx1ZScpLFxuICAgICkudG9CZSgnc2V0UGFzcycpO1xuICB9KTtcblxuICBpdCgndGhlIGljb24gc2hvdWxkIGJlIGNoYW5nZWQgd2hlbiBpY29uIGNhbiBjbGljaycsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPFBhc3N3b3JkIHZhbHVlPVwicGFzc3dvcmRcIiAvPik7XG4gICAgZXhwZWN0KHdyYXBwZXIuZmluZCgnLmljb24tdmlzaWJpbGl0eV9vZmYnKSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh3cmFwcGVyLmZpbmQoJy5pY29uLXZpc2liaWxpdHknKSkudG9IYXZlTGVuZ3RoKDApO1xuICAgIHdyYXBwZXIuZmluZCgnLmljb24nKS5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgZXhwZWN0KHdyYXBwZXIuZmluZCgnLmljb24tdmlzaWJpbGl0eV9vZmYnKSkudG9IYXZlTGVuZ3RoKDApO1xuICAgIGV4cGVjdCh3cmFwcGVyLmZpbmQoJy5pY29uLXZpc2liaWxpdHknKSkudG9IYXZlTGVuZ3RoKDEpO1xuICB9KTtcblxuICBpdCgndGhlIGRhdGFzZXQgIHdpbGwgYmUgcmVuZGVyIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVEYXRhU2V0Q2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IGRzID0gbmV3IERhdGFTZXQoe1xuICAgICAgYXV0b0NyZWF0ZTogdHJ1ZSxcbiAgICAgIGZpZWxkczogW1xuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ3Rlc3QnLFxuICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBldmVudHM6IHtcbiAgICAgICAgdXBkYXRlOiBoYW5kbGVEYXRhU2V0Q2hhbmdlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPFBhc3N3b3JkIGRhdGFTZXQ9e2RzfSBuYW1lPVwidGVzdFwiIC8+KTtcbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCdQYXNzd29yZCcpLnByb3BzKCkubmFtZSkudG9FcXVhbCgndGVzdCcpO1xuICAgIGV4cGVjdChcbiAgICAgIHdyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5jN24tcHJvLXBhc3N3b3JkJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5wcm9wKCd2YWx1ZScpLFxuICAgICkudG9CZSgncGFzc3dvcmQnKTtcbiAgfSk7XG59KTtcbiJdfQ==