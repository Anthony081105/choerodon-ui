d2a2863f7247765f5fa78eadb3e16524
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getActiveKey = getActiveKey;
exports.saveRef = saveRef;
exports["default"] = exports.SubPopupMenu = void 0;

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectSpread4 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var _noop = _interopRequireDefault(require("lodash/noop"));

var _miniStore = require("mini-store");

var _KeyCode = _interopRequireDefault(require("../../_util/KeyCode"));

var _createChainedFunction = _interopRequireDefault(require("../util/createChainedFunction"));

var _util = require("./util");

var _DOMWrap = _interopRequireDefault(require("./DOMWrap"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

function allDisabled(arr) {
  if (!arr.length) {
    return true;
  }

  return arr.every(function (c) {
    return !!c.props.disabled;
  });
}

function updateActiveKey(store, menuId, activeKey) {
  var state = store.getState();
  store.setState({
    activeKey: (0, _objectSpread4["default"])({}, state.activeKey, (0, _defineProperty2["default"])({}, menuId, activeKey))
  });
}

function getEventKey(props) {
  // when eventKey not available ,it's menu and return menu id '0-menu-'
  return props.eventKey || '0-menu-';
}

function getActiveKey(props, originalActiveKey) {
  var activeKey = originalActiveKey;
  var children = props.children,
      eventKey = props.eventKey;

  if (activeKey) {
    var found;
    (0, _util.loopMenuItem)(children, function (c, i) {
      if (c && !c.props.disabled && activeKey === (0, _util.getKeyFromChildrenIndex)(c, eventKey, i)) {
        found = true;
      }
    });

    if (found) {
      return activeKey;
    }
  }

  activeKey = null;

  if (props.defaultActiveFirst) {
    (0, _util.loopMenuItem)(children, function (c, i) {
      if (!activeKey && c && !c.props.disabled) {
        activeKey = (0, _util.getKeyFromChildrenIndex)(c, eventKey, i);
      }
    });
    return activeKey;
  }

  return activeKey;
}

function saveRef(c) {
  if (c) {
    var index = this.instanceArray.indexOf(c);

    if (index !== -1) {
      // update component if it's already inside instanceArray
      this.instanceArray[index] = c;
    } else {
      // add component if it's not in instanceArray yet;
      this.instanceArray.push(c);
    }
  }
}

var SubPopupMenu =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(SubPopupMenu, _Component);

  var _super = _createSuper(SubPopupMenu);

  function SubPopupMenu(_props) {
    var _this;

    (0, _classCallCheck2["default"])(this, SubPopupMenu);
    _this = _super.call(this, _props);
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onKeyDown", function (e, callback) {
      var keyCode = e.keyCode;
      var handled;

      _this.getFlatInstanceArray().forEach(function (obj) {
        if (obj && obj.props.active && obj.onKeyDown) {
          handled = obj.onKeyDown(e);
        }
      });

      if (handled) {
        return 1;
      }

      var activeItem = null;

      if (keyCode === _KeyCode["default"].UP || keyCode === _KeyCode["default"].DOWN) {
        activeItem = _this.step(keyCode === _KeyCode["default"].UP ? -1 : 1);
      }

      if (activeItem) {
        e.preventDefault();
        updateActiveKey(_this.props.store, getEventKey(_this.props), activeItem.props.eventKey);

        if (typeof callback === 'function') {
          callback(activeItem);
        }

        return 1;
      }
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onItemHover", function (e) {
      var key = e.key,
          hover = e.hover;
      updateActiveKey(_this.props.store, getEventKey(_this.props), hover ? key : null);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onDeselect", function (selectInfo) {
      _this.props.onDeselect(selectInfo);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onSelect", function (selectInfo) {
      _this.props.onSelect(selectInfo);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onClick", function (e) {
      _this.props.onClick(e);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onOpenChange", function (e) {
      _this.props.onOpenChange(e);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onDestroy", function (key) {
      /* istanbul ignore next */
      _this.props.onDestroy(key);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getFlatInstanceArray", function () {
      return _this.instanceArray;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getOpenTransitionName", function () {
      return _this.props.openTransitionName;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "step", function (direction) {
      var children = _this.getFlatInstanceArray();

      var activeKey = _this.props.store.getState().activeKey[getEventKey(_this.props)];

      var len = children.length;

      if (!len) {
        return null;
      }

      if (direction < 0) {
        children = children.concat().reverse();
      } // find current activeIndex


      var activeIndex = -1;
      children.every(function (c, ci) {
        if (c && c.props.eventKey === activeKey) {
          activeIndex = ci;
          return false;
        }

        return true;
      });

      if (!_this.props.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {
        return undefined;
      }

      var start = (activeIndex + 1) % len;
      var i = start;

      do {
        var child = children[i];

        if (!child || child.props.disabled) {
          i = (i + 1) % len;
        } else {
          return child;
        }
      } while (i !== start);

      return null;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "renderCommonMenuItem", function (child, i, extraProps) {
      var state = _this.props.store.getState();

      var props = _this.props;
      var key = (0, _util.getKeyFromChildrenIndex)(child, props.eventKey, i);
      var childProps = child.props;
      var isActive = key === state.activeKey;
      var newChildProps = (0, _objectSpread4["default"])({
        mode: childProps.mode || props.mode,
        level: props.level,
        inlineIndent: props.inlineIndent,
        renderMenuItem: _this.renderMenuItem,
        rootPrefixCls: props.prefixCls,
        index: i,
        parentMenu: props.parentMenu,
        // customized ref function, need to be invoked manually in child's componentDidMount
        manualRef: childProps.disabled ? undefined : (0, _createChainedFunction["default"])(child.ref, saveRef.bind((0, _assertThisInitialized2["default"])(_this))),
        eventKey: key,
        active: !childProps.disabled && isActive,
        multiple: props.multiple,
        onClick: function onClick(e) {
          (childProps.onClick || _noop["default"])(e);

          _this.onClick(e);
        },
        onItemHover: _this.onItemHover,
        openTransitionName: _this.getOpenTransitionName(),
        openAnimation: props.openAnimation,
        subMenuOpenDelay: props.subMenuOpenDelay,
        subMenuCloseDelay: props.subMenuCloseDelay,
        forceSubMenuRender: props.forceSubMenuRender,
        onOpenChange: _this.onOpenChange,
        onDeselect: _this.onDeselect,
        onSelect: _this.onSelect,
        builtinPlacements: props.builtinPlacements,
        itemIcon: childProps.itemIcon || _this.props.itemIcon,
        expandIcon: childProps.expandIcon || _this.props.expandIcon
      }, extraProps);

      if (props.mode === 'inline') {
        newChildProps.triggerSubMenuAction = 'click';
      }

      return (0, _react.cloneElement)(child, newChildProps);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "renderMenuItem", function (c, i, subMenuKey) {
      /* istanbul ignore if */
      if (!c) {
        return null;
      }

      var props = _this.props;
      var extraProps = {
        openKeys: props.openKeys,
        selectedKeys: props.selectedKeys,
        triggerSubMenuAction: props.triggerSubMenuAction,
        subMenuKey: subMenuKey
      };
      return _this.renderCommonMenuItem(c, i, extraProps);
    });

    _props.store.setState({
      activeKey: (0, _objectSpread4["default"])({}, _props.store.getState().activeKey, (0, _defineProperty2["default"])({}, _props.eventKey, getActiveKey(_props, _props.activeKey)))
    });

    _this.instanceArray = [];
    return _this;
  }

  (0, _createClass2["default"])(SubPopupMenu, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      // invoke customized ref to expose component to mixin
      if (this.props.manualRef) {
        this.props.manualRef(this);
      }
    }
  }, {
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps) {
      return !this.props.hidden || !nextProps.hidden;
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      var props = this.props;
      var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];
      var activeKey = getActiveKey(props, originalActiveKey);

      if (activeKey !== originalActiveKey) {
        updateActiveKey(props.store, getEventKey(props), activeKey);
      }
    } // all keyboard events callbacks run from here at first

  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var props = (0, _extends2["default"])({}, this.props);
      this.instanceArray = [];
      var className = (0, _classnames["default"])(props.prefixCls, props.className, "".concat(props.prefixCls, "-").concat(props.mode));
      var haveRendered = this.haveRendered;
      this.haveRendered = true;
      this.haveOpened = this.haveOpened || !props.hidden || props.forceSubMenuRender;

      if (!this.haveOpened) {
        return null;
      }

      var domProps = {
        className: className,
        // role could be 'select' and by default set to menu
        role: props.role || 'menu'
      };

      if (props.id) {
        domProps.id = props.id;
      }

      if (props.focusable) {
        domProps.tabIndex = '0';
        domProps.onKeyDown = this.onKeyDown;
      }

      var prefixCls = props.prefixCls,
          eventKey = props.eventKey,
          hidden = props.hidden,
          level = props.level,
          mode = props.mode,
          overflowedIndicator = props.overflowedIndicator,
          theme = props.theme;

      _util.menuAllProps.forEach(function (key) {
        return delete props[key];
      });

      var transitionAppear = !(!haveRendered && !props.hidden && props.mode === 'inline');
      props.className += " ".concat(props.prefixCls, "-sub");
      delete props.onClick;
      var animProps = {};

      if (props.openTransitionName) {
        animProps.transitionName = props.openTransitionName;
      } else if ((0, _typeof2["default"])(props.openAnimation) === 'object') {
        animProps.animation = (0, _objectSpread4["default"])({}, props.openAnimation);

        if (!transitionAppear) {
          delete animProps.animation.appear;
        }
      }

      return (
        /* eslint-disable */
        _react["default"].createElement(_DOMWrap["default"], (0, _extends2["default"])({}, props, {
          prefixCls: prefixCls,
          mode: mode,
          tag: "ul",
          level: level,
          theme: theme,
          hiddenClassName: "".concat(prefixCls, "-hidden"),
          hidden: hidden,
          overflowedIndicator: overflowedIndicator
        }, domProps), _react.Children.map(props.children, function (c, i) {
          return _this2.renderMenuItem(c, i, eventKey || '0-menu-');
        }))
        /*eslint-enable */

      );
    }
  }]);
  return SubPopupMenu;
}(_react.Component);

exports.SubPopupMenu = SubPopupMenu;
(0, _defineProperty2["default"])(SubPopupMenu, "propTypes", {
  onSelect: _propTypes["default"].func,
  onClick: _propTypes["default"].func,
  onDeselect: _propTypes["default"].func,
  onOpenChange: _propTypes["default"].func,
  onDestroy: _propTypes["default"].func,
  openTransitionName: _propTypes["default"].string,
  openAnimation: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].object]),
  openKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  hidden: _propTypes["default"].bool,
  children: _propTypes["default"].any,
  parentMenu: _propTypes["default"].object,
  eventKey: _propTypes["default"].string,
  store: _propTypes["default"].shape({
    getState: _propTypes["default"].func,
    setState: _propTypes["default"].func
  }),
  // adding in refactor
  focusable: _propTypes["default"].bool,
  multiple: _propTypes["default"].bool,
  style: _propTypes["default"].object,
  defaultActiveFirst: _propTypes["default"].bool,
  activeKey: _propTypes["default"].string,
  selectedKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  defaultSelectedKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  defaultOpenKeys: _propTypes["default"].arrayOf(_propTypes["default"].string),
  level: _propTypes["default"].number,
  mode: _propTypes["default"].oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),
  triggerSubMenuAction: _propTypes["default"].oneOf(['click', 'hover']),
  inlineIndent: _propTypes["default"].oneOfType([_propTypes["default"].number, _propTypes["default"].string]),
  manualRef: _propTypes["default"].func,
  itemIcon: _propTypes["default"].oneOfType([_propTypes["default"].func, _propTypes["default"].node]),
  expandIcon: _propTypes["default"].oneOfType([_propTypes["default"].func, _propTypes["default"].node])
});
(0, _defineProperty2["default"])(SubPopupMenu, "defaultProps", {
  prefixCls: 'rc-menu',
  className: '',
  mode: 'vertical',
  level: 1,
  inlineIndent: 24,
  hidden: false,
  focusable: true,
  style: {},
  manualRef: _noop["default"]
});
var connected = (0, _miniStore.connect)()(SubPopupMenu);
var _default = connected;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUvU3ViUG9wdXBNZW51LmpzeCJdLCJuYW1lcyI6WyJhcnIiLCJjIiwic3RhdGUiLCJzdG9yZSIsImFjdGl2ZUtleSIsInByb3BzIiwiY2hpbGRyZW4iLCJldmVudEtleSIsImZvdW5kIiwiaW5kZXgiLCJTdWJQb3B1cE1lbnUiLCJDb21wb25lbnQiLCJvblNlbGVjdCIsIlByb3BUeXBlcyIsIm9uQ2xpY2siLCJvbkRlc2VsZWN0Iiwib25PcGVuQ2hhbmdlIiwib25EZXN0cm95Iiwib3BlblRyYW5zaXRpb25OYW1lIiwib3BlbkFuaW1hdGlvbiIsIm9wZW5LZXlzIiwiaGlkZGVuIiwicGFyZW50TWVudSIsImdldFN0YXRlIiwic2V0U3RhdGUiLCJmdW5jIiwiZm9jdXNhYmxlIiwibXVsdGlwbGUiLCJzdHlsZSIsImRlZmF1bHRBY3RpdmVGaXJzdCIsInNlbGVjdGVkS2V5cyIsImRlZmF1bHRTZWxlY3RlZEtleXMiLCJkZWZhdWx0T3BlbktleXMiLCJsZXZlbCIsIm1vZGUiLCJ0cmlnZ2VyU3ViTWVudUFjdGlvbiIsImlubGluZUluZGVudCIsIm1hbnVhbFJlZiIsIml0ZW1JY29uIiwiZXhwYW5kSWNvbiIsInByZWZpeENscyIsImNsYXNzTmFtZSIsIm5vb3AiLCJnZXRBY3RpdmVLZXkiLCJuZXh0UHJvcHMiLCJvcmlnaW5hbEFjdGl2ZUtleSIsImdldEV2ZW50S2V5IiwidXBkYXRlQWN0aXZlS2V5Iiwia2V5Q29kZSIsImUiLCJvYmoiLCJoYW5kbGVkIiwiYWN0aXZlSXRlbSIsIktleUNvZGUiLCJjYWxsYmFjayIsImtleSIsImhvdmVyIiwibGVuIiwiZGlyZWN0aW9uIiwiYWN0aXZlSW5kZXgiLCJhbGxEaXNhYmxlZCIsInN0YXJ0IiwiaSIsImNoaWxkIiwiY2hpbGRQcm9wcyIsImlzQWN0aXZlIiwibmV3Q2hpbGRQcm9wcyIsInJlbmRlck1lbnVJdGVtIiwicm9vdFByZWZpeENscyIsInNhdmVSZWYiLCJhY3RpdmUiLCJvbkl0ZW1Ib3ZlciIsInN1Yk1lbnVPcGVuRGVsYXkiLCJzdWJNZW51Q2xvc2VEZWxheSIsImZvcmNlU3ViTWVudVJlbmRlciIsImJ1aWx0aW5QbGFjZW1lbnRzIiwiZXh0cmFQcm9wcyIsInN1Yk1lbnVLZXkiLCJoYXZlUmVuZGVyZWQiLCJkb21Qcm9wcyIsInJvbGUiLCJvdmVyZmxvd2VkSW5kaWNhdG9yIiwidGhlbWUiLCJtZW51QWxsUHJvcHMiLCJ0cmFuc2l0aW9uQXBwZWFyIiwiYW5pbVByb3BzIiwiY29ubmVjdGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBLE1BQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFVBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFdBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLEtBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxhQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFVBQUEsR0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLHFCQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLHNCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsK0JBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsS0FBQSxHQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUE7O0FBQ0EsSUFBQSxRQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxTQUFBLFdBQUEsQ0FBQSxHQUFBLEVBQTBCO0FBQ3hCLE1BQUksQ0FBQ0EsR0FBRyxDQUFSLE1BQUEsRUFBaUI7QUFDZixXQUFBLElBQUE7QUFDRDs7QUFDRCxTQUFPLEdBQUcsQ0FBSCxLQUFBLENB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Q0FBQUEsU0FBQUE7QUFUUyxDO0FBaVJ4QixJQUFNNEMsU0FBUyxHQUFHLENBQUEsR0FBQSxVQUFBLENBQUEsT0FBQSxJQUFsQixZQUFrQixDQUFsQjtlQUVlQSxTIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENoaWxkcmVuLCBjbG9uZUVsZW1lbnQsIENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBub29wIGZyb20gJ2xvZGFzaC9ub29wJztcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdtaW5pLXN0b3JlJztcbmltcG9ydCBLZXlDb2RlIGZyb20gJy4uLy4uL191dGlsL0tleUNvZGUnO1xuaW1wb3J0IGNyZWF0ZUNoYWluZWRGdW5jdGlvbiBmcm9tICcuLi91dGlsL2NyZWF0ZUNoYWluZWRGdW5jdGlvbic7XG5pbXBvcnQgeyBnZXRLZXlGcm9tQ2hpbGRyZW5JbmRleCwgbG9vcE1lbnVJdGVtLCBtZW51QWxsUHJvcHMgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IERPTVdyYXAgZnJvbSAnLi9ET01XcmFwJztcblxuZnVuY3Rpb24gYWxsRGlzYWJsZWQoYXJyKSB7XG4gIGlmICghYXJyLmxlbmd0aCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBhcnIuZXZlcnkoYyA9PiAhIWMucHJvcHMuZGlzYWJsZWQpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVBY3RpdmVLZXkoc3RvcmUsIG1lbnVJZCwgYWN0aXZlS2V5KSB7XG4gIGNvbnN0IHN0YXRlID0gc3RvcmUuZ2V0U3RhdGUoKTtcbiAgc3RvcmUuc2V0U3RhdGUoe1xuICAgIGFjdGl2ZUtleToge1xuICAgICAgLi4uc3RhdGUuYWN0aXZlS2V5LFxuICAgICAgW21lbnVJZF06IGFjdGl2ZUtleSxcbiAgICB9LFxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RXZlbnRLZXkocHJvcHMpIHtcbiAgLy8gd2hlbiBldmVudEtleSBub3QgYXZhaWxhYmxlICxpdCdzIG1lbnUgYW5kIHJldHVybiBtZW51IGlkICcwLW1lbnUtJ1xuICByZXR1cm4gcHJvcHMuZXZlbnRLZXkgfHwgJzAtbWVudS0nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWN0aXZlS2V5KHByb3BzLCBvcmlnaW5hbEFjdGl2ZUtleSkge1xuICBsZXQgYWN0aXZlS2V5ID0gb3JpZ2luYWxBY3RpdmVLZXk7XG4gIGNvbnN0IHsgY2hpbGRyZW4sIGV2ZW50S2V5IH0gPSBwcm9wcztcbiAgaWYgKGFjdGl2ZUtleSkge1xuICAgIGxldCBmb3VuZDtcbiAgICBsb29wTWVudUl0ZW0oY2hpbGRyZW4sIChjLCBpKSA9PiB7XG4gICAgICBpZiAoYyAmJiAhYy5wcm9wcy5kaXNhYmxlZCAmJiBhY3RpdmVLZXkgPT09IGdldEtleUZyb21DaGlsZHJlbkluZGV4KGMsIGV2ZW50S2V5LCBpKSkge1xuICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGZvdW5kKSB7XG4gICAgICByZXR1cm4gYWN0aXZlS2V5O1xuICAgIH1cbiAgfVxuICBhY3RpdmVLZXkgPSBudWxsO1xuICBpZiAocHJvcHMuZGVmYXVsdEFjdGl2ZUZpcnN0KSB7XG4gICAgbG9vcE1lbnVJdGVtKGNoaWxkcmVuLCAoYywgaSkgPT4ge1xuICAgICAgaWYgKCFhY3RpdmVLZXkgJiYgYyAmJiAhYy5wcm9wcy5kaXNhYmxlZCkge1xuICAgICAgICBhY3RpdmVLZXkgPSBnZXRLZXlGcm9tQ2hpbGRyZW5JbmRleChjLCBldmVudEtleSwgaSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGFjdGl2ZUtleTtcbiAgfVxuICByZXR1cm4gYWN0aXZlS2V5O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2F2ZVJlZihjKSB7XG4gIGlmIChjKSB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmluc3RhbmNlQXJyYXkuaW5kZXhPZihjKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAvLyB1cGRhdGUgY29tcG9uZW50IGlmIGl0J3MgYWxyZWFkeSBpbnNpZGUgaW5zdGFuY2VBcnJheVxuICAgICAgdGhpcy5pbnN0YW5jZUFycmF5W2luZGV4XSA9IGM7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGFkZCBjb21wb25lbnQgaWYgaXQncyBub3QgaW4gaW5zdGFuY2VBcnJheSB5ZXQ7XG4gICAgICB0aGlzLmluc3RhbmNlQXJyYXkucHVzaChjKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN1YlBvcHVwTWVudSBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgb25TZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uRGVzZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uT3BlbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25EZXN0cm95OiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvcGVuVHJhbnNpdGlvbk5hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgb3BlbkFuaW1hdGlvbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm9iamVjdF0pLFxuICAgIG9wZW5LZXlzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuc3RyaW5nKSxcbiAgICBoaWRkZW46IFByb3BUeXBlcy5ib29sLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgIHBhcmVudE1lbnU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgZXZlbnRLZXk6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgc3RvcmU6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBnZXRTdGF0ZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBzZXRTdGF0ZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgfSksXG5cbiAgICAvLyBhZGRpbmcgaW4gcmVmYWN0b3JcbiAgICBmb2N1c2FibGU6IFByb3BUeXBlcy5ib29sLFxuICAgIG11bHRpcGxlOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzdHlsZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBkZWZhdWx0QWN0aXZlRmlyc3Q6IFByb3BUeXBlcy5ib29sLFxuICAgIGFjdGl2ZUtleTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBzZWxlY3RlZEtleXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zdHJpbmcpLFxuICAgIGRlZmF1bHRTZWxlY3RlZEtleXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zdHJpbmcpLFxuICAgIGRlZmF1bHRPcGVuS2V5czogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnN0cmluZyksXG4gICAgbGV2ZWw6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgbW9kZTogUHJvcFR5cGVzLm9uZU9mKFsnaG9yaXpvbnRhbCcsICd2ZXJ0aWNhbCcsICd2ZXJ0aWNhbC1sZWZ0JywgJ3ZlcnRpY2FsLXJpZ2h0JywgJ2lubGluZSddKSxcbiAgICB0cmlnZ2VyU3ViTWVudUFjdGlvbjogUHJvcFR5cGVzLm9uZU9mKFsnY2xpY2snLCAnaG92ZXInXSksXG4gICAgaW5saW5lSW5kZW50OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMubnVtYmVyLCBQcm9wVHlwZXMuc3RyaW5nXSksXG4gICAgbWFudWFsUmVmOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBpdGVtSWNvbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmMsIFByb3BUeXBlcy5ub2RlXSksXG4gICAgZXhwYW5kSWNvbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmMsIFByb3BUeXBlcy5ub2RlXSksXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBwcmVmaXhDbHM6ICdyYy1tZW51JyxcbiAgICBjbGFzc05hbWU6ICcnLFxuICAgIG1vZGU6ICd2ZXJ0aWNhbCcsXG4gICAgbGV2ZWw6IDEsXG4gICAgaW5saW5lSW5kZW50OiAyNCxcbiAgICBoaWRkZW46IGZhbHNlLFxuICAgIGZvY3VzYWJsZTogdHJ1ZSxcbiAgICBzdHlsZToge30sXG4gICAgbWFudWFsUmVmOiBub29wLFxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgcHJvcHMuc3RvcmUuc2V0U3RhdGUoe1xuICAgICAgYWN0aXZlS2V5OiB7XG4gICAgICAgIC4uLnByb3BzLnN0b3JlLmdldFN0YXRlKCkuYWN0aXZlS2V5LFxuICAgICAgICBbcHJvcHMuZXZlbnRLZXldOiBnZXRBY3RpdmVLZXkocHJvcHMsIHByb3BzLmFjdGl2ZUtleSksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy5pbnN0YW5jZUFycmF5ID0gW107XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAvLyBpbnZva2UgY3VzdG9taXplZCByZWYgdG8gZXhwb3NlIGNvbXBvbmVudCB0byBtaXhpblxuICAgIGlmICh0aGlzLnByb3BzLm1hbnVhbFJlZikge1xuICAgICAgdGhpcy5wcm9wcy5tYW51YWxSZWYodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcykge1xuICAgIHJldHVybiAhdGhpcy5wcm9wcy5oaWRkZW4gfHwgIW5leHRQcm9wcy5oaWRkZW47XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IG9yaWdpbmFsQWN0aXZlS2V5ID0gJ2FjdGl2ZUtleScgaW4gcHJvcHMgPyBwcm9wcy5hY3RpdmVLZXkgOiBwcm9wcy5zdG9yZS5nZXRTdGF0ZSgpLmFjdGl2ZUtleVtnZXRFdmVudEtleShwcm9wcyldO1xuICAgIGNvbnN0IGFjdGl2ZUtleSA9IGdldEFjdGl2ZUtleShwcm9wcywgb3JpZ2luYWxBY3RpdmVLZXkpO1xuICAgIGlmIChhY3RpdmVLZXkgIT09IG9yaWdpbmFsQWN0aXZlS2V5KSB7XG4gICAgICB1cGRhdGVBY3RpdmVLZXkocHJvcHMuc3RvcmUsIGdldEV2ZW50S2V5KHByb3BzKSwgYWN0aXZlS2V5KTtcbiAgICB9XG4gIH1cblxuICAvLyBhbGwga2V5Ym9hcmQgZXZlbnRzIGNhbGxiYWNrcyBydW4gZnJvbSBoZXJlIGF0IGZpcnN0XG4gIG9uS2V5RG93biA9IChlLCBjYWxsYmFjaykgPT4ge1xuICAgIGNvbnN0IGtleUNvZGUgPSBlLmtleUNvZGU7XG4gICAgbGV0IGhhbmRsZWQ7XG4gICAgdGhpcy5nZXRGbGF0SW5zdGFuY2VBcnJheSgpLmZvckVhY2goKG9iaikgPT4ge1xuICAgICAgaWYgKG9iaiAmJiBvYmoucHJvcHMuYWN0aXZlICYmIG9iai5vbktleURvd24pIHtcbiAgICAgICAgaGFuZGxlZCA9IG9iai5vbktleURvd24oZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGhhbmRsZWQpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBsZXQgYWN0aXZlSXRlbSA9IG51bGw7XG4gICAgaWYgKGtleUNvZGUgPT09IEtleUNvZGUuVVAgfHwga2V5Q29kZSA9PT0gS2V5Q29kZS5ET1dOKSB7XG4gICAgICBhY3RpdmVJdGVtID0gdGhpcy5zdGVwKGtleUNvZGUgPT09IEtleUNvZGUuVVAgPyAtMSA6IDEpO1xuICAgIH1cbiAgICBpZiAoYWN0aXZlSXRlbSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdXBkYXRlQWN0aXZlS2V5KHRoaXMucHJvcHMuc3RvcmUsIGdldEV2ZW50S2V5KHRoaXMucHJvcHMpLCBhY3RpdmVJdGVtLnByb3BzLmV2ZW50S2V5KTtcblxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYWxsYmFjayhhY3RpdmVJdGVtKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICB9O1xuXG4gIG9uSXRlbUhvdmVyID0gKGUpID0+IHtcbiAgICBjb25zdCB7IGtleSwgaG92ZXIgfSA9IGU7XG4gICAgdXBkYXRlQWN0aXZlS2V5KHRoaXMucHJvcHMuc3RvcmUsIGdldEV2ZW50S2V5KHRoaXMucHJvcHMpLCBob3ZlciA/IGtleSA6IG51bGwpO1xuICB9O1xuXG4gIG9uRGVzZWxlY3QgPSAoc2VsZWN0SW5mbykgPT4ge1xuICAgIHRoaXMucHJvcHMub25EZXNlbGVjdChzZWxlY3RJbmZvKTtcbiAgfTtcblxuICBvblNlbGVjdCA9IChzZWxlY3RJbmZvKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNlbGVjdChzZWxlY3RJbmZvKTtcbiAgfTtcblxuICBvbkNsaWNrID0gKGUpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uQ2xpY2soZSk7XG4gIH07XG5cbiAgb25PcGVuQ2hhbmdlID0gKGUpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uT3BlbkNoYW5nZShlKTtcbiAgfTtcblxuICBvbkRlc3Ryb3kgPSAoa2V5KSA9PiB7XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICB0aGlzLnByb3BzLm9uRGVzdHJveShrZXkpO1xuICB9O1xuXG4gIGdldEZsYXRJbnN0YW5jZUFycmF5ID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLmluc3RhbmNlQXJyYXk7XG4gIH07XG5cbiAgZ2V0T3BlblRyYW5zaXRpb25OYW1lID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLnByb3BzLm9wZW5UcmFuc2l0aW9uTmFtZTtcbiAgfTtcblxuICBzdGVwID0gKGRpcmVjdGlvbikgPT4ge1xuICAgIGxldCBjaGlsZHJlbiA9IHRoaXMuZ2V0RmxhdEluc3RhbmNlQXJyYXkoKTtcbiAgICBjb25zdCBhY3RpdmVLZXkgPSB0aGlzLnByb3BzLnN0b3JlLmdldFN0YXRlKCkuYWN0aXZlS2V5W2dldEV2ZW50S2V5KHRoaXMucHJvcHMpXTtcbiAgICBjb25zdCBsZW4gPSBjaGlsZHJlbi5sZW5ndGg7XG4gICAgaWYgKCFsZW4pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAoZGlyZWN0aW9uIDwgMCkge1xuICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5jb25jYXQoKS5yZXZlcnNlKCk7XG4gICAgfVxuICAgIC8vIGZpbmQgY3VycmVudCBhY3RpdmVJbmRleFxuICAgIGxldCBhY3RpdmVJbmRleCA9IC0xO1xuICAgIGNoaWxkcmVuLmV2ZXJ5KChjLCBjaSkgPT4ge1xuICAgICAgaWYgKGMgJiYgYy5wcm9wcy5ldmVudEtleSA9PT0gYWN0aXZlS2V5KSB7XG4gICAgICAgIGFjdGl2ZUluZGV4ID0gY2k7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIGlmIChcbiAgICAgICF0aGlzLnByb3BzLmRlZmF1bHRBY3RpdmVGaXJzdCAmJiBhY3RpdmVJbmRleCAhPT0gLTFcbiAgICAgICYmXG4gICAgICBhbGxEaXNhYmxlZChjaGlsZHJlbi5zbGljZShhY3RpdmVJbmRleCwgbGVuIC0gMSkpXG4gICAgKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBzdGFydCA9IChhY3RpdmVJbmRleCArIDEpICUgbGVuO1xuICAgIGxldCBpID0gc3RhcnQ7XG5cbiAgICBkbyB7XG4gICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgaWYgKCFjaGlsZCB8fCBjaGlsZC5wcm9wcy5kaXNhYmxlZCkge1xuICAgICAgICBpID0gKGkgKyAxKSAlIGxlbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChpICE9PSBzdGFydCk7XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICByZW5kZXJDb21tb25NZW51SXRlbSA9IChjaGlsZCwgaSwgZXh0cmFQcm9wcykgPT4ge1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5wcm9wcy5zdG9yZS5nZXRTdGF0ZSgpO1xuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBrZXkgPSBnZXRLZXlGcm9tQ2hpbGRyZW5JbmRleChjaGlsZCwgcHJvcHMuZXZlbnRLZXksIGkpO1xuICAgIGNvbnN0IGNoaWxkUHJvcHMgPSBjaGlsZC5wcm9wcztcbiAgICBjb25zdCBpc0FjdGl2ZSA9IGtleSA9PT0gc3RhdGUuYWN0aXZlS2V5O1xuICAgIGNvbnN0IG5ld0NoaWxkUHJvcHMgPSB7XG4gICAgICBtb2RlOiBjaGlsZFByb3BzLm1vZGUgfHwgcHJvcHMubW9kZSxcbiAgICAgIGxldmVsOiBwcm9wcy5sZXZlbCxcbiAgICAgIGlubGluZUluZGVudDogcHJvcHMuaW5saW5lSW5kZW50LFxuICAgICAgcmVuZGVyTWVudUl0ZW06IHRoaXMucmVuZGVyTWVudUl0ZW0sXG4gICAgICByb290UHJlZml4Q2xzOiBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBpbmRleDogaSxcbiAgICAgIHBhcmVudE1lbnU6IHByb3BzLnBhcmVudE1lbnUsXG4gICAgICAvLyBjdXN0b21pemVkIHJlZiBmdW5jdGlvbiwgbmVlZCB0byBiZSBpbnZva2VkIG1hbnVhbGx5IGluIGNoaWxkJ3MgY29tcG9uZW50RGlkTW91bnRcbiAgICAgIG1hbnVhbFJlZjogY2hpbGRQcm9wcy5kaXNhYmxlZCA/IHVuZGVmaW5lZCA6IGNyZWF0ZUNoYWluZWRGdW5jdGlvbihjaGlsZC5yZWYsIHNhdmVSZWYuYmluZCh0aGlzKSksXG4gICAgICBldmVudEtleToga2V5LFxuICAgICAgYWN0aXZlOiAhY2hpbGRQcm9wcy5kaXNhYmxlZCAmJiBpc0FjdGl2ZSxcbiAgICAgIG11bHRpcGxlOiBwcm9wcy5tdWx0aXBsZSxcbiAgICAgIG9uQ2xpY2s6IChlKSA9PiB7XG4gICAgICAgIChjaGlsZFByb3BzLm9uQ2xpY2sgfHwgbm9vcCkoZSk7XG4gICAgICAgIHRoaXMub25DbGljayhlKTtcbiAgICAgIH0sXG4gICAgICBvbkl0ZW1Ib3ZlcjogdGhpcy5vbkl0ZW1Ib3ZlcixcbiAgICAgIG9wZW5UcmFuc2l0aW9uTmFtZTogdGhpcy5nZXRPcGVuVHJhbnNpdGlvbk5hbWUoKSxcbiAgICAgIG9wZW5BbmltYXRpb246IHByb3BzLm9wZW5BbmltYXRpb24sXG4gICAgICBzdWJNZW51T3BlbkRlbGF5OiBwcm9wcy5zdWJNZW51T3BlbkRlbGF5LFxuICAgICAgc3ViTWVudUNsb3NlRGVsYXk6IHByb3BzLnN1Yk1lbnVDbG9zZURlbGF5LFxuICAgICAgZm9yY2VTdWJNZW51UmVuZGVyOiBwcm9wcy5mb3JjZVN1Yk1lbnVSZW5kZXIsXG4gICAgICBvbk9wZW5DaGFuZ2U6IHRoaXMub25PcGVuQ2hhbmdlLFxuICAgICAgb25EZXNlbGVjdDogdGhpcy5vbkRlc2VsZWN0LFxuICAgICAgb25TZWxlY3Q6IHRoaXMub25TZWxlY3QsXG4gICAgICBidWlsdGluUGxhY2VtZW50czogcHJvcHMuYnVpbHRpblBsYWNlbWVudHMsXG4gICAgICBpdGVtSWNvbjogY2hpbGRQcm9wcy5pdGVtSWNvbiB8fCB0aGlzLnByb3BzLml0ZW1JY29uLFxuICAgICAgZXhwYW5kSWNvbjogY2hpbGRQcm9wcy5leHBhbmRJY29uIHx8IHRoaXMucHJvcHMuZXhwYW5kSWNvbixcbiAgICAgIC4uLmV4dHJhUHJvcHMsXG4gICAgfTtcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2lubGluZScpIHtcbiAgICAgIG5ld0NoaWxkUHJvcHMudHJpZ2dlclN1Yk1lbnVBY3Rpb24gPSAnY2xpY2snO1xuICAgIH1cbiAgICByZXR1cm4gY2xvbmVFbGVtZW50KGNoaWxkLCBuZXdDaGlsZFByb3BzKTtcbiAgfTtcblxuICByZW5kZXJNZW51SXRlbSA9IChjLCBpLCBzdWJNZW51S2V5KSA9PiB7XG4gICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgaWYgKCFjKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGV4dHJhUHJvcHMgPSB7XG4gICAgICBvcGVuS2V5czogcHJvcHMub3BlbktleXMsXG4gICAgICBzZWxlY3RlZEtleXM6IHByb3BzLnNlbGVjdGVkS2V5cyxcbiAgICAgIHRyaWdnZXJTdWJNZW51QWN0aW9uOiBwcm9wcy50cmlnZ2VyU3ViTWVudUFjdGlvbixcbiAgICAgIHN1Yk1lbnVLZXksXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJDb21tb25NZW51SXRlbShjLCBpLCBleHRyYVByb3BzKTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyAuLi5wcm9wcyB9ID0gdGhpcy5wcm9wcztcblxuICAgIHRoaXMuaW5zdGFuY2VBcnJheSA9IFtdO1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IGNsYXNzTmFtZXMoXG4gICAgICBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBwcm9wcy5jbGFzc05hbWUsXG4gICAgICBgJHtwcm9wcy5wcmVmaXhDbHN9LSR7cHJvcHMubW9kZX1gLFxuICAgICk7XG4gICAgY29uc3QgaGF2ZVJlbmRlcmVkID0gdGhpcy5oYXZlUmVuZGVyZWQ7XG4gICAgdGhpcy5oYXZlUmVuZGVyZWQgPSB0cnVlO1xuICAgIHRoaXMuaGF2ZU9wZW5lZCA9IHRoaXMuaGF2ZU9wZW5lZCB8fCAhcHJvcHMuaGlkZGVuIHx8IHByb3BzLmZvcmNlU3ViTWVudVJlbmRlcjtcbiAgICBpZiAoIXRoaXMuaGF2ZU9wZW5lZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGRvbVByb3BzID0ge1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgLy8gcm9sZSBjb3VsZCBiZSAnc2VsZWN0JyBhbmQgYnkgZGVmYXVsdCBzZXQgdG8gbWVudVxuICAgICAgcm9sZTogcHJvcHMucm9sZSB8fCAnbWVudScsXG4gICAgfTtcbiAgICBpZiAocHJvcHMuaWQpIHtcbiAgICAgIGRvbVByb3BzLmlkID0gcHJvcHMuaWQ7XG4gICAgfVxuICAgIGlmIChwcm9wcy5mb2N1c2FibGUpIHtcbiAgICAgIGRvbVByb3BzLnRhYkluZGV4ID0gJzAnO1xuICAgICAgZG9tUHJvcHMub25LZXlEb3duID0gdGhpcy5vbktleURvd247XG4gICAgfVxuICAgIGNvbnN0IHsgcHJlZml4Q2xzLCBldmVudEtleSwgaGlkZGVuLCBsZXZlbCwgbW9kZSwgb3ZlcmZsb3dlZEluZGljYXRvciwgdGhlbWUgfSA9IHByb3BzO1xuICAgIG1lbnVBbGxQcm9wcy5mb3JFYWNoKGtleSA9PiBkZWxldGUgcHJvcHNba2V5XSk7XG5cbiAgICBjb25zdCB0cmFuc2l0aW9uQXBwZWFyID0gISghaGF2ZVJlbmRlcmVkICYmICFwcm9wcy5oaWRkZW4gJiYgcHJvcHMubW9kZSA9PT0gJ2lubGluZScpO1xuXG4gICAgcHJvcHMuY2xhc3NOYW1lICs9IGAgJHtwcm9wcy5wcmVmaXhDbHN9LXN1YmA7XG4gICAgZGVsZXRlIHByb3BzLm9uQ2xpY2s7XG4gICAgY29uc3QgYW5pbVByb3BzID0ge307XG4gICAgaWYgKHByb3BzLm9wZW5UcmFuc2l0aW9uTmFtZSkge1xuICAgICAgYW5pbVByb3BzLnRyYW5zaXRpb25OYW1lID0gcHJvcHMub3BlblRyYW5zaXRpb25OYW1lO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb3BzLm9wZW5BbmltYXRpb24gPT09ICdvYmplY3QnKSB7XG4gICAgICBhbmltUHJvcHMuYW5pbWF0aW9uID0geyAuLi5wcm9wcy5vcGVuQW5pbWF0aW9uIH07XG4gICAgICBpZiAoIXRyYW5zaXRpb25BcHBlYXIpIHtcbiAgICAgICAgZGVsZXRlIGFuaW1Qcm9wcy5hbmltYXRpb24uYXBwZWFyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgLyogZXNsaW50LWRpc2FibGUgKi9cbiAgICAgIDxET01XcmFwXG4gICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgcHJlZml4Q2xzPXtwcmVmaXhDbHN9XG4gICAgICAgIG1vZGU9e21vZGV9XG4gICAgICAgIHRhZz1cInVsXCJcbiAgICAgICAgbGV2ZWw9e2xldmVsfVxuICAgICAgICB0aGVtZT17dGhlbWV9XG4gICAgICAgIGhpZGRlbkNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1oaWRkZW5gfVxuICAgICAgICBoaWRkZW49e2hpZGRlbn1cbiAgICAgICAgb3ZlcmZsb3dlZEluZGljYXRvcj17b3ZlcmZsb3dlZEluZGljYXRvcn1cbiAgICAgICAgey4uLmRvbVByb3BzfVxuICAgICAgPlxuICAgICAgICB7Q2hpbGRyZW4ubWFwKFxuICAgICAgICAgIHByb3BzLmNoaWxkcmVuLFxuICAgICAgICAgIChjLCBpKSA9PiB0aGlzLnJlbmRlck1lbnVJdGVtKGMsIGksIGV2ZW50S2V5IHx8ICcwLW1lbnUtJyksXG4gICAgICAgICl9XG4gICAgICA8L0RPTVdyYXA+XG4gICAgICAvKmVzbGludC1lbmFibGUgKi9cbiAgICApO1xuICB9XG59XG5cbmNvbnN0IGNvbm5lY3RlZCA9IGNvbm5lY3QoKShTdWJQb3B1cE1lbnUpO1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0ZWQ7XG4iXX0=