9daa27b8b43acf249e2cc8ec9e54d33b
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _Select = _interopRequireDefault(require("./Select"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var formatOption = function formatOption(option, disabledOptions) {
  var value = "".concat(option);

  if (option < 10) {
    value = "0".concat(option);
  }

  var disabled = false;

  if (disabledOptions && disabledOptions.indexOf(option) >= 0) {
    disabled = true;
  }

  return {
    value: value,
    disabled: disabled
  };
};

var Combobox =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Combobox, _Component);

  var _super = _createSuper(Combobox);

  function Combobox() {
    var _this;

    (0, _classCallCheck2["default"])(this, Combobox);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onItemChange", function (type, itemValue) {
      var _this$props = _this.props,
          onChange = _this$props.onChange,
          defaultOpenValue = _this$props.defaultOpenValue,
          use12Hours = _this$props.use12Hours;
      var value = (_this.props.value || defaultOpenValue).clone();

      if (type === 'hour') {
        if (use12Hours) {
          if (_this.props.isAM) {
            value.hour(+itemValue % 12);
          } else {
            value.hour(+itemValue % 12 + 12);
          }
        } else {
          value.hour(+itemValue);
        }
      } else if (type === 'minute') {
        value.minute(+itemValue);
      } else if (type === 'ampm') {
        var ampm = itemValue.toUpperCase();

        if (use12Hours) {
          if (ampm === 'PM' && value.hour() < 12) {
            value.hour(value.hour() % 12 + 12);
          }

          if (ampm === 'AM') {
            if (value.hour() >= 12) {
              value.hour(value.hour() - 12);
            }
          }
        }
      } else {
        value.second(+itemValue);
      }

      onChange(value);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onEnterSelectPanel", function (range) {
      _this.props.onCurrentSelectPanelChange(range);
    });
    return _this;
  }

  (0, _createClass2["default"])(Combobox, [{
    key: "getHourSelect",
    value: function getHourSelect(hour) {
      var _this$props2 = this.props,
          prefixCls = _this$props2.prefixCls,
          hourOptions = _this$props2.hourOptions,
          disabledHours = _this$props2.disabledHours,
          showHour = _this$props2.showHour,
          use12Hours = _this$props2.use12Hours;

      if (!showHour) {
        return null;
      }

      var disabledOptions = disabledHours();
      var hourOptionsAdj;
      var hourAdj;

      if (use12Hours) {
        hourOptionsAdj = [12].concat(hourOptions.filter(function (h) {
          return h < 12 && h > 0;
        }));
        hourAdj = hour % 12 || 12;
      } else {
        hourOptionsAdj = hourOptions;
        hourAdj = hour;
      }

      return _react["default"].createElement(_Select["default"], {
        prefixCls: prefixCls,
        options: hourOptionsAdj.map(function (option) {
          return formatOption(option, disabledOptions);
        }),
        selectedIndex: hourOptionsAdj.indexOf(hourAdj),
        type: "hour",
        onSelect: this.onItemChange,
        onMouseEnter: this.onEnterSelectPanel.bind(this, 'hour')
      });
    }
  }, {
    key: "getMinuteSelect",
    value: function getMinuteSelect(minute) {
      var _this$props3 = this.props,
          prefixCls = _this$props3.prefixCls,
          minuteOptions = _this$props3.minuteOptions,
          disabledMinutes = _this$props3.disabledMinutes,
          defaultOpenValue = _this$props3.defaultOpenValue,
          showMinute = _this$props3.showMinute;

      if (!showMinute) {
        return null;
      }

      var value = this.props.value || defaultOpenValue;
      var disabledOptions = disabledMinutes(value.hour());
      return _react["default"].createElement(_Select["default"], {
        prefixCls: prefixCls,
        options: minuteOptions.map(function (option) {
          return formatOption(option, disabledOptions);
        }),
        selectedIndex: minuteOptions.indexOf(minute),
        type: "minute",
        onSelect: this.onItemChange,
        onMouseEnter: this.onEnterSelectPanel.bind(this, 'minute')
      });
    }
  }, {
    key: "getSecondSelect",
    value: function getSecondSelect(second) {
      var _this$props4 = this.props,
          prefixCls = _this$props4.prefixCls,
          secondOptions = _this$props4.secondOptions,
          disabledSeconds = _this$props4.disabledSeconds,
          showSecond = _this$props4.showSecond,
          defaultOpenValue = _this$props4.defaultOpenValue;

      if (!showSecond) {
        return null;
      }

      var value = this.props.value || defaultOpenValue;
      var disabledOptions = disabledSeconds(value.hour(), value.minute());
      return _react["default"].createElement(_Select["default"], {
        prefixCls: prefixCls,
        options: secondOptions.map(function (option) {
          return formatOption(option, disabledOptions);
        }),
        selectedIndex: secondOptions.indexOf(second),
        type: "second",
        onSelect: this.onItemChange,
        onMouseEnter: this.onEnterSelectPanel.bind(this, 'second')
      });
    }
  }, {
    key: "getAMPMSelect",
    value: function getAMPMSelect() {
      var _this$props5 = this.props,
          prefixCls = _this$props5.prefixCls,
          use12Hours = _this$props5.use12Hours,
          format = _this$props5.format;

      if (!use12Hours) {
        return null;
      }

      var AMPMOptions = ['am', 'pm'] // If format has A char, then we should uppercase AM/PM
      .map(function (c) {
        return format.match(/\sA/) ? c.toUpperCase() : c;
      }).map(function (c) {
        return {
          value: c
        };
      });
      var selected = this.props.isAM ? 0 : 1;
      return _react["default"].createElement(_Select["default"], {
        prefixCls: prefixCls,
        options: AMPMOptions,
        selectedIndex: selected,
        type: "ampm",
        onSelect: this.onItemChange,
        onMouseEnter: this.onEnterSelectPanel.bind(this, 'ampm')
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props6 = this.props,
          prefixCls = _this$props6.prefixCls,
          defaultOpenValue = _this$props6.defaultOpenValue;
      var value = this.props.value || defaultOpenValue;
      return _react["default"].createElement("div", {
        className: "".concat(prefixCls, "-combobox")
      }, this.getHourSelect(value.hour()), this.getMinuteSelect(value.minute()), this.getSecondSelect(value.second()), this.getAMPMSelect(value.hour()));
    }
  }]);
  return Combobox;
}(_react.Component);

(0, _defineProperty2["default"])(Combobox, "propTypes", {
  format: _propTypes["default"].string,
  defaultOpenValue: _propTypes["default"].object,
  prefixCls: _propTypes["default"].string,
  value: _propTypes["default"].object,
  onChange: _propTypes["default"].func,
  showHour: _propTypes["default"].bool,
  showMinute: _propTypes["default"].bool,
  showSecond: _propTypes["default"].bool,
  hourOptions: _propTypes["default"].array,
  minuteOptions: _propTypes["default"].array,
  secondOptions: _propTypes["default"].array,
  disabledHours: _propTypes["default"].func,
  disabledMinutes: _propTypes["default"].func,
  disabledSeconds: _propTypes["default"].func,
  onCurrentSelectPanelChange: _propTypes["default"].func,
  use12Hours: _propTypes["default"].bool,
  isAM: _propTypes["default"].bool
});
var _default = Combobox;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbWJvYm94LmpzeCJdLCJuYW1lcyI6WyJmb3JtYXRPcHRpb24iLCJvcHRpb24iLCJkaXNhYmxlZE9wdGlvbnMiLCJ2YWx1ZSIsImRpc2FibGVkIiwiaW5kZXhPZiIsIkNvbWJvYm94IiwidHlwZSIsIml0ZW1WYWx1ZSIsInByb3BzIiwib25DaGFuZ2UiLCJkZWZhdWx0T3BlblZhbHVlIiwidXNlMTJIb3VycyIsImNsb25lIiwiaXNBTSIsImhvdXIiLCJtaW51dGUiLCJhbXBtIiwidG9VcHBlckNhc2UiLCJzZWNvbmQiLCJyYW5nZSIsIm9uQ3VycmVudFNlbGVjdFBhbmVsQ2hhbmdlIiwicHJlZml4Q2xzIiwiaG91ck9wdGlvbnMiLCJkaXNhYmxlZEhvdXJzIiwic2hvd0hvdXIiLCJob3VyT3B0aW9uc0FkaiIsImhvdXJBZGoiLCJjb25jYXQiLCJmaWx0ZXIiLCJoIiwibWFwIiwib25JdGVtQ2hhbmdlIiwib25FbnRlclNlbGVjdFBhbmVsIiwiYmluZCIsIm1pbnV0ZU9wdGlvbnMiLCJkaXNhYmxlZE1pbnV0ZXMiLCJzaG93TWludXRlIiwic2Vjb25kT3B0aW9ucyIsImRpc2FibGVkU2Vjb25kcyIsInNob3dTZWNvbmQiLCJmb3JtYXQiLCJBTVBNT3B0aW9ucyIsImMiLCJtYXRjaCIsInNlbGVjdGVkIiwiZ2V0SG91clNlbGVjdCIsImdldE1pbnV0ZVNlbGVjdCIsImdldFNlY29uZFNlbGVjdCIsImdldEFNUE1TZWxlY3QiLCJDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJvYmplY3QiLCJmdW5jIiwiYm9vbCIsImFycmF5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxZQUFZLEdBQUcsU0FBZkEsWUFBZSxDQUFDQyxNQUFELEVBQVNDLGVBQVQsRUFBNkI7QUFDaEQsTUFBSUMsS0FBSyxhQUFNRixNQUFOLENBQVQ7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VUFBVSxFQUFFYyxzQkFBVUksSUFQTDtBQVFqQmYsRUFBQUEsVUFBVSxFQUFFVyxzQkFBVUksSUFSTDtBQVNqQmhDLEVBQUFBLFdBQVcsRUFBRTRCLHNCQUFVSyxLQVROO0FBVWpCckIsRUFBQUEsYUFBYSxFQUFFZ0Isc0JBQVVLLEtBVlI7QUFXakJsQixFQUFBQSxhQUFhLEVBQUVhLHNCQUFVSyxLQVhSO0FBWWpCaEMsRUFBQUEsYUFBYSxFQUFFMkIsc0JBQVVHLElBWlI7QUFhakJsQixFQUFBQSxlQUFlLEVBQUVlLHNCQUFVRyxJQWJWO0FBY2pCZixFQUFBQSxlQUFlLEVBQUVZLHNCQUFVRyxJQWRWO0FBZWpCakMsRUFBQUEsMEJBQTBCLEVBQUU4QixzQkFBVUcsSUFmckI7QUFnQmpCMUMsRUFBQUEsVUFBVSxFQUFFdUMsc0JBQVVJLElBaEJMO0FBaUJqQnpDLEVBQUFBLElBQUksRUFBRXFDLHNCQUFVSTtBQWpCQyxDO2VBcUtOakQsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFNlbGVjdCBmcm9tICcuL1NlbGVjdCc7XG5cbmNvbnN0IGZvcm1hdE9wdGlvbiA9IChvcHRpb24sIGRpc2FibGVkT3B0aW9ucykgPT4ge1xuICBsZXQgdmFsdWUgPSBgJHtvcHRpb259YDtcbiAgaWYgKG9wdGlvbiA8IDEwKSB7XG4gICAgdmFsdWUgPSBgMCR7b3B0aW9ufWA7XG4gIH1cblxuICBsZXQgZGlzYWJsZWQgPSBmYWxzZTtcbiAgaWYgKGRpc2FibGVkT3B0aW9ucyAmJiBkaXNhYmxlZE9wdGlvbnMuaW5kZXhPZihvcHRpb24pID49IDApIHtcbiAgICBkaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHZhbHVlLFxuICAgIGRpc2FibGVkLFxuICB9O1xufTtcblxuY2xhc3MgQ29tYm9ib3ggZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGZvcm1hdDogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBkZWZhdWx0T3BlblZhbHVlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHByZWZpeENsczogUHJvcFR5cGVzLnN0cmluZyxcbiAgICB2YWx1ZTogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgc2hvd0hvdXI6IFByb3BUeXBlcy5ib29sLFxuICAgIHNob3dNaW51dGU6IFByb3BUeXBlcy5ib29sLFxuICAgIHNob3dTZWNvbmQ6IFByb3BUeXBlcy5ib29sLFxuICAgIGhvdXJPcHRpb25zOiBQcm9wVHlwZXMuYXJyYXksXG4gICAgbWludXRlT3B0aW9uczogUHJvcFR5cGVzLmFycmF5LFxuICAgIHNlY29uZE9wdGlvbnM6IFByb3BUeXBlcy5hcnJheSxcbiAgICBkaXNhYmxlZEhvdXJzOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBkaXNhYmxlZE1pbnV0ZXM6IFByb3BUeXBlcy5mdW5jLFxuICAgIGRpc2FibGVkU2Vjb25kczogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25DdXJyZW50U2VsZWN0UGFuZWxDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgIHVzZTEySG91cnM6IFByb3BUeXBlcy5ib29sLFxuICAgIGlzQU06IFByb3BUeXBlcy5ib29sLFxuICB9O1xuXG4gIG9uSXRlbUNoYW5nZSA9ICh0eXBlLCBpdGVtVmFsdWUpID0+IHtcbiAgICBjb25zdCB7IG9uQ2hhbmdlLCBkZWZhdWx0T3BlblZhbHVlLCB1c2UxMkhvdXJzIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHZhbHVlID0gKHRoaXMucHJvcHMudmFsdWUgfHwgZGVmYXVsdE9wZW5WYWx1ZSkuY2xvbmUoKTtcblxuICAgIGlmICh0eXBlID09PSAnaG91cicpIHtcbiAgICAgIGlmICh1c2UxMkhvdXJzKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlzQU0pIHtcbiAgICAgICAgICB2YWx1ZS5ob3VyKCtpdGVtVmFsdWUgJSAxMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFsdWUuaG91cigoK2l0ZW1WYWx1ZSAlIDEyKSArIDEyKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUuaG91cigraXRlbVZhbHVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdtaW51dGUnKSB7XG4gICAgICB2YWx1ZS5taW51dGUoK2l0ZW1WYWx1ZSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnYW1wbScpIHtcbiAgICAgIGNvbnN0IGFtcG0gPSBpdGVtVmFsdWUudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmICh1c2UxMkhvdXJzKSB7XG4gICAgICAgIGlmIChhbXBtID09PSAnUE0nICYmIHZhbHVlLmhvdXIoKSA8IDEyKSB7XG4gICAgICAgICAgdmFsdWUuaG91cigodmFsdWUuaG91cigpICUgMTIpICsgMTIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFtcG0gPT09ICdBTScpIHtcbiAgICAgICAgICBpZiAodmFsdWUuaG91cigpID49IDEyKSB7XG4gICAgICAgICAgICB2YWx1ZS5ob3VyKHZhbHVlLmhvdXIoKSAtIDEyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUuc2Vjb25kKCtpdGVtVmFsdWUpO1xuICAgIH1cbiAgICBvbkNoYW5nZSh2YWx1ZSk7XG4gIH1cblxuICBvbkVudGVyU2VsZWN0UGFuZWwgPSAocmFuZ2UpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uQ3VycmVudFNlbGVjdFBhbmVsQ2hhbmdlKHJhbmdlKTtcbiAgfVxuXG4gIGdldEhvdXJTZWxlY3QoaG91cikge1xuICAgIGNvbnN0IHsgcHJlZml4Q2xzLCBob3VyT3B0aW9ucywgZGlzYWJsZWRIb3Vycywgc2hvd0hvdXIsIHVzZTEySG91cnMgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKCFzaG93SG91cikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGRpc2FibGVkT3B0aW9ucyA9IGRpc2FibGVkSG91cnMoKTtcbiAgICBsZXQgaG91ck9wdGlvbnNBZGo7XG4gICAgbGV0IGhvdXJBZGo7XG4gICAgaWYgKHVzZTEySG91cnMpIHtcbiAgICAgIGhvdXJPcHRpb25zQWRqID0gWzEyXS5jb25jYXQoaG91ck9wdGlvbnMuZmlsdGVyKGggPT4gaCA8IDEyICYmIGggPiAwKSk7XG4gICAgICBob3VyQWRqID0gKGhvdXIgJSAxMikgfHwgMTI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhvdXJPcHRpb25zQWRqID0gaG91ck9wdGlvbnM7XG4gICAgICBob3VyQWRqID0gaG91cjtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFNlbGVjdFxuICAgICAgICBwcmVmaXhDbHM9e3ByZWZpeENsc31cbiAgICAgICAgb3B0aW9ucz17aG91ck9wdGlvbnNBZGoubWFwKG9wdGlvbiA9PiBmb3JtYXRPcHRpb24ob3B0aW9uLCBkaXNhYmxlZE9wdGlvbnMpKX1cbiAgICAgICAgc2VsZWN0ZWRJbmRleD17aG91ck9wdGlvbnNBZGouaW5kZXhPZihob3VyQWRqKX1cbiAgICAgICAgdHlwZT1cImhvdXJcIlxuICAgICAgICBvblNlbGVjdD17dGhpcy5vbkl0ZW1DaGFuZ2V9XG4gICAgICAgIG9uTW91c2VFbnRlcj17dGhpcy5vbkVudGVyU2VsZWN0UGFuZWwuYmluZCh0aGlzLCAnaG91cicpfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgZ2V0TWludXRlU2VsZWN0KG1pbnV0ZSkge1xuICAgIGNvbnN0IHsgcHJlZml4Q2xzLCBtaW51dGVPcHRpb25zLCBkaXNhYmxlZE1pbnV0ZXMsIGRlZmF1bHRPcGVuVmFsdWUsIHNob3dNaW51dGUgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKCFzaG93TWludXRlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlIHx8IGRlZmF1bHRPcGVuVmFsdWU7XG4gICAgY29uc3QgZGlzYWJsZWRPcHRpb25zID0gZGlzYWJsZWRNaW51dGVzKHZhbHVlLmhvdXIoKSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFNlbGVjdFxuICAgICAgICBwcmVmaXhDbHM9e3ByZWZpeENsc31cbiAgICAgICAgb3B0aW9ucz17bWludXRlT3B0aW9ucy5tYXAob3B0aW9uID0+IGZvcm1hdE9wdGlvbihvcHRpb24sIGRpc2FibGVkT3B0aW9ucykpfVxuICAgICAgICBzZWxlY3RlZEluZGV4PXttaW51dGVPcHRpb25zLmluZGV4T2YobWludXRlKX1cbiAgICAgICAgdHlwZT1cIm1pbnV0ZVwiXG4gICAgICAgIG9uU2VsZWN0PXt0aGlzLm9uSXRlbUNoYW5nZX1cbiAgICAgICAgb25Nb3VzZUVudGVyPXt0aGlzLm9uRW50ZXJTZWxlY3RQYW5lbC5iaW5kKHRoaXMsICdtaW51dGUnKX1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIGdldFNlY29uZFNlbGVjdChzZWNvbmQpIHtcbiAgICBjb25zdCB7IHByZWZpeENscywgc2Vjb25kT3B0aW9ucywgZGlzYWJsZWRTZWNvbmRzLCBzaG93U2Vjb25kLCBkZWZhdWx0T3BlblZhbHVlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmICghc2hvd1NlY29uZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5wcm9wcy52YWx1ZSB8fCBkZWZhdWx0T3BlblZhbHVlO1xuICAgIGNvbnN0IGRpc2FibGVkT3B0aW9ucyA9IGRpc2FibGVkU2Vjb25kcyh2YWx1ZS5ob3VyKCksIHZhbHVlLm1pbnV0ZSgpKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U2VsZWN0XG4gICAgICAgIHByZWZpeENscz17cHJlZml4Q2xzfVxuICAgICAgICBvcHRpb25zPXtzZWNvbmRPcHRpb25zLm1hcChvcHRpb24gPT4gZm9ybWF0T3B0aW9uKG9wdGlvbiwgZGlzYWJsZWRPcHRpb25zKSl9XG4gICAgICAgIHNlbGVjdGVkSW5kZXg9e3NlY29uZE9wdGlvbnMuaW5kZXhPZihzZWNvbmQpfVxuICAgICAgICB0eXBlPVwic2Vjb25kXCJcbiAgICAgICAgb25TZWxlY3Q9e3RoaXMub25JdGVtQ2hhbmdlfVxuICAgICAgICBvbk1vdXNlRW50ZXI9e3RoaXMub25FbnRlclNlbGVjdFBhbmVsLmJpbmQodGhpcywgJ3NlY29uZCcpfVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgZ2V0QU1QTVNlbGVjdCgpIHtcbiAgICBjb25zdCB7IHByZWZpeENscywgdXNlMTJIb3VycywgZm9ybWF0IH0gPSB0aGlzLnByb3BzO1xuICAgIGlmICghdXNlMTJIb3Vycykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgQU1QTU9wdGlvbnMgPSBbJ2FtJywgJ3BtJ10gLy8gSWYgZm9ybWF0IGhhcyBBIGNoYXIsIHRoZW4gd2Ugc2hvdWxkIHVwcGVyY2FzZSBBTS9QTVxuICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGMgPT4gZm9ybWF0Lm1hdGNoKC9cXHNBLykgPyBjLnRvVXBwZXJDYXNlKCkgOiBjKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGMgPT4gKHsgdmFsdWU6IGMgfSkpO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnByb3BzLmlzQU0gPyAwIDogMTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U2VsZWN0XG4gICAgICAgIHByZWZpeENscz17cHJlZml4Q2xzfVxuICAgICAgICBvcHRpb25zPXtBTVBNT3B0aW9uc31cbiAgICAgICAgc2VsZWN0ZWRJbmRleD17c2VsZWN0ZWR9XG4gICAgICAgIHR5cGU9XCJhbXBtXCJcbiAgICAgICAgb25TZWxlY3Q9e3RoaXMub25JdGVtQ2hhbmdlfVxuICAgICAgICBvbk1vdXNlRW50ZXI9e3RoaXMub25FbnRlclNlbGVjdFBhbmVsLmJpbmQodGhpcywgJ2FtcG0nKX1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHByZWZpeENscywgZGVmYXVsdE9wZW5WYWx1ZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB2YWx1ZSA9IHRoaXMucHJvcHMudmFsdWUgfHwgZGVmYXVsdE9wZW5WYWx1ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tY29tYm9ib3hgfT5cbiAgICAgICAge3RoaXMuZ2V0SG91clNlbGVjdCh2YWx1ZS5ob3VyKCkpfVxuICAgICAgICB7dGhpcy5nZXRNaW51dGVTZWxlY3QodmFsdWUubWludXRlKCkpfVxuICAgICAgICB7dGhpcy5nZXRTZWNvbmRTZWxlY3QodmFsdWUuc2Vjb25kKCkpfVxuICAgICAgICB7dGhpcy5nZXRBTVBNU2VsZWN0KHZhbHVlLmhvdXIoKSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENvbWJvYm94O1xuIl19