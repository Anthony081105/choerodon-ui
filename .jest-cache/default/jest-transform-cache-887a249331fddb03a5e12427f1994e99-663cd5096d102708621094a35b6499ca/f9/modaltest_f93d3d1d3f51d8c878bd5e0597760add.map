{"version":3,"sources":["modal.test.js"],"names":["describe","errorSpy","jest","spyOn","console","mockImplementation","beforeEach","useFakeTimers","afterEach","mockReset","document","body","innerHTML","useRealTimers","afterAll","mockRestore","_pro","className","querySelectorAll","open","args","Modal","title","destroyOnClose","children","it","confirm","expect","toHaveLength","querySelector","toBe","key","click","not","toHaveBeenCalled","onCancel","fn","onOk","mock","calls","length","okCancel","toContain","forEach","type"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Modal from '..';\n\ndescribe('modal triggers callbacks correctly', () => {\n  const errorSpy = jest.spyOn(console, 'error').mockImplementation(() => {});\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    errorSpy.mockReset();\n    document.body.innerHTML = '';\n    jest.useRealTimers();\n  });\n\n  afterAll(() => {\n    errorSpy.mockRestore();\n  });\n\n  const _pro = className => {\n    return document.body.querySelectorAll(className);\n  };\n\n  function open(args) {\n    Modal.open({\n      title: 'Modal Test',\n      destroyOnClose: true,\n      children: (\n        <div>\n          <p>Some contents...</p>\n          <p>Some contents...</p>\n          <p>Some contents...</p>\n        </div>\n      ),\n      ...args,\n    });\n  }\n\n  it('should not render title when title not defined', () => {\n    // first modal\n    Modal.confirm({\n      children: 'test descriptions',\n    });\n    expect(_pro('.c7n-pro-modal-footer')).toHaveLength(1);\n    expect(document.querySelector('.c7n-pro-confirm-title')).toBe(null);\n  });\n\n  it('should allow Modal without onCancel been set', () => {\n    // second modal\n    const key = Modal.key();\n    open({\n      key,\n    });\n    _pro('.c7n-pro-modal-footer')[1]\n      .querySelector('.c7n-pro-btn-default')\n      .click();\n    expect(errorSpy).not.toHaveBeenCalled();\n  });\n\n  it('should allow Modal.comfirm without onOk been set', () => {\n    // third modal\n    const key = Modal.key();\n    open({\n      key,\n    });\n    _pro('.c7n-pro-modal-footer')[2]\n      .querySelector('.c7n-pro-btn-primary')\n      .click();\n    expect(errorSpy).not.toHaveBeenCalled();\n  });\n\n  it('trigger onCancel once when click on cancel button', () => {\n    const onCancel = jest.fn();\n    const onOk = jest.fn();\n    const key = Modal.key();\n    // forth modal\n    open({\n      key,\n      onCancel,\n      onOk,\n    });\n    _pro('.c7n-pro-modal-footer')[3]\n      .querySelector('.c7n-pro-btn-default')\n      .click();\n    expect(onCancel.mock.calls.length).toBe(1);\n    expect(onOk.mock.calls.length).toBe(0);\n  });\n\n  it('trigger onOk once when click on ok button', () => {\n    const onCancel = jest.fn();\n    const onOk = jest.fn();\n    const key = Modal.key();\n    // fifth modal\n    open({\n      key,\n      onCancel,\n      onOk,\n    });\n    _pro('.c7n-pro-modal-footer')[4]\n      .querySelector('.c7n-pro-btn-primary')\n      .click();\n    expect(onCancel.mock.calls.length).toBe(0);\n    expect(onOk.mock.calls.length).toBe(1);\n  });\n\n  it('only ok when the okCancel false', () => {\n    open({ okCancel: false });\n    expect(_pro('.c7n-pro-modal-footer')[5].querySelectorAll('.c7n-pro-btn')).toHaveLength(1);\n    expect(\n      _pro('.c7n-pro-modal-footer')[5].querySelectorAll('.c7n-pro-btn')[0].innerHTML,\n    ).toContain('确定');\n  });\n\n  it('should render info modal correctly ', () => {\n    ['success', 'warning', 'error'].forEach(type => {\n      Modal[type]({\n        title: 'title',\n        children: 'content',\n      });\n      expect(_pro(`.c7n-pro-confirm-${type}`)).toHaveLength(1);\n    });\n  });\n});\n"]}