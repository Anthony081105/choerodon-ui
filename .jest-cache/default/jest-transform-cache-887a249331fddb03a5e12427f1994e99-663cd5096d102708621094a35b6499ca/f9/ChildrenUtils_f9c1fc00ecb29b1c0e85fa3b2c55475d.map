{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components/animate/ChildrenUtils.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Children, isValidElement, Key, ReactElement, ReactNode } from 'react';\n\nexport function toArrayChildren(children: ReactNode): ReactElement<any>[] {\n  const ret: ReactElement<any>[] = [];\n  Children.forEach(children, child => {\n    if (isValidElement(child)) {\n      ret.push(child);\n    }\n  });\n  return ret;\n}\n\nexport function findChildInChildrenByKey(\n  children: ReactElement<any>[],\n  key: Key | null,\n): ReactElement<any> | undefined {\n  if (children) {\n    return children.find(child => child && child.key === key);\n  }\n}\n\nexport function findShownChildInChildrenByKey(\n  children: ReactElement<any>[],\n  key: Key | null,\n  hiddenProp: string,\n): ReactElement<any> | undefined {\n  let ret: ReactElement<any> | undefined;\n  if (children) {\n    children.forEach(child => {\n      if (child && child.key === key && !child.props[hiddenProp]) {\n        if (ret) {\n          throw new Error('two child with same key for animate children');\n        }\n        ret = child;\n      }\n    });\n  }\n  return ret;\n}\n\n// export function findHiddenChildInChildrenByKey(children, key, showProp):boolean {\n//   let found = false;\n//   if (children) {\n//     children.forEach(function (child) {\n//       if (found) {\n//         return;\n//       }\n//       found = child && child.key === key && !child.props[showProp];\n//     });\n//   }\n//   return found;\n// }\n\nexport function isSameChildren(\n  c1: ReactElement<any>[],\n  c2: ReactElement<any>[],\n  hiddenProp?: string,\n): boolean {\n  let same = c1.length === c2.length;\n  if (same) {\n    c1.forEach((child, index) => {\n      const child2 = c2[index];\n      if (child && child2) {\n        if ((child && !child2) || (!child && child2)) {\n          same = false;\n        } else if (child.key !== child2.key) {\n          same = false;\n        } else if (hiddenProp && child.props[hiddenProp] !== child2.props[hiddenProp]) {\n          same = false;\n        }\n      }\n    });\n  }\n  return same;\n}\n\nexport function mergeChildren(\n  prev: ReactElement<any>[],\n  next: ReactElement<any>[],\n): ReactElement<any>[] {\n  let ret: ReactElement<any>[] = [];\n  const nextChildrenPending: { [key: string]: ReactElement<any>[] } = {};\n  let pendingChildren: ReactElement<any>[] = [];\n  prev.forEach(child => {\n    if (child && child.key && findChildInChildrenByKey(next, child.key)) {\n      if (pendingChildren.length) {\n        nextChildrenPending[child.key] = pendingChildren;\n        pendingChildren = [];\n      }\n    } else {\n      pendingChildren.push(child);\n    }\n  });\n\n  next.forEach(child => {\n    if (child && child.key && {}.hasOwnProperty.call(nextChildrenPending, child.key)) {\n      ret = ret.concat(nextChildrenPending[child.key]);\n    }\n    ret.push(child);\n  });\n\n  return ret.concat(pendingChildren);\n}\n"]}