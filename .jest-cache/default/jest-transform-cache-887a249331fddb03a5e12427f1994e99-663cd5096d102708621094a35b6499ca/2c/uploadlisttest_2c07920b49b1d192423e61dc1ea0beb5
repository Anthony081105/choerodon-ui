b5bdd27f852cb08cbf2ee15a8004e488
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _ = _interopRequireDefault(require(".."));

var _form = _interopRequireDefault(require("../../form"));

var _requests = require("./requests");

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var delay = function delay(timeout) {
  return new Promise(function (resolve) {
    return setTimeout(resolve, timeout);
  });
};

var fileList = [{
  uid: -1,
  name: 'xxx.png',
  status: 'done',
  url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',
  thumbUrl: 'https://zos.alipayobjects.com/rmsportal/IQKRngzUuFzJzGzRJXUs.png'
}, {
  uid: -2,
  name: 'yyy.png',
  status: 'done',
  url: 'https://zos.alipayobjects.com/rmsportal/IQKRngzUuFzJzGzRJXUs.png',
  thumbUrl: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'
}];
describe('Upload List', function () {
  it('should use file.thumbUrl for <img /> in priority', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      defaultFileList: fileList,
      listType: "picture"
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    fileList.forEach(function (file, i) {
      var linkNode = wrapper.find('.c7n-upload-list-item-thumbnail').at(i);
      var imgNode = wrapper.find('.c7n-upload-list-item-thumbnail img').at(i);
      expect(linkNode.prop('href')).toBe(file.url);
      expect(imgNode.prop('src')).toBe(file.thumbUrl);
    });
  });
  it('should remove correct item when uid is 0',
  /*#__PURE__*/
  (0, _asyncToGenerator2["default"])(
  /*#__PURE__*/
  _regenerator["default"].mark(function _callee() {
    var list, wrapper;
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            list = [{
              uid: 0,
              name: 'xxx.png',
              status: 'done',
              url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',
              thumbUrl: 'https://zos.alipayobjects.com/rmsportal/IQKRngzUuFzJzGzRJXUs.png'
            }, {
              uid: 1,
              name: 'xxx.png',
              status: 'done',
              url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',
              thumbUrl: 'https://zos.alipayobjects.com/rmsportal/IQKRngzUuFzJzGzRJXUs.png'
            }];
            wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
              defaultFileList: list
            }, _react["default"].createElement("button", {
              type: "button"
            }, "upload")));
            expect(wrapper.find('.c7n-upload-list-item').length).toBe(2);
            wrapper.find('.c7n-upload-list-item').at(0).find('.icon-close').simulate('click');
            _context.next = 6;
            return delay(400);

          case 6:
            wrapper.update();
            expect(wrapper.find('.c7n-upload-list-item').hostNodes().length).toBe(1);

          case 8:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })));
  it('should be uploading when upload a file', function (done) {
    var wrapper;

    var onChange = function onChange(_ref2) {
      var file = _ref2.file;

      if (file.status === 'uploading') {
        expect(wrapper.render()).toMatchSnapshot();
      }

      if (file.status === 'done') {
        expect(wrapper.render()).toMatchSnapshot();
        done();
      }
    };

    wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      action: "http://jsonplaceholder.typicode.com/posts/",
      onChange: onChange,
      customRequest: _requests.successRequest
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    wrapper.find('input').simulate('change', {
      target: {
        files: [{
          filename: 'foo.png'
        }]
      }
    });
  });
  it('handle error', function (done) {
    var wrapper;

    var onChange = function onChange(_ref3) {
      var file = _ref3.file;

      if (file.status !== 'uploading') {
        expect(wrapper.render()).toMatchSnapshot();
        done();
      }
    };

    wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      action: "http://jsonplaceholder.typicode.com/posts/",
      onChange: onChange,
      customRequest: _requests.errorRequest
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    wrapper.find('input').simulate('change', {
      target: {
        files: [{
          filename: 'foo.png'
        }]
      }
    });
  });
  it('does concat filelist when beforeUpload returns false', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      listType: "picture",
      defaultFileList: fileList,
      onChange: handleChange,
      beforeUpload: function beforeUpload() {
        return false;
      }
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    wrapper.find('input').simulate('change', {
      target: {
        files: [{
          filename: 'foo.png'
        }]
      }
    });
    expect(wrapper.state().fileList.length).toBe(fileList.length + 1);
    expect(handleChange.mock.calls[0][0].fileList).toHaveLength(3);
  });
  it('work with form validation', function () {
    var errors;

    var TestForm =
    /*#__PURE__*/
    function (_React$Component) {
      (0, _inherits2["default"])(TestForm, _React$Component);

      var _super = _createSuper(TestForm);

      function TestForm() {
        var _this;

        (0, _classCallCheck2["default"])(this, TestForm);

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        _this = _super.call.apply(_super, [this].concat(args));
        (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "handleSubmit", function () {
          var validateFields = _this.props.form.validateFields;
          validateFields(function (err) {
            errors = err;
          });
        });
        return _this;
      }

      (0, _createClass2["default"])(TestForm, [{
        key: "render",
        value: function render() {
          var getFieldDecorator = this.props.form.getFieldDecorator;
          return _react["default"].createElement(_form["default"], {
            onSubmit: this.handleSubmit
          }, _react["default"].createElement(_form["default"].Item, null, getFieldDecorator('file', {
            valuePropname: 'fileList',
            getValueFromEvent: function getValueFromEvent(e) {
              return e.fileList;
            },
            rules: [{
              required: true,
              validator: function validator(rule, value, callback) {
                if (!value || value.length === 0) {
                  callback('file required');
                } else {
                  callback();
                }
              }
            }]
          })(_react["default"].createElement(_["default"], {
            beforeUpload: function beforeUpload() {
              return false;
            }
          }, _react["default"].createElement("button", {
            type: "button"
          }, "upload")))));
        }
      }]);
      return TestForm;
    }(_react["default"].Component);

    var App = _form["default"].create()(TestForm);

    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(App, null));
    wrapper.find(_form["default"]).simulate('submit');
    expect(errors.file.errors).toEqual([{
      message: 'file required',
      field: 'file'
    }]);
    wrapper.find('input').simulate('change', {
      target: {
        files: [{
          filename: 'foo.png'
        }]
      }
    });
    wrapper.find(_form["default"]).simulate('submit');
    expect(errors).toBeNull();
  });
  it('should support onPreview', function () {
    var handlePreview = jest.fn();
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      listType: "picture-card",
      defaultFileList: fileList,
      onPreview: handlePreview
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    wrapper.find('.icon-visibility').at(0).simulate('click');
    expect(handlePreview).toHaveBeenCalledWith(fileList[0]);
    wrapper.find('.icon-visibility').at(1).simulate('click');
    expect(handlePreview).toHaveBeenCalledWith(fileList[1]);
  });
  it('should support onRemove',
  /*#__PURE__*/
  (0, _asyncToGenerator2["default"])(
  /*#__PURE__*/
  _regenerator["default"].mark(function _callee2() {
    var handleRemove, handleChange, wrapper;
    return _regenerator["default"].wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            handleRemove = jest.fn();
            handleChange = jest.fn();
            wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
              listType: "picture-card",
              defaultFileList: fileList,
              onRemove: handleRemove,
              onChange: handleChange
            }, _react["default"].createElement("button", {
              type: "button"
            }, "upload")));
            wrapper.find('.icon-delete').at(0).simulate('click');
            expect(handleRemove).toHaveBeenCalledWith(fileList[0]);
            wrapper.find('.icon-delete').at(1).simulate('click');
            expect(handleRemove).toHaveBeenCalledWith(fileList[1]);
            _context2.next = 9;
            return delay(0);

          case 9:
            expect(handleChange.mock.calls.length).toBe(2);

          case 10:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  })));
  it('should generate thumbUrl from file',
  /*#__PURE__*/
  (0, _asyncToGenerator2["default"])(
  /*#__PURE__*/
  _regenerator["default"].mark(function _callee3() {
    var handlePreview, newFileList, newFile, wrapper;
    return _regenerator["default"].wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            handlePreview = jest.fn();
            newFileList = [].concat(fileList);
            newFile = (0, _objectSpread2["default"])({}, fileList[0], {
              uid: -3,
              originFileObj: new File([], 'xxx.png')
            });
            delete newFile.thumbUrl;
            newFileList.push(newFile);
            wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
              listType: "picture-card",
              defaultFileList: newFileList,
              onPreview: handlePreview
            }, _react["default"].createElement("button", {
              type: "button"
            }, "upload")));
            wrapper.setState({});
            _context3.next = 9;
            return delay(20);

          case 9:
            expect(wrapper.state().fileList[2].thumbUrl).not.toBe('');

          case 10:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3);
  })));
  it('should non-image format file preview', function () {
    var list = [(0, _objectSpread2["default"])({}, fileList[0], {
      uid: -3,
      url: 'https://cdn.xxx.com/aaa.zip',
      thumbUrl: 'data:application/zip;base64,UEsDBAoAAAAAADYZYkwAAAAAAAAAAAAAAAAdAAk',
      originFileObj: new File([], 'aaa.zip')
    })];
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      listType: "picture",
      defaultFileList: list
    }, _react["default"].createElement("button", {
      type: "button"
    }, "upload")));
    expect(wrapper.render()).toMatchSnapshot();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZGxpc3QudGVzdC5qcyJdLCJuYW1lcyI6WyJkZWxheSIsInRpbWVvdXQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJmaWxlTGlzdCIsInVpZCIsIm5hbWUiLCJzdGF0dXMiLCJ1cmwiLCJ0aHVtYlVybCIsImRlc2NyaWJlIiwiaXQiLCJ3cmFwcGVyIiwiZm9yRWFjaCIsImZpbGUiLCJpIiwibGlua05vZGUiLCJmaW5kIiwiYXQiLCJpbWdOb2RlIiwiZXhwZWN0IiwicHJvcCIsInRvQmUiLCJsaXN0IiwibGVuZ3RoIiwic2ltdWxhdGUiLCJ1cGRhdGUiLCJob3N0Tm9kZXMiLCJkb25lIiwib25DaGFuZ2UiLCJyZW5kZXIiLCJ0b01hdGNoU25hcHNob3QiLCJzdWNjZXNzUmVxdWVzdCIsInRhcmdldCIsImZpbGVzIiwiZmlsZW5hbWUiLCJlcnJvclJlcXVlc3QiLCJoYW5kbGVDaGFuZ2UiLCJqZXN0IiwiZm4iLCJzdGF0ZSIsIm1vY2siLCJjYWxscyIsInRvSGF2ZUxlbmd0aCIsImVycm9ycyIsIlRlc3RGb3JtIiwidmFsaWRhdGVGaWVsZHMiLCJwcm9wcyIsImZvcm0iLCJlcnIiLCJnZXRGaWVsZERlY29yYXRvciIsImhhbmRsZVN1Ym1pdCIsInZhbHVlUHJvcG5hbWUiLCJnZXRWYWx1ZUZyb21FdmVudCIsImUiLCJydWxlcyIsInJlcXVpcmVkIiwidmFsaWRhdG9yIiwicnVsZSIsInZhbHVlIiwiY2FsbGJhY2siLCJSZWFjdCIsIkNvbXBvbmVudCIsIkFwcCIsIkZvcm0iLCJjcmVhdGUiLCJ0b0VxdWFsIiwibWVzc2FnZSIsImZpZWxkIiwidG9CZU51bGwiLCJoYW5kbGVQcmV2aWV3IiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJoYW5kbGVSZW1vdmUiLCJuZXdGaWxlTGlzdCIsIm5ld0ZpbGUiLCJvcmlnaW5GaWxlT2JqIiwiRmlsZSIsInB1c2giLCJzZXRTdGF0ZSIsIm5vdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7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QWdCcEMsUUFBaEIsQ0FBeUIsQ0FBekIsRUFBNEJLLFFBQTdCLENBQU4sQ0FBNkNzRSxHQUE3QyxDQUFpRHpELElBQWpELENBQXNELEVBQXREOztBQWJ1QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUF2QyxHQUFGO0FBZ0JBWCxFQUFBQSxFQUFFLENBQUMsc0NBQUQsRUFBeUMsWUFBTTtBQUMvQyxRQUFNWSxJQUFJLEdBQUcsb0NBRU5uQixRQUFRLENBQUMsQ0FBRCxDQUZGO0FBR1RDLE1BQUFBLEdBQUcsRUFBRSxDQUFDLENBSEc7QUFJVEcsTUFBQUEsR0FBRyxFQUFFLDZCQUpJO0FBS1RDLE1BQUFBLFFBQVEsRUFBRSxxRUFMRDtBQU1Ua0UsTUFBQUEsYUFBYSxFQUFFLElBQUlDLElBQUosQ0FBUyxFQUFULEVBQWEsU0FBYjtBQU5OLE9BQWI7QUFVQSxRQUFNaEUsT0FBTyxHQUFHLG1CQUNkLGdDQUFDLFlBQUQ7QUFBUSxNQUFBLFFBQVEsRUFBQyxTQUFqQjtBQUEyQixNQUFBLGVBQWUsRUFBRVc7QUFBNUMsT0FDRTtBQUFRLE1BQUEsSUFBSSxFQUFDO0FBQWIsZ0JBREYsQ0FEYyxDQUFoQjtBQUtBSCxJQUFBQSxNQUFNLENBQUNSLE9BQU8sQ0FBQ2tCLE1BQVIsRUFBRCxDQUFOLENBQXlCQyxlQUF6QjtBQUNELEdBakJDLENBQUY7QUFrQkQsQ0F0UU8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBtb3VudCB9IGZyb20gJ2VuenltZSc7XG5pbXBvcnQgVXBsb2FkIGZyb20gJy4uJztcbmltcG9ydCBGb3JtIGZyb20gJy4uLy4uL2Zvcm0nO1xuaW1wb3J0IHsgZXJyb3JSZXF1ZXN0LCBzdWNjZXNzUmVxdWVzdCB9IGZyb20gJy4vcmVxdWVzdHMnO1xuXG5jb25zdCBkZWxheSA9IHRpbWVvdXQgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWVvdXQpKTtcblxuY29uc3QgZmlsZUxpc3QgPSBbXG4gIHtcbiAgICB1aWQ6IC0xLFxuICAgIG5hbWU6ICd4eHgucG5nJyxcbiAgICBzdGF0dXM6ICdkb25lJyxcbiAgICB1cmw6ICdodHRwczovL3pvcy5hbGlwYXlvYmplY3RzLmNvbS9ybXNwb3J0YWwvamtqZ2tFZnZwVVBWeVJqVUltbmlWc2xaZldQbkp1dVoucG5nJyxcbiAgICB0aHVtYlVybDogJ2h0dHBzOi8vem9zLmFsaXBheW9iamVjdHMuY29tL3Jtc3BvcnRhbC9JUUtSbmd6VXVGekp6R3pSSlhVcy5wbmcnLFxuICB9LFxuICB7XG4gICAgdWlkOiAtMixcbiAgICBuYW1lOiAneXl5LnBuZycsXG4gICAgc3RhdHVzOiAnZG9uZScsXG4gICAgdXJsOiAnaHR0cHM6Ly96b3MuYWxpcGF5b2JqZWN0cy5jb20vcm1zcG9ydGFsL0lRS1JuZ3pVdUZ6SnpHelJKWFVzLnBuZycsXG4gICAgdGh1bWJVcmw6ICdodHRwczovL3pvcy5hbGlwYXlvYmplY3RzLmNvbS9ybXNwb3J0YWwvamtqZ2tFZnZwVVBWeVJqVUltbmlWc2xaZldQbkp1dVoucG5nJyxcbiAgfSxcbl07XG5cbmRlc2NyaWJlKCdVcGxvYWQgTGlzdCcsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCB1c2UgZmlsZS50aHVtYlVybCBmb3IgPGltZyAvPiBpbiBwcmlvcml0eScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoXG4gICAgICA8VXBsb2FkIGRlZmF1bHRGaWxlTGlzdD17ZmlsZUxpc3R9IGxpc3RUeXBlPVwicGljdHVyZVwiPlxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIj51cGxvYWQ8L2J1dHRvbj5cbiAgICAgIDwvVXBsb2FkPixcbiAgICApO1xuICAgIGZpbGVMaXN0LmZvckVhY2goKGZpbGUsIGkpID0+IHtcbiAgICAgIGNvbnN0IGxpbmtOb2RlID0gd3JhcHBlci5maW5kKCcuYzduLXVwbG9hZC1saXN0LWl0ZW0tdGh1bWJuYWlsJykuYXQoaSk7XG4gICAgICBjb25zdCBpbWdOb2RlID0gd3JhcHBlci5maW5kKCcuYzduLXVwbG9hZC1saXN0LWl0ZW0tdGh1bWJuYWlsIGltZycpLmF0KGkpO1xuICAgICAgZXhwZWN0KGxpbmtOb2RlLnByb3AoJ2hyZWYnKSkudG9CZShmaWxlLnVybCk7XG4gICAgICBleHBlY3QoaW1nTm9kZS5wcm9wKCdzcmMnKSkudG9CZShmaWxlLnRodW1iVXJsKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZW1vdmUgY29ycmVjdCBpdGVtIHdoZW4gdWlkIGlzIDAnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbGlzdCA9IFtcbiAgICAgIHtcbiAgICAgICAgdWlkOiAwLFxuICAgICAgICBuYW1lOiAneHh4LnBuZycsXG4gICAgICAgIHN0YXR1czogJ2RvbmUnLFxuICAgICAgICB1cmw6ICdodHRwczovL3pvcy5hbGlwYXlvYmplY3RzLmNvbS9ybXNwb3J0YWwvamtqZ2tFZnZwVVBWeVJqVUltbmlWc2xaZldQbkp1dVoucG5nJyxcbiAgICAgICAgdGh1bWJVcmw6ICdodHRwczovL3pvcy5hbGlwYXlvYmplY3RzLmNvbS9ybXNwb3J0YWwvSVFLUm5nelV1RnpKekd6UkpYVXMucG5nJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHVpZDogMSxcbiAgICAgICAgbmFtZTogJ3h4eC5wbmcnLFxuICAgICAgICBzdGF0dXM6ICdkb25lJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly96b3MuYWxpcGF5b2JqZWN0cy5jb20vcm1zcG9ydGFsL2pramdrRWZ2cFVQVnlSalVJbW5pVnNsWmZXUG5KdXVaLnBuZycsXG4gICAgICAgIHRodW1iVXJsOiAnaHR0cHM6Ly96b3MuYWxpcGF5b2JqZWN0cy5jb20vcm1zcG9ydGFsL0lRS1JuZ3pVdUZ6SnpHelJKWFVzLnBuZycsXG4gICAgICB9LFxuICAgIF07XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPFVwbG9hZCBkZWZhdWx0RmlsZUxpc3Q9e2xpc3R9PlxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIj51cGxvYWQ8L2J1dHRvbj5cbiAgICAgIDwvVXBsb2FkPixcbiAgICApO1xuICAgIGV4cGVjdCh3cmFwcGVyLmZpbmQoJy5jN24tdXBsb2FkLWxpc3QtaXRlbScpLmxlbmd0aCkudG9CZSgyKTtcbiAgICB3cmFwcGVyXG4gICAgICAuZmluZCgnLmM3bi11cGxvYWQtbGlzdC1pdGVtJylcbiAgICAgIC5hdCgwKVxuICAgICAgLmZpbmQoJy5pY29uLWNsb3NlJylcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBhd2FpdCBkZWxheSg0MDApO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgZXhwZWN0KHdyYXBwZXIuZmluZCgnLmM3bi11cGxvYWQtbGlzdC1pdGVtJykuaG9zdE5vZGVzKCkubGVuZ3RoKS50b0JlKDEpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIHVwbG9hZGluZyB3aGVuIHVwbG9hZCBhIGZpbGUnLCBkb25lID0+IHtcbiAgICBsZXQgd3JhcHBlcjtcbiAgICBjb25zdCBvbkNoYW5nZSA9ICh7IGZpbGUgfSkgPT4ge1xuICAgICAgaWYgKGZpbGUuc3RhdHVzID09PSAndXBsb2FkaW5nJykge1xuICAgICAgICBleHBlY3Qod3JhcHBlci5yZW5kZXIoKSkudG9NYXRjaFNuYXBzaG90KCk7XG4gICAgICB9XG4gICAgICBpZiAoZmlsZS5zdGF0dXMgPT09ICdkb25lJykge1xuICAgICAgICBleHBlY3Qod3JhcHBlci5yZW5kZXIoKSkudG9NYXRjaFNuYXBzaG90KCk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxVcGxvYWRcbiAgICAgICAgYWN0aW9uPVwiaHR0cDovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vcG9zdHMvXCJcbiAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICBjdXN0b21SZXF1ZXN0PXtzdWNjZXNzUmVxdWVzdH1cbiAgICAgID5cbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCI+dXBsb2FkPC9idXR0b24+XG4gICAgICA8L1VwbG9hZD4sXG4gICAgKTtcbiAgICB3cmFwcGVyLmZpbmQoJ2lucHV0Jykuc2ltdWxhdGUoJ2NoYW5nZScsIHtcbiAgICAgIHRhcmdldDoge1xuICAgICAgICBmaWxlczogW3sgZmlsZW5hbWU6ICdmb28ucG5nJyB9XSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdoYW5kbGUgZXJyb3InLCBkb25lID0+IHtcbiAgICBsZXQgd3JhcHBlcjtcbiAgICBjb25zdCBvbkNoYW5nZSA9ICh7IGZpbGUgfSkgPT4ge1xuICAgICAgaWYgKGZpbGUuc3RhdHVzICE9PSAndXBsb2FkaW5nJykge1xuICAgICAgICBleHBlY3Qod3JhcHBlci5yZW5kZXIoKSkudG9NYXRjaFNuYXBzaG90KCk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxVcGxvYWRcbiAgICAgICAgYWN0aW9uPVwiaHR0cDovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vcG9zdHMvXCJcbiAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICBjdXN0b21SZXF1ZXN0PXtlcnJvclJlcXVlc3R9XG4gICAgICA+XG4gICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiPnVwbG9hZDwvYnV0dG9uPlxuICAgICAgPC9VcGxvYWQ+LFxuICAgICk7XG4gICAgd3JhcHBlci5maW5kKCdpbnB1dCcpLnNpbXVsYXRlKCdjaGFuZ2UnLCB7XG4gICAgICB0YXJnZXQ6IHtcbiAgICAgICAgZmlsZXM6IFt7IGZpbGVuYW1lOiAnZm9vLnBuZycgfV0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICBpdCgnZG9lcyBjb25jYXQgZmlsZWxpc3Qgd2hlbiBiZWZvcmVVcGxvYWQgcmV0dXJucyBmYWxzZScsICgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPFVwbG9hZFxuICAgICAgICBsaXN0VHlwZT1cInBpY3R1cmVcIlxuICAgICAgICBkZWZhdWx0RmlsZUxpc3Q9e2ZpbGVMaXN0fVxuICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICBiZWZvcmVVcGxvYWQ9eygpID0+IGZhbHNlfVxuICAgICAgPlxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIj51cGxvYWQ8L2J1dHRvbj5cbiAgICAgIDwvVXBsb2FkPixcbiAgICApO1xuXG4gICAgd3JhcHBlci5maW5kKCdpbnB1dCcpLnNpbXVsYXRlKCdjaGFuZ2UnLCB7XG4gICAgICB0YXJnZXQ6IHtcbiAgICAgICAgZmlsZXM6IFt7IGZpbGVuYW1lOiAnZm9vLnBuZycgfV0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS5maWxlTGlzdC5sZW5ndGgpLnRvQmUoZmlsZUxpc3QubGVuZ3RoICsgMSk7XG4gICAgZXhwZWN0KGhhbmRsZUNoYW5nZS5tb2NrLmNhbGxzWzBdWzBdLmZpbGVMaXN0KS50b0hhdmVMZW5ndGgoMyk7XG4gIH0pO1xuXG4gIGl0KCd3b3JrIHdpdGggZm9ybSB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGxldCBlcnJvcnM7XG4gICAgY2xhc3MgVGVzdEZvcm0gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgICAgaGFuZGxlU3VibWl0ID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZm9ybTogeyB2YWxpZGF0ZUZpZWxkcyB9LFxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgdmFsaWRhdGVGaWVsZHMoZXJyID0+IHtcbiAgICAgICAgICBlcnJvcnMgPSBlcnI7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZm9ybTogeyBnZXRGaWVsZERlY29yYXRvciB9LFxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxGb3JtIG9uU3VibWl0PXt0aGlzLmhhbmRsZVN1Ym1pdH0+XG4gICAgICAgICAgICA8Rm9ybS5JdGVtPlxuICAgICAgICAgICAgICB7Z2V0RmllbGREZWNvcmF0b3IoJ2ZpbGUnLCB7XG4gICAgICAgICAgICAgICAgdmFsdWVQcm9wbmFtZTogJ2ZpbGVMaXN0JyxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZUZyb21FdmVudDogZSA9PiBlLmZpbGVMaXN0LFxuICAgICAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3I6IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soJ2ZpbGUgcmVxdWlyZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIH0pKFxuICAgICAgICAgICAgICAgIDxVcGxvYWQgYmVmb3JlVXBsb2FkPXsoKSA9PiBmYWxzZX0+XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIj51cGxvYWQ8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L1VwbG9hZD4sXG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0Zvcm0uSXRlbT5cbiAgICAgICAgICA8L0Zvcm0+XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgQXBwID0gRm9ybS5jcmVhdGUoKShUZXN0Rm9ybSk7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxBcHAgLz4pO1xuICAgIHdyYXBwZXIuZmluZChGb3JtKS5zaW11bGF0ZSgnc3VibWl0Jyk7XG4gICAgZXhwZWN0KGVycm9ycy5maWxlLmVycm9ycykudG9FcXVhbChbeyBtZXNzYWdlOiAnZmlsZSByZXF1aXJlZCcsIGZpZWxkOiAnZmlsZScgfV0pO1xuXG4gICAgd3JhcHBlci5maW5kKCdpbnB1dCcpLnNpbXVsYXRlKCdjaGFuZ2UnLCB7XG4gICAgICB0YXJnZXQ6IHtcbiAgICAgICAgZmlsZXM6IFt7IGZpbGVuYW1lOiAnZm9vLnBuZycgfV0sXG4gICAgICB9LFxuICAgIH0pO1xuICAgIHdyYXBwZXIuZmluZChGb3JtKS5zaW11bGF0ZSgnc3VibWl0Jyk7XG4gICAgZXhwZWN0KGVycm9ycykudG9CZU51bGwoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBzdXBwb3J0IG9uUHJldmlldycsICgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVQcmV2aWV3ID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxVcGxvYWQgbGlzdFR5cGU9XCJwaWN0dXJlLWNhcmRcIiBkZWZhdWx0RmlsZUxpc3Q9e2ZpbGVMaXN0fSBvblByZXZpZXc9e2hhbmRsZVByZXZpZXd9PlxuICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIj51cGxvYWQ8L2J1dHRvbj5cbiAgICAgIDwvVXBsb2FkPixcbiAgICApO1xuICAgIHdyYXBwZXJcbiAgICAgIC5maW5kKCcuaWNvbi12aXNpYmlsaXR5JylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGV4cGVjdChoYW5kbGVQcmV2aWV3KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmaWxlTGlzdFswXSk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJy5pY29uLXZpc2liaWxpdHknKVxuICAgICAgLmF0KDEpXG4gICAgICAuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgZXhwZWN0KGhhbmRsZVByZXZpZXcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZpbGVMaXN0WzFdKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBzdXBwb3J0IG9uUmVtb3ZlJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZVJlbW92ZSA9IGplc3QuZm4oKTtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPFVwbG9hZFxuICAgICAgICBsaXN0VHlwZT1cInBpY3R1cmUtY2FyZFwiXG4gICAgICAgIGRlZmF1bHRGaWxlTGlzdD17ZmlsZUxpc3R9XG4gICAgICAgIG9uUmVtb3ZlPXtoYW5kbGVSZW1vdmV9XG4gICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICA+XG4gICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiPnVwbG9hZDwvYnV0dG9uPlxuICAgICAgPC9VcGxvYWQ+LFxuICAgICk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJy5pY29uLWRlbGV0ZScpXG4gICAgICAuYXQoMClcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBleHBlY3QoaGFuZGxlUmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmaWxlTGlzdFswXSk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJy5pY29uLWRlbGV0ZScpXG4gICAgICAuYXQoMSlcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBleHBlY3QoaGFuZGxlUmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmaWxlTGlzdFsxXSk7XG4gICAgYXdhaXQgZGVsYXkoMCk7XG4gICAgZXhwZWN0KGhhbmRsZUNoYW5nZS5tb2NrLmNhbGxzLmxlbmd0aCkudG9CZSgyKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSB0aHVtYlVybCBmcm9tIGZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlUHJldmlldyA9IGplc3QuZm4oKTtcbiAgICBjb25zdCBuZXdGaWxlTGlzdCA9IFsuLi5maWxlTGlzdF07XG4gICAgY29uc3QgbmV3RmlsZSA9IHsgLi4uZmlsZUxpc3RbMF0sIHVpZDogLTMsIG9yaWdpbkZpbGVPYmo6IG5ldyBGaWxlKFtdLCAneHh4LnBuZycpIH07XG4gICAgZGVsZXRlIG5ld0ZpbGUudGh1bWJVcmw7XG4gICAgbmV3RmlsZUxpc3QucHVzaChuZXdGaWxlKTtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoXG4gICAgICA8VXBsb2FkIGxpc3RUeXBlPVwicGljdHVyZS1jYXJkXCIgZGVmYXVsdEZpbGVMaXN0PXtuZXdGaWxlTGlzdH0gb25QcmV2aWV3PXtoYW5kbGVQcmV2aWV3fT5cbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCI+dXBsb2FkPC9idXR0b24+XG4gICAgICA8L1VwbG9hZD4sXG4gICAgKTtcbiAgICB3cmFwcGVyLnNldFN0YXRlKHt9KTtcbiAgICBhd2FpdCBkZWxheSgyMCk7XG4gICAgZXhwZWN0KHdyYXBwZXIuc3RhdGUoKS5maWxlTGlzdFsyXS50aHVtYlVybCkubm90LnRvQmUoJycpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG5vbi1pbWFnZSBmb3JtYXQgZmlsZSBwcmV2aWV3JywgKCkgPT4ge1xuICAgIGNvbnN0IGxpc3QgPSBbXG4gICAgICB7XG4gICAgICAgIC4uLmZpbGVMaXN0WzBdLFxuICAgICAgICB1aWQ6IC0zLFxuICAgICAgICB1cmw6ICdodHRwczovL2Nkbi54eHguY29tL2FhYS56aXAnLFxuICAgICAgICB0aHVtYlVybDogJ2RhdGE6YXBwbGljYXRpb24vemlwO2Jhc2U2NCxVRXNEQkFvQUFBQUFBRFlaWWt3QUFBQUFBQUFBQUFBQUFBQWRBQWsnLFxuICAgICAgICBvcmlnaW5GaWxlT2JqOiBuZXcgRmlsZShbXSwgJ2FhYS56aXAnKSxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxVcGxvYWQgbGlzdFR5cGU9XCJwaWN0dXJlXCIgZGVmYXVsdEZpbGVMaXN0PXtsaXN0fT5cbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCI+dXBsb2FkPC9idXR0b24+XG4gICAgICA8L1VwbG9hZD4sXG4gICAgKTtcbiAgICBleHBlY3Qod3JhcHBlci5yZW5kZXIoKSkudG9NYXRjaFNuYXBzaG90KCk7XG4gIH0pO1xufSk7XG4iXX0=