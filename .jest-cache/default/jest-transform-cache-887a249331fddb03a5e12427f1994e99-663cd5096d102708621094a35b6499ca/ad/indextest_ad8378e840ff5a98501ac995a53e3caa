0b5348a14967cbd4bc846b75e90a6606
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _ = _interopRequireDefault(require(".."));

var _dataSet = _interopRequireDefault(require("../../data-set"));

var _textField = _interopRequireDefault(require("../../text-field"));

var _numberField = _interopRequireDefault(require("../../number-field"));

var _password = _interopRequireDefault(require("../../password"));

var _button = _interopRequireDefault(require("../../button"));

var _emailField = _interopRequireDefault(require("../../email-field"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var FormTest =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2["default"])(FormTest, _React$Component);

  var _super = _createSuper(FormTest);

  function FormTest() {
    var _this;

    (0, _classCallCheck2["default"])(this, FormTest);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "ds", new _dataSet["default"]({
      data: [{
        phone: 1800000000,
        age: 18,
        sex: 'F',
        email: 'xxx@choerodon.io',
        homepage: 'https://choerodon.io'
      }],
      fields: [{
        name: 'phone',
        type: 'string',
        label: '手机号',
        labelWidth: 150,
        required: true,
        pattern: '^1[3-9]\\d{9}$'
      }, // /^1[3-9]\d{9}$/
      {
        name: 'password',
        type: 'string',
        label: '密码',
        required: true
      }, {
        name: 'age',
        type: 'number',
        label: '年龄',
        required: true,
        min: 18,
        step: 1,
        help: '我们需要确定你的年龄'
      }, {
        name: 'email',
        type: 'email',
        label: '邮箱',
        required: true
      }]
    }));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "changeField", function () {
      _this.ds.current.getField('code').set('textField', 'description');
    });
    return _this;
  }

  (0, _createClass2["default"])(FormTest, [{
    key: "render",
    value: function render() {
      return _react["default"].createElement(_["default"], (0, _extends2["default"])({
        dataSet: this.ds,
        style: {
          width: '4.5rem'
        }
      }, this.props), _react["default"].createElement(_textField["default"], {
        name: "phone"
      }), _react["default"].createElement(_password["default"], {
        name: "password"
      }), _react["default"].createElement(_numberField["default"], {
        name: "age",
        addonAfter: "\u5468\u5C81",
        showHelp: "tooltip"
      }), _react["default"].createElement(_emailField["default"], {
        name: "email"
      }), _react["default"].createElement("div", null, _react["default"].createElement(_button["default"], {
        type: "submit"
      }, "\u6CE8\u518C"), _react["default"].createElement(_button["default"], {
        type: "reset",
        style: {
          marginLeft: 8
        }
      }, "\u91CD\u7F6E"), _react["default"].createElement(_button["default"], {
        onClick: this.changeField,
        style: {
          marginLeft: 8
        }
      }, "\u8BBE\u7F6E\u4EE3\u7801\u63CF\u8FF0\u7684textField")));
    }
  }]);
  return FormTest;
}(_react["default"].Component);

describe('Select', function () {
  beforeEach(function () {
    jest.useFakeTimers();
  });
  afterEach(function () {
    jest.useRealTimers();
  });
  it('the form reder right', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(FormTest, null));
    jest.runAllTimers();
    expect(wrapper.find('input').length).toBe(5);
  });
  it('dataset data form test', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(FormTest, {
      disabled: true
    }));
    expect(wrapper.find('input').at(0).prop('value')).toBe('1800000000');
    expect(wrapper.find('input').at(1).prop('value')).toBe(undefined);
    expect(wrapper.find('input').at(2).prop('value')).toBe('');
    expect(wrapper.find('input').at(3).prop('value')).toBe('18');
    expect(wrapper.find('input').at(4).prop('value')).toBe('xxx@choerodon.io');
  });
  it('disable test', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(FormTest, {
      disabled: true
    }));
    jest.runAllTimers();
    expect(wrapper).toMatchSnapshot();
  });
  it('useColon test', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(FormTest, {
      useColon: true
    }));
    jest.runAllTimers();
    expect(wrapper.find('.c7n-pro-field-label-useColon')).toHaveLength(4);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRlc3QuanMiXSwibmFtZXMiOlsiRm9ybVRlc3QiLCJEYXRhU2V0IiwiZGF0YSIsInBob25lIiwiYWdlIiwic2V4IiwiZW1haWwiLCJob21lcGFnZSIsImZpZWxkcyIsIm5hbWUiLCJ0eXBlIiwibGFiZWwiLCJsYWJlbFdpZHRoIiwicmVxdWlyZWQiLCJwYXR0ZXJuIiwibWluIiwic3RlcCIsImhlbHAiLCJkcyIsImN1cnJlbnQiLCJnZXRGaWVsZCIsInNldCIsIndpZHRoIiwicHJvcHMiLCJtYXJnaW5MZWZ0IiwiY2hhbmdlRmllbGQiLCJSZWFjdCIsIkNvbXBvbmVudCIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImplc3QiLCJ1c2VGYWtlVGltZXJzIiwiYWZ0ZXJFYWNoIiwidXNlUmVhbFRpbWVycyIsIml0Iiwid3JhcHBlciIsInJ1bkFsbFRpbWVycyIsImV4cGVjdCIsImZpbmQiLCJsZW5ndGgiLCJ0b0JlIiwiYXQiLCJwcm9wIiwidW5kZWZpbmVkIiwidG9NYXRjaFNuYXBzaG90IiwidG9IYXZlTGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBRU1BLFE7Ozs7Ozs7Ozs7Ozs7Ozs7OzJGQUNDLElBQUlDLG1CQUFKLENBQVk7QUFDZkMsTUFBQUEsSUFBSSxFQUFFLENBQ0o7QUFDRUMsUUFBQUEsS0FBSyxFQUFFLFVBRFQ7QUFFRUMsUUFBQUEsR0FBRyxFQUFFLEVBRlA7QUFHRUMsUUFBQUEsR0FBRyxFQUFFLEdBSFA7QUFJRUMsUUFBQUEsS0FBSyxFQUFFLGtCQUpUO0FBS0VDLFFBQUFBLFFBQVEsRUFBRTtBQUxaLE9BREksQ0FEUztBQVVmQyxNQUFBQSxNQUFNLEVBQUUsQ0FDTjtBQUNFQyxRQUFBQSxJQUFJLEVBQUUsT0FEUjtBQUVFQyxRQUFBQSxJQUFJLEVB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QyxDQUFGO0FBTUFWLEVBQUFBLEVBQUUsQ0FBQyxlQUFELEVBQWtCLFlBQU07QUFDeEIsUUFBTUMsT0FBTyxHQUFHLG1CQUFNLGdDQUFDLFFBQUQ7QUFBVSxNQUFBLFFBQVE7QUFBbEIsTUFBTixDQUFoQjtBQUNBTCxJQUFBQSxJQUFJLENBQUNNLFlBQUw7QUFDQUMsSUFBQUEsTUFBTSxDQUFDRixPQUFPLENBQUNHLElBQVIsQ0FBYSwrQkFBYixDQUFELENBQU4sQ0FBc0RPLFlBQXRELENBQW1FLENBQW5FO0FBQ0QsR0FKQyxDQUFGO0FBS0QsQ0ExRE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBtb3VudCB9IGZyb20gJ2VuenltZSc7XG5pbXBvcnQgRm9ybSBmcm9tICcuLic7XG5pbXBvcnQgRGF0YVNldCBmcm9tICcuLi8uLi9kYXRhLXNldCc7XG5pbXBvcnQgVGV4dEZpZWxkIGZyb20gJy4uLy4uL3RleHQtZmllbGQnO1xuaW1wb3J0IE51bWJlckZpZWxkIGZyb20gJy4uLy4uL251bWJlci1maWVsZCc7XG5pbXBvcnQgUGFzc3dvcmQgZnJvbSAnLi4vLi4vcGFzc3dvcmQnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi8uLi9idXR0b24nO1xuaW1wb3J0IEVtYWlsRmllbGQgZnJvbSAnLi4vLi4vZW1haWwtZmllbGQnO1xuXG5jbGFzcyBGb3JtVGVzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGRzID0gbmV3IERhdGFTZXQoe1xuICAgIGRhdGE6IFtcbiAgICAgIHtcbiAgICAgICAgcGhvbmU6IDE4MDAwMDAwMDAsXG4gICAgICAgIGFnZTogMTgsXG4gICAgICAgIHNleDogJ0YnLFxuICAgICAgICBlbWFpbDogJ3h4eEBjaG9lcm9kb24uaW8nLFxuICAgICAgICBob21lcGFnZTogJ2h0dHBzOi8vY2hvZXJvZG9uLmlvJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBmaWVsZHM6IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ3Bob25lJyxcbiAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgIGxhYmVsOiAn5omL5py65Y+3JyxcbiAgICAgICAgbGFiZWxXaWR0aDogMTUwLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgcGF0dGVybjogJ14xWzMtOV1cXFxcZHs5fSQnLFxuICAgICAgfSwgLy8gL14xWzMtOV1cXGR7OX0kL1xuICAgICAge1xuICAgICAgICBuYW1lOiAncGFzc3dvcmQnLFxuICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgbGFiZWw6ICflr4bnoIEnLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdhZ2UnLFxuICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgbGFiZWw6ICflubTpvoQnLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgbWluOiAxOCxcbiAgICAgICAgc3RlcDogMSxcbiAgICAgICAgaGVscDogJ+aIkeS7rOmcgOimgeehruWumuS9oOeahOW5tOm+hCcsXG4gICAgICB9LFxuICAgICAgeyBuYW1lOiAnZW1haWwnLCB0eXBlOiAnZW1haWwnLCBsYWJlbDogJ+mCrueusScsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgXSxcbiAgfSk7XG5cbiAgY2hhbmdlRmllbGQgPSAoKSA9PiB7XG4gICAgdGhpcy5kcy5jdXJyZW50LmdldEZpZWxkKCdjb2RlJykuc2V0KCd0ZXh0RmllbGQnLCAnZGVzY3JpcHRpb24nKTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGb3JtIGRhdGFTZXQ9e3RoaXMuZHN9IHN0eWxlPXt7IHdpZHRoOiAnNC41cmVtJyB9fSB7Li4udGhpcy5wcm9wc30+XG4gICAgICAgIDxUZXh0RmllbGQgbmFtZT1cInBob25lXCIgLz5cbiAgICAgICAgPFBhc3N3b3JkIG5hbWU9XCJwYXNzd29yZFwiIC8+XG4gICAgICAgIDxOdW1iZXJGaWVsZCBuYW1lPVwiYWdlXCIgYWRkb25BZnRlcj1cIuWRqOWygVwiIHNob3dIZWxwPVwidG9vbHRpcFwiIC8+XG4gICAgICAgIDxFbWFpbEZpZWxkIG5hbWU9XCJlbWFpbFwiIC8+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPEJ1dHRvbiB0eXBlPVwic3VibWl0XCI+5rOo5YaMPC9CdXR0b24+XG4gICAgICAgICAgPEJ1dHRvbiB0eXBlPVwicmVzZXRcIiBzdHlsZT17eyBtYXJnaW5MZWZ0OiA4IH19PlxuICAgICAgICAgICAg6YeN572uXG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXt0aGlzLmNoYW5nZUZpZWxkfSBzdHlsZT17eyBtYXJnaW5MZWZ0OiA4IH19PlxuICAgICAgICAgICAg6K6+572u5Luj56CB5o+P6L+w55qEdGV4dEZpZWxkXG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9Gb3JtPlxuICAgICk7XG4gIH1cbn1cblxuZGVzY3JpYmUoJ1NlbGVjdCcsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gIH0pO1xuXG4gIGl0KCd0aGUgZm9ybSByZWRlciByaWdodCcsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPEZvcm1UZXN0IC8+KTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIGV4cGVjdCh3cmFwcGVyLmZpbmQoJ2lucHV0JykubGVuZ3RoKS50b0JlKDUpO1xuICB9KTtcbiAgaXQoJ2RhdGFzZXQgZGF0YSBmb3JtIHRlc3QnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxGb3JtVGVzdCBkaXNhYmxlZCAvPik7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKCcxODAwMDAwMDAwJyk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgICAuYXQoMSlcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKHVuZGVmaW5lZCk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgICAuYXQoMilcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKCcnKTtcbiAgICBleHBlY3QoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCdpbnB1dCcpXG4gICAgICAgIC5hdCgzKVxuICAgICAgICAucHJvcCgndmFsdWUnKSxcbiAgICApLnRvQmUoJzE4Jyk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgICAuYXQoNClcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKCd4eHhAY2hvZXJvZG9uLmlvJyk7XG4gIH0pO1xuICBpdCgnZGlzYWJsZSB0ZXN0JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudCg8Rm9ybVRlc3QgZGlzYWJsZWQgLz4pO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgZXhwZWN0KHdyYXBwZXIpLnRvTWF0Y2hTbmFwc2hvdCgpO1xuICB9KTtcblxuICBpdCgndXNlQ29sb24gdGVzdCcsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPEZvcm1UZXN0IHVzZUNvbG9uIC8+KTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIGV4cGVjdCh3cmFwcGVyLmZpbmQoJy5jN24tcHJvLWZpZWxkLWxhYmVsLXVzZUNvbG9uJykpLnRvSGF2ZUxlbmd0aCg0KTtcbiAgfSk7XG59KTtcbiJdfQ==