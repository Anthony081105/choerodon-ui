{"version":3,"sources":["Menus.jsx"],"names":["Menus","props","index","node","menuItems","scrollActiveItemToView","prevProps","visible","option","menuIndex","prefixCls","expandTrigger","expandIcon","onSelect","bind","expandProps","onClick","menuItemCls","expandIconNode","hasChildren","children","length","isLeaf","onMouseEnter","delayOnSelect","onMouseLeave","isActiveOption","ref","saveMenuItem","disabled","loading","title","label","key","value","values","activeValue","options","o","level","result","getActiveOptions","map","activeOption","filter","unshift","args","delayTimer","clearTimeout","setTimeout","optionsLength","getShowOptions","i","itemComponent","target","parentNode","scrollTop","offsetTop","dropdownMenuColumnStyle","getOption","Component","PropTypes","array","isRequired","string","func","bool","object"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport arrayTreeFilter from 'array-tree-filter';\nimport { findDOMNode } from 'react-dom';\nimport Icon from '../../icon';\n\nexport default class Menus extends Component {\n  static defaultProps = {\n    options: [],\n    value: [],\n    activeValue: [],\n    onSelect() {\n    },\n    prefixCls: 'rc-cascader-menus',\n    visible: false,\n    expandTrigger: 'click',\n    expandIcon: <Icon type=\"navigate_next\" />,\n  };\n\n  static propTypes = {\n    value: PropTypes.array,\n    activeValue: PropTypes.array,\n    options: PropTypes.array.isRequired,\n    prefixCls: PropTypes.string,\n    expandTrigger: PropTypes.string,\n    onSelect: PropTypes.func,\n    visible: PropTypes.bool,\n    dropdownMenuColumnStyle: PropTypes.object,\n    expandIcon:PropTypes.node,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.menuItems = {};\n  }\n\n  componentDidMount() {\n    this.scrollActiveItemToView();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.visible && this.props.visible) {\n      this.scrollActiveItemToView();\n    }\n  }\n\n  getOption(option, menuIndex) {\n    const { prefixCls, expandTrigger, expandIcon } = this.props;\n    const onSelect = this.props.onSelect.bind(this, option, menuIndex);\n    let expandProps = {\n      onClick: onSelect,\n    };\n    let menuItemCls = `${prefixCls}-menu-item`;\n    let expandIconNode = null;\n    const hasChildren = option.children && option.children.length > 0;\n    if (hasChildren || option.isLeaf === false) {\n      menuItemCls += ` ${prefixCls}-menu-item-expand`;\n      expandIconNode = (\n        <span className={`${prefixCls}-menu-item-expand-icon`}>\n          {expandIcon}\n        </span>\n      );\n    }\n    if (expandTrigger === 'hover' && hasChildren) {\n      expandProps = {\n        onMouseEnter: this.delayOnSelect.bind(this, onSelect),\n        onMouseLeave: this.delayOnSelect.bind(this),\n        onClick: onSelect,\n      };\n    }\n    if (this.isActiveOption(option, menuIndex)) {\n      menuItemCls += ` ${prefixCls}-menu-item-active`;\n      expandProps.ref = this.saveMenuItem(menuIndex);\n    }\n    if (option.disabled) {\n      menuItemCls += ` ${prefixCls}-menu-item-disabled`;\n    }\n    if (option.loading) {\n      menuItemCls += ` ${prefixCls}-menu-item-loading`;\n    }\n    let title = '';\n    if (option.title) {\n      title = option.title;\n    } else if (typeof option.label === 'string') {\n      title = option.label;\n    }\n    return (\n      <li\n        key={option.key || option.value}\n        className={menuItemCls}\n        title={title}\n        {...expandProps}\n      >\n        {option.label}\n        {expandIconNode}\n      </li>\n    );\n  }\n\n  getActiveOptions(values) {\n    const activeValue = values || this.props.activeValue;\n    const options = this.props.options;\n    return arrayTreeFilter(options, (o, level) => o.value === activeValue[level]);\n  }\n\n  getShowOptions() {\n    const { options } = this.props;\n    const result = this.getActiveOptions()\n      .map(activeOption => activeOption.children)\n      .filter(activeOption => !!activeOption);\n    result.unshift(options);\n    return result;\n  }\n\n  delayOnSelect(onSelect, ...args) {\n    if (this.delayTimer) {\n      clearTimeout(this.delayTimer);\n      this.delayTimer = null;\n    }\n    if (typeof onSelect === 'function') {\n      this.delayTimer = setTimeout(() => {\n        onSelect(args);\n        this.delayTimer = null;\n      }, 150);\n    }\n  }\n\n  scrollActiveItemToView() {\n    // scroll into view\n    const optionsLength = this.getShowOptions().length;\n    for (let i = 0; i < optionsLength; i++) {\n      const itemComponent = this.menuItems[i];\n      if (itemComponent) {\n        const target = findDOMNode(itemComponent);\n        target.parentNode.scrollTop = target.offsetTop;\n      }\n    }\n  }\n\n  isActiveOption(option, menuIndex) {\n    const { activeValue = [] } = this.props;\n    return activeValue[menuIndex] === option.value;\n  }\n\n  saveMenuItem = (index) => (node) => {\n    this.menuItems[index] = node;\n  };\n\n  render() {\n    const { prefixCls, dropdownMenuColumnStyle } = this.props;\n    return (\n      <div>\n        {this.getShowOptions().map((options, menuIndex) =>\n          <ul className={`${prefixCls}-menu`} key={menuIndex} style={dropdownMenuColumnStyle}>\n            {options.map(option => this.getOption(option, menuIndex))}\n          </ul>,\n        )}\n      </div>\n    );\n  }\n}\n"]}