{"version":3,"sources":["StepGroup.jsx"],"names":["Steps","props","domNode","children","length","calcTimeout","clearTimeout","setTimeout","lastStepOffsetWidth","lastChild","offsetWidth","state","Math","abs","setState","index","setNumberChange","getNumberChange","flexSupported","calcStepOffsetWidth","cancel","prefixCls","style","className","direction","labelPlacement","iconPrefix","status","size","current","progressDot","headerRender","headerIcon","headerText","restProps","filteredChildren","Children","toArray","filter","c","lastIndex","adjustedlabelPlacement","classString","renderHeader","renderFn","headerTitle","IconText","headerChildren","push","componentFn","renderFNHOC","ComponentFn","Component","HasKeyComponent","map","child","type","Step","gIndex","childProps","stepNumber","wrapperStyle","itemWidth","adjustMarginRight","round","StepGroup","gruopProps","PropTypes","string","any","oneOfType","bool","func","object","number"],"mappings":"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","sourcesContent":["/* eslint react/no-did-mount-set-state: 0 */\nimport React, { Children, cloneElement, Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { findDOMNode } from 'react-dom';\nimport classNames from 'classnames';\nimport debounce from 'lodash/debounce';\nimport { isFlexSupported } from './utils';\nimport StepGroup from './StepGroup';\nimport Step from './Step';\nimport Icon from '../../icon';\nimport isFunction from 'lodash/isFunction';\nimport isString from 'lodash/isString';\n\n\n\nexport default class Steps extends Component {\n  static propTypes = {\n    prefixCls: PropTypes.string,\n    className: PropTypes.string,\n    iconPrefix: PropTypes.string,\n    direction: PropTypes.string,\n    labelPlacement: PropTypes.string,\n    children: PropTypes.any,\n    status: PropTypes.string,\n    size: PropTypes.string,\n    progressDot: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),\n    style: PropTypes.object,\n    current: PropTypes.number,\n    getNumberChange:PropTypes.func,\n    setNumberChange: PropTypes.func,\n    headerRender: PropTypes.func,\n    headerIcon:PropTypes.string,\n    headerText: PropTypes.string,\n  };\n\n  static defaultProps = {\n    prefixCls: 'rc-steps',\n    iconPrefix: 'rc',\n    direction: 'horizontal',\n    labelPlacement: 'horizontal',\n    current: 0,\n    status: 'process',\n    size: '',\n    progressDot: false,\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      flexSupported: true,\n      lastStepOffsetWidth: 0,\n    };\n    this.calcStepOffsetWidth = debounce(this.calcStepOffsetWidth, 150);\n  }\n\n  componentDidMount() {\n    this.props.setNumberChange(0)\n    this.calcStepOffsetWidth();\n    if (!isFlexSupported()) {\n      this.setState({\n        flexSupported: false,\n      });\n    }\n    \n  }\n\n  componentDidUpdate() { \n    this.props.setNumberChange(0)\n    this.calcStepOffsetWidth();\n    \n  }\n\n  componentWillUnmount() {\n    this.props.setNumberChange(0)\n    if (this.calcTimeout) {\n      clearTimeout(this.calcTimeout);\n    }\n    if (this.calcStepOffsetWidth && this.calcStepOffsetWidth.cancel) {\n      this.calcStepOffsetWidth.cancel();\n    }\n\n  }\n\n  calcStepOffsetWidth = () => {\n    if (isFlexSupported()) {\n      return;\n    }\n    // Just for IE9\n    const domNode = findDOMNode(this);\n    if (domNode.children.length > 0) {\n      if (this.calcTimeout) {\n        clearTimeout(this.calcTimeout);\n      }\n      this.calcTimeout = setTimeout(() => {\n        // +1 for fit edge bug of digit width, like 35.4px\n        const lastStepOffsetWidth = (domNode.lastChild.offsetWidth || 0) + 1;\n        // Reduce shake bug\n        if (\n          this.state.lastStepOffsetWidth === lastStepOffsetWidth ||\n          Math.abs(this.state.lastStepOffsetWidth - lastStepOffsetWidth) <= 3\n        ) {\n          return;\n        }\n        this.setState({ lastStepOffsetWidth });\n      });\n    }\n  };\n\n\n  setNumberChange = (index) => {\n    this.props.setNumberChange(index)\n  }\n\n  getNumberChange = () => {\n    this.props.getNumberChange()\n  }\n  \n  render() {\n    const {\n      prefixCls,\n      style = {},\n      className,\n      children,\n      direction,\n      labelPlacement,\n      iconPrefix,\n      status,\n      size,\n      current,\n      progressDot,\n      setNumberChange,\n      getNumberChange,\n      headerRender,\n      headerIcon,\n      headerText,\n      ...restProps\n    } = this.props;\n    const { lastStepOffsetWidth, flexSupported } = this.state;\n    const filteredChildren = Children.toArray(children).filter(c => !!c);\n    const lastIndex = filteredChildren.length - 1;\n    const adjustedlabelPlacement = !!progressDot ? 'vertical' : labelPlacement;\n    const classString = classNames(prefixCls, `${prefixCls}-${direction}`, className, {\n      [`${prefixCls}-${size}`]: size,\n      [`${prefixCls}-label-${adjustedlabelPlacement}`]: direction === 'horizontal',\n      [`${prefixCls}-dot`]: !!progressDot,\n    });\n\n    const renderHeader = (renderFn,headerTitle,IconText) => {\n      let headerChildren = [];\n\n      if(isString(IconText)){\n        headerChildren.push(<Icon key=\"IconText\" type={IconText} className={classNames(`${prefixCls}-header-icon`)} />)\n      }\n      if(isString(headerTitle)){\n        headerChildren.push(<span key=\"headerTitle\" className={classNames(`${prefixCls}-header-title`)}>{headerTitle}</span>)\n      }\n\n      if(isFunction(renderFn)){\n        const componentFn =  renderFn\n        const renderFNHOC = (ComponentFn) =>{\n          return class renderFN extends Component {\n            render() {\n              return ComponentFn()\n            }\n          }\n        }\n\n        const HasKeyComponent = renderFNHOC(componentFn)\n        headerChildren = [<HasKeyComponent key={\"renderFn\"} />]\n      }\n      \n      return headerChildren.length>0? <div className={`${prefixCls}-header`}>{headerChildren}</div>: null;\n    }\n\n    return (  \n      <div className={classString} style={style} {...restProps}>\n        {renderHeader(\n                headerRender,\n                headerText,\n                headerIcon\n        )}\n        {Children.map(filteredChildren, (child, index) => {\n          if (child.type === Step){\n            let gIndex = getNumberChange()\n              const childProps = {\n                stepNumber: `${gIndex + 1}`,\n                prefixCls,\n                iconPrefix,\n                wrapperStyle: style,\n                progressDot,\n                ...child.props,\n              };\n              /**\n               * 如果支持flex布局 方向不是垂直 indx不是最后一个\n               */\n              if (!flexSupported && direction !== 'vertical' && gIndex !== lastIndex) {\n                childProps.itemWidth = `${100 / lastIndex}%`;\n                childProps.adjustMarginRight = -Math.round(lastStepOffsetWidth / lastIndex + 1);\n              }\n              // fix tail color 修复末尾颜色\n              if (status === 'error' && gIndex === current - 1) {\n                childProps.className = `${prefixCls}-next-error`;\n              }\n              if (!child.props.status) {\n                if (gIndex === current) {\n                  childProps.status = status;\n                } else if (gIndex < current) {\n                  childProps.status = 'finish';\n                } else {\n                  childProps.status = 'wait';\n                }\n              }\n              setNumberChange(++gIndex)\n              return (\n                 cloneElement(child, childProps)\n              );\n          }\n            \n          if(child.type === StepGroup ){\n            let gruopProps = {...this.props};\n            gruopProps.children = child.props.children\n            gruopProps.className = classNames(`${prefixCls}-group`, child.props.className);\n            return cloneElement(child, gruopProps);\n          }\n\n          return null;\n          \n        })}\n     </div>\n    )\n  }\n}\n"]}