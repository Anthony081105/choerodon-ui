23822af1ea3367d142e139a02e56f662
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.findExpandedKeys = findExpandedKeys;
exports.getExpandRange = getExpandRange;

function findExpandedKeys() {
  var prev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var next = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var prevLen = prev.length;
  var nextLen = next.length;

  if (Math.abs(prevLen - nextLen) !== 1) {
    return {
      add: false,
      key: null
    };
  }

  function find(shorter, longer) {
    var cache = new Map();
    shorter.forEach(function (key) {
      cache.set(key, true);
    });
    var keys = longer.filter(function (key) {
      return !cache.has(key);
    });
    return keys.length === 1 ? keys[0] : null;
  }

  if (prevLen < nextLen) {
    return {
      add: true,
      key: find(prev, next)
    };
  }

  return {
    add: false,
    key: find(next, prev)
  };
}

function getExpandRange(shorter, longer, key) {
  var shorterStartIndex = shorter.findIndex(function (_ref) {
    var data = _ref.data;
    return data.key === key;
  });
  var shorterEndNode = shorter[shorterStartIndex + 1];
  var longerStartIndex = longer.findIndex(function (_ref2) {
    var data = _ref2.data;
    return data.key === key;
  });

  if (shorterEndNode) {
    var longerEndIndex = longer.findIndex(function (_ref3) {
      var data = _ref3.data;
      return data.key === shorterEndNode.data.key;
    });
    return longer.slice(longerStartIndex + 1, longerEndIndex);
  }

  return longer.slice(longerStartIndex + 1);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJjLWNvbXBvbmVudHMvdHJlZS91dGlscy9kaWZmVXRpbC5qcyJdLCJuYW1lcyI6WyJwcmV2IiwibmV4dCIsInByZXZMZW4iLCJuZXh0TGVuIiwiTWF0aCIsImFkZCIsImtleSIsImNhY2hlIiwic2hvcnRlciIsImtleXMiLCJmaW5kIiwic2hvcnRlclN0YXJ0SW5kZXgiLCJkYXRhIiwic2hvcnRlckVuZE5vZGUiLCJsb25nZXJTdGFydEluZGV4IiwibG9uZ2VyRW5kSW5kZXgiLCJsb25nZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQU8sU0FBQSxnQkFBQSxHQUFnRDtBQUFBLE1BQXRCQSxJQUFzQixHQUFBLFNBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxJQUFBLFNBQUEsQ0FBQSxDQUFBLENBQUEsS0FBQSxTQUFBLEdBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxHQUFmLEVBQWU7QUFBQSxNQUFYQyxJQUFXLEdBQUEsU0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLElBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxLQUFBLFNBQUEsR0FBQSxTQUFBLENBQUEsQ0FBQSxDQUFBLEdBQUosRUFBSTtBQUNuRCxNQUFNQyxPQUFPLEdBQUdGLElBQUksQ0FBcEIsTUFBQTtBQUNBLE1BQU1HLE9BQU8sR0FBR0YsSUFBSSxDQUFwQixNQUFBOztBQUNBLE1BQUlHLElBQUksQ0FBSkEsR0FBQUEsQ0FBU0YsT0FBTyxHQUFoQkUsT0FBQUEsTUFBSixDQUFBLEVBQXVDO0FBQ25DLFdBQU87QUFBRUMsTUFBQUEsR0FBRyxFQUFMLEtBQUE7QUFBY0MsTUFBQUEsR0FBRyxFQUFFO0FBQW5CLEtBQVA7QUFDSDs7QUFDRCxXQUFBLElBQUEsQ0FBQSxPQUFBLEVBQUEsTUFBQSxFQUErQjtBQUMzQixRQUFNQyxLQUFLLEdBQUcsSUFBZCxHQUFjLEVBQWQ7QUFDQUMsSUFBQUEsT0FBTyxDQUFQQSxPQUFBQSxDQUFnQixVQUFBLEdBQUEsRUFBTztBQUNuQkQsTUFBQUEsS0FBSyxDQUFMQSxHQUFBQSxDQUFBQSxHQUFBQSxFQUFBQSxJQUFBQTtBQURKQyxLQUFBQTtBQUdBLFFBQU1DLElBQUksR0FBRyxNQUFNLENBQU4sTUFBQSxDQUFjLFVBQUEsR0FBQSxFQUFHO0FBQUEsYUFBSSxDQUFDRixLQUFLLENBQUxBLEdBQUFBLENBQUwsR0FBS0EsQ0FBTDtBQUE5QixLQUFhLENBQWI7QUFDQSxXQUFPRSxJQUFJLENBQUpBLE1BQUFBLEtBQUFBLENBQUFBLEdBQW9CQSxJQUFJLENBQXhCQSxDQUF3QixDQUF4QkEsR0FBUCxJQUFBO0FBQ0g7O0FBQ0QsTUFBSVAsT0FBTyxHQUFYLE9BQUEsRUFBdUI7QUFDbkIsV0FBTztBQUNIRyxNQUFBQSxHQUFHLEVBREEsSUFBQTtBQUVIQyxNQUFBQSxHQUFHLEVBQUVJLElBQUksQ0FBQSxJQUFBLEVBQUEsSUFBQTtBQUZOLEtBQVA7QUFJSDs7QUFDRCxTQUFPO0FBQ0hMLElBQUFBLEdBQUcsRUFEQSxLQUFBO0FBRUhDLElBQUFBLEdBQUcsRUFBRUksSUFBSSxDQUFBLElBQUEsRUFBQSxJQUFBO0FBRk4sR0FBUDtBQUlIOztBQUNNLFNBQUEsY0FBQSxDQUFBLE9BQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxFQUE4QztBQUNqRCxNQUFNQyxpQkFBaUIsR0FBRyxPQUFPLENBQVAsU0FBQSxDQUFrQixVQUFBLElBQUEsRUFBQTtBQUFBLFFBQUdDLElBQUgsR0FBQSxJQUFBLENBQUEsSUFBQTtBQUFBLFdBQWNBLElBQUksQ0FBSkEsR0FBQUEsS0FBZCxHQUFBO0FBQTVDLEdBQTBCLENBQTFCO0FBQ0EsTUFBTUMsY0FBYyxHQUFHTCxPQUFPLENBQUNHLGlCQUFpQixHQUFoRCxDQUE4QixDQUE5QjtBQUNBLE1BQU1HLGdCQUFnQixHQUFHLE1BQU0sQ0FBTixTQUFBLENBQWlCLFVBQUEsS0FBQSxFQUFBO0FBQUEsUUFBR0YsSUFBSCxHQUFBLEtBQUEsQ0FBQSxJQUFBO0FBQUEsV0FBY0EsSUFBSSxDQUFKQSxHQUFBQSxLQUFkLEdBQUE7QUFBMUMsR0FBeUIsQ0FBekI7O0FBQ0EsTUFBQSxjQUFBLEVBQW9CO0FBQ2hCLFFBQU1HLGNBQWMsR0FBRyxNQUFNLENBQU4sU0FBQSxDQUFpQixVQUFBLEtBQUEsRUFBQTtBQUFBLFVBQUdILElBQUgsR0FBQSxLQUFBLENBQUEsSUFBQTtBQUFBLGFBQWNBLElBQUksQ0FBSkEsR0FBQUEsS0FBYUMsY0FBYyxDQUFkQSxJQUFBQSxDQUEzQixHQUFBO0FBQXhDLEtBQXVCLENBQXZCO0FBQ0EsV0FBT0csTUFBTSxDQUFOQSxLQUFBQSxDQUFhRixnQkFBZ0IsR0FBN0JFLENBQUFBLEVBQVAsY0FBT0EsQ0FBUDtBQUNIOztBQUNELFNBQU9BLE1BQU0sQ0FBTkEsS0FBQUEsQ0FBYUYsZ0JBQWdCLEdBQXBDLENBQU9FLENBQVA7QUFDSCIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBmaW5kRXhwYW5kZWRLZXlzKHByZXYgPSBbXSwgbmV4dCA9IFtdKSB7XG4gICAgY29uc3QgcHJldkxlbiA9IHByZXYubGVuZ3RoO1xuICAgIGNvbnN0IG5leHRMZW4gPSBuZXh0Lmxlbmd0aDtcbiAgICBpZiAoTWF0aC5hYnMocHJldkxlbiAtIG5leHRMZW4pICE9PSAxKSB7XG4gICAgICAgIHJldHVybiB7IGFkZDogZmFsc2UsIGtleTogbnVsbCB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBmaW5kKHNob3J0ZXIsIGxvbmdlcikge1xuICAgICAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgc2hvcnRlci5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBjYWNoZS5zZXQoa2V5LCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGtleXMgPSBsb25nZXIuZmlsdGVyKGtleSA9PiAhY2FjaGUuaGFzKGtleSkpO1xuICAgICAgICByZXR1cm4ga2V5cy5sZW5ndGggPT09IDEgPyBrZXlzWzBdIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHByZXZMZW4gPCBuZXh0TGVuKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhZGQ6IHRydWUsXG4gICAgICAgICAgICBrZXk6IGZpbmQocHJldiwgbmV4dCksXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGFkZDogZmFsc2UsXG4gICAgICAgIGtleTogZmluZChuZXh0LCBwcmV2KSxcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGFuZFJhbmdlKHNob3J0ZXIsIGxvbmdlciwga2V5KSB7XG4gICAgY29uc3Qgc2hvcnRlclN0YXJ0SW5kZXggPSBzaG9ydGVyLmZpbmRJbmRleCgoeyBkYXRhIH0pID0+IGRhdGEua2V5ID09PSBrZXkpO1xuICAgIGNvbnN0IHNob3J0ZXJFbmROb2RlID0gc2hvcnRlcltzaG9ydGVyU3RhcnRJbmRleCArIDFdO1xuICAgIGNvbnN0IGxvbmdlclN0YXJ0SW5kZXggPSBsb25nZXIuZmluZEluZGV4KCh7IGRhdGEgfSkgPT4gZGF0YS5rZXkgPT09IGtleSk7XG4gICAgaWYgKHNob3J0ZXJFbmROb2RlKSB7XG4gICAgICAgIGNvbnN0IGxvbmdlckVuZEluZGV4ID0gbG9uZ2VyLmZpbmRJbmRleCgoeyBkYXRhIH0pID0+IGRhdGEua2V5ID09PSBzaG9ydGVyRW5kTm9kZS5kYXRhLmtleSk7XG4gICAgICAgIHJldHVybiBsb25nZXIuc2xpY2UobG9uZ2VyU3RhcnRJbmRleCArIDEsIGxvbmdlckVuZEluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIGxvbmdlci5zbGljZShsb25nZXJTdGFydEluZGV4ICsgMSk7XG59XG4iXX0=