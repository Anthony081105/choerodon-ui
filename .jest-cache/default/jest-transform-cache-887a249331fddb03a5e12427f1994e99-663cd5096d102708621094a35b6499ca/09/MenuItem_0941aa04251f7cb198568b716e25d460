c09f400492751ee1f3c51b81f5c46feb
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _createReactClass = _interopRequireDefault(require("create-react-class"));

var _KeyCode = _interopRequireDefault(require("../../_util/KeyCode"));

var _classnames = _interopRequireDefault(require("classnames"));

var _miniStore = require("mini-store");

var _noop = _interopRequireDefault(require("lodash/noop"));

var _Checkbox = _interopRequireDefault(require("../../checkbox/Checkbox"));

var _ripple = _interopRequireDefault(require("../../ripple"));
/* eslint react/no-is-mounted:0 */


var MenuItem = (0, _createReactClass["default"])({
  displayName: 'MenuItem',
  propTypes: {
    rootPrefixCls: _propTypes["default"].string,
    eventKey: _propTypes["default"].string,
    active: _propTypes["default"].bool,
    children: _propTypes["default"].any,
    selectedKeys: _propTypes["default"].array,
    disabled: _propTypes["default"].bool,
    title: _propTypes["default"].string,
    onItemHover: _propTypes["default"].func,
    onSelect: _propTypes["default"].func,
    onClick: _propTypes["default"].func,
    onDeselect: _propTypes["default"].func,
    parentMenu: _propTypes["default"].object,
    onDestroy: _propTypes["default"].func,
    onMouseEnter: _propTypes["default"].func,
    onMouseLeave: _propTypes["default"].func,
    onMouseDown: _propTypes["default"].func
  },
  getDefaultProps: function getDefaultProps() {
    return {
      onSelect: _noop["default"],
      onMouseEnter: _noop["default"],
      onMouseLeave: _noop["default"],
      onMouseDown: _noop["default"]
    };
  },
  componentWillUnmount: function componentWillUnmount() {
    var props = this.props;

    if (props.onDestroy) {
      props.onDestroy(props.eventKey);
    }
  },
  componentDidMount: function componentDidMount() {
    // invoke customized ref to expose component to mixin
    if (this.props.manualRef) {
      this.props.manualRef(this);
    }
  },
  componentDidUpdate: function componentDidUpdate() {
    // invoke customized ref to expose component to mixin
    if (this.props.manualRef) {
      this.props.manualRef(this);
    }
  },
  onKeyDown: function onKeyDown(e) {
    var keyCode = e.keyCode;

    if (keyCode === _KeyCode["default"].ENTER) {
      this.onClick(e);
      return true;
    }
  },
  onMouseLeave: function onMouseLeave(e) {
    var _this$props = this.props,
        eventKey = _this$props.eventKey,
        onItemHover = _this$props.onItemHover,
        onMouseLeave = _this$props.onMouseLeave;
    onItemHover({
      key: eventKey,
      hover: false
    });
    onMouseLeave({
      key: eventKey,
      domEvent: e
    });
  },
  onMouseEnter: function onMouseEnter(e) {
    var _this$props2 = this.props,
        eventKey = _this$props2.eventKey,
        onItemHover = _this$props2.onItemHover,
        onMouseEnter = _this$props2.onMouseEnter;
    onItemHover({
      key: eventKey,
      hover: true
    });
    onMouseEnter({
      key: eventKey,
      domEvent: e
    });
  },
  onClick: function onClick(e) {
    var _this$props3 = this.props,
        eventKey = _this$props3.eventKey,
        multiple = _this$props3.multiple,
        onClick = _this$props3.onClick,
        onSelect = _this$props3.onSelect,
        onDeselect = _this$props3.onDeselect,
        isSelected = _this$props3.isSelected;
    var info = {
      key: eventKey,
      keyPath: [eventKey],
      item: this,
      domEvent: e
    };
    onClick(info);

    if (multiple) {
      if (isSelected) {
        onDeselect(info);
      } else {
        onSelect(info);
      }
    } else if (!isSelected) {
      onSelect(info);
    }
  },
  getPrefixCls: function getPrefixCls() {
    return "".concat(this.props.rootPrefixCls, "-item");
  },
  getActiveClassName: function getActiveClassName() {
    return "".concat(this.getPrefixCls(), "-active");
  },
  getSelectedClassName: function getSelectedClassName() {
    return "".concat(this.getPrefixCls(), "-selected");
  },
  getDisabledClassName: function getDisabledClassName() {
    return "".concat(this.getPrefixCls(), "-disabled");
  },
  render: function render() {
    var _classNames;

    var props = this.props;
    var className = (0, _classnames["default"])(this.getPrefixCls(), props.className, (_classNames = {}, (0, _defineProperty2["default"])(_classNames, this.getActiveClassName(), !props.disabled && props.active), (0, _defineProperty2["default"])(_classNames, this.getSelectedClassName(), props.isSelected), (0, _defineProperty2["default"])(_classNames, this.getDisabledClassName(), props.disabled), _classNames));
    var attrs = (0, _objectSpread2["default"])({}, props.attribute, {
      title: props.title,
      className: className,
      role: 'menuitem',
      'aria-selected': props.isSelected,
      'aria-disabled': props.disabled
    });
    var mouseEvent = {};

    if (!props.disabled) {
      mouseEvent = {
        onClick: this.onClick,
        onMouseLeave: this.onMouseLeave,
        onMouseEnter: this.onMouseEnter,
        onMouseDown: this.props.onMouseDown
      };
    }

    var style = (0, _objectSpread2["default"])({}, props.style);

    if (props.mode === 'inline') {
      style.paddingLeft = props.inlineIndent * props.level;
    }

    var notFound = props.eventKey === 'NOT_FOUND';
    var checkbox = props.multiple && !notFound ? _react["default"].createElement(_Checkbox["default"], {
      disabled: props.disabled,
      checked: props.isSelected,
      tabIndex: -1
    }) : null;
    return _react["default"].createElement(_ripple["default"], {
      disabled: props.disabled
    }, _react["default"].createElement("li", (0, _extends2["default"])({}, attrs, mouseEvent, {
      style: style
    }), checkbox, props.children));
  }
});
MenuItem.isMenuItem = 1;

var _default = (0, _miniStore.connect)(function (_ref, _ref2) {
  var activeKey = _ref.activeKey,
      selectedKeys = _ref.selectedKeys;
  var eventKey = _ref2.eventKey,
      subMenuKey = _ref2.subMenuKey;
  return {
    active: activeKey[subMenuKey] === eventKey,
    isSelected: selectedKeys.indexOf(eventKey) !== -1
  };
})(MenuItem);

exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUvTWVudUl0ZW0uanN4Il0sIm5hbWVzIjpbIk1lbnVJdGVtIiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJyb290UHJlZml4Q2xzIiwiUHJvcFR5cGVzIiwiZXZlbnRLZXkiLCJhY3RpdmUiLCJjaGlsZHJlbiIsInNlbGVjdGVkS2V5cyIsImRpc2FibGVkIiwidGl0bGUiLCJvbkl0ZW1Ib3ZlciIsIm9uU2VsZWN0Iiwib25DbGljayIsIm9uRGVzZWxlY3QiLCJwYXJlbnRNZW51Iiwib25EZXN0cm95Iiwib25Nb3VzZUVudGVyIiwib25Nb3VzZUxlYXZlIiwib25Nb3VzZURvd24iLCJmdW5jIiwiZ2V0RGVmYXVsdFByb3BzIiwibm9vcCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicHJvcHMiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudERpZFVwZGF0ZSIsIm9uS2V5RG93biIsImtleUNvZGUiLCJlIiwiS2V5Q29kZSIsImtleSIsImhvdmVyIiwiZG9tRXZlbnQiLCJtdWx0aXBsZSIsImlzU2VsZWN0ZWQiLCJpbmZvIiwia2V5UGF0aCIsIml0ZW0iLCJnZXRQcmVmaXhDbHMiLCJnZXRBY3RpdmVDbGFzc05hbWUiLCJnZXRTZWxlY3RlZENsYXNzTmFtZSIsImdldERpc2FibGVkQ2xhc3NOYW1lIiwicmVuZGVyIiwiY2xhc3NOYW1lIiwiYXR0cnMiLCJyb2xlIiwibW91c2VFdmVudCIsInN0eWxlIiwibm90Rm91bmQiLCJjaGVja2JveCIsImFjdGl2ZUtleSIsInN1Yk1lbnVLZXkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsTUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsVUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsaUJBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxvQkFBQSxDQUFBLENBQUE7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Q0FBQSxRQUFBO0FBQUEsTUFBMEMrQyxVQUExQyxHQUFBLEtBQUEsQ0FBQSxVQUFBO0FBQUEsU0FBNEQ7QUFDakY5QyxJQUFBQSxNQUFNLEVBQUU2QyxTQUFTLENBQVRBLFVBQVMsQ0FBVEEsS0FEeUUsUUFBQTtBQUVqRmhCLElBQUFBLFVBQVUsRUFBRTNCLFlBQVksQ0FBWkEsT0FBQUEsQ0FBQUEsUUFBQUEsTUFBbUMsQ0FBQztBQUZpQyxHQUE1RDtBQUFSLENBQUEsRUFBQSxRQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBjcmVhdGVSZWFjdENsYXNzIGZyb20gJ2NyZWF0ZS1yZWFjdC1jbGFzcyc7XG5pbXBvcnQgS2V5Q29kZSBmcm9tICcuLi8uLi9fdXRpbC9LZXlDb2RlJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ21pbmktc3RvcmUnO1xuaW1wb3J0IG5vb3AgZnJvbSAnbG9kYXNoL25vb3AnO1xuaW1wb3J0IENoZWNrYm94IGZyb20gJy4uLy4uL2NoZWNrYm94L0NoZWNrYm94JztcbmltcG9ydCBSaXBwbGUgZnJvbSAnLi4vLi4vcmlwcGxlJztcbi8qIGVzbGludCByZWFjdC9uby1pcy1tb3VudGVkOjAgKi9cblxuY29uc3QgTWVudUl0ZW0gPSBjcmVhdGVSZWFjdENsYXNzKHtcbiAgZGlzcGxheU5hbWU6ICdNZW51SXRlbScsXG5cbiAgcHJvcFR5cGVzOiB7XG4gICAgcm9vdFByZWZpeENsczogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBldmVudEtleTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBhY3RpdmU6IFByb3BUeXBlcy5ib29sLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgIHNlbGVjdGVkS2V5czogUHJvcFR5cGVzLmFycmF5LFxuICAgIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgICB0aXRsZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBvbkl0ZW1Ib3ZlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25TZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uRGVzZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICAgIHBhcmVudE1lbnU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgb25EZXN0cm95OiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbk1vdXNlRW50ZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uTW91c2VMZWF2ZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25Nb3VzZURvd246IFByb3BUeXBlcy5mdW5jLFxuICB9LFxuXG4gIGdldERlZmF1bHRQcm9wcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb25TZWxlY3Q6IG5vb3AsXG4gICAgICBvbk1vdXNlRW50ZXI6IG5vb3AsXG4gICAgICBvbk1vdXNlTGVhdmU6IG5vb3AsXG4gICAgICBvbk1vdXNlRG93bjogbm9vcCxcbiAgICB9O1xuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wcztcbiAgICBpZiAocHJvcHMub25EZXN0cm95KSB7XG4gICAgICBwcm9wcy5vbkRlc3Ryb3kocHJvcHMuZXZlbnRLZXkpO1xuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAvLyBpbnZva2UgY3VzdG9taXplZCByZWYgdG8gZXhwb3NlIGNvbXBvbmVudCB0byBtaXhpblxuICAgIGlmICh0aGlzLnByb3BzLm1hbnVhbFJlZikge1xuICAgICAgdGhpcy5wcm9wcy5tYW51YWxSZWYodGhpcyk7XG4gICAgfVxuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICAvLyBpbnZva2UgY3VzdG9taXplZCByZWYgdG8gZXhwb3NlIGNvbXBvbmVudCB0byBtaXhpblxuICAgIGlmICh0aGlzLnByb3BzLm1hbnVhbFJlZikge1xuICAgICAgdGhpcy5wcm9wcy5tYW51YWxSZWYodGhpcyk7XG4gICAgfVxuICB9LFxuXG4gIG9uS2V5RG93bihlKSB7XG4gICAgY29uc3Qga2V5Q29kZSA9IGUua2V5Q29kZTtcbiAgICBpZiAoa2V5Q29kZSA9PT0gS2V5Q29kZS5FTlRFUikge1xuICAgICAgdGhpcy5vbkNsaWNrKGUpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9LFxuXG4gIG9uTW91c2VMZWF2ZShlKSB7XG4gICAgY29uc3QgeyBldmVudEtleSwgb25JdGVtSG92ZXIsIG9uTW91c2VMZWF2ZSB9ID0gdGhpcy5wcm9wcztcbiAgICBvbkl0ZW1Ib3Zlcih7XG4gICAgICBrZXk6IGV2ZW50S2V5LFxuICAgICAgaG92ZXI6IGZhbHNlLFxuICAgIH0pO1xuICAgIG9uTW91c2VMZWF2ZSh7XG4gICAgICBrZXk6IGV2ZW50S2V5LFxuICAgICAgZG9tRXZlbnQ6IGUsXG4gICAgfSk7XG4gIH0sXG5cbiAgb25Nb3VzZUVudGVyKGUpIHtcbiAgICBjb25zdCB7IGV2ZW50S2V5LCBvbkl0ZW1Ib3Zlciwgb25Nb3VzZUVudGVyIH0gPSB0aGlzLnByb3BzO1xuICAgIG9uSXRlbUhvdmVyKHtcbiAgICAgIGtleTogZXZlbnRLZXksXG4gICAgICBob3ZlcjogdHJ1ZSxcbiAgICB9KTtcbiAgICBvbk1vdXNlRW50ZXIoe1xuICAgICAga2V5OiBldmVudEtleSxcbiAgICAgIGRvbUV2ZW50OiBlLFxuICAgIH0pO1xuICB9LFxuXG4gIG9uQ2xpY2soZSkge1xuICAgIGNvbnN0IHsgZXZlbnRLZXksIG11bHRpcGxlLCBvbkNsaWNrLCBvblNlbGVjdCwgb25EZXNlbGVjdCwgaXNTZWxlY3RlZCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBpbmZvID0ge1xuICAgICAga2V5OiBldmVudEtleSxcbiAgICAgIGtleVBhdGg6IFtldmVudEtleV0sXG4gICAgICBpdGVtOiB0aGlzLFxuICAgICAgZG9tRXZlbnQ6IGUsXG4gICAgfTtcbiAgICBvbkNsaWNrKGluZm8pO1xuICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgaWYgKGlzU2VsZWN0ZWQpIHtcbiAgICAgICAgb25EZXNlbGVjdChpbmZvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9uU2VsZWN0KGluZm8pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIWlzU2VsZWN0ZWQpIHtcbiAgICAgIG9uU2VsZWN0KGluZm8pO1xuICAgIH1cbiAgfSxcblxuICBnZXRQcmVmaXhDbHMoKSB7XG4gICAgcmV0dXJuIGAke3RoaXMucHJvcHMucm9vdFByZWZpeENsc30taXRlbWA7XG4gIH0sXG5cbiAgZ2V0QWN0aXZlQ2xhc3NOYW1lKCkge1xuICAgIHJldHVybiBgJHt0aGlzLmdldFByZWZpeENscygpfS1hY3RpdmVgO1xuICB9LFxuXG4gIGdldFNlbGVjdGVkQ2xhc3NOYW1lKCkge1xuICAgIHJldHVybiBgJHt0aGlzLmdldFByZWZpeENscygpfS1zZWxlY3RlZGA7XG4gIH0sXG5cbiAgZ2V0RGlzYWJsZWRDbGFzc05hbWUoKSB7XG4gICAgcmV0dXJuIGAke3RoaXMuZ2V0UHJlZml4Q2xzKCl9LWRpc2FibGVkYDtcbiAgfSxcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IGNsYXNzTmFtZXModGhpcy5nZXRQcmVmaXhDbHMoKSwgcHJvcHMuY2xhc3NOYW1lLCB7XG4gICAgICBbdGhpcy5nZXRBY3RpdmVDbGFzc05hbWUoKV06ICFwcm9wcy5kaXNhYmxlZCAmJiBwcm9wcy5hY3RpdmUsXG4gICAgICBbdGhpcy5nZXRTZWxlY3RlZENsYXNzTmFtZSgpXTogcHJvcHMuaXNTZWxlY3RlZCxcbiAgICAgIFt0aGlzLmdldERpc2FibGVkQ2xhc3NOYW1lKCldOiBwcm9wcy5kaXNhYmxlZCxcbiAgICB9KTtcbiAgICBjb25zdCBhdHRycyA9IHtcbiAgICAgIC4uLnByb3BzLmF0dHJpYnV0ZSxcbiAgICAgIHRpdGxlOiBwcm9wcy50aXRsZSxcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIHJvbGU6ICdtZW51aXRlbScsXG4gICAgICAnYXJpYS1zZWxlY3RlZCc6IHByb3BzLmlzU2VsZWN0ZWQsXG4gICAgICAnYXJpYS1kaXNhYmxlZCc6IHByb3BzLmRpc2FibGVkLFxuICAgIH07XG4gICAgbGV0IG1vdXNlRXZlbnQgPSB7fTtcbiAgICBpZiAoIXByb3BzLmRpc2FibGVkKSB7XG4gICAgICBtb3VzZUV2ZW50ID0ge1xuICAgICAgICBvbkNsaWNrOiB0aGlzLm9uQ2xpY2ssXG4gICAgICAgIG9uTW91c2VMZWF2ZTogdGhpcy5vbk1vdXNlTGVhdmUsXG4gICAgICAgIG9uTW91c2VFbnRlcjogdGhpcy5vbk1vdXNlRW50ZXIsXG4gICAgICAgIG9uTW91c2VEb3duOiB0aGlzLnByb3BzLm9uTW91c2VEb3duLFxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3Qgc3R5bGUgPSB7XG4gICAgICAuLi5wcm9wcy5zdHlsZSxcbiAgICB9O1xuICAgIGlmIChwcm9wcy5tb2RlID09PSAnaW5saW5lJykge1xuICAgICAgc3R5bGUucGFkZGluZ0xlZnQgPSBwcm9wcy5pbmxpbmVJbmRlbnQgKiBwcm9wcy5sZXZlbDtcbiAgICB9XG5cbiAgICBjb25zdCBub3RGb3VuZCA9IHByb3BzLmV2ZW50S2V5ID09PSAnTk9UX0ZPVU5EJztcbiAgICBjb25zdCBjaGVja2JveCA9IHByb3BzLm11bHRpcGxlICYmICFub3RGb3VuZCA/IDxDaGVja2JveCBkaXNhYmxlZD17cHJvcHMuZGlzYWJsZWR9IGNoZWNrZWQ9e3Byb3BzLmlzU2VsZWN0ZWR9IHRhYkluZGV4PXstMX0gLz4gOiBudWxsO1xuICAgIHJldHVybiAoXG4gICAgICA8UmlwcGxlIGRpc2FibGVkPXtwcm9wcy5kaXNhYmxlZH0+XG4gICAgICAgIDxsaVxuICAgICAgICAgIHsuLi5hdHRyc31cbiAgICAgICAgICB7Li4ubW91c2VFdmVudH1cbiAgICAgICAgICBzdHlsZT17c3R5bGV9XG4gICAgICAgID5cbiAgICAgICAgICB7Y2hlY2tib3h9XG4gICAgICAgICAge3Byb3BzLmNoaWxkcmVufVxuICAgICAgICA8L2xpPlxuICAgICAgPC9SaXBwbGU+XG4gICAgKTtcbiAgfSxcbn0pO1xuXG5NZW51SXRlbS5pc01lbnVJdGVtID0gMTtcblxuZXhwb3J0IGRlZmF1bHQgY29ubmVjdCgoeyBhY3RpdmVLZXksIHNlbGVjdGVkS2V5cyB9LCB7IGV2ZW50S2V5LCBzdWJNZW51S2V5IH0pID0+ICh7XG4gIGFjdGl2ZTogYWN0aXZlS2V5W3N1Yk1lbnVLZXldID09PSBldmVudEtleSxcbiAgaXNTZWxlY3RlZDogc2VsZWN0ZWRLZXlzLmluZGV4T2YoZXZlbnRLZXkpICE9PSAtMSxcbn0pKShNZW51SXRlbSk7XG4iXX0=