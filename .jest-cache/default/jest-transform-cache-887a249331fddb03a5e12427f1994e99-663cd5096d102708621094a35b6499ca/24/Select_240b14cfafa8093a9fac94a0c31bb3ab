4d36b9a5fd829f210fd771718db3d3df
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _classnames3 = _interopRequireDefault(require("classnames"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var scrollTo = function scrollTo(element, to, duration) {
  var requestAnimationFrame = window.requestAnimationFrame || function requestAnimationFrameTimeout() {
    return setTimeout(arguments[0], 10);
  }; // jump to target if duration zero


  if (duration <= 0) {
    element.scrollTop = to;
    return;
  }

  var difference = to - element.scrollTop;
  var perTick = difference / duration * 10;
  requestAnimationFrame(function () {
    element.scrollTop = element.scrollTop + perTick;
    if (element.scrollTop === to) return;
    scrollTo(element, to, duration - 10);
  });
};

var Select =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Select, _Component);

  var _super = _createSuper(Select);

  function Select() {
    var _this;

    (0, _classCallCheck2["default"])(this, Select);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
      active: false
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onSelect", function (value) {
      var _this$props = _this.props,
          onSelect = _this$props.onSelect,
          type = _this$props.type;
      onSelect(type, value);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "handleMouseEnter", function (e) {
      _this.setState({
        active: true
      });

      _this.props.onMouseEnter(e);
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "handleMouseLeave", function () {
      _this.setState({
        active: false
      });
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "saveList", function (node) {
      _this.list = node;
    });
    return _this;
  }

  (0, _createClass2["default"])(Select, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      // jump to selected option
      this.scrollToSelected(0);
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      // smooth scroll to selected option
      if (prevProps.selectedIndex !== this.props.selectedIndex) {
        this.scrollToSelected(120);
      }
    }
  }, {
    key: "getOptions",
    value: function getOptions() {
      var _this2 = this;

      var _this$props2 = this.props,
          options = _this$props2.options,
          selectedIndex = _this$props2.selectedIndex,
          prefixCls = _this$props2.prefixCls;
      return options.map(function (item, index) {
        var _classnames;

        var cls = (0, _classnames3["default"])((_classnames = {}, (0, _defineProperty2["default"])(_classnames, "".concat(prefixCls, "-select-option-selected"), selectedIndex === index), (0, _defineProperty2["default"])(_classnames, "".concat(prefixCls, "-select-option-disabled"), item.disabled), _classnames));
        var onclick = null;

        if (!item.disabled) {
          onclick = _this2.onSelect.bind(_this2, item.value);
        }

        return _react["default"].createElement("li", {
          className: cls,
          key: index,
          onClick: onclick,
          disabled: item.disabled
        }, item.value);
      });
    }
  }, {
    key: "scrollToSelected",
    value: function scrollToSelected(duration) {
      // move to selected item
      var select = _reactDom["default"].findDOMNode(this);

      var list = _reactDom["default"].findDOMNode(this.list);

      if (!list) {
        return;
      }

      var index = this.props.selectedIndex;

      if (index < 0) {
        index = 0;
      }

      var topOption = list.children[index];
      var to = topOption.offsetTop;
      scrollTo(select, to, duration);
    }
  }, {
    key: "render",
    value: function render() {
      var _classnames2;

      if (this.props.options.length === 0) {
        return null;
      }

      var prefixCls = this.props.prefixCls;
      var cls = (0, _classnames3["default"])((_classnames2 = {}, (0, _defineProperty2["default"])(_classnames2, "".concat(prefixCls, "-select"), 1), (0, _defineProperty2["default"])(_classnames2, "".concat(prefixCls, "-select-active"), this.state.active), _classnames2));
      return _react["default"].createElement("div", {
        className: cls,
        onMouseEnter: this.handleMouseEnter,
        onMouseLeave: this.handleMouseLeave
      }, _react["default"].createElement("ul", {
        ref: this.saveList
      }, this.getOptions()));
    }
  }]);
  return Select;
}(_react.Component);

(0, _defineProperty2["default"])(Select, "propTypes", {
  prefixCls: _propTypes["default"].string,
  options: _propTypes["default"].array,
  selectedIndex: _propTypes["default"].number,
  type: _propTypes["default"].string,
  onSelect: _propTypes["default"].func,
  onMouseEnter: _propTypes["default"].func
});
var _default = Select;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlbGVjdC5qc3giXSwibmFtZXMiOlsic2Nyb2xsVG8iLCJlbGVtZW50IiwidG8iLCJkdXJhdGlvbiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZVRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiYXJndW1lbnRzIiwic2Nyb2xsVG9wIiwiZGlmZmVyZW5jZSIsInBlclRpY2siLCJTZWxlY3QiLCJhY3RpdmUiLCJ2YWx1ZSIsInByb3BzIiwib25TZWxlY3QiLCJ0eXBlIiwiZSIsInNldFN0YXRlIiwib25Nb3VzZUVudGVyIiwibm9kZSIsImxpc3QiLCJzY3JvbGxUb1NlbGVjdGVkIiwicHJldlByb3BzIiwic2VsZWN0ZWRJbmRleCIsIm9wdGlvbnMiLCJwcmVmaXhDbHMiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJjbHMiLCJkaXNhYmxlZCIsIm9uY2xpY2siLCJiaW5kIiwic2VsZWN0IiwiUmVhY3REb20iLCJmaW5kRE9NTm9kZSIsInRvcE9wdGlvbiIsImNoaWxkcmVuIiwib2Zmc2V0VG9wIiwibGVuZ3RoIiwic3RhdGUiLCJoYW5kbGVNb3VzZUVudGVyIiwiaGFuZGxlTW91c2VMZWF2ZSIsInNhdmVMaXN0IiwiZ2V0T3B0aW9ucyIsIkNvbXBvbmVudCIsIlByb3BUeXBlcyIsInN0cmluZyIsImFycmF5IiwibnVtYmVyIiwiZnVuYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsUUFBUSxHQUFHLFNBQVhBLFFBQVcsQ0FBQ0MsT0FBRCxFQUFVQyxFQUFWLEVBQWNDLFFBQWQsRUFBMkI7QUFDMUMsTUFBTUMscUJBQXFCLEdBQUdDLE1BQU0sQ0FBQ0QscUJBQVAsSUFDNUIsU0FBU0UsNEJBQVQsR0FBd0M7QUFDdEMsV0FBT0MsVUFBVSxDQUFDQyxTQUFTLENBQUMsQ0FBRCxD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QUFHakJ6QixFQUFBQSxhQUFhLEVBQUV1QixzQkFBVUcsTUFIUjtBQUlqQmxDLEVBQUFBLElBQUksRUFBRStCLHNCQUFVQyxNQUpDO0FBS2pCakMsRUFBQUEsUUFBUSxFQUFFZ0Msc0JBQVVJLElBTEg7QUFNakJoQyxFQUFBQSxZQUFZLEVBQUU0QixzQkFBVUk7QUFOUCxDO2VBd0dOeEMsTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0RG9tIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuY29uc3Qgc2Nyb2xsVG8gPSAoZWxlbWVudCwgdG8sIGR1cmF0aW9uKSA9PiB7XG4gIGNvbnN0IHJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICBmdW5jdGlvbiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVUaW1lb3V0KCkge1xuICAgICAgcmV0dXJuIHNldFRpbWVvdXQoYXJndW1lbnRzWzBdLCAxMCk7XG4gICAgfTtcbiAgLy8ganVtcCB0byB0YXJnZXQgaWYgZHVyYXRpb24gemVyb1xuICBpZiAoZHVyYXRpb24gPD0gMCkge1xuICAgIGVsZW1lbnQuc2Nyb2xsVG9wID0gdG87XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGRpZmZlcmVuY2UgPSB0byAtIGVsZW1lbnQuc2Nyb2xsVG9wO1xuICBjb25zdCBwZXJUaWNrID0gZGlmZmVyZW5jZSAvIGR1cmF0aW9uICogMTA7XG5cbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICBlbGVtZW50LnNjcm9sbFRvcCA9IGVsZW1lbnQuc2Nyb2xsVG9wICsgcGVyVGljaztcbiAgICBpZiAoZWxlbWVudC5zY3JvbGxUb3AgPT09IHRvKSByZXR1cm47XG4gICAgc2Nyb2xsVG8oZWxlbWVudCwgdG8sIGR1cmF0aW9uIC0gMTApO1xuICB9KTtcbn07XG5cbmNsYXNzIFNlbGVjdCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgcHJlZml4Q2xzOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIG9wdGlvbnM6IFByb3BUeXBlcy5hcnJheSxcbiAgICBzZWxlY3RlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgb25TZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uTW91c2VFbnRlcjogUHJvcFR5cGVzLmZ1bmMsXG4gIH07XG5cbiAgc3RhdGUgPSB7XG4gICAgYWN0aXZlOiBmYWxzZSxcbiAgfTtcblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAvLyBqdW1wIHRvIHNlbGVjdGVkIG9wdGlvblxuICAgIHRoaXMuc2Nyb2xsVG9TZWxlY3RlZCgwKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMpIHtcbiAgICAvLyBzbW9vdGggc2Nyb2xsIHRvIHNlbGVjdGVkIG9wdGlvblxuICAgIGlmIChwcmV2UHJvcHMuc2VsZWN0ZWRJbmRleCAhPT0gdGhpcy5wcm9wcy5zZWxlY3RlZEluZGV4KSB7XG4gICAgICB0aGlzLnNjcm9sbFRvU2VsZWN0ZWQoMTIwKTtcbiAgICB9XG4gIH1cblxuICBvblNlbGVjdCA9ICh2YWx1ZSkgPT4ge1xuICAgIGNvbnN0IHsgb25TZWxlY3QsIHR5cGUgfSA9IHRoaXMucHJvcHM7XG4gICAgb25TZWxlY3QodHlwZSwgdmFsdWUpO1xuICB9XG5cbiAgZ2V0T3B0aW9ucygpIHtcbiAgICBjb25zdCB7IG9wdGlvbnMsIHNlbGVjdGVkSW5kZXgsIHByZWZpeENscyB9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gb3B0aW9ucy5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjbHMgPSBjbGFzc25hbWVzKHtcbiAgICAgICAgW2Ake3ByZWZpeENsc30tc2VsZWN0LW9wdGlvbi1zZWxlY3RlZGBdOiBzZWxlY3RlZEluZGV4ID09PSBpbmRleCxcbiAgICAgICAgW2Ake3ByZWZpeENsc30tc2VsZWN0LW9wdGlvbi1kaXNhYmxlZGBdOiBpdGVtLmRpc2FibGVkLFxuICAgICAgfSk7XG4gICAgICBsZXQgb25jbGljayA9IG51bGw7XG4gICAgICBpZiAoIWl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgICAgb25jbGljayA9IHRoaXMub25TZWxlY3QuYmluZCh0aGlzLCBpdGVtLnZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoPGxpXG4gICAgICAgIGNsYXNzTmFtZT17Y2xzfVxuICAgICAgICBrZXk9e2luZGV4fVxuICAgICAgICBvbkNsaWNrPXtvbmNsaWNrfVxuICAgICAgICBkaXNhYmxlZD17aXRlbS5kaXNhYmxlZH1cbiAgICAgID5cbiAgICAgICAge2l0ZW0udmFsdWV9XG4gICAgICA8L2xpPik7XG4gICAgfSk7XG4gIH1cblxuICBzY3JvbGxUb1NlbGVjdGVkKGR1cmF0aW9uKSB7XG4gICAgLy8gbW92ZSB0byBzZWxlY3RlZCBpdGVtXG4gICAgY29uc3Qgc2VsZWN0ID0gUmVhY3REb20uZmluZERPTU5vZGUodGhpcyk7XG4gICAgY29uc3QgbGlzdCA9IFJlYWN0RG9tLmZpbmRET01Ob2RlKHRoaXMubGlzdCk7XG4gICAgaWYgKCFsaXN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCBpbmRleCA9IHRoaXMucHJvcHMuc2VsZWN0ZWRJbmRleDtcbiAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICBpbmRleCA9IDA7XG4gICAgfVxuICAgIGNvbnN0IHRvcE9wdGlvbiA9IGxpc3QuY2hpbGRyZW5baW5kZXhdO1xuICAgIGNvbnN0IHRvID0gdG9wT3B0aW9uLm9mZnNldFRvcDtcbiAgICBzY3JvbGxUbyhzZWxlY3QsIHRvLCBkdXJhdGlvbik7XG4gIH1cblxuICBoYW5kbGVNb3VzZUVudGVyID0gKGUpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlOiB0cnVlIH0pO1xuICAgIHRoaXMucHJvcHMub25Nb3VzZUVudGVyKGUpO1xuICB9XG5cbiAgaGFuZGxlTW91c2VMZWF2ZSA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgYWN0aXZlOiBmYWxzZSB9KTtcbiAgfVxuXG4gIHNhdmVMaXN0ID0gKG5vZGUpID0+IHtcbiAgICB0aGlzLmxpc3QgPSBub2RlO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICh0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB7IHByZWZpeENscyB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBjbHMgPSBjbGFzc25hbWVzKHtcbiAgICAgIFtgJHtwcmVmaXhDbHN9LXNlbGVjdGBdOiAxLFxuICAgICAgW2Ake3ByZWZpeENsc30tc2VsZWN0LWFjdGl2ZWBdOiB0aGlzLnN0YXRlLmFjdGl2ZSxcbiAgICB9KTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17Y2xzfVxuICAgICAgICBvbk1vdXNlRW50ZXI9e3RoaXMuaGFuZGxlTW91c2VFbnRlcn1cbiAgICAgICAgb25Nb3VzZUxlYXZlPXt0aGlzLmhhbmRsZU1vdXNlTGVhdmV9XG4gICAgICA+XG4gICAgICAgIDx1bCByZWY9e3RoaXMuc2F2ZUxpc3R9Pnt0aGlzLmdldE9wdGlvbnMoKX08L3VsPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWxlY3Q7XG4iXX0=