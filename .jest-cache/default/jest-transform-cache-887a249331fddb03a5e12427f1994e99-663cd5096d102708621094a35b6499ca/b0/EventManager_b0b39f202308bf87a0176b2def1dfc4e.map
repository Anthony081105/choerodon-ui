{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components/_util/EventManager.tsx"],"names":[],"mappings":"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","sourcesContent":["function on(eventName: string, fn: Function, el?: any, useCapture?: boolean): void {\n  if (el) {\n    if (el.addEventListener) {\n      el.addEventListener(eventName, fn, useCapture);\n    } else if (el.attachEvent) {\n      el.attachEvent(`on${eventName}`, fn);\n    }\n  }\n}\n\nfunction off(eventName: string, fn: Function, el?: any, useCapture?: boolean): void {\n  if (el) {\n    if (el.removeEventListener) {\n      el.removeEventListener(eventName, fn, useCapture);\n    } else if (el.attachEvent) {\n      el.detachEvent(`on${eventName}`, fn);\n    }\n  }\n}\n\ntype handler = [Function, boolean];\n\nexport default class EventManager {\n  events: { [eventName: string]: handler[] } = {};\n\n  el?: any;\n\n  constructor(el?: any) {\n    this.el = el;\n  }\n\n  addEventListener(eventName: string, fn: Function, useCapture: boolean = false): EventManager {\n    eventName = eventName.toLowerCase();\n    const events: handler[] = this.events[eventName] || [];\n    const index = events.findIndex(([event]) => event === fn);\n    if (index === -1) {\n      events.push([fn, useCapture]);\n      this.events[eventName] = events;\n      on(eventName, fn, this.el, useCapture);\n    }\n    return this;\n  }\n\n  removeEventListener(eventName: string, fn?: Function, useCapture: boolean = false): EventManager {\n    eventName = eventName.toLowerCase();\n    const events: handler[] = this.events[eventName];\n    if (events) {\n      if (fn) {\n        const index = events.findIndex(([event]) => event === fn);\n        if (index !== -1) {\n          events.splice(index, 1);\n        }\n        off(eventName, fn, this.el, useCapture);\n      } else {\n        this.events[eventName] = this.el\n          ? (this.events[eventName] || []).filter(([event, capture]) => {\n              off(eventName, event, this.el, capture);\n              return false;\n            })\n          : [];\n      }\n    }\n    return this;\n  }\n\n  fireEvent(eventName: string, ...rest: any[]): Promise<boolean> {\n    const events: handler[] = this.events[eventName.toLowerCase()];\n    return events\n      ? Promise.all(events.map(([fn]) => fn(...rest))).then(all =>\n          all.every(result => result !== false),\n        )\n      : Promise.resolve(true);\n  }\n\n  clear(): EventManager {\n    if (this.el) {\n      Object.keys(this.events).forEach(eventName => this.removeEventListener(eventName));\n    }\n    this.events = {};\n    return this;\n  }\n}\n\nexport function preventDefault(e) {\n  e.preventDefault();\n}\n\nexport function stopPropagation(e) {\n  e.stopPropagation();\n}\n\nexport function stopEvent(e) {\n  preventDefault(e);\n  stopPropagation(e);\n}\n"]}