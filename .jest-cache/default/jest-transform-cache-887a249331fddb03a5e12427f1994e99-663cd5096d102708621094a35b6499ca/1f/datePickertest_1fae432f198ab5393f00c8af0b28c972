71edd2918c45e74b5d1ee2f348392bef
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _moment = _interopRequireDefault(require("moment"));

var _ = _interopRequireDefault(require(".."));

var _DatePicker = _interopRequireDefault(require("./DatePicker"));

var _utils = require("./utils");

var _focusTest = _interopRequireDefault(require("../../../tests/shared/focusTest"));

var _triggerPopTest = _interopRequireDefault(require("../../../tests/shared/triggerPopTest"));

describe('date-picker-pro', function () {
  (0, _focusTest["default"])(_["default"]);
  (0, _triggerPopTest["default"])(_["default"]);
  beforeEach(function () {
    jest.useFakeTimers();
  });
  afterEach(function () {
    jest.useRealTimers();
  });
  it('renders multiple correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      defaultValue: "2020-02-10 18:18:18"
    }));
    expect(wrapper.find('input').at(0).prop('value')).toBe('2020-02-10');
    wrapper.setProps({
      multiple: true
    });
    wrapper.update();
    expect(wrapper.find('.c7n-pro-calendar-picker-wrapper').at(0).hasClass('c7n-pro-calendar-picker-multiple')).toBe(true);
  });
  it('renders dataSet date correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_DatePicker["default"], null));
    expect(wrapper.find('DatePicker').props().name).toEqual('date');
    expect(wrapper.find('.c7n-pro-calendar-picker-wrapper').at(0).hasClass('c7n-pro-calendar-picker-multiple')).toBe(false);
    expect(wrapper.find('.c7n-pro-calendar-picker-range-end').at(0).prop('value')).toBe('2020-02-09');
    expect(wrapper.find('.c7n-pro-calendar-picker-range-start').at(0).prop('value')).toBe('1984-11-22');
  });
  it('the onChange event only triggers when date was selected or changed', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      onChange: handleChange
    }));
    (0, _utils.openPanel)(wrapper);
    (0, _utils.nextYear)(wrapper);
    expect(handleChange).not.toHaveBeenCalled();
    (0, _utils.nextMonth)(wrapper);
    expect(handleChange).not.toHaveBeenCalled();
  });
  it('the keydown event should render correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "date",
      multiple: false
    }));
    wrapper.find('input').simulate('click');
    jest.runAllTimers();
    wrapper.update();
    (0, _utils.simulateCode)(wrapper, 39);
    (0, _utils.simulateCode)(wrapper, 37);
    (0, _utils.simulateCode)(wrapper, 40);
    (0, _utils.simulateCode)(wrapper, 38);
    (0, _utils.simulateCode)(wrapper, 35);
    (0, _utils.simulateCode)(wrapper, 36);
    (0, _utils.simulateCode)(wrapper, 33);
    (0, _utils.simulateCode)(wrapper, 34);
    (0, _utils.simulateCode)(wrapper, 13);
    (0, _utils.simulateCode)(wrapper, 10);
    wrapper.update();
  });
  it('the keyDown event {space} keyCode should render correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], null));
    wrapper.find('input').simulate('keydown', {
      keyCode: 32
    });
    jest.runAllTimers();
    wrapper.update();
  });
  it('the mode { decade } should render correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "decade"
    }));
    wrapper.find('input').simulate('keydown', {
      keyCode: 32
    });
    jest.runAllTimers();
    wrapper.update();
  });
  it('the keyDown event { esc, enter } keyCode should render correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], null));
    wrapper.find('input').simulate('click');
    jest.runAllTimers();
    wrapper.update();
    (0, _utils.simulateCode)(wrapper, 9);
    wrapper.update();
    wrapper.find('input').simulate('click');
    jest.runAllTimers();
    (0, _utils.simulateCode)(wrapper, 27);
    wrapper.update();
  });
  it('the { multiple, min, max } property should render correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "month",
      multiple: true,
      min: (0, _moment["default"])('2019-02-10'),
      max: (0, _moment["default"])('2021-02-10')
    }));
    wrapper.find('input').at(0).simulate('click');
    jest.runAllTimers();
    wrapper.update();
    wrapper.find('input').at(0).simulate('keydown', {
      keyCode: 13
    });
    jest.runAllTimers();
    wrapper.update();
  });
  it('the { min, max } property should render month-picker correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "month",
      min: (0, _moment["default"])('2019-02-10'),
      max: (0, _moment["default"])('2021-02-10')
    }));
    wrapper.find('input').at(0).simulate('click');
    jest.runAllTimers();
    wrapper.update();
  });
  it('read only when setting read-only', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      readOnly: true
    }));
    var isReadOnly = wrapper.find('input').at(0).prop('readOnly');
    expect(isReadOnly).toBe(true);
  });
  it('the { min, max } property should render year-picker correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "year",
      min: (0, _moment["default"])('2019-02-10'),
      max: (0, _moment["default"])('2021-02-10')
    }));
    wrapper.find('input').at(0).simulate('click');
    jest.runAllTimers();
    wrapper.update();
  });
  it('the { min, max } property should render date-time-picker correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "dateTime",
      min: (0, _moment["default"])('2019-02-10'),
      max: (0, _moment["default"])('2021-02-10')
    }));
    wrapper.find('input').at(0).simulate('click');
    jest.runAllTimers();
    wrapper.update();
  });
  it('the { min, max } property should render decadeYear-picker correctly', function () {
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      mode: "decade",
      min: (0, _moment["default"])('2019-02-10'),
      max: (0, _moment["default"])('2021-02-10')
    }));
    wrapper.find('input').at(0).simulate('click');
    jest.runAllTimers();
    wrapper.update();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGVQaWNrZXIudGVzdC5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIkRhdGVQaWNrZXIiLCJiZWZvcmVFYWNoIiwiamVzdCIsInVzZUZha2VUaW1lcnMiLCJhZnRlckVhY2giLCJ1c2VSZWFsVGltZXJzIiwiaXQiLCJ3cmFwcGVyIiwiZXhwZWN0IiwiZmluZCIsImF0IiwicHJvcCIsInRvQmUiLCJzZXRQcm9wcyIsIm11bHRpcGxlIiwidXBkYXRlIiwiaGFzQ2xhc3MiLCJwcm9wcyIsIm5hbWUiLCJ0b0VxdWFsIiwiaGFuZGxlQ2hhbmdlIiwiZm4iLCJub3QiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwic2ltdWxhdGUiLCJydW5BbGxUaW1lcnMiLCJrZXlDb2RlIiwiaXNSZWFkT25seSJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBQSxRQUFRLENBQUMsaUJBQUQsRUFBb0IsWUFBTTtBQUNoQyw2QkFBVUMsWUFBVjtBQUNBLGtDQUFlQSxZQUFmO0FBRUFDLEVBQUFBLFVBQVUsQ0FBQyxZQUFNO0FBQ2ZDLElBQUFBLElBQUksQ0FBQ0MsYUFBTDtBQUNELEdBRlMsQ0FBVjtBQUlBQyxFQUFBQSxTQUFTLENBQUMsWUFBTTtBQUNkRixJQUFBQSxJQUFJLENBQUNHLGFBQUw7QUFDRCxHQUZRLENBQVQ7QUFJQUMsRUFBQUEsRUFBRSxDQUFDLDRCQUFELEVBQStCLFlBQU07QUFDckMsUUFBTUMsT0FBTyxHQUFHLG1CQUFNLGdDQUFDLFlBQUQ7QUFBWSxNQUFBLFlBQVksRUFBQztBQUF6QixNQUFOLENBQWhCO0FBQ0FDLElBQUFBLE1BQU0sQ0FDSkQsT0FBTyxDQUNKRSxJQURILENBQ1EsT0FEUixFQUVHQyxFQUZILENBRU0sQ0FGTixFQUdHQyxJQUhILENBR1EsT0FIUixDQURJLENBQU4sQ0FLRUMsSUFMRixDQUtPLFlBTFA7QUFNQUwsSUFBQUEsT0FBTyxDQUFDTSxRQUFSLENBQWlCO0FB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UUFISCxDQUdZLE9BSFo7QUFJQXRCLElBQUFBLElBQUksQ0FBQ3VCLFlBQUw7QUFDQWxCLElBQUFBLE9BQU8sQ0FBQ1EsTUFBUjtBQUNELEdBVkMsQ0FBRjtBQVlBVCxFQUFBQSxFQUFFLENBQUMscUVBQUQsRUFBd0UsWUFBTTtBQUM5RSxRQUFNQyxPQUFPLEdBQUcsbUJBQ2QsZ0NBQUMsWUFBRDtBQUFZLE1BQUEsSUFBSSxFQUFDLFFBQWpCO0FBQTBCLE1BQUEsR0FBRyxFQUFFLHdCQUFPLFlBQVAsQ0FBL0I7QUFBcUQsTUFBQSxHQUFHLEVBQUUsd0JBQU8sWUFBUDtBQUExRCxNQURjLENBQWhCO0FBR0FBLElBQUFBLE9BQU8sQ0FDSkUsSUFESCxDQUNRLE9BRFIsRUFFR0MsRUFGSCxDQUVNLENBRk4sRUFHR2MsUUFISCxDQUdZLE9BSFo7QUFJQXRCLElBQUFBLElBQUksQ0FBQ3VCLFlBQUw7QUFDQWxCLElBQUFBLE9BQU8sQ0FBQ1EsTUFBUjtBQUNELEdBVkMsQ0FBRjtBQVdELENBdExPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbW91bnQgfSBmcm9tICdlbnp5bWUnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IERhdGVQaWNrZXIgZnJvbSAnLi4nO1xuaW1wb3J0IERhdGVQaWNrZXJUZXN0IGZyb20gJy4vRGF0ZVBpY2tlcic7XG5pbXBvcnQgeyBvcGVuUGFuZWwsIG5leHRZZWFyLCBuZXh0TW9udGgsIHNpbXVsYXRlQ29kZSB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IGZvY3VzVGVzdCBmcm9tICcuLi8uLi8uLi90ZXN0cy9zaGFyZWQvZm9jdXNUZXN0JztcbmltcG9ydCBUcmlnZ2VyUG9wVGVzdCBmcm9tICcuLi8uLi8uLi90ZXN0cy9zaGFyZWQvdHJpZ2dlclBvcFRlc3QnO1xuXG5kZXNjcmliZSgnZGF0ZS1waWNrZXItcHJvJywgKCkgPT4ge1xuICBmb2N1c1Rlc3QoRGF0ZVBpY2tlcik7XG4gIFRyaWdnZXJQb3BUZXN0KERhdGVQaWNrZXIpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuICB9KTtcblxuICBpdCgncmVuZGVycyBtdWx0aXBsZSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxEYXRlUGlja2VyIGRlZmF1bHRWYWx1ZT1cIjIwMjAtMDItMTAgMTg6MTg6MThcIiAvPik7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKCcyMDIwLTAyLTEwJyk7XG4gICAgd3JhcHBlci5zZXRQcm9wcyh7IG11bHRpcGxlOiB0cnVlIH0pO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnLmM3bi1wcm8tY2FsZW5kYXItcGlja2VyLXdyYXBwZXInKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLmhhc0NsYXNzKCdjN24tcHJvLWNhbGVuZGFyLXBpY2tlci1tdWx0aXBsZScpLFxuICAgICkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgaXQoJ3JlbmRlcnMgZGF0YVNldCBkYXRlIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPERhdGVQaWNrZXJUZXN0IC8+KTtcbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCdEYXRlUGlja2VyJykucHJvcHMoKS5uYW1lKS50b0VxdWFsKCdkYXRlJyk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnLmM3bi1wcm8tY2FsZW5kYXItcGlja2VyLXdyYXBwZXInKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLmhhc0NsYXNzKCdjN24tcHJvLWNhbGVuZGFyLXBpY2tlci1tdWx0aXBsZScpLFxuICAgICkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnLmM3bi1wcm8tY2FsZW5kYXItcGlja2VyLXJhbmdlLWVuZCcpXG4gICAgICAgIC5hdCgwKVxuICAgICAgICAucHJvcCgndmFsdWUnKSxcbiAgICApLnRvQmUoJzIwMjAtMDItMDknKTtcbiAgICBleHBlY3QoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCcuYzduLXByby1jYWxlbmRhci1waWNrZXItcmFuZ2Utc3RhcnQnKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLnByb3AoJ3ZhbHVlJyksXG4gICAgKS50b0JlKCcxOTg0LTExLTIyJyk7XG4gIH0pO1xuXG4gIGl0KCd0aGUgb25DaGFuZ2UgZXZlbnQgb25seSB0cmlnZ2VycyB3aGVuIGRhdGUgd2FzIHNlbGVjdGVkIG9yIGNoYW5nZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudCg8RGF0ZVBpY2tlciBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfSAvPik7XG4gICAgb3BlblBhbmVsKHdyYXBwZXIpO1xuICAgIG5leHRZZWFyKHdyYXBwZXIpO1xuICAgIGV4cGVjdChoYW5kbGVDaGFuZ2UpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgbmV4dE1vbnRoKHdyYXBwZXIpO1xuICAgIGV4cGVjdChoYW5kbGVDaGFuZ2UpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIGl0KCd0aGUga2V5ZG93biBldmVudCBzaG91bGQgcmVuZGVyIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPERhdGVQaWNrZXIgbW9kZT1cImRhdGVcIiBtdWx0aXBsZT17ZmFsc2V9IC8+KTtcbiAgICB3cmFwcGVyLmZpbmQoJ2lucHV0Jykuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCAzOSk7XG4gICAgc2ltdWxhdGVDb2RlKHdyYXBwZXIsIDM3KTtcbiAgICBzaW11bGF0ZUNvZGUod3JhcHBlciwgNDApO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCAzOCk7XG4gICAgc2ltdWxhdGVDb2RlKHdyYXBwZXIsIDM1KTtcbiAgICBzaW11bGF0ZUNvZGUod3JhcHBlciwgMzYpO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCAzMyk7XG4gICAgc2ltdWxhdGVDb2RlKHdyYXBwZXIsIDM0KTtcbiAgICBzaW11bGF0ZUNvZGUod3JhcHBlciwgMTMpO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCAxMCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSBrZXlEb3duIGV2ZW50IHtzcGFjZX0ga2V5Q29kZSBzaG91bGQgcmVuZGVyIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPERhdGVQaWNrZXIgLz4pO1xuICAgIHdyYXBwZXIuZmluZCgnaW5wdXQnKS5zaW11bGF0ZSgna2V5ZG93bicsIHsga2V5Q29kZTogMzIgfSk7XG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICB9KTtcblxuICBpdCgndGhlIG1vZGUgeyBkZWNhZGUgfSBzaG91bGQgcmVuZGVyIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoPERhdGVQaWNrZXIgbW9kZT1cImRlY2FkZVwiIC8+KTtcbiAgICB3cmFwcGVyLmZpbmQoJ2lucHV0Jykuc2ltdWxhdGUoJ2tleWRvd24nLCB7IGtleUNvZGU6IDMyIH0pO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSBrZXlEb3duIGV2ZW50IHsgZXNjLCBlbnRlciB9IGtleUNvZGUgc2hvdWxkIHJlbmRlciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxEYXRlUGlja2VyIC8+KTtcbiAgICB3cmFwcGVyLmZpbmQoJ2lucHV0Jykuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCA5KTtcbiAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgIHdyYXBwZXIuZmluZCgnaW5wdXQnKS5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIHNpbXVsYXRlQ29kZSh3cmFwcGVyLCAyNyk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSB7IG11bHRpcGxlLCBtaW4sIG1heCB9IHByb3BlcnR5IHNob3VsZCByZW5kZXIgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxEYXRlUGlja2VyIG1vZGU9XCJtb250aFwiIG11bHRpcGxlIG1pbj17bW9tZW50KCcyMDE5LTAyLTEwJyl9IG1heD17bW9tZW50KCcyMDIxLTAyLTEwJyl9IC8+LFxuICAgICk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJ2lucHV0JylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICB3cmFwcGVyXG4gICAgICAuZmluZCgnaW5wdXQnKVxuICAgICAgLmF0KDApXG4gICAgICAuc2ltdWxhdGUoJ2tleWRvd24nLCB7IGtleUNvZGU6IDEzIH0pO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSB7IG1pbiwgbWF4IH0gcHJvcGVydHkgc2hvdWxkIHJlbmRlciBtb250aC1waWNrZXIgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxEYXRlUGlja2VyIG1vZGU9XCJtb250aFwiIG1pbj17bW9tZW50KCcyMDE5LTAyLTEwJyl9IG1heD17bW9tZW50KCcyMDIxLTAyLTEwJyl9IC8+LFxuICAgICk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJ2lucHV0JylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3JlYWQgb25seSB3aGVuIHNldHRpbmcgcmVhZC1vbmx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxEYXRlUGlja2VyIHJlYWRPbmx5IC8+LFxuICAgICk7XG4gICAgY29uc3QgaXNSZWFkT25seSA9IHdyYXBwZXIuZmluZCgnaW5wdXQnKVxuICAgICAgLmF0KDApXG4gICAgICAucHJvcCgncmVhZE9ubHknKTtcbiAgICBleHBlY3QoaXNSZWFkT25seSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSB7IG1pbiwgbWF4IH0gcHJvcGVydHkgc2hvdWxkIHJlbmRlciB5ZWFyLXBpY2tlciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPERhdGVQaWNrZXIgbW9kZT1cInllYXJcIiBtaW49e21vbWVudCgnMjAxOS0wMi0xMCcpfSBtYXg9e21vbWVudCgnMjAyMS0wMi0xMCcpfSAvPixcbiAgICApO1xuICAgIHdyYXBwZXJcbiAgICAgIC5maW5kKCdpbnB1dCcpXG4gICAgICAuYXQoMClcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gIH0pO1xuICBpdCgndGhlIHsgbWluLCBtYXggfSBwcm9wZXJ0eSBzaG91bGQgcmVuZGVyIGRhdGUtdGltZS1waWNrZXIgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIDxEYXRlUGlja2VyIG1vZGU9XCJkYXRlVGltZVwiIG1pbj17bW9tZW50KCcyMDE5LTAyLTEwJyl9IG1heD17bW9tZW50KCcyMDIxLTAyLTEwJyl9IC8+LFxuICAgICk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJ2lucHV0JylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG5cbiAgaXQoJ3RoZSB7IG1pbiwgbWF4IH0gcHJvcGVydHkgc2hvdWxkIHJlbmRlciBkZWNhZGVZZWFyLXBpY2tlciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPERhdGVQaWNrZXIgbW9kZT1cImRlY2FkZVwiIG1pbj17bW9tZW50KCcyMDE5LTAyLTEwJyl9IG1heD17bW9tZW50KCcyMDIxLTAyLTEwJyl9IC8+LFxuICAgICk7XG4gICAgd3JhcHBlclxuICAgICAgLmZpbmQoJ2lucHV0JylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGplc3QucnVuQWxsVGltZXJzKCk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgfSk7XG59KTtcbiJdfQ==