4074fc90fa45e21ac2b96d7d939b5208
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var React = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _Title = _interopRequireDefault(require("./Title"));

var _Paragraph = _interopRequireDefault(require("./Paragraph"));

var _configure = require("../configure");

var _Element = _interopRequireDefault(require("./Element"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

function getComponentProps(prop) {
  if (prop && (0, _typeof2["default"])(prop) === 'object') {
    return prop;
  }

  return {};
}

function getAvatarBasicProps(hasTitle, hasParagraph) {
  if (hasTitle && !hasParagraph) {
    // Square avatar
    return {
      size: 'large',
      shape: 'square'
    };
  }

  return {
    size: 'large',
    shape: 'circle'
  };
}

function getTitleBasicProps(hasAvatar, hasParagraph) {
  if (!hasAvatar && hasParagraph) {
    return {
      width: '38%'
    };
  }

  if (hasAvatar && hasParagraph) {
    return {
      width: '50%'
    };
  }

  return {};
}

function getParagraphBasicProps(hasAvatar, hasTitle) {
  var basicProps = {}; // Width

  if (!hasAvatar || !hasTitle) {
    basicProps.width = '61%';
  } // Rows


  if (!hasAvatar && hasTitle) {
    basicProps.rows = 3;
  } else {
    basicProps.rows = 2;
  }

  return basicProps;
}

var Skeleton =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2["default"])(Skeleton, _React$Component);

  var _super = _createSuper(Skeleton);

  function Skeleton() {
    var _this;

    (0, _classCallCheck2["default"])(this, Skeleton);
    _this = _super.apply(this, arguments);

    _this.renderSkeleton = function () {
      var _this$props = _this.props,
          customizePrefixCls = _this$props.prefixCls,
          loading = _this$props.loading,
          className = _this$props.className,
          children = _this$props.children,
          avatar = _this$props.avatar,
          title = _this$props.title,
          paragraph = _this$props.paragraph,
          active = _this$props.active;
      var prefixCls = (0, _configure.getPrefixCls)('skeleton', customizePrefixCls);

      if (loading || !('loading' in _this.props)) {
        var _classNames;

        var hasAvatar = !!avatar;
        var hasTitle = !!title;
        var hasParagraph = !!paragraph; // Avatar

        var avatarNode;

        if (hasAvatar) {
          var avatarProps = (0, _objectSpread2["default"])({
            prefixCls: "".concat(prefixCls, "-avatar")
          }, getAvatarBasicProps(hasTitle, hasParagraph), {}, getComponentProps(avatar)); // We direct use SkeletonElement as avatar in skeleton internal.

          avatarNode = React.createElement("div", {
            className: "".concat(prefixCls, "-header")
          }, React.createElement(_Element["default"], (0, _extends2["default"])({}, avatarProps)));
        }

        var contentNode;

        if (hasTitle || hasParagraph) {
          // Title
          var $title;

          if (hasTitle) {
            var titleProps = (0, _objectSpread2["default"])({
              prefixCls: "".concat(prefixCls, "-title")
            }, getTitleBasicProps(hasAvatar, hasParagraph), {}, getComponentProps(title));
            $title = React.createElement(_Title["default"], (0, _extends2["default"])({}, titleProps));
          } // Paragraph


          var paragraphNode;

          if (hasParagraph) {
            var paragraphProps = (0, _objectSpread2["default"])({
              prefixCls: "".concat(prefixCls, "-paragraph")
            }, getParagraphBasicProps(hasAvatar, hasTitle), {}, getComponentProps(paragraph));
            paragraphNode = React.createElement(_Paragraph["default"], (0, _extends2["default"])({}, paragraphProps));
          }

          contentNode = React.createElement("div", {
            className: "".concat(prefixCls, "-content")
          }, $title, paragraphNode);
        }

        var cls = (0, _classnames["default"])(prefixCls, className, (_classNames = {}, (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-with-avatar"), hasAvatar), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-active"), active), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-rtl"), false), _classNames));
        return React.createElement("div", {
          className: cls
        }, avatarNode, contentNode);
      }

      return children;
    };

    return _this;
  }

  (0, _createClass2["default"])(Skeleton, [{
    key: "render",
    value: function render() {
      return React.createElement(React.Fragment, null, this.renderSkeleton());
    }
  }]);
  return Skeleton;
}(React.Component);

Skeleton.defaultProps = {
  avatar: false,
  title: true,
  paragraph: true
};
var _default = Skeleton;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNrZWxldG9uL1NrZWxldG9uLmpzIl0sIm5hbWVzIjpbInByb3AiLCJoYXNUaXRsZSIsInNpemUiLCJzaGFwZSIsIndpZHRoIiwiaGFzQXZhdGFyIiwiYmFzaWNQcm9wcyIsIlNrZWxldG9uIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjdXN0b21pemVQcmVmaXhDbHMiLCJsb2FkaW5nIiwiY2xhc3NOYW1lIiwiY2hpbGRyZW4iLCJhdmF0YXIiLCJ0aXRsZSIsInBhcmFncmFwaCIsImFjdGl2ZSIsInByZWZpeENscyIsImhhc1BhcmFncmFwaCIsImF2YXRhclByb3BzIiwiZ2V0QXZhdGFyQmFzaWNQcm9wcyIsImdldENvbXBvbmVudFByb3BzIiwiYXZhdGFyTm9kZSIsIkVsZW1lbnQiLCJ0aXRsZVByb3BzIiwiZ2V0VGl0bGVCYXNpY1Byb3BzIiwiJHRpdGxlIiwiVGl0bGUiLCJwYXJhZ3JhcGhQcm9wcyIsImdldFBhcmFncmFwaEJhc2ljUHJvcHMiLCJwYXJhZ3JhcGhOb2RlIiwiUGFyYWdyYXBoIiwiY29udGVudE5vZGUiLCJjbHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQSxLQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxXQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxNQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxVQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxVQUFBLEdBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQTs7QUFDQSxJQUFBLFFBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBLFNBQUEs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QSxFQUFBLENBQUEsR0FBQSxnQkFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLFdBQUEsRUFBQSxHQUFBLE1BQUEsQ0FBQSxTQUFBLEVBQUEsTUFBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLEVBQVosV0FBWSxFQUFaO0FBS0EsZUFBUSxLQUFLLENBQUwsYUFBQSxDQUFBLEtBQUEsRUFBMkI7QUFBRXRCLFVBQUFBLFNBQVMsRUFBRXNCO0FBQWIsU0FBM0IsRUFBQSxVQUFBLEVBQVIsV0FBUSxDQUFSO0FBR0g7O0FBQ0QsYUFBQSxRQUFBO0FBdERKLEtBQUE7O0FBRlUsV0FBQSxLQUFBO0FBMERiOzs7OzZCQUNRO0FBQ0wsYUFBTzFCLEtBQUssQ0FBTEEsYUFBQUEsQ0FBb0JBLEtBQUssQ0FBekJBLFFBQUFBLEVBQUFBLElBQUFBLEVBQTBDLEtBQWpELGNBQWlELEVBQTFDQSxDQUFQO0FBQ0g7OztFQTlEa0JBLEtBQUssQ0FBQ0MsUzs7QUFnRTdCRixRQUFRLENBQVJBLFlBQUFBLEdBQXdCO0FBQ3BCTyxFQUFBQSxNQUFNLEVBRGMsS0FBQTtBQUVwQkMsRUFBQUEsS0FBSyxFQUZlLElBQUE7QUFHcEJDLEVBQUFBLFNBQVMsRUFBRTtBQUhTLENBQXhCVDtlQUtlQSxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgVGl0bGUgZnJvbSAnLi9UaXRsZSc7XG5pbXBvcnQgUGFyYWdyYXBoIGZyb20gJy4vUGFyYWdyYXBoJztcbmltcG9ydCB7IGdldFByZWZpeENscyB9IGZyb20gJy4uL2NvbmZpZ3VyZSc7XG5pbXBvcnQgRWxlbWVudCBmcm9tICcuL0VsZW1lbnQnO1xuZnVuY3Rpb24gZ2V0Q29tcG9uZW50UHJvcHMocHJvcCkge1xuICAgIGlmIChwcm9wICYmIHR5cGVvZiBwcm9wID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gcHJvcDtcbiAgICB9XG4gICAgcmV0dXJuIHt9O1xufVxuZnVuY3Rpb24gZ2V0QXZhdGFyQmFzaWNQcm9wcyhoYXNUaXRsZSwgaGFzUGFyYWdyYXBoKSB7XG4gICAgaWYgKGhhc1RpdGxlICYmICFoYXNQYXJhZ3JhcGgpIHtcbiAgICAgICAgLy8gU3F1YXJlIGF2YXRhclxuICAgICAgICByZXR1cm4geyBzaXplOiAnbGFyZ2UnLCBzaGFwZTogJ3NxdWFyZScgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc2l6ZTogJ2xhcmdlJywgc2hhcGU6ICdjaXJjbGUnIH07XG59XG5mdW5jdGlvbiBnZXRUaXRsZUJhc2ljUHJvcHMoaGFzQXZhdGFyLCBoYXNQYXJhZ3JhcGgpIHtcbiAgICBpZiAoIWhhc0F2YXRhciAmJiBoYXNQYXJhZ3JhcGgpIHtcbiAgICAgICAgcmV0dXJuIHsgd2lkdGg6ICczOCUnIH07XG4gICAgfVxuICAgIGlmIChoYXNBdmF0YXIgJiYgaGFzUGFyYWdyYXBoKSB7XG4gICAgICAgIHJldHVybiB7IHdpZHRoOiAnNTAlJyB9O1xuICAgIH1cbiAgICByZXR1cm4ge307XG59XG5mdW5jdGlvbiBnZXRQYXJhZ3JhcGhCYXNpY1Byb3BzKGhhc0F2YXRhciwgaGFzVGl0bGUpIHtcbiAgICBjb25zdCBiYXNpY1Byb3BzID0ge307XG4gICAgLy8gV2lkdGhcbiAgICBpZiAoIWhhc0F2YXRhciB8fCAhaGFzVGl0bGUpIHtcbiAgICAgICAgYmFzaWNQcm9wcy53aWR0aCA9ICc2MSUnO1xuICAgIH1cbiAgICAvLyBSb3dzXG4gICAgaWYgKCFoYXNBdmF0YXIgJiYgaGFzVGl0bGUpIHtcbiAgICAgICAgYmFzaWNQcm9wcy5yb3dzID0gMztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGJhc2ljUHJvcHMucm93cyA9IDI7XG4gICAgfVxuICAgIHJldHVybiBiYXNpY1Byb3BzO1xufVxuY2xhc3MgU2tlbGV0b24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnJlbmRlclNrZWxldG9uID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBwcmVmaXhDbHM6IGN1c3RvbWl6ZVByZWZpeENscywgbG9hZGluZywgY2xhc3NOYW1lLCBjaGlsZHJlbiwgYXZhdGFyLCB0aXRsZSwgcGFyYWdyYXBoLCBhY3RpdmUsIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICAgICAgY29uc3QgcHJlZml4Q2xzID0gZ2V0UHJlZml4Q2xzKCdza2VsZXRvbicsIGN1c3RvbWl6ZVByZWZpeENscyk7XG4gICAgICAgICAgICBpZiAobG9hZGluZyB8fCAhKCdsb2FkaW5nJyBpbiB0aGlzLnByb3BzKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhhc0F2YXRhciA9ICEhYXZhdGFyO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhhc1RpdGxlID0gISF0aXRsZTtcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNQYXJhZ3JhcGggPSAhIXBhcmFncmFwaDtcbiAgICAgICAgICAgICAgICAvLyBBdmF0YXJcbiAgICAgICAgICAgICAgICBsZXQgYXZhdGFyTm9kZTtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQXZhdGFyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF2YXRhclByb3BzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4Q2xzOiBgJHtwcmVmaXhDbHN9LWF2YXRhcmAsXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5nZXRBdmF0YXJCYXNpY1Byb3BzKGhhc1RpdGxlLCBoYXNQYXJhZ3JhcGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZ2V0Q29tcG9uZW50UHJvcHMoYXZhdGFyKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgZGlyZWN0IHVzZSBTa2VsZXRvbkVsZW1lbnQgYXMgYXZhdGFyIGluIHNrZWxldG9uIGludGVybmFsLlxuICAgICAgICAgICAgICAgICAgICBhdmF0YXJOb2RlID0gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IGAke3ByZWZpeENsc30taGVhZGVyYCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChFbGVtZW50LCBPYmplY3QuYXNzaWduKHt9LCBhdmF0YXJQcm9wcykpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50Tm9kZTtcbiAgICAgICAgICAgICAgICBpZiAoaGFzVGl0bGUgfHwgaGFzUGFyYWdyYXBoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRpdGxlXG4gICAgICAgICAgICAgICAgICAgIGxldCAkdGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGVQcm9wcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXhDbHM6IGAke3ByZWZpeENsc30tdGl0bGVgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmdldFRpdGxlQmFzaWNQcm9wcyhoYXNBdmF0YXIsIGhhc1BhcmFncmFwaCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZ2V0Q29tcG9uZW50UHJvcHModGl0bGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aXRsZSA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoVGl0bGUsIE9iamVjdC5hc3NpZ24oe30sIHRpdGxlUHJvcHMpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBQYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaE5vZGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNQYXJhZ3JhcGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFncmFwaFByb3BzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpeENsczogYCR7cHJlZml4Q2xzfS1wYXJhZ3JhcGhgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmdldFBhcmFncmFwaEJhc2ljUHJvcHMoaGFzQXZhdGFyLCBoYXNUaXRsZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZ2V0Q29tcG9uZW50UHJvcHMocGFyYWdyYXBoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhOb2RlID0gUmVhY3QuY3JlYXRlRWxlbWVudChQYXJhZ3JhcGgsIE9iamVjdC5hc3NpZ24oe30sIHBhcmFncmFwaFByb3BzKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGVudE5vZGUgPSAoUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogYCR7cHJlZml4Q2xzfS1jb250ZW50YCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTm9kZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjbHMgPSBjbGFzc05hbWVzKHByZWZpeENscywgY2xhc3NOYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LXdpdGgtYXZhdGFyYF06IGhhc0F2YXRhcixcbiAgICAgICAgICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tYWN0aXZlYF06IGFjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tcnRsYF06IGZhbHNlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogY2xzIH0sXG4gICAgICAgICAgICAgICAgICAgIGF2YXRhck5vZGUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnROb2RlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsIHRoaXMucmVuZGVyU2tlbGV0b24oKSk7XG4gICAgfVxufVxuU2tlbGV0b24uZGVmYXVsdFByb3BzID0ge1xuICAgIGF2YXRhcjogZmFsc2UsXG4gICAgdGl0bGU6IHRydWUsXG4gICAgcGFyYWdyYXBoOiB0cnVlLFxufTtcbmV4cG9ydCBkZWZhdWx0IFNrZWxldG9uO1xuIl19