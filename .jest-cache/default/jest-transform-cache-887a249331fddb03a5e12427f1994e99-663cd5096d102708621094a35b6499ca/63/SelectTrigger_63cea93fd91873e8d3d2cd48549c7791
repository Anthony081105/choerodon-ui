0090e6da68b5086cdef99036fc255284
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _trigger = _interopRequireDefault(require("../trigger"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var _DropdownMenu = _interopRequireDefault(require("./DropdownMenu"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _util = require("./util");

var _spin = _interopRequireDefault(require("../../spin"));

_trigger["default"].displayName = 'Trigger';
var BUILT_IN_PLACEMENTS = {
  bottomLeft: {
    points: ['tl', 'bl'],
    offset: [0, 4],
    overflow: {
      adjustX: 0,
      adjustY: 1
    }
  },
  topLeft: {
    points: ['bl', 'tl'],
    offset: [0, -4],
    overflow: {
      adjustX: 0,
      adjustY: 1
    }
  },
  bottomRight: {
    points: ['tr', 'br'],
    offset: [0, 4],
    overflow: {
      adjustX: 0,
      adjustY: 1
    }
  }
};

var SelectTrigger =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(SelectTrigger, _Component);

  function SelectTrigger() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2["default"])(this, SelectTrigger);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(SelectTrigger)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
      dropdownWidth: null
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "setDropdownWidth", function () {
      var width = _reactDom["default"].findDOMNode((0, _assertThisInitialized2["default"])(_this)).offsetWidth;

      if (width !== _this.state.dropdownWidth) {
        _this.setState({
          dropdownWidth: width
        });
      }
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getInnerMenu", function () {
      return _this.dropdownMenuRef && _this.dropdownMenuRef.menuRef;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getFilterInput", function () {
      return _this.dropdownMenuRef && _this.dropdownMenuRef.filterRef;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getPopupDOMNode", function () {
      return _this.triggerRef.getPopupDomNode();
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getDropdownElement", function (newProps) {
      var props = _this.props;
      var loading = props.loading;

      if (typeof loading === 'boolean') {
        loading = {
          spinning: loading
        };
      }

      return _react["default"].createElement(_spin["default"], loading, _react["default"].createElement(_DropdownMenu["default"], (0, _extends2["default"])({
        ref: (0, _util.saveRef)((0, _assertThisInitialized2["default"])(_this), 'dropdownMenuRef')
      }, newProps, {
        prefixCls: _this.getDropdownPrefixCls(),
        onMenuSelect: props.onMenuSelect,
        onMenuDeselect: props.onMenuDeselect,
        onPopupScroll: props.onPopupScroll,
        onKeyDown: props.onKeyDown,
        value: props.value,
        placeholder: props.filterPlaceholder,
        checkAll: props.checkAll,
        backfillValue: props.backfillValue,
        firstActiveValue: props.firstActiveValue,
        defaultActiveFirstOption: props.defaultActiveFirstOption,
        dropdownMenuStyle: props.dropdownMenuStyle,
        onFilterChange: props.onFilterChange,
        footer: props.footer,
        onMouseDown: props.onDropdownMouseDown
      })));
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getDropdownTransitionName", function () {
      var props = _this.props;
      var transitionName = props.transitionName;

      if (!transitionName && props.animation) {
        transitionName = "".concat(_this.getDropdownPrefixCls(), "-").concat(props.animation);
      }

      return transitionName;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "getDropdownPrefixCls", function () {
      return "".concat(_this.props.prefixCls, "-dropdown");
    });
    return _this;
  }

  (0, _createClass2["default"])(SelectTrigger, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setDropdownWidth();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      this.setDropdownWidth();
    }
  }, {
    key: "render",
    value: function render() {
      var _popupClassName;

      var _this$props = this.props,
          onPopupFocus = _this$props.onPopupFocus,
          props = (0, _objectWithoutProperties2["default"])(_this$props, ["onPopupFocus"]);
      var multiple = props.multiple,
          visible = props.visible,
          inputValue = props.inputValue,
          dropdownAlign = props.dropdownAlign,
          disabled = props.disabled,
          showSearch = props.showSearch,
          dropdownClassName = props.dropdownClassName,
          dropdownStyle = props.dropdownStyle,
          dropdownMatchSelectWidth = props.dropdownMatchSelectWidth,
          filter = props.filter,
          filterValue = props.filterValue;
      var dropdownPrefixCls = this.getDropdownPrefixCls();
      var popupClassName = (_popupClassName = {}, (0, _defineProperty2["default"])(_popupClassName, dropdownClassName, !!dropdownClassName), (0, _defineProperty2["default"])(_popupClassName, "".concat(dropdownPrefixCls, "--").concat(multiple ? 'multiple' : 'single'), 1), _popupClassName);
      var popupElement = this.getDropdownElement({
        menuItems: props.options,
        onPopupFocus: onPopupFocus,
        multiple: multiple,
        inputValue: inputValue,
        visible: visible,
        filter: filter,
        filterValue: filterValue
      });
      var popupStyle = (0, _objectSpread2["default"])({}, dropdownStyle);
      var widthProp = dropdownMatchSelectWidth ? 'width' : 'minWidth';

      if (this.state.dropdownWidth && !popupStyle[widthProp]) {
        popupStyle[widthProp] = "".concat(this.state.dropdownWidth, "px");
      }

      return _react["default"].createElement(_trigger["default"], (0, _extends2["default"])({}, props, {
        action: disabled ? [] : ['click'],
        ref: (0, _util.saveRef)(this, 'triggerRef'),
        popupPlacement: props.popupPlacement,
        builtinPlacements: props.builtinPlacements || BUILT_IN_PLACEMENTS,
        prefixCls: dropdownPrefixCls,
        popupTransitionName: this.getDropdownTransitionName(),
        onPopupVisibleChange: props.onDropdownVisibleChange,
        popup: popupElement,
        popupAlign: dropdownAlign,
        popupVisible: visible,
        getPopupContainer: props.getPopupContainer,
        popupClassName: (0, _classnames["default"])(popupClassName),
        popupStyle: popupStyle
      }), props.children);
    }
  }]);
  return SelectTrigger;
}(_react.Component);

exports["default"] = SelectTrigger;
(0, _defineProperty2["default"])(SelectTrigger, "propTypes", {
  onPopupFocus: _propTypes["default"].func,
  onPopupScroll: _propTypes["default"].func,
  dropdownMatchSelectWidth: _propTypes["default"].bool,
  dropdownAlign: _propTypes["default"].object,
  visible: _propTypes["default"].bool,
  disabled: _propTypes["default"].bool,
  showSearch: _propTypes["default"].bool,
  dropdownClassName: _propTypes["default"].string,
  onDropdownMouseDown: _propTypes["default"].any,
  dropdownStyle: _propTypes["default"].any,
  multiple: _propTypes["default"].bool,
  inputValue: _propTypes["default"].string,
  filterOption: _propTypes["default"].any,
  options: _propTypes["default"].any,
  prefixCls: _propTypes["default"].string,
  popupClassName: _propTypes["default"].string,
  popupPlacement: _propTypes["default"].string,
  children: _propTypes["default"].any,
  filter: _propTypes["default"].bool,
  builtinPlacements: _propTypes["default"].any,
  getRootDomNode: _propTypes["default"].func,
  loading: _propTypes["default"].oneOfType([_propTypes["default"].bool, _propTypes["default"].object]),
  onKeyDown: _propTypes["default"].func
});
(0, _defineProperty2["default"])(SelectTrigger, "defaultProps", {
  popupPlacement: 'bottomLeft',
  loading: false
});
SelectTrigger.displayName = 'SelectTrigger';
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlbGVjdFRyaWdnZXIuanN4Il0sIm5hbWVzIjpbIlRyaWdnZXIiLCJkaXNwbGF5TmFtZSIsIkJVSUxUX0lOX1BMQUNFTUVOVFMiLCJib3R0b21MZWZ0IiwicG9pbnRzIiwib2Zmc2V0Iiwib3ZlcmZsb3ciLCJhZGp1c3RYIiwiYWRqdXN0WSIsInRvcExlZnQiLCJib3R0b21SaWdodCIsIlNlbGVjdFRyaWdnZXIiLCJkcm9wZG93bldpZHRoIiwid2lkdGgiLCJSZWFjdERPTSIsImZpbmRET01Ob2RlIiwib2Zmc2V0V2lkdGgiLCJzdGF0ZSIsInNldFN0YXRlIiwiZHJvcGRvd25NZW51UmVmIiwibWVudVJlZiIsImZpbHRlclJlZiIsInRyaWdnZXJSZWYiLCJnZXRQb3B1cERvbU5vZGUiLCJuZXdQcm9wcyIsInByb3BzIiwibG9hZGluZyIsInNwaW5uaW5nIiwiZ2V0RHJvcGRvd25QcmVmaXhDbHMiLCJvbk1lbnVTZWxlY3QiLCJvbk1lbnVEZXNlbGVjdCIsIm9uUG9wdXBTY3JvbGwiLCJvbktleURvd24iLCJ2YWx1ZSIsImZpbHRlclBsYWNlaG9sZGVyIiwiY2hlY2tBbGwiLCJiYWNrZmlsbFZhbHVlIiwiZmlyc3RBY3RpdmVWYWx1ZSIsImRlZmF1bHRBY3RpdmVGaXJzdE9wdGlvbiIsImRyb3Bkb3duTWVudVN0eWxlIiwib25GaWx0ZXJDaGFuZ2UiLCJmb290ZXIiLCJvbkRyb3Bkb3duTW91c2VEb3duIiwidHJhbnNpdGlvbk5hbWUiLCJhbmltYXRpb24iLCJwcmVmaXhDbHMiLCJzZXREcm9wZG93bldpZHRoIiwib25Qb3B1cEZvY3VzIiwibXVsdGlwbGUiLCJ2aXNpYmxlIiwiaW5wdXRWYWx1ZSIsImRyb3Bkb3duQWxpZ24iLCJkaXNhYmxlZCIsInNob3dTZWFyY2giLCJkcm9wZG93bkNsYXNzTmFtZSIsImRyb3Bkb3duU3R5bGUiLCJkcm9wZG93bk1hdGNoU2VsZWN0V2lkdGgiLCJmaWx0ZXIiLCJmaWx0ZXJWYWx1ZSIsImRyb3Bkb3duUHJlZml4Q2xzIiwicG9wdXBDbGFzc05hbWUiLCJwb3B1cEVsZW1lbnQiLCJnZXREcm9wZG93bkVsZW1lbnQiLCJtZW51SXRlbXMiLCJvcHRpb25zIiwicG9wdXBTdHlsZSIsIndpZHRoUHJvcCIsInBvcHVwUGxhY2VtZW50IiwiYnVpbHRpblBsYWNlbWVudHMiLCJnZXREcm9wZG93blRyYW5zaXRpb25OYW1lIiwib25Ecm9wZG93blZpc2libGVDaGFuZ2UiLCJnZXRQb3B1cENvbnRhaW5lciIsImNoaWxkcmVuIiwiQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwiZnVuYyIsImJvb2wiLCJvYmplY3QiLCJzdHJpbmciLCJhbnkiLCJmaWx0ZXJPcHRpb24iLCJnZXRSb290RG9tTm9kZSIsIm9uZU9mVHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBQSxvQkFBUUMsV0FBUixHQUFzQixTQUF0QjtBQUVBLElBQU1DLG1CQUFtQixHQUFHO0FBQzFCQyxFQUFBQSxVQUFVLEVBQUU7QUFDVkMsSUFBQUEsTUFBTSxFQUFFLENBQUMsSUFBRCxFQUFPLElBQVAsQ0FERTtBQUVWQyxJQUFBQSxNQUFNLEVBQUUsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUZFO0FBR1ZDLElBQUFBLFFBQVEsRUFBRTtBQUNSQyxNQUFBQSxPQUFPLEVBQUUsQ0FERDtBQUVSQyxNQUFBQSxPQUFPLEVBQUU7QUFGRDtBQUhBLEdBRGM7QUFTMUJDLEVBQUFBLE9BQU8sRUFBRTtBQUNQTCxJQUFBQSxNQUFNLEVBQUUsQ0FBQyxJQUFELEVBQU8sSUFBUCxDQUREO0FBRVBDLElBQUFBLE1BQU0sRUFBRSxDQUFDLENBQUQsRUFBSSxDQUFDLENBQUwsQ0FGRDtBQUdQQyxJQUFBQSxRQUFRLEVBQUU7QUFDUkMsTUFBQUEsT0FBTyxFQUFFLENBREQ7QUFFUkMsTUFBQUEsT0FBTyxFQUFFO0FBRkQ7QUFISCxHQVRpQjtBQWlCMUJFLEVBQUFB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QyxJQXJCVDtBQXNCakJqRCxFQUFBQSxPQUFPLEVBQUVnRCxzQkFBVVEsU0FBVixDQUFvQixDQUMzQlIsc0JBQVVFLElBRGlCLEVBRTNCRixzQkFBVUcsTUFGaUIsQ0FBcEIsQ0F0QlE7QUEwQmpCN0MsRUFBQUEsU0FBUyxFQUFFMEMsc0JBQVVDO0FBMUJKLEM7aUNBREFoRSxhLGtCQThCRztBQUNwQndELEVBQUFBLGNBQWMsRUFBRSxZQURJO0FBRXBCekMsRUFBQUEsT0FBTyxFQUFFO0FBRlcsQztBQThJeEJmLGFBQWEsQ0FBQ1YsV0FBZCxHQUE0QixlQUE1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUcmlnZ2VyIGZyb20gJy4uL3RyaWdnZXInO1xuaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBEcm9wZG93bk1lbnUgZnJvbSAnLi9Ecm9wZG93bk1lbnUnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgeyBpc1NpbmdsZU1vZGUsIHNhdmVSZWYgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IFNwaW4gZnJvbSAnLi4vLi4vc3Bpbic7XG5cblRyaWdnZXIuZGlzcGxheU5hbWUgPSAnVHJpZ2dlcic7XG5cbmNvbnN0IEJVSUxUX0lOX1BMQUNFTUVOVFMgPSB7XG4gIGJvdHRvbUxlZnQ6IHtcbiAgICBwb2ludHM6IFsndGwnLCAnYmwnXSxcbiAgICBvZmZzZXQ6IFswLCA0XSxcbiAgICBvdmVyZmxvdzoge1xuICAgICAgYWRqdXN0WDogMCxcbiAgICAgIGFkanVzdFk6IDEsXG4gICAgfSxcbiAgfSxcbiAgdG9wTGVmdDoge1xuICAgIHBvaW50czogWydibCcsICd0bCddLFxuICAgIG9mZnNldDogWzAsIC00XSxcbiAgICBvdmVyZmxvdzoge1xuICAgICAgYWRqdXN0WDogMCxcbiAgICAgIGFkanVzdFk6IDEsXG4gICAgfSxcbiAgfSxcbiAgYm90dG9tUmlnaHQ6IHtcbiAgICBwb2ludHM6IFsndHInLCAnYnInXSxcbiAgICBvZmZzZXQ6IFswLCA0XSxcbiAgICBvdmVyZmxvdzoge1xuICAgICAgYWRqdXN0WDogMCxcbiAgICAgIGFkanVzdFk6IDEsXG4gICAgfSxcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlbGVjdFRyaWdnZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIG9uUG9wdXBGb2N1czogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25Qb3B1cFNjcm9sbDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZHJvcGRvd25NYXRjaFNlbGVjdFdpZHRoOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBkcm9wZG93bkFsaWduOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHZpc2libGU6IFByb3BUeXBlcy5ib29sLFxuICAgIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzaG93U2VhcmNoOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBkcm9wZG93bkNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBvbkRyb3Bkb3duTW91c2VEb3duOiBQcm9wVHlwZXMuYW55LFxuICAgIGRyb3Bkb3duU3R5bGU6IFByb3BUeXBlcy5hbnksXG4gICAgbXVsdGlwbGU6IFByb3BUeXBlcy5ib29sLFxuICAgIGlucHV0VmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgZmlsdGVyT3B0aW9uOiBQcm9wVHlwZXMuYW55LFxuICAgIG9wdGlvbnM6IFByb3BUeXBlcy5hbnksXG4gICAgcHJlZml4Q2xzOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHBvcHVwQ2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHBvcHVwUGxhY2VtZW50OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgIGZpbHRlcjogUHJvcFR5cGVzLmJvb2wsXG4gICAgYnVpbHRpblBsYWNlbWVudHM6IFByb3BUeXBlcy5hbnksXG4gICAgZ2V0Um9vdERvbU5vZGU6IFByb3BUeXBlcy5mdW5jLFxuICAgIGxvYWRpbmc6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgUHJvcFR5cGVzLmJvb2wsXG4gICAgICBQcm9wVHlwZXMub2JqZWN0LFxuICAgIF0pLFxuICAgIG9uS2V5RG93bjogUHJvcFR5cGVzLmZ1bmMsXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBwb3B1cFBsYWNlbWVudDogJ2JvdHRvbUxlZnQnLFxuICAgIGxvYWRpbmc6IGZhbHNlLFxuICB9O1xuXG4gIHN0YXRlID0ge1xuICAgIGRyb3Bkb3duV2lkdGg6IG51bGwsXG4gIH07XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5zZXREcm9wZG93bldpZHRoKCk7XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgdGhpcy5zZXREcm9wZG93bldpZHRoKCk7XG4gIH1cblxuICBzZXREcm9wZG93bldpZHRoID0gKCkgPT4ge1xuICAgIGNvbnN0IHdpZHRoID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcykub2Zmc2V0V2lkdGg7XG4gICAgaWYgKHdpZHRoICE9PSB0aGlzLnN0YXRlLmRyb3Bkb3duV2lkdGgpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBkcm9wZG93bldpZHRoOiB3aWR0aCB9KTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0SW5uZXJNZW51ID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLmRyb3Bkb3duTWVudVJlZiAmJiB0aGlzLmRyb3Bkb3duTWVudVJlZi5tZW51UmVmO1xuICB9O1xuXG4gIGdldEZpbHRlcklucHV0ID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLmRyb3Bkb3duTWVudVJlZiAmJiB0aGlzLmRyb3Bkb3duTWVudVJlZi5maWx0ZXJSZWY7XG4gIH1cblxuICBnZXRQb3B1cERPTU5vZGUgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMudHJpZ2dlclJlZi5nZXRQb3B1cERvbU5vZGUoKTtcbiAgfTtcblxuICBnZXREcm9wZG93bkVsZW1lbnQgPSBuZXdQcm9wcyA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgIGxldCBsb2FkaW5nID0gcHJvcHMubG9hZGluZztcbiAgICBpZiAodHlwZW9mIGxvYWRpbmcgPT09ICdib29sZWFuJykge1xuICAgICAgbG9hZGluZyA9IHtcbiAgICAgICAgc3Bpbm5pbmc6IGxvYWRpbmcsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgPFNwaW4gey4uLmxvYWRpbmd9PlxuICAgICAgICA8RHJvcGRvd25NZW51XG4gICAgICAgICAgcmVmPXtzYXZlUmVmKHRoaXMsICdkcm9wZG93bk1lbnVSZWYnKX1cbiAgICAgICAgICB7Li4ubmV3UHJvcHN9XG4gICAgICAgICAgcHJlZml4Q2xzPXt0aGlzLmdldERyb3Bkb3duUHJlZml4Q2xzKCl9XG4gICAgICAgICAgb25NZW51U2VsZWN0PXtwcm9wcy5vbk1lbnVTZWxlY3R9XG4gICAgICAgICAgb25NZW51RGVzZWxlY3Q9e3Byb3BzLm9uTWVudURlc2VsZWN0fVxuICAgICAgICAgIG9uUG9wdXBTY3JvbGw9e3Byb3BzLm9uUG9wdXBTY3JvbGx9XG4gICAgICAgICAgb25LZXlEb3duPXtwcm9wcy5vbktleURvd259XG4gICAgICAgICAgdmFsdWU9e3Byb3BzLnZhbHVlfVxuICAgICAgICAgIHBsYWNlaG9sZGVyPXtwcm9wcy5maWx0ZXJQbGFjZWhvbGRlcn1cbiAgICAgICAgICBjaGVja0FsbD17cHJvcHMuY2hlY2tBbGx9XG4gICAgICAgICAgYmFja2ZpbGxWYWx1ZT17cHJvcHMuYmFja2ZpbGxWYWx1ZX1cbiAgICAgICAgICBmaXJzdEFjdGl2ZVZhbHVlPXtwcm9wcy5maXJzdEFjdGl2ZVZhbHVlfVxuICAgICAgICAgIGRlZmF1bHRBY3RpdmVGaXJzdE9wdGlvbj17cHJvcHMuZGVmYXVsdEFjdGl2ZUZpcnN0T3B0aW9ufVxuICAgICAgICAgIGRyb3Bkb3duTWVudVN0eWxlPXtwcm9wcy5kcm9wZG93bk1lbnVTdHlsZX1cbiAgICAgICAgICBvbkZpbHRlckNoYW5nZT17cHJvcHMub25GaWx0ZXJDaGFuZ2V9XG4gICAgICAgICAgZm9vdGVyPXtwcm9wcy5mb290ZXJ9XG4gICAgICAgICAgb25Nb3VzZURvd249e3Byb3BzLm9uRHJvcGRvd25Nb3VzZURvd259XG4gICAgICAvPlxuICAgICAgPC9TcGluPlxuXG4gICAgKTtcbiAgfTtcblxuICBnZXREcm9wZG93blRyYW5zaXRpb25OYW1lID0gKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wcztcbiAgICBsZXQgdHJhbnNpdGlvbk5hbWUgPSBwcm9wcy50cmFuc2l0aW9uTmFtZTtcbiAgICBpZiAoIXRyYW5zaXRpb25OYW1lICYmIHByb3BzLmFuaW1hdGlvbikge1xuICAgICAgdHJhbnNpdGlvbk5hbWUgPSBgJHt0aGlzLmdldERyb3Bkb3duUHJlZml4Q2xzKCl9LSR7cHJvcHMuYW5pbWF0aW9ufWA7XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2l0aW9uTmFtZTtcbiAgfTtcblxuICBnZXREcm9wZG93blByZWZpeENscyA9ICgpID0+IHtcbiAgICByZXR1cm4gYCR7dGhpcy5wcm9wcy5wcmVmaXhDbHN9LWRyb3Bkb3duYDtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBvblBvcHVwRm9jdXMsIC4uLnByb3BzIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtcbiAgICAgIG11bHRpcGxlLFxuICAgICAgdmlzaWJsZSxcbiAgICAgIGlucHV0VmFsdWUsXG4gICAgICBkcm9wZG93bkFsaWduLFxuICAgICAgZGlzYWJsZWQsXG4gICAgICBzaG93U2VhcmNoLFxuICAgICAgZHJvcGRvd25DbGFzc05hbWUsXG4gICAgICBkcm9wZG93blN0eWxlLFxuICAgICAgZHJvcGRvd25NYXRjaFNlbGVjdFdpZHRoLFxuICAgICAgZmlsdGVyLFxuICAgICAgZmlsdGVyVmFsdWUsXG4gICAgfSA9IHByb3BzO1xuICAgIGNvbnN0IGRyb3Bkb3duUHJlZml4Q2xzID0gdGhpcy5nZXREcm9wZG93blByZWZpeENscygpO1xuICAgIGNvbnN0IHBvcHVwQ2xhc3NOYW1lID0ge1xuICAgICAgW2Ryb3Bkb3duQ2xhc3NOYW1lXTogISFkcm9wZG93bkNsYXNzTmFtZSxcbiAgICAgIFtgJHtkcm9wZG93blByZWZpeENsc30tLSR7bXVsdGlwbGUgPyAnbXVsdGlwbGUnIDogJ3NpbmdsZSd9YF06IDEsXG4gICAgfTtcbiAgICBjb25zdCBwb3B1cEVsZW1lbnQgPSB0aGlzLmdldERyb3Bkb3duRWxlbWVudCh7XG4gICAgICBtZW51SXRlbXM6IHByb3BzLm9wdGlvbnMsXG4gICAgICBvblBvcHVwRm9jdXMsXG4gICAgICBtdWx0aXBsZSxcbiAgICAgIGlucHV0VmFsdWUsXG4gICAgICB2aXNpYmxlLFxuICAgICAgZmlsdGVyLFxuICAgICAgZmlsdGVyVmFsdWUsXG4gICAgfSk7XG5cbiAgICBjb25zdCBwb3B1cFN0eWxlID0geyAuLi5kcm9wZG93blN0eWxlIH07XG4gICAgY29uc3Qgd2lkdGhQcm9wID0gZHJvcGRvd25NYXRjaFNlbGVjdFdpZHRoID8gJ3dpZHRoJyA6ICdtaW5XaWR0aCc7XG4gICAgaWYgKHRoaXMuc3RhdGUuZHJvcGRvd25XaWR0aCAmJiAhcG9wdXBTdHlsZVt3aWR0aFByb3BdKSB7XG4gICAgICBwb3B1cFN0eWxlW3dpZHRoUHJvcF0gPSBgJHt0aGlzLnN0YXRlLmRyb3Bkb3duV2lkdGh9cHhgO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8VHJpZ2dlclxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgIGFjdGlvbj17ZGlzYWJsZWQgPyBbXSA6IFsnY2xpY2snXX1cbiAgICAgICAgcmVmPXtzYXZlUmVmKHRoaXMsICd0cmlnZ2VyUmVmJyl9XG4gICAgICAgIHBvcHVwUGxhY2VtZW50PXtwcm9wcy5wb3B1cFBsYWNlbWVudH1cbiAgICAgICAgYnVpbHRpblBsYWNlbWVudHM9e3Byb3BzLmJ1aWx0aW5QbGFjZW1lbnRzIHx8IEJVSUxUX0lOX1BMQUNFTUVOVFN9XG4gICAgICAgIHByZWZpeENscz17ZHJvcGRvd25QcmVmaXhDbHN9XG4gICAgICAgIHBvcHVwVHJhbnNpdGlvbk5hbWU9e3RoaXMuZ2V0RHJvcGRvd25UcmFuc2l0aW9uTmFtZSgpfVxuICAgICAgICBvblBvcHVwVmlzaWJsZUNoYW5nZT17cHJvcHMub25Ecm9wZG93blZpc2libGVDaGFuZ2V9XG4gICAgICAgIHBvcHVwPXtwb3B1cEVsZW1lbnR9XG4gICAgICAgIHBvcHVwQWxpZ249e2Ryb3Bkb3duQWxpZ259XG4gICAgICAgIHBvcHVwVmlzaWJsZT17dmlzaWJsZX1cbiAgICAgICAgZ2V0UG9wdXBDb250YWluZXI9e3Byb3BzLmdldFBvcHVwQ29udGFpbmVyfVxuICAgICAgICBwb3B1cENsYXNzTmFtZT17Y2xhc3NuYW1lcyhwb3B1cENsYXNzTmFtZSl9XG4gICAgICAgIHBvcHVwU3R5bGU9e3BvcHVwU3R5bGV9XG4gICAgICA+XG4gICAgICAgIHtwcm9wcy5jaGlsZHJlbn1cbiAgICAgIDwvVHJpZ2dlcj5cbiAgICApO1xuICB9XG59XG5cblNlbGVjdFRyaWdnZXIuZGlzcGxheU5hbWUgPSAnU2VsZWN0VHJpZ2dlcic7XG4iXX0=