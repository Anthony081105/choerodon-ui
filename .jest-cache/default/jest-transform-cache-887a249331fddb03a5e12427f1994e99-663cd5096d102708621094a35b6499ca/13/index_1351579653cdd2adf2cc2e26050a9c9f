dfd218a2baef95e5fca296389b570bff
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _react = _interopRequireWildcard(require("react"));

var _reactDom = require("react-dom");

var _classnames = _interopRequireDefault(require("classnames"));

var _icon = _interopRequireDefault(require("../icon"));

var _warning = _interopRequireDefault(require("../_util/warning"));

var _isFlexSupported = _interopRequireDefault(require("../_util/isFlexSupported"));

var _tabs = _interopRequireWildcard(require("../rc-components/tabs"));

var _ScrollableInkTabBar = _interopRequireDefault(require("../rc-components/tabs/ScrollableInkTabBar"));

var _utils = require("../rc-components/tabs/utils");

var _configure = require("../configure");

var Tabs =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Tabs, _Component);

  function Tabs() {
    var _this;

    (0, _classCallCheck2["default"])(this, Tabs);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(Tabs).apply(this, arguments));

    _this.createNewTab = function (targetKey) {
      var onEdit = _this.props.onEdit;

      if (onEdit) {
        onEdit(targetKey, 'add');
      }
    };

    _this.removeTab = function (targetKey, e) {
      e.stopPropagation();

      if (!targetKey) {
        return;
      }

      var onEdit = _this.props.onEdit;

      if (onEdit) {
        onEdit(targetKey, 'remove');
      }
    };

    _this.handleChange = function (activeKey) {
      var onChange = _this.props.onChange;

      if (onChange) {
        onChange(activeKey);
      }
    };

    return _this;
  }

  (0, _createClass2["default"])(Tabs, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var NO_FLEX = ' no-flex';
      var tabNode = (0, _reactDom.findDOMNode)(this);

      if (tabNode && !(0, _isFlexSupported["default"])() && tabNode.className.indexOf(NO_FLEX) === -1) {
        tabNode.className += NO_FLEX;
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _classNames,
          _this2 = this;

      var _this$props = this.props,
          customizePrefixCls = _this$props.prefixCls,
          _this$props$className = _this$props.className,
          className = _this$props$className === void 0 ? '' : _this$props$className,
          size = _this$props.size,
          _this$props$type = _this$props.type,
          type = _this$props$type === void 0 ? "line" : _this$props$type,
          tabPosition = _this$props.tabPosition,
          children = _this$props.children,
          tabBarStyle = _this$props.tabBarStyle,
          hideAdd = _this$props.hideAdd,
          onTabClick = _this$props.onTabClick,
          onPrevClick = _this$props.onPrevClick,
          onNextClick = _this$props.onNextClick,
          _this$props$animated = _this$props.animated,
          animated = _this$props$animated === void 0 ? true : _this$props$animated,
          tabBarGutter = _this$props.tabBarGutter;
      var tabBarExtraContent = this.props.tabBarExtraContent;
      var prefixCls = (0, _configure.getPrefixCls)('tabs', customizePrefixCls);
      var inkBarAnimated = (0, _typeof2["default"])(animated) === 'object' ? animated.inkBar : animated;
      var tabPaneAnimated = (0, _typeof2["default"])(animated) === 'object' ? animated.tabPane : animated; // card tabs should not have animation

      if (type !== "line"
      /* line */
      ) {
          tabPaneAnimated = 'animated' in this.props ? tabPaneAnimated : false;
        }

      var isCard = type === "card"
      /* card */
      || type === "editable-card"
      /* 'editable-card' */
      ;
      (0, _warning["default"])(!(isCard && (size === "small"
      /* small */
      || size === "large"
      /* large */
      )), "Tabs[type=card|editable-card] doesn't have small or large size, it's by designed.");
      var cls = (0, _classnames["default"])(className, "".concat(prefixCls, "-").concat(type), (_classNames = {}, (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-vertical"), tabPosition === "left"
      /* left */
      || tabPosition === "right"), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-").concat(size), !!size), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-card"), isCard), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-no-animation"), !tabPaneAnimated), _classNames)); // only card type tabs can be added and closed

      var childrenWithClose = [];

      if (type === "editable-card"
      /* 'editable-card' */
      ) {
          childrenWithClose = [];

          _react.Children.forEach(children, function (child, index) {
            var closable = child.props.closable;
            closable = typeof closable === 'undefined' ? true : closable;
            var closeIcon = closable ? _react["default"].createElement(_icon["default"], {
              type: "close",
              onClick: function onClick(e) {
                return _this2.removeTab(child.key, e);
              }
            }) : null;
            childrenWithClose.push((0, _react.cloneElement)(child, {
              tab: _react["default"].createElement("div", {
                className: closable ? undefined : "".concat(prefixCls, "-tab-unclosable")
              }, child.props.tab, closeIcon),
              key: (0, _utils.generateKey)(child.key, index)
            }));
          }); // Add new tab handler


          if (!hideAdd) {
            tabBarExtraContent = _react["default"].createElement("span", null, _react["default"].createElement(_icon["default"], {
              type: "plus",
              className: "".concat(prefixCls, "-new-tab"),
              onClick: this.createNewTab
            }), tabBarExtraContent);
          }
        }

      tabBarExtraContent = tabBarExtraContent ? _react["default"].createElement("div", {
        className: "".concat(prefixCls, "-extra-content")
      }, tabBarExtraContent) : null;

      var renderTabBar = function renderTabBar() {
        return _react["default"].createElement(_ScrollableInkTabBar["default"], {
          inkBarAnimated: inkBarAnimated,
          extraContent: tabBarExtraContent,
          onTabClick: onTabClick,
          onPrevClick: onPrevClick,
          onNextClick: onNextClick,
          style: tabBarStyle,
          tabBarGutter: tabBarGutter
        });
      };

      return _react["default"].createElement(_tabs["default"], (0, _extends2["default"])({}, this.props, {
        prefixCls: prefixCls,
        className: cls,
        tabBarPosition: tabPosition,
        renderTabBar: renderTabBar,
        renderTabContent: function renderTabContent() {
          return _react["default"].createElement(_tabs.TabContent, {
            animated: tabPaneAnimated,
            animatedWithMargin: true
          });
        },
        onChange: this.handleChange
      }), childrenWithClose.length > 0 ? childrenWithClose : children);
    }
  }]);
  return Tabs;
}(_react.Component);

exports["default"] = Tabs;
Tabs.displayName = 'Tabs';
Tabs.TabPane = _tabs.TabPane;
Tabs.defaultProps = {
  hideAdd: false
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhYnMvaW5kZXguanMiXSwibmFtZXMiOlsiVGFicyIsIkNvbXBvbmVudCIsIm9uRWRpdCIsImUiLCJvbkNoYW5nZSIsIk5PX0ZMRVgiLCJ0YWJOb2RlIiwiY3VzdG9taXplUHJlZml4Q2xzIiwiY2xhc3NOYW1lIiwic2l6ZSIsInR5cGUiLCJ0YWJQb3NpdGlvbiIsImNoaWxkcmVuIiwidGFiQmFyU3R5bGUiLCJoaWRlQWRkIiwib25UYWJDbGljayIsIm9uUHJldkNsaWNrIiwib25OZXh0Q2xpY2siLCJhbmltYXRlZCIsInRhYkJhckd1dHRlciIsInRhYkJhckV4dHJhQ29udGVudCIsInByZWZpeENscyIsImlua0JhckFuaW1hdGVkIiwidGFiUGFuZUFuaW1hdGVkIiwiaXNDYXJkIiwiY2xzIiwiY2hpbGRyZW5XaXRoQ2xvc2UiLCJDaGlsZHJlbiIsImNsb3NhYmxlIiwiY2hpbGQiLCJjbG9zZUljb24iLCJJY29uIiwib25DbGljayIsInRhYiIsImtleSIsImNyZWF0ZU5ld1RhYiIsInJlbmRlclRhYkJhciIsIlNjcm9sbGFibGVJbmtUYWJCYXIiLCJleHRyYUNvbnRlbnQiLCJzdHlsZSIsIlJjVGFicyIsInRhYkJhclBvc2l0aW9uIiwicmVuZGVyVGFiQ29udGVudCIsIlRhYkNvbnRlbnQiLCJhbmltYXRlZFdpdGhNYXJnaW4iLCJoYW5kbGVDaGFuZ2UiLCJUYWJQYW5lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBLE1BQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTs7QUFDQSxJQUFBLFNBQUEsR0FBQSxPQUFBLENBQUEsV0FBQSxDQUFBOztBQUNBLElBQUEsV0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsS0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFB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QSxTQUFBLENBQUEsQ0FBQSxhQUFBLENBQW9CcUIsS0FBQUEsQ0FBcEIsU0FBb0JBLENBQXBCLEVBQTRCLENBQUEsR0FBQSxTQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsRUFBQSxFQUFrQixLQUFsQixLQUFBLEVBQThCO0FBQUVuQixRQUFBQSxTQUFTLEVBQVgsU0FBQTtBQUF3QmIsUUFBQUEsU0FBUyxFQUFqQyxHQUFBO0FBQXdDaUMsUUFBQUEsY0FBYyxFQUF0RCxXQUFBO0FBQXFFTCxRQUFBQSxZQUFZLEVBQWpGLFlBQUE7QUFBaUdNLFFBQUFBLGdCQUFnQixFQUFFLFNBQUEsZ0JBQUEsR0FBQTtBQUFBLGlCQUFNLE1BQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxhQUFBLENBQW9CQyxLQUFBQSxDQUFwQixVQUFBLEVBQWdDO0FBQUV6QixZQUFBQSxRQUFRLEVBQVYsZUFBQTtBQUE2QjBCLFlBQUFBLGtCQUFrQixFQUFFO0FBQWpELFdBQWhDLENBQU47QUFBbkgsU0FBQTtBQUFtTnhDLFFBQUFBLFFBQVEsRUFBRSxLQUFLeUM7QUFBbE8sT0FBOUIsQ0FBNUIsRUFBNlNuQixpQkFBaUIsQ0FBakJBLE1BQUFBLEdBQUFBLENBQUFBLEdBQUFBLGlCQUFBQSxHQUFyVCxRQUFRLENBQVI7QUFDSDs7O0VBNUU2QnpCLE1BQUFBLENBQUFBLFM7OztBQThFbENELElBQUksQ0FBSkEsV0FBQUEsR0FBQUEsTUFBQUE7QUFDQUEsSUFBSSxDQUFKQSxPQUFBQSxHQUFlOEMsS0FBQUEsQ0FBZjlDLE9BQUFBO0FBQ0FBLElBQUksQ0FBSkEsWUFBQUEsR0FBb0I7QUFDaEJjLEVBQUFBLE9BQU8sRUFBRTtBQURPLENBQXBCZCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDaGlsZHJlbiwgY2xvbmVFbGVtZW50LCBDb21wb25lbnQsIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgSWNvbiBmcm9tICcuLi9pY29uJztcbmltcG9ydCB3YXJuaW5nIGZyb20gJy4uL191dGlsL3dhcm5pbmcnO1xuaW1wb3J0IGlzRmxleFN1cHBvcnRlZCBmcm9tICcuLi9fdXRpbC9pc0ZsZXhTdXBwb3J0ZWQnO1xuaW1wb3J0IFJjVGFicywgeyBUYWJDb250ZW50LCBUYWJQYW5lIH0gZnJvbSAnLi4vcmMtY29tcG9uZW50cy90YWJzJztcbmltcG9ydCBTY3JvbGxhYmxlSW5rVGFiQmFyIGZyb20gJy4uL3JjLWNvbXBvbmVudHMvdGFicy9TY3JvbGxhYmxlSW5rVGFiQmFyJztcbmltcG9ydCB7IGdlbmVyYXRlS2V5IH0gZnJvbSAnLi4vcmMtY29tcG9uZW50cy90YWJzL3V0aWxzJztcbmltcG9ydCB7IGdldFByZWZpeENscyB9IGZyb20gJy4uL2NvbmZpZ3VyZSc7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWJzIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5jcmVhdGVOZXdUYWIgPSB0YXJnZXRLZXkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBvbkVkaXQgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgICAgICBpZiAob25FZGl0KSB7XG4gICAgICAgICAgICAgICAgb25FZGl0KHRhcmdldEtleSwgJ2FkZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlbW92ZVRhYiA9ICh0YXJnZXRLZXksIGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBpZiAoIXRhcmdldEtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHsgb25FZGl0IH0gPSB0aGlzLnByb3BzO1xuICAgICAgICAgICAgaWYgKG9uRWRpdCkge1xuICAgICAgICAgICAgICAgIG9uRWRpdCh0YXJnZXRLZXksICdyZW1vdmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVDaGFuZ2UgPSAoYWN0aXZlS2V5KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IG9uQ2hhbmdlIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICAgICAgaWYgKG9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgb25DaGFuZ2UoYWN0aXZlS2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGNvbnN0IE5PX0ZMRVggPSAnIG5vLWZsZXgnO1xuICAgICAgICBjb25zdCB0YWJOb2RlID0gZmluZERPTU5vZGUodGhpcyk7XG4gICAgICAgIGlmICh0YWJOb2RlICYmICFpc0ZsZXhTdXBwb3J0ZWQoKSAmJiB0YWJOb2RlLmNsYXNzTmFtZS5pbmRleE9mKE5PX0ZMRVgpID09PSAtMSkge1xuICAgICAgICAgICAgdGFiTm9kZS5jbGFzc05hbWUgKz0gTk9fRkxFWDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgcHJlZml4Q2xzOiBjdXN0b21pemVQcmVmaXhDbHMsIGNsYXNzTmFtZSA9ICcnLCBzaXplLCB0eXBlID0gXCJsaW5lXCIgLyogbGluZSAqLywgdGFiUG9zaXRpb24sIGNoaWxkcmVuLCB0YWJCYXJTdHlsZSwgaGlkZUFkZCwgb25UYWJDbGljaywgb25QcmV2Q2xpY2ssIG9uTmV4dENsaWNrLCBhbmltYXRlZCA9IHRydWUsIHRhYkJhckd1dHRlciwgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCB7IHRhYkJhckV4dHJhQ29udGVudCB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgcHJlZml4Q2xzID0gZ2V0UHJlZml4Q2xzKCd0YWJzJywgY3VzdG9taXplUHJlZml4Q2xzKTtcbiAgICAgICAgY29uc3QgaW5rQmFyQW5pbWF0ZWQgPSB0eXBlb2YgYW5pbWF0ZWQgPT09ICdvYmplY3QnID8gYW5pbWF0ZWQuaW5rQmFyIDogYW5pbWF0ZWQ7XG4gICAgICAgIGxldCB0YWJQYW5lQW5pbWF0ZWQgPSB0eXBlb2YgYW5pbWF0ZWQgPT09ICdvYmplY3QnID8gYW5pbWF0ZWQudGFiUGFuZSA6IGFuaW1hdGVkO1xuICAgICAgICAvLyBjYXJkIHRhYnMgc2hvdWxkIG5vdCBoYXZlIGFuaW1hdGlvblxuICAgICAgICBpZiAodHlwZSAhPT0gXCJsaW5lXCIgLyogbGluZSAqLykge1xuICAgICAgICAgICAgdGFiUGFuZUFuaW1hdGVkID0gJ2FuaW1hdGVkJyBpbiB0aGlzLnByb3BzID8gdGFiUGFuZUFuaW1hdGVkIDogZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNDYXJkID0gdHlwZSA9PT0gXCJjYXJkXCIgLyogY2FyZCAqLyB8fCB0eXBlID09PSBcImVkaXRhYmxlLWNhcmRcIiAvKiAnZWRpdGFibGUtY2FyZCcgKi87XG4gICAgICAgIHdhcm5pbmcoIShpc0NhcmQgJiYgKHNpemUgPT09IFwic21hbGxcIiAvKiBzbWFsbCAqLyB8fCBzaXplID09PSBcImxhcmdlXCIgLyogbGFyZ2UgKi8pKSwgXCJUYWJzW3R5cGU9Y2FyZHxlZGl0YWJsZS1jYXJkXSBkb2Vzbid0IGhhdmUgc21hbGwgb3IgbGFyZ2Ugc2l6ZSwgaXQncyBieSBkZXNpZ25lZC5cIik7XG4gICAgICAgIGNvbnN0IGNscyA9IGNsYXNzTmFtZXMoY2xhc3NOYW1lLCBgJHtwcmVmaXhDbHN9LSR7dHlwZX1gLCB7XG4gICAgICAgICAgICBbYCR7cHJlZml4Q2xzfS12ZXJ0aWNhbGBdOiB0YWJQb3NpdGlvbiA9PT0gXCJsZWZ0XCIgLyogbGVmdCAqLyB8fCB0YWJQb3NpdGlvbiA9PT0gXCJyaWdodFwiIC8qIHJpZ2h0ICovLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tJHtzaXplfWBdOiAhIXNpemUsXG4gICAgICAgICAgICBbYCR7cHJlZml4Q2xzfS1jYXJkYF06IGlzQ2FyZCxcbiAgICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LW5vLWFuaW1hdGlvbmBdOiAhdGFiUGFuZUFuaW1hdGVkLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gb25seSBjYXJkIHR5cGUgdGFicyBjYW4gYmUgYWRkZWQgYW5kIGNsb3NlZFxuICAgICAgICBsZXQgY2hpbGRyZW5XaXRoQ2xvc2UgPSBbXTtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwiZWRpdGFibGUtY2FyZFwiIC8qICdlZGl0YWJsZS1jYXJkJyAqLykge1xuICAgICAgICAgICAgY2hpbGRyZW5XaXRoQ2xvc2UgPSBbXTtcbiAgICAgICAgICAgIENoaWxkcmVuLmZvckVhY2goY2hpbGRyZW4sIChjaGlsZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgY2xvc2FibGUgPSBjaGlsZC5wcm9wcy5jbG9zYWJsZTtcbiAgICAgICAgICAgICAgICBjbG9zYWJsZSA9IHR5cGVvZiBjbG9zYWJsZSA9PT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDogY2xvc2FibGU7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xvc2VJY29uID0gY2xvc2FibGUgPyAoUmVhY3QuY3JlYXRlRWxlbWVudChJY29uLCB7IHR5cGU6IFwiY2xvc2VcIiwgb25DbGljazogZSA9PiB0aGlzLnJlbW92ZVRhYihjaGlsZC5rZXksIGUpIH0pKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgY2hpbGRyZW5XaXRoQ2xvc2UucHVzaChjbG9uZUVsZW1lbnQoY2hpbGQsIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiOiAoUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogY2xvc2FibGUgPyB1bmRlZmluZWQgOiBgJHtwcmVmaXhDbHN9LXRhYi11bmNsb3NhYmxlYCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQucHJvcHMudGFiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VJY29uKSksXG4gICAgICAgICAgICAgICAgICAgIGtleTogZ2VuZXJhdGVLZXkoY2hpbGQua2V5LCBpbmRleCksXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBBZGQgbmV3IHRhYiBoYW5kbGVyXG4gICAgICAgICAgICBpZiAoIWhpZGVBZGQpIHtcbiAgICAgICAgICAgICAgICB0YWJCYXJFeHRyYUNvbnRlbnQgPSAoUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChJY29uLCB7IHR5cGU6IFwicGx1c1wiLCBjbGFzc05hbWU6IGAke3ByZWZpeENsc30tbmV3LXRhYmAsIG9uQ2xpY2s6IHRoaXMuY3JlYXRlTmV3VGFiIH0pLFxuICAgICAgICAgICAgICAgICAgICB0YWJCYXJFeHRyYUNvbnRlbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YWJCYXJFeHRyYUNvbnRlbnQgPSB0YWJCYXJFeHRyYUNvbnRlbnQgPyAoUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogYCR7cHJlZml4Q2xzfS1leHRyYS1jb250ZW50YCB9LCB0YWJCYXJFeHRyYUNvbnRlbnQpKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IHJlbmRlclRhYkJhciA9ICgpID0+IChSZWFjdC5jcmVhdGVFbGVtZW50KFNjcm9sbGFibGVJbmtUYWJCYXIsIHsgaW5rQmFyQW5pbWF0ZWQ6IGlua0JhckFuaW1hdGVkLCBleHRyYUNvbnRlbnQ6IHRhYkJhckV4dHJhQ29udGVudCwgb25UYWJDbGljazogb25UYWJDbGljaywgb25QcmV2Q2xpY2s6IG9uUHJldkNsaWNrLCBvbk5leHRDbGljazogb25OZXh0Q2xpY2ssIHN0eWxlOiB0YWJCYXJTdHlsZSwgdGFiQmFyR3V0dGVyOiB0YWJCYXJHdXR0ZXIgfSkpO1xuICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmNUYWJzLCBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnByb3BzLCB7IHByZWZpeENsczogcHJlZml4Q2xzLCBjbGFzc05hbWU6IGNscywgdGFiQmFyUG9zaXRpb246IHRhYlBvc2l0aW9uLCByZW5kZXJUYWJCYXI6IHJlbmRlclRhYkJhciwgcmVuZGVyVGFiQ29udGVudDogKCkgPT4gUmVhY3QuY3JlYXRlRWxlbWVudChUYWJDb250ZW50LCB7IGFuaW1hdGVkOiB0YWJQYW5lQW5pbWF0ZWQsIGFuaW1hdGVkV2l0aE1hcmdpbjogdHJ1ZSB9KSwgb25DaGFuZ2U6IHRoaXMuaGFuZGxlQ2hhbmdlIH0pLCBjaGlsZHJlbldpdGhDbG9zZS5sZW5ndGggPiAwID8gY2hpbGRyZW5XaXRoQ2xvc2UgOiBjaGlsZHJlbikpO1xuICAgIH1cbn1cblRhYnMuZGlzcGxheU5hbWUgPSAnVGFicyc7XG5UYWJzLlRhYlBhbmUgPSBUYWJQYW5lO1xuVGFicy5kZWZhdWx0UHJvcHMgPSB7XG4gICAgaGlkZUFkZDogZmFsc2UsXG59O1xuIl19