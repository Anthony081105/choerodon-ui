{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components-pro/table/TableEditor.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { cloneElement, Component, isValidElement, ReactElement } from 'react';\nimport PropTypes from 'prop-types';\nimport { runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport noop from 'lodash/noop';\nimport KeyCode from 'choerodon-ui/lib/_util/KeyCode';\nimport { pxToRem } from 'choerodon-ui/lib/_util/UnitConvertor';\nimport Row from 'choerodon-ui/lib/row';\nimport Col from 'choerodon-ui/lib/col';\nimport { ColumnProps } from './Column';\nimport { ElementProps } from '../core/ViewComponent';\nimport { FormField, FormFieldProps } from '../field/FormField';\nimport TableContext from './TableContext';\nimport { findCell, getColumnKey, getEditorByColumnAndRecord, getEditorByField, isRadio } from './utils';\nimport { stopEvent } from '../_util/EventManager';\nimport { ShowHelp } from '../field/enum';\nimport autobind from '../_util/autobind';\n\nexport interface TableEditorProps extends ElementProps {\n  column: ColumnProps;\n}\n\n@observer\nexport default class TableEditor extends Component<TableEditorProps> {\n  static displayName = 'TableEditor';\n\n  static propTypes = {\n    column: PropTypes.object.isRequired,\n  };\n\n  static contextType = TableContext;\n\n  editorProps?: any;\n\n  editor: FormField<FormFieldProps> | null;\n\n  editing: boolean = false;\n\n  currentEditorName?: string;\n\n  @autobind\n  onWindowResize() {\n    this.forceUpdate();\n  }\n\n  /**\n   * 触发多行编辑器失焦切换编辑/只读模式\n   * @param e\n   */\n  @autobind\n  onWindowClick(e) {\n    const { prefixCls } = this.props;\n    if (e.target.className !== `${prefixCls}-content`) {\n      this.handleEditorBlur(e);\n    }\n  }\n\n  componentDidMount() {\n    const { column: { name } } = this.props;\n    const {\n      tableStore: { dataSet, currentEditRecord },\n    } = this.context;\n    const record = currentEditRecord || dataSet.current;\n    const field = record?.getField(name) || dataSet.getField(name);\n    if (field?.get('multiLine')) {\n      window.addEventListener('click', this.onWindowClick);\n    }\n    window.addEventListener('resize', this.onWindowResize);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onWindowResize);\n    window.removeEventListener('click', this.onWindowClick);\n  }\n\n  @autobind\n  saveRef(node) {\n    this.editor = node;\n  }\n\n  @autobind\n  handleEditorKeyEnterDown(e) {\n    const { tableStore } = this.context;\n    const editorNextKeyEnterDown = tableStore.editorNextKeyEnterDown;\n    if (!e.isDefaultPrevented() && editorNextKeyEnterDown) {\n      this.showNextEditor(e.shiftKey);\n    }\n  }\n\n  @autobind\n  handleEditorKeyDown(e) {\n    if (e.keyCode !== KeyCode.ESC || !e.isDefaultPrevented()) {\n      const { tableStore } = this.context;\n      switch (e.keyCode) {\n        case KeyCode.ESC:\n        case KeyCode.TAB: {\n          const { prefixCls, column } = this.props;\n          const cell = findCell(tableStore, prefixCls, getColumnKey(column));\n          if (cell) {\n            cell.focus();\n          }\n          this.hideEditor();\n          break;\n        }\n        case KeyCode.PAGE_UP:\n        case KeyCode.PAGE_DOWN:\n          stopEvent(e);\n          break;\n        default:\n      }\n    }\n    const { editorProps } = this;\n    if (editorProps) {\n      const { onKeyDown = noop } = editorProps;\n      onKeyDown(e);\n    }\n  }\n\n  @autobind\n  handleEditorFocus() {\n    const {\n      currentEditorName,\n      context: { tableStore },\n    } = this;\n    if (!tableStore.currentEditorName && currentEditorName) {\n      runInAction(() => {\n        tableStore.currentEditorName = currentEditorName;\n      });\n    }\n  }\n\n  @autobind\n  handleEditorBlur(e) {\n    this.hideEditor();\n    const { editorProps } = this;\n    if (editorProps) {\n      const { onBlur = noop } = editorProps;\n      onBlur(e);\n    }\n  }\n\n  /**\n   * 多行编辑切换编辑器阻止冒泡\n   * @param e\n   */\n  @autobind\n  handleEditorClick(e) {\n    const { editorProps } = this;\n    if (editorProps) {\n      const { onClick = noop } = editorProps;\n      onClick(e);\n    }\n    stopEvent(e);\n  }\n\n  @autobind\n  hideEditor() {\n    if (this.editing) {\n      const { tableStore } = this.context;\n      tableStore.hideEditor();\n    }\n  }\n\n  showNextEditor(reserve: boolean) {\n    if (this.editor) {\n      this.editor.blur();\n    }\n    const { tableStore } = this.context;\n    const { column } = this.props;\n    tableStore.showNextEditor(column.name, reserve);\n  }\n\n  /**\n   * 渲染多行编辑单元格\n   */\n  renderMultiLineEditor(): ReactElement<FormFieldProps> | undefined {\n    const { column: { name }, prefixCls } = this.props;\n    const {\n      tableStore: { dataSet, currentEditRecord, rowHeight, inlineEdit },\n    } = this.context;\n    const record = currentEditRecord || dataSet.current;\n    const multiLineFields = dataSet.props.fields.map(field => {\n      if (field.bind && field.bind.split('.')[0] === name) {\n        return record.getField(field.name) || dataSet.getField(field.name);\n      }\n      return null;\n    }).filter(f => f);\n    if (multiLineFields && multiLineFields.length) {\n      return (\n        <div>\n          {multiLineFields.map((fields, index) => {\n            if (fields) {\n              const editor = getEditorByField(fields);\n              this.editorProps = editor.props;\n              const { style = {}, ...otherProps } = this.editorProps;\n              if (rowHeight !== 'auto') {\n                style.height = pxToRem(rowHeight);\n              }\n              const newEditorProps = {\n                ...otherProps,\n                style,\n                ref: index === 0 ? this.saveRef : '',\n                record,\n                name: fields.get('name'),\n                onKeyDown: this.handleEditorKeyDown,\n                onEnterDown: this.handleEditorKeyEnterDown,\n                onClick: this.handleEditorClick,\n                tabIndex: -1,\n                showHelp: ShowHelp.none,\n                // 目前测试inline时候需要放开限制\n                _inTable: !inlineEdit,\n              };\n              return (\n                <Row key={`${record?.index}-multi-${fields.get('name')}`} className={`${prefixCls}-multi`}>\n                  <Col span={8} className={`${prefixCls}-multi-label`}>{fields.get('label')}</Col>\n                  <Col span={16} className={`${prefixCls}-multi-value`}>{cloneElement<FormFieldProps>(editor, newEditorProps)}</Col>\n                </Row>\n              );\n            }\n            return null;\n          })}\n        </div>\n      );\n    }\n  }\n\n  renderEditor(): ReactElement<FormFieldProps> | undefined {\n    const { column } = this.props;\n    const {\n      tableStore: { dataSet, currentEditRecord, rowHeight, pristine, inlineEdit },\n    } = this.context;\n    const record = currentEditRecord || dataSet.current;\n    const field = record?.getField(column.name);\n    // 多行编辑拦截返回渲染器\n    if (!pristine && field && field.get('multiLine')) {\n      return this.renderMultiLineEditor();\n    }\n    const cellEditor = getEditorByColumnAndRecord(column, record);\n    if (!pristine && isValidElement(cellEditor) && !isRadio(cellEditor)) {\n      this.editorProps = cellEditor.props;\n      const { style = {}, ...otherProps } = this.editorProps;\n      if (rowHeight !== 'auto') {\n        style.height = pxToRem(rowHeight);\n      }\n      const newEditorProps = {\n        ...otherProps,\n        style,\n        ref: this.saveRef,\n        record,\n        name: column.name,\n        onKeyDown: this.handleEditorKeyDown,\n        onEnterDown: this.handleEditorKeyEnterDown,\n        onBlur: this.handleEditorBlur,\n        tabIndex: -1,\n        showHelp: ShowHelp.none,\n        // 目前测试inline时候需要放开限制\n        _inTable: !inlineEdit,\n      };\n      return cloneElement<FormFieldProps>(cellEditor, newEditorProps);\n    }\n  }\n\n  render() {\n    const editor = this.renderEditor();\n    if (editor) {\n      const {\n        prefixCls,\n        column,\n        column: { lock, name },\n      } = this.props;\n      const props: any = {\n        className: `${prefixCls}-editor`,\n      };\n      const editorProps: any = {};\n      const { tableStore } = this.context;\n      if (tableStore.currentEditorName === name || tableStore.currentEditRecord) {\n        this.currentEditorName = name;\n        const cell = findCell(tableStore, prefixCls, getColumnKey(column), lock);\n        if (cell) {\n          this.editing = true;\n          const { offsetLeft, offsetTop, offsetWidth, offsetHeight } = cell;\n          props.style = {\n            left: pxToRem(offsetLeft),\n            top: pxToRem(offsetTop),\n          };\n          editorProps.style = {\n            ...editor.props.style,\n            width: pxToRem(offsetWidth),\n            height: pxToRem(offsetHeight),\n          };\n        }\n      } else if (this.editing) {\n        this.editing = false;\n        editorProps.onFocus = this.handleEditorFocus;\n      }\n      return <div {...props}>{cloneElement(editor, editorProps)}</div>;\n    }\n    return null;\n  }\n\n  componentDidUpdate() {\n    const {\n      column: { name },\n    } = this.props;\n    const { tableStore } = this.context;\n    if (this.editor && this.editing && tableStore.currentEditorName === name) {\n      this.editor.focus();\n    }\n  }\n}\n"]}