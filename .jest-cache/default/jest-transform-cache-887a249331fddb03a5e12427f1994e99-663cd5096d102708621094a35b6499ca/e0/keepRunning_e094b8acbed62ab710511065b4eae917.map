{"version":3,"sources":["/Users/huihuawk/Documents/opt/choerodon-ui/components-pro/_util/keepRunning.tsx"],"names":[],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,SAAS,IAAT,CAAc,EAAd,EAAkB,CAAlB,EAAmB;AAAA;;AACjB,MAAI,CAAC,IAAI,CAAC,CAAC,MAAX,EAAmB;AACjB,IAAA,CAAC,CAAC,OAAF;AACA,QAAM,OAAO,GAAG,IAAI,sBAAJ,EAAhB;AACA,QAAM,MAAM,GAAG,IAAI,sBAAJ,EAAf;AACA,QAAM,KAAK,GAAG,IAAI,wBAAJ,CAAiB,CAAC,CAAC,MAAnB,CAAd;;AACA,QAAM,OAAO,GAAG,SAAV,OAAU,GAAK;AACnB,MAAA,MAAM,CAAC,GAAP,CAAW,EAAX,EAAe,EAAE,CAAC,IAAH,CAAQ,KAAR,EAAc,CAAd,CAAf;AACD,KAFD;;AAGA,QAAM,MAAM,GAAG,SAAT,MAAS,GAAK;AAClB,MAAA,OAAO,CAAC,MAAR;AACA,MAAA,MAAM,CAAC,MAAP;AACA,MAAA,KAAK,CAAC,KAAN;AACD,KAJD;;AAKA,IAAA,OAAO,CAAC,KAAR,CAAc,GAAd,EAAmB,OAAnB;AACA,IAAA,KAAK,CAAC,gBAAN,CAAuB,YAAvB,EAAqC,MAArC;AACA,IAAA,KAAK,CAAC,gBAAN,CAAuB,SAAvB,EAAkC,MAAlC;AACD;;AACD,EAAA,EAAE,CAAC,IAAH,CAAQ,IAAR,EAAc,CAAd;AACD;;AAEa,SAAU,WAAV,CAAsB,MAAtB,EAA8B,GAA9B,EAAmC,UAAnC,EAA6C;AAAA,MACjD,WADiD,GACjC,MADiC,CACjD,WADiD;AAAA,MAE1C,EAF0C,GAEnC,UAFmC,CAEjD,KAFiD;AAGzD,SAAO;AACL,IAAA,YAAY,EAAE,IADT;AAEL,IAAA,GAFK,iBAEF;AACD,UAAI,SAAS,MAAb,EAAqB;AACnB,eAAO,EAAP;AACD;;AAED,UAAI,KAAK,WAAL,KAAqB,WAArB,IAAoC,MAAM,CAAC,cAAP,CAAsB,IAAtB,EAA4B,WAA5B,KAA4C,WAApF,EAAiG;AAC/F,eAAO,EAAP;AACD;;AAED,UAAM,OAAO,GAAG,IAAI,CAAC,IAAL,CAAU,IAAV,EAAgB,EAAhB,CAAhB;AACA,MAAA,MAAM,CAAC,cAAP,CAAsB,IAAtB,EAA4B,GAA5B,EAAiC;AAC/B,QAAA,KAAK,EAAE,OADwB;AAE/B,QAAA,YAAY,EAAE,IAFiB;AAG/B,QAAA,QAAQ,EAAE;AAHqB,OAAjC;AAKA,aAAO,OAAP;AACD,KAlBI;AAmBL,IAAA,GAAG,EAAE,qCAAoB,GAApB;AAnBA,GAAP;AAqBD","sourcesContent":["import createDefaultSetter from './createDefaultSetter';\nimport EventManager from './EventManager';\nimport TaskRunner from './TaskRunner';\n\nfunction keep(fn, e) {\n  if (e && e.target) {\n    e.persist();\n    const delayer = new TaskRunner();\n    const keeper = new TaskRunner();\n    const event = new EventManager(e.target);\n    const delayFn = () => {\n      keeper.run(40, fn.bind(this, e));\n    };\n    const stopFn = () => {\n      delayer.cancel();\n      keeper.cancel();\n      event.clear();\n    };\n    delayer.delay(500, delayFn);\n    event.addEventListener('mouseleave', stopFn);\n    event.addEventListener('mouseup', stopFn);\n  }\n  fn.call(this, e);\n}\n\nexport default function keepRunning(target, key, descriptor) {\n  const { constructor } = target;\n  const { value: fn } = descriptor;\n  return {\n    configurable: true,\n    get() {\n      if (this === target) {\n        return fn;\n      }\n\n      if (this.constructor !== constructor && Object.getPrototypeOf(this).constructor === constructor) {\n        return fn;\n      }\n\n      const boundFn = keep.bind(this, fn);\n      Object.defineProperty(this, key, {\n        value: boundFn,\n        configurable: true,\n        writable: true,\n      });\n      return boundFn;\n    },\n    set: createDefaultSetter(key),\n  };\n}\n"]}