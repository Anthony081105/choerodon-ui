631942c8e69ec53d8c83906e3bc5c530
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _classnames = _interopRequireDefault(require("classnames"));

var _omit = _interopRequireDefault(require("lodash/omit"));

var _icon = _interopRequireDefault(require("../icon"));

var _ripple = _interopRequireDefault(require("../ripple"));

var _configure = require("../configure");

var _progress = _interopRequireDefault(require("../progress"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var Button =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Button, _Component);

  var _super = _createSuper(Button);

  function Button(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, Button);
    _this = _super.call(this, props);

    _this.handleClick = function (e) {
      clearTimeout(_this.timeout);
      _this.timeout = window.setTimeout(function () {
        return _this.setState({
          clicked: false
        });
      }, 500);
      var onClick = _this.props.onClick;

      if (onClick) {
        onClick(e);
      }
    };

    _this.state = {
      loading: props.loading,
      clicked: false
    };
    return _this;
  }

  (0, _createClass2["default"])(Button, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var _this2 = this;

      var currentLoading = this.props.loading;
      var loading = nextProps.loading;

      if (currentLoading) {
        clearTimeout(this.delayTimeout);
      }

      if (typeof loading !== 'boolean' && loading && loading.delay) {
        this.delayTimeout = window.setTimeout(function () {
          return _this2.setState({
            loading: loading
          });
        }, loading.delay);
      } else {
        this.setState({
          loading: loading
        });
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      if (this.timeout) {
        clearTimeout(this.timeout);
      }

      if (this.delayTimeout) {
        clearTimeout(this.delayTimeout);
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _classNames;

      var _this$props = this.props,
          customizePrefixCls = _this$props.prefixCls,
          type = _this$props.type,
          shape = _this$props.shape,
          size = _this$props.size,
          className = _this$props.className,
          htmlType = _this$props.htmlType,
          children = _this$props.children,
          icon = _this$props.icon,
          ghost = _this$props.ghost,
          funcType = _this$props.funcType,
          others = (0, _objectWithoutProperties2["default"])(_this$props, ["prefixCls", "type", "shape", "size", "className", "htmlType", "children", "icon", "ghost", "funcType"]);
      var _this$state = this.state,
          loading = _this$state.loading,
          clicked = _this$state.clicked;
      var prefixCls = (0, _configure.getPrefixCls)('btn', customizePrefixCls); // large => lg
      // small => sm

      var sizeCls = '';

      switch (size) {
        case "large"
        /* large */
        :
          sizeCls = 'lg';
          break;

        case "small"
        /* small */
        :
          sizeCls = 'sm';
          break;

        default:
      }

      var ComponentProp = others.href ? 'a' : 'button';
      var classes = (0, _classnames["default"])(prefixCls, className, (_classNames = {}, (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-").concat(type), type), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-").concat(shape), shape), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-").concat(sizeCls), sizeCls), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-icon-only"), !children && icon), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-loading"), loading), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-clicked"), clicked), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-background-ghost"), ghost), (0, _defineProperty2["default"])(_classNames, "".concat(prefixCls, "-").concat(funcType), funcType), _classNames));
      var iconNode = icon ? _react["default"].createElement(_icon["default"], {
        type: icon
      }) : null;
      iconNode = loading ? _react["default"].createElement(_progress["default"], {
        key: "loading",
        type: "loading"
        /* loading */
        ,
        size: "small"
        /* small */

      }) : iconNode;
      var kids = children || children === 0 ? _react.Children.map(children, function (child) {
        if (typeof child === 'string') {
          return _react["default"].createElement("span", null, child);
        }

        return child;
      }) : null;
      return _react["default"].createElement(_ripple["default"], {
        disabled: others.disabled
      }, _react["default"].createElement(ComponentProp, (0, _extends2["default"])({}, (0, _omit["default"])(others, ['loading']), {
        // 如果没有href属性，则表示组件使用button标签，type为'submit' | 'reset' | 'button'
        type: others.href ? undefined : htmlType || 'button',
        className: classes,
        onClick: this.handleClick
      }), iconNode, kids));
    }
  }]);
  return Button;
}(_react.Component);

exports["default"] = Button;
Button.displayName = 'Button';
Button.__ANT_BUTTON = true;
Button.defaultProps = {
  loading: false,
  ghost: false,
  funcType: 'flat'
};
Button.propTypes = {
  type: _propTypes["default"].string,
  shape: _propTypes["default"].oneOf(['circle', 'circle-outline']),
  size: _propTypes["default"].oneOf(["large"
  /* large */
  , "default"
  /* default */
  , "small"
  /* small */
  ]),
  htmlType: _propTypes["default"].oneOf(['submit', 'button', 'reset']),
  onClick: _propTypes["default"].func,
  loading: _propTypes["default"].oneOfType([_propTypes["default"].bool, _propTypes["default"].object]),
  className: _propTypes["default"].string,
  icon: _propTypes["default"].string,
  ghost: _propTypes["default"].bool,
  funcType: _propTypes["default"].oneOf(['raised', 'flat'])
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1dHRvbi9CdXR0b24uanMiXSwibmFtZXMiOlsiQnV0dG9uIiwiQ29tcG9uZW50IiwiY2xlYXJUaW1lb3V0IiwiY2xpY2tlZCIsIm9uQ2xpY2siLCJsb2FkaW5nIiwicHJvcHMiLCJuZXh0UHJvcHMiLCJjdXJyZW50TG9hZGluZyIsImN1c3RvbWl6ZVByZWZpeENscyIsInR5cGUiLCJzaGFwZSIsInNpemUiLCJjbGFzc05hbWUiLCJodG1sVHlwZSIsImNoaWxkcmVuIiwiaWNvbiIsImdob3N0IiwiZnVuY1R5cGUiLCJvdGhlcnMiLCJwcmVmaXhDbHMiLCJzaXplQ2xzIiwiQ29tcG9uZW50UHJvcCIsImNsYXNzZXMiLCJpY29uTm9kZSIsIkljb24iLCJQcm9ncmVzcyIsImtleSIsImtpZHMiLCJSZWFjdCIsIlJpcHBsZSIsImRpc2FibGVkIiwiaGFuZGxlQ2xpY2siLCJQcm9wVHlwZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsTUFBQSxHQUFBLHVCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsVUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsV0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsS0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLGFBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsS0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsT0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsVUFBQSxHQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUE7O0FBQ0EsSUFBQSxTQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxDQUFBLENBQUE7Ozs7Ozs7Ozs7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QUFFb0IsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FQSSxNQUFBO0FBUWZqQixFQUFBQSxJQUFJLEVBQUVpQixVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQVJTLE1BQUE7QUFTZmhCLEVBQUFBLEtBQUssRUFBRWdCLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBVFEsSUFBQTtBQVVmZixFQUFBQSxRQUFRLEVBQUVlLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQUFBLEtBQUFBLENBQWdCLENBQUEsUUFBQSxFQUFoQkEsTUFBZ0IsQ0FBaEJBO0FBVkssQ0FBbkJqQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDaGlsZHJlbiwgQ29tcG9uZW50LCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBvbWl0IGZyb20gJ2xvZGFzaC9vbWl0JztcbmltcG9ydCBJY29uIGZyb20gJy4uL2ljb24nO1xuaW1wb3J0IFJpcHBsZSBmcm9tICcuLi9yaXBwbGUnO1xuaW1wb3J0IHsgZ2V0UHJlZml4Q2xzIH0gZnJvbSAnLi4vY29uZmlndXJlJztcbmltcG9ydCBQcm9ncmVzcyBmcm9tICcuLi9wcm9ncmVzcyc7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCdXR0b24gZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5oYW5kbGVDbGljayA9IGUgPT4ge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB0aGlzLnNldFN0YXRlKHsgY2xpY2tlZDogZmFsc2UgfSksIDUwMCk7XG4gICAgICAgICAgICBjb25zdCB7IG9uQ2xpY2sgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgICAgICBpZiAob25DbGljaykge1xuICAgICAgICAgICAgICAgIG9uQ2xpY2soZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBsb2FkaW5nOiBwcm9wcy5sb2FkaW5nLFxuICAgICAgICAgICAgY2xpY2tlZDogZmFsc2UsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGNvbnN0IHsgbG9hZGluZzogY3VycmVudExvYWRpbmcgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IHsgbG9hZGluZyB9ID0gbmV4dFByb3BzO1xuICAgICAgICBpZiAoY3VycmVudExvYWRpbmcpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmRlbGF5VGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBsb2FkaW5nICE9PSAnYm9vbGVhbicgJiYgbG9hZGluZyAmJiBsb2FkaW5nLmRlbGF5KSB7XG4gICAgICAgICAgICB0aGlzLmRlbGF5VGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMuc2V0U3RhdGUoeyBsb2FkaW5nIH0pLCBsb2FkaW5nLmRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsb2FkaW5nIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kZWxheVRpbWVvdXQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmRlbGF5VGltZW91dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7IHByZWZpeENsczogY3VzdG9taXplUHJlZml4Q2xzLCB0eXBlLCBzaGFwZSwgc2l6ZSwgY2xhc3NOYW1lLCBodG1sVHlwZSwgY2hpbGRyZW4sIGljb24sIGdob3N0LCBmdW5jVHlwZSwgLi4ub3RoZXJzIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7IGxvYWRpbmcsIGNsaWNrZWQgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGNvbnN0IHByZWZpeENscyA9IGdldFByZWZpeENscygnYnRuJywgY3VzdG9taXplUHJlZml4Q2xzKTtcbiAgICAgICAgLy8gbGFyZ2UgPT4gbGdcbiAgICAgICAgLy8gc21hbGwgPT4gc21cbiAgICAgICAgbGV0IHNpemVDbHMgPSAnJztcbiAgICAgICAgc3dpdGNoIChzaXplKSB7XG4gICAgICAgICAgICBjYXNlIFwibGFyZ2VcIiAvKiBsYXJnZSAqLzpcbiAgICAgICAgICAgICAgICBzaXplQ2xzID0gJ2xnJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzbWFsbFwiIC8qIHNtYWxsICovOlxuICAgICAgICAgICAgICAgIHNpemVDbHMgPSAnc20nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBDb21wb25lbnRQcm9wID0gb3RoZXJzLmhyZWYgPyAnYScgOiAnYnV0dG9uJztcbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IGNsYXNzTmFtZXMocHJlZml4Q2xzLCBjbGFzc05hbWUsIHtcbiAgICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LSR7dHlwZX1gXTogdHlwZSxcbiAgICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LSR7c2hhcGV9YF06IHNoYXBlLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tJHtzaXplQ2xzfWBdOiBzaXplQ2xzLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30taWNvbi1vbmx5YF06ICFjaGlsZHJlbiAmJiBpY29uLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tbG9hZGluZ2BdOiBsb2FkaW5nLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tY2xpY2tlZGBdOiBjbGlja2VkLFxuICAgICAgICAgICAgW2Ake3ByZWZpeENsc30tYmFja2dyb3VuZC1naG9zdGBdOiBnaG9zdCxcbiAgICAgICAgICAgIFtgJHtwcmVmaXhDbHN9LSR7ZnVuY1R5cGV9YF06IGZ1bmNUeXBlLFxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGljb25Ob2RlID0gaWNvbiA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoSWNvbiwgeyB0eXBlOiBpY29uIH0pIDogbnVsbDtcbiAgICAgICAgaWNvbk5vZGUgPSBsb2FkaW5nID8gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoUHJvZ3Jlc3MsIHsga2V5OiBcImxvYWRpbmdcIiwgdHlwZTogXCJsb2FkaW5nXCIgLyogbG9hZGluZyAqLywgc2l6ZTogXCJzbWFsbFwiIC8qIHNtYWxsICovIH0pKSA6IChpY29uTm9kZSk7XG4gICAgICAgIGNvbnN0IGtpZHMgPSBjaGlsZHJlbiB8fCBjaGlsZHJlbiA9PT0gMFxuICAgICAgICAgICAgPyBDaGlsZHJlbi5tYXAoY2hpbGRyZW4sIGNoaWxkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNoaWxkID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgbnVsbCwgY2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICByZXR1cm4gKFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmlwcGxlLCB7IGRpc2FibGVkOiBvdGhlcnMuZGlzYWJsZWQgfSxcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29tcG9uZW50UHJvcCwgT2JqZWN0LmFzc2lnbih7fSwgb21pdChvdGhlcnMsIFsnbG9hZGluZyddKSwgeyBcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmsqHmnIlocmVm5bGe5oCn77yM5YiZ6KGo56S657uE5Lu25L2/55SoYnV0dG9u5qCH562+77yMdHlwZeS4uidzdWJtaXQnIHwgJ3Jlc2V0JyB8ICdidXR0b24nXG4gICAgICAgICAgICAgICAgdHlwZTogb3RoZXJzLmhyZWYgPyB1bmRlZmluZWQgOiBodG1sVHlwZSB8fCAnYnV0dG9uJywgY2xhc3NOYW1lOiBjbGFzc2VzLCBvbkNsaWNrOiB0aGlzLmhhbmRsZUNsaWNrIH0pLFxuICAgICAgICAgICAgICAgIGljb25Ob2RlLFxuICAgICAgICAgICAgICAgIGtpZHMpKSk7XG4gICAgfVxufVxuQnV0dG9uLmRpc3BsYXlOYW1lID0gJ0J1dHRvbic7XG5CdXR0b24uX19BTlRfQlVUVE9OID0gdHJ1ZTtcbkJ1dHRvbi5kZWZhdWx0UHJvcHMgPSB7XG4gICAgbG9hZGluZzogZmFsc2UsXG4gICAgZ2hvc3Q6IGZhbHNlLFxuICAgIGZ1bmNUeXBlOiAnZmxhdCcsXG59O1xuQnV0dG9uLnByb3BUeXBlcyA9IHtcbiAgICB0eXBlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHNoYXBlOiBQcm9wVHlwZXMub25lT2YoWydjaXJjbGUnLCAnY2lyY2xlLW91dGxpbmUnXSksXG4gICAgc2l6ZTogUHJvcFR5cGVzLm9uZU9mKFtcImxhcmdlXCIgLyogbGFyZ2UgKi8sIFwiZGVmYXVsdFwiIC8qIGRlZmF1bHQgKi8sIFwic21hbGxcIiAvKiBzbWFsbCAqL10pLFxuICAgIGh0bWxUeXBlOiBQcm9wVHlwZXMub25lT2YoWydzdWJtaXQnLCAnYnV0dG9uJywgJ3Jlc2V0J10pLFxuICAgIG9uQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICAgIGxvYWRpbmc6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5ib29sLCBQcm9wVHlwZXMub2JqZWN0XSksXG4gICAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGljb246IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgZ2hvc3Q6IFByb3BUeXBlcy5ib29sLFxuICAgIGZ1bmNUeXBlOiBQcm9wVHlwZXMub25lT2YoWydyYWlzZWQnLCAnZmxhdCddKSxcbn07XG4iXX0=