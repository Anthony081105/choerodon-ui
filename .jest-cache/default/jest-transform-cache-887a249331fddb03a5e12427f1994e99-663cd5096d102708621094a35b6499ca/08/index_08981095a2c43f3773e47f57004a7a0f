7d47b9aad83eff722b4ead3b10b50589
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _placements = _interopRequireDefault(require("./placements"));

var _tooltip = _interopRequireDefault(require("../rc-components/tooltip"));

var _configure = require("../configure");

var splitObject = function splitObject(obj, keys) {
  var picked = {};
  var omited = (0, _objectSpread2["default"])({}, obj);
  keys.forEach(function (key) {
    if (obj && key in obj) {
      picked[key] = obj[key];
      delete omited[key];
    }
  });
  return {
    picked: picked,
    omited: omited
  };
};

var Tooltip =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(Tooltip, _Component);

  function Tooltip(props) {
    var _this;

    (0, _classCallCheck2["default"])(this, Tooltip);
    _this = (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(Tooltip).call(this, props));

    _this.onVisibleChange = function (visible) {
      var onVisibleChange = _this.props.onVisibleChange;

      if (!('visible' in _this.props)) {
        _this.setState({
          visible: _this.isNoTitle() ? false : visible
        });
      }

      if (onVisibleChange && !_this.isNoTitle()) {
        onVisibleChange(visible);
      }
    }; // 动态设置动画点


    _this.onPopupAlign = function (domNode, align) {
      var placements = _this.getPlacements(); // 当前返回的位置


      var placement = Object.keys(placements).filter(function (key) {
        return placements[key].points[0] === align.points[0] && placements[key].points[1] === align.points[1];
      })[0];

      if (!placement) {
        return;
      } // 根据当前坐标设置动画点


      var rect = domNode.getBoundingClientRect();
      var transformOrigin = {
        top: '50%',
        left: '50%'
      };

      if (placement.indexOf('top') >= 0 || placement.indexOf('Bottom') >= 0) {
        transformOrigin.top = "".concat(rect.height - align.offset[1], "px");
      } else if (placement.indexOf('Top') >= 0 || placement.indexOf('bottom') >= 0) {
        transformOrigin.top = "".concat(-align.offset[1], "px");
      }

      if (placement.indexOf('left') >= 0 || placement.indexOf('Right') >= 0) {
        transformOrigin.left = "".concat(rect.width - align.offset[0], "px");
      } else if (placement.indexOf('right') >= 0 || placement.indexOf('Left') >= 0) {
        transformOrigin.left = "".concat(-align.offset[0], "px");
      }

      domNode.style.transformOrigin = "".concat(transformOrigin.left, " ").concat(transformOrigin.top);
    };

    _this.saveTooltip = function (node) {
      _this.tooltip = node;
    };

    _this.state = {
      visible: !!props.visible || !!props.defaultVisible
    };
    return _this;
  }

  (0, _createClass2["default"])(Tooltip, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if ('visible' in nextProps) {
        this.setState({
          visible: nextProps.visible
        });
      }
    }
  }, {
    key: "getPopupDomNode",
    value: function getPopupDomNode() {
      return this.tooltip.getPopupDomNode();
    }
  }, {
    key: "getPlacements",
    value: function getPlacements() {
      var _this$props = this.props,
          builtinPlacements = _this$props.builtinPlacements,
          arrowPointAtCenter = _this$props.arrowPointAtCenter,
          autoAdjustOverflow = _this$props.autoAdjustOverflow;
      return builtinPlacements || (0, _placements["default"])({
        arrowPointAtCenter: arrowPointAtCenter,
        verticalArrowShift: 8,
        autoAdjustOverflow: autoAdjustOverflow
      });
    }
  }, {
    key: "isHoverTrigger",
    value: function isHoverTrigger() {
      var trigger = this.props.trigger;

      if (!trigger || trigger === 'hover') {
        return true;
      }

      if (Array.isArray(trigger)) {
        return trigger.indexOf('hover') >= 0;
      }

      return false;
    } // Fix Tooltip won't hide at disabled button
    // mouse events don't trigger at disabled button in Chrome
    // https://github.com/react-component/tooltip/issues/18

  }, {
    key: "getDisabledCompatibleChildren",
    value: function getDisabledCompatibleChildren(element) {
      if ((element.type.__ANT_BUTTON || element.type === 'button') && element.props.disabled && this.isHoverTrigger()) {
        // Pick some layout related style properties up to span
        var _splitObject = splitObject(element.props.style, ['position', 'left', 'right', 'top', 'bottom', 'float', 'display', 'zIndex']),
            picked = _splitObject.picked,
            omited = _splitObject.omited;

        var spanStyle = (0, _objectSpread2["default"])({
          display: 'inline-block'
        }, picked, {
          cursor: 'not-allowed'
        });
        var buttonStyle = (0, _objectSpread2["default"])({}, omited, {
          pointerEvents: 'none'
        });
        var child = (0, _react.cloneElement)(element, {
          style: buttonStyle,
          className: null
        });
        return _react["default"].createElement("span", {
          style: spanStyle,
          className: element.props.className
        }, child);
      }

      return element;
    }
  }, {
    key: "isNoTitle",
    value: function isNoTitle() {
      var _this$props2 = this.props,
          title = _this$props2.title,
          overlay = _this$props2.overlay;
      return !title && !overlay; // overlay for old version compatibility
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props,
          state = this.state;
      var customizePrefixCls = props.prefixCls,
          title = props.title,
          overlay = props.overlay,
          openClassName = props.openClassName,
          getPopupContainer = props.getPopupContainer,
          getTooltipContainer = props.getTooltipContainer;
      var prefixCls = (0, _configure.getPrefixCls)('tooltip', customizePrefixCls);
      var children = props.children;
      var visible = state.visible; // Hide tooltip when there is no title

      if (!('visible' in props) && this.isNoTitle()) {
        visible = false;
      }

      var child = this.getDisabledCompatibleChildren((0, _react.isValidElement)(children) ? children : _react["default"].createElement("span", null, children));
      var childProps = child.props;
      var childCls = (0, _classnames["default"])(childProps.className, (0, _defineProperty2["default"])({}, openClassName || "".concat(prefixCls, "-open"), true));
      return _react["default"].createElement(_tooltip["default"], (0, _extends2["default"])({}, this.props, {
        prefixCls: prefixCls,
        getTooltipContainer: getPopupContainer || getTooltipContainer,
        ref: this.saveTooltip,
        builtinPlacements: this.getPlacements(),
        overlay: overlay || title || '',
        visible: visible,
        onVisibleChange: this.onVisibleChange,
        onPopupAlign: this.onPopupAlign
      }), visible ? (0, _react.cloneElement)(child, {
        className: childCls
      }) : child);
    }
  }]);
  return Tooltip;
}(_react.Component);

exports["default"] = Tooltip;
Tooltip.displayName = 'Tooltip';
Tooltip.defaultProps = {
  placement: 'top',
  transitionName: 'zoom-big-fast',
  mouseEnterDelay: 0.1,
  mouseLeaveDelay: 0.1,
  arrowPointAtCenter: false,
  autoAdjustOverflow: true
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvb2x0aXAvaW5kZXguanMiXSwibmFtZXMiOlsic3BsaXRPYmplY3QiLCJwaWNrZWQiLCJvbWl0ZWQiLCJrZXlzIiwib2JqIiwia2V5IiwiVG9vbHRpcCIsIkNvbXBvbmVudCIsIm9uVmlzaWJsZUNoYW5nZSIsInZpc2libGUiLCJwbGFjZW1lbnRzIiwicGxhY2VtZW50IiwiYWxpZ24iLCJyZWN0IiwiZG9tTm9kZSIsInRyYW5zZm9ybU9yaWdpbiIsInRvcCIsImxlZnQiLCJwcm9wcyIsImRlZmF1bHRWaXNpYmxlIiwibmV4dFByb3BzIiwiYnVpbHRpblBsYWNlbWVudHMiLCJhcnJvd1BvaW50QXRDZW50ZXIiLCJhdXRvQWRqdXN0T3ZlcmZsb3ciLCJ2ZXJ0aWNhbEFycm93U2hpZnQiLCJ0cmlnZ2VyIiwiQXJyYXkiLCJlbGVtZW50Iiwic3BhblN0eWxlIiwiZGlzcGxheSIsImN1cnNvciIsImJ1dHRvblN0eWxlIiwicG9pbnRlckV2ZW50cyIsImNoaWxkIiwic3R5bGUiLCJjbGFzc05hbWUiLCJ0aXRsZSIsIm92ZXJsYXkiLCJzdGF0ZSIsImN1c3RvbWl6ZVByZWZpeENscyIsIm9wZW5DbGFzc05hbWUiLCJnZXRQb3B1cENvbnRhaW5lciIsImdldFRvb2x0aXBDb250YWluZXIiLCJwcmVmaXhDbHMiLCJjaGlsZHJlbiIsIlJlYWN0IiwiY2hpbGRQcm9wcyIsImNoaWxkQ2xzIiwiUmNUb29sdGlwIiwicmVmIiwib25Qb3B1cEFsaWduIiwidHJhbnNpdGlvbk5hbWUiLCJtb3VzZUVudGVyRGVsYXkiLCJtb3VzZUxlYXZlRGVsYXkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsTUFBQSxHQUFBLHVCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsV0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsV0FBQSxHQUFBLHNCQUFBLENB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LEVBQWpJO0FBQXVKZ0IsUUFBQUEsT0FBTyxFQUFFQSxPQUFPLElBQVBBLEtBQUFBLElBQWhLLEVBQUE7QUFBd0w1QixRQUFBQSxPQUFPLEVBQS9MLE9BQUE7QUFBME1ELFFBQUFBLGVBQWUsRUFBRSxLQUEzTixlQUFBO0FBQWlQMEMsUUFBQUEsWUFBWSxFQUFFLEtBQUtBO0FBQXBRLE9BQTlCLENBQS9CLEVBQWtWekMsT0FBTyxHQUFHLENBQUEsR0FBQSxNQUFBLENBQUEsWUFBQSxFQUFBLEtBQUEsRUFBb0I7QUFBRTBCLFFBQUFBLFNBQVMsRUFBRVk7QUFBYixPQUFwQixDQUFILEdBQWpXLEtBQVEsQ0FBUjtBQUNIOzs7RUFsSWdDeEMsTUFBQUEsQ0FBQUEsUzs7O0FBb0lyQ0QsT0FBTyxDQUFQQSxXQUFBQSxHQUFBQSxTQUFBQTtBQUNBQSxPQUFPLENBQVBBLFlBQUFBLEdBQXVCO0FBQ25CSyxFQUFBQSxTQUFTLEVBRFUsS0FBQTtBQUVuQndDLEVBQUFBLGNBQWMsRUFGSyxlQUFBO0FBR25CQyxFQUFBQSxlQUFlLEVBSEksR0FBQTtBQUluQkMsRUFBQUEsZUFBZSxFQUpJLEdBQUE7QUFLbkIvQixFQUFBQSxrQkFBa0IsRUFMQyxLQUFBO0FBTW5CQyxFQUFBQSxrQkFBa0IsRUFBRTtBQU5ELENBQXZCakIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgY2xvbmVFbGVtZW50LCBDb21wb25lbnQsIGlzVmFsaWRFbGVtZW50LCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IGdldFBsYWNlbWVudHMgZnJvbSAnLi9wbGFjZW1lbnRzJztcbmltcG9ydCBSY1Rvb2x0aXAgZnJvbSAnLi4vcmMtY29tcG9uZW50cy90b29sdGlwJztcbmltcG9ydCB7IGdldFByZWZpeENscyB9IGZyb20gJy4uL2NvbmZpZ3VyZSc7XG5jb25zdCBzcGxpdE9iamVjdCA9IChvYmosIGtleXMpID0+IHtcbiAgICBjb25zdCBwaWNrZWQgPSB7fTtcbiAgICBjb25zdCBvbWl0ZWQgPSB7IC4uLm9iaiB9O1xuICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAob2JqICYmIGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgIHBpY2tlZFtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICBkZWxldGUgb21pdGVkW2tleV07XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4geyBwaWNrZWQsIG9taXRlZCB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvb2x0aXAgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5vblZpc2libGVDaGFuZ2UgPSAodmlzaWJsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBvblZpc2libGVDaGFuZ2UgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgICAgICBpZiAoISgndmlzaWJsZScgaW4gdGhpcy5wcm9wcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogdGhpcy5pc05vVGl0bGUoKSA/IGZhbHNlIDogdmlzaWJsZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvblZpc2libGVDaGFuZ2UgJiYgIXRoaXMuaXNOb1RpdGxlKCkpIHtcbiAgICAgICAgICAgICAgICBvblZpc2libGVDaGFuZ2UodmlzaWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIOWKqOaAgeiuvue9ruWKqOeUu+eCuVxuICAgICAgICB0aGlzLm9uUG9wdXBBbGlnbiA9IChkb21Ob2RlLCBhbGlnbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGxhY2VtZW50cyA9IHRoaXMuZ2V0UGxhY2VtZW50cygpO1xuICAgICAgICAgICAgLy8g5b2T5YmN6L+U5Zue55qE5L2N572uXG4gICAgICAgICAgICBjb25zdCBwbGFjZW1lbnQgPSBPYmplY3Qua2V5cyhwbGFjZW1lbnRzKS5maWx0ZXIoa2V5ID0+IHBsYWNlbWVudHNba2V5XS5wb2ludHNbMF0gPT09IGFsaWduLnBvaW50c1swXSAmJlxuICAgICAgICAgICAgICAgIHBsYWNlbWVudHNba2V5XS5wb2ludHNbMV0gPT09IGFsaWduLnBvaW50c1sxXSlbMF07XG4gICAgICAgICAgICBpZiAoIXBsYWNlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOagueaNruW9k+WJjeWdkOagh+iuvue9ruWKqOeUu+eCuVxuICAgICAgICAgICAgY29uc3QgcmVjdCA9IGRvbU5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2Zvcm1PcmlnaW4gPSB7XG4gICAgICAgICAgICAgICAgdG9wOiAnNTAlJyxcbiAgICAgICAgICAgICAgICBsZWZ0OiAnNTAlJyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAocGxhY2VtZW50LmluZGV4T2YoJ3RvcCcpID49IDAgfHwgcGxhY2VtZW50LmluZGV4T2YoJ0JvdHRvbScpID49IDApIHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4udG9wID0gYCR7cmVjdC5oZWlnaHQgLSBhbGlnbi5vZmZzZXRbMV19cHhgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGxhY2VtZW50LmluZGV4T2YoJ1RvcCcpID49IDAgfHwgcGxhY2VtZW50LmluZGV4T2YoJ2JvdHRvbScpID49IDApIHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4udG9wID0gYCR7LWFsaWduLm9mZnNldFsxXX1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGxhY2VtZW50LmluZGV4T2YoJ2xlZnQnKSA+PSAwIHx8IHBsYWNlbWVudC5pbmRleE9mKCdSaWdodCcpID49IDApIHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4ubGVmdCA9IGAke3JlY3Qud2lkdGggLSBhbGlnbi5vZmZzZXRbMF19cHhgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGxhY2VtZW50LmluZGV4T2YoJ3JpZ2h0JykgPj0gMCB8fCBwbGFjZW1lbnQuaW5kZXhPZignTGVmdCcpID49IDApIHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4ubGVmdCA9IGAkey1hbGlnbi5vZmZzZXRbMF19cHhgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9tTm9kZS5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSBgJHt0cmFuc2Zvcm1PcmlnaW4ubGVmdH0gJHt0cmFuc2Zvcm1PcmlnaW4udG9wfWA7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2F2ZVRvb2x0aXAgPSAobm9kZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy50b29sdGlwID0gbm9kZTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHZpc2libGU6ICEhcHJvcHMudmlzaWJsZSB8fCAhIXByb3BzLmRlZmF1bHRWaXNpYmxlLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAoJ3Zpc2libGUnIGluIG5leHRQcm9wcykge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZpc2libGU6IG5leHRQcm9wcy52aXNpYmxlIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFBvcHVwRG9tTm9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9vbHRpcC5nZXRQb3B1cERvbU5vZGUoKTtcbiAgICB9XG4gICAgZ2V0UGxhY2VtZW50cygpIHtcbiAgICAgICAgY29uc3QgeyBidWlsdGluUGxhY2VtZW50cywgYXJyb3dQb2ludEF0Q2VudGVyLCBhdXRvQWRqdXN0T3ZlcmZsb3cgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHJldHVybiAoYnVpbHRpblBsYWNlbWVudHMgfHxcbiAgICAgICAgICAgIGdldFBsYWNlbWVudHMoe1xuICAgICAgICAgICAgICAgIGFycm93UG9pbnRBdENlbnRlcixcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFycm93U2hpZnQ6IDgsXG4gICAgICAgICAgICAgICAgYXV0b0FkanVzdE92ZXJmbG93LFxuICAgICAgICAgICAgfSkpO1xuICAgIH1cbiAgICBpc0hvdmVyVHJpZ2dlcigpIHtcbiAgICAgICAgY29uc3QgeyB0cmlnZ2VyIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAoIXRyaWdnZXIgfHwgdHJpZ2dlciA9PT0gJ2hvdmVyJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodHJpZ2dlcikpIHtcbiAgICAgICAgICAgIHJldHVybiB0cmlnZ2VyLmluZGV4T2YoJ2hvdmVyJykgPj0gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIEZpeCBUb29sdGlwIHdvbid0IGhpZGUgYXQgZGlzYWJsZWQgYnV0dG9uXG4gICAgLy8gbW91c2UgZXZlbnRzIGRvbid0IHRyaWdnZXIgYXQgZGlzYWJsZWQgYnV0dG9uIGluIENocm9tZVxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdC1jb21wb25lbnQvdG9vbHRpcC9pc3N1ZXMvMThcbiAgICBnZXREaXNhYmxlZENvbXBhdGlibGVDaGlsZHJlbihlbGVtZW50KSB7XG4gICAgICAgIGlmICgoZWxlbWVudC50eXBlLl9fQU5UX0JVVFRPTiB8fCBlbGVtZW50LnR5cGUgPT09ICdidXR0b24nKSAmJlxuICAgICAgICAgICAgZWxlbWVudC5wcm9wcy5kaXNhYmxlZCAmJlxuICAgICAgICAgICAgdGhpcy5pc0hvdmVyVHJpZ2dlcigpKSB7XG4gICAgICAgICAgICAvLyBQaWNrIHNvbWUgbGF5b3V0IHJlbGF0ZWQgc3R5bGUgcHJvcGVydGllcyB1cCB0byBzcGFuXG4gICAgICAgICAgICBjb25zdCB7IHBpY2tlZCwgb21pdGVkIH0gPSBzcGxpdE9iamVjdChlbGVtZW50LnByb3BzLnN0eWxlLCBbXG4gICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJyxcbiAgICAgICAgICAgICAgICAnbGVmdCcsXG4gICAgICAgICAgICAgICAgJ3JpZ2h0JyxcbiAgICAgICAgICAgICAgICAndG9wJyxcbiAgICAgICAgICAgICAgICAnYm90dG9tJyxcbiAgICAgICAgICAgICAgICAnZmxvYXQnLFxuICAgICAgICAgICAgICAgICdkaXNwbGF5JyxcbiAgICAgICAgICAgICAgICAnekluZGV4JyxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgY29uc3Qgc3BhblN0eWxlID0ge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgICAgICAgICAgIC4uLnBpY2tlZCxcbiAgICAgICAgICAgICAgICBjdXJzb3I6ICdub3QtYWxsb3dlZCcsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgYnV0dG9uU3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgLi4ub21pdGVkLFxuICAgICAgICAgICAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNsb25lRWxlbWVudChlbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgc3R5bGU6IGJ1dHRvblN0eWxlLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogbnVsbCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIChSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IHN0eWxlOiBzcGFuU3R5bGUsIGNsYXNzTmFtZTogZWxlbWVudC5wcm9wcy5jbGFzc05hbWUgfSwgY2hpbGQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG4gICAgaXNOb1RpdGxlKCkge1xuICAgICAgICBjb25zdCB7IHRpdGxlLCBvdmVybGF5IH0gPSB0aGlzLnByb3BzO1xuICAgICAgICByZXR1cm4gIXRpdGxlICYmICFvdmVybGF5OyAvLyBvdmVybGF5IGZvciBvbGQgdmVyc2lvbiBjb21wYXRpYmlsaXR5XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBwcm9wcywgc3RhdGUgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHsgcHJlZml4Q2xzOiBjdXN0b21pemVQcmVmaXhDbHMsIHRpdGxlLCBvdmVybGF5LCBvcGVuQ2xhc3NOYW1lLCBnZXRQb3B1cENvbnRhaW5lciwgZ2V0VG9vbHRpcENvbnRhaW5lciwgfSA9IHByb3BzO1xuICAgICAgICBjb25zdCBwcmVmaXhDbHMgPSBnZXRQcmVmaXhDbHMoJ3Rvb2x0aXAnLCBjdXN0b21pemVQcmVmaXhDbHMpO1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHByb3BzLmNoaWxkcmVuO1xuICAgICAgICBsZXQgdmlzaWJsZSA9IHN0YXRlLnZpc2libGU7XG4gICAgICAgIC8vIEhpZGUgdG9vbHRpcCB3aGVuIHRoZXJlIGlzIG5vIHRpdGxlXG4gICAgICAgIGlmICghKCd2aXNpYmxlJyBpbiBwcm9wcykgJiYgdGhpcy5pc05vVGl0bGUoKSkge1xuICAgICAgICAgICAgdmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5nZXREaXNhYmxlZENvbXBhdGlibGVDaGlsZHJlbihpc1ZhbGlkRWxlbWVudChjaGlsZHJlbikgPyBjaGlsZHJlbiA6IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIG51bGwsIGNoaWxkcmVuKSk7XG4gICAgICAgIGNvbnN0IGNoaWxkUHJvcHMgPSBjaGlsZC5wcm9wcztcbiAgICAgICAgY29uc3QgY2hpbGRDbHMgPSBjbGFzc05hbWVzKGNoaWxkUHJvcHMuY2xhc3NOYW1lLCB7XG4gICAgICAgICAgICBbb3BlbkNsYXNzTmFtZSB8fCBgJHtwcmVmaXhDbHN9LW9wZW5gXTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAoUmVhY3QuY3JlYXRlRWxlbWVudChSY1Rvb2x0aXAsIE9iamVjdC5hc3NpZ24oe30sIHRoaXMucHJvcHMsIHsgcHJlZml4Q2xzOiBwcmVmaXhDbHMsIGdldFRvb2x0aXBDb250YWluZXI6IGdldFBvcHVwQ29udGFpbmVyIHx8IGdldFRvb2x0aXBDb250YWluZXIsIHJlZjogdGhpcy5zYXZlVG9vbHRpcCwgYnVpbHRpblBsYWNlbWVudHM6IHRoaXMuZ2V0UGxhY2VtZW50cygpLCBvdmVybGF5OiBvdmVybGF5IHx8IHRpdGxlIHx8ICcnLCB2aXNpYmxlOiB2aXNpYmxlLCBvblZpc2libGVDaGFuZ2U6IHRoaXMub25WaXNpYmxlQ2hhbmdlLCBvblBvcHVwQWxpZ246IHRoaXMub25Qb3B1cEFsaWduIH0pLCB2aXNpYmxlID8gY2xvbmVFbGVtZW50KGNoaWxkLCB7IGNsYXNzTmFtZTogY2hpbGRDbHMgfSkgOiBjaGlsZCkpO1xuICAgIH1cbn1cblRvb2x0aXAuZGlzcGxheU5hbWUgPSAnVG9vbHRpcCc7XG5Ub29sdGlwLmRlZmF1bHRQcm9wcyA9IHtcbiAgICBwbGFjZW1lbnQ6ICd0b3AnLFxuICAgIHRyYW5zaXRpb25OYW1lOiAnem9vbS1iaWctZmFzdCcsXG4gICAgbW91c2VFbnRlckRlbGF5OiAwLjEsXG4gICAgbW91c2VMZWF2ZURlbGF5OiAwLjEsXG4gICAgYXJyb3dQb2ludEF0Q2VudGVyOiBmYWxzZSxcbiAgICBhdXRvQWRqdXN0T3ZlcmZsb3c6IHRydWUsXG59O1xuIl19