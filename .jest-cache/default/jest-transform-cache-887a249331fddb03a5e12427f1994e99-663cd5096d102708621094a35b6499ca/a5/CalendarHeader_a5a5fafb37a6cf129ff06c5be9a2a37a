6553bf4d5cbf2d567f4b3d736b26f4c5
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _noop = _interopRequireDefault(require("lodash/noop"));

var _util = require("../util");

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var CalendarHeader =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(CalendarHeader, _Component);

  var _super = _createSuper(CalendarHeader);

  function CalendarHeader() {
    (0, _classCallCheck2["default"])(this, CalendarHeader);
    return _super.apply(this, arguments);
  }

  (0, _createClass2["default"])(CalendarHeader, [{
    key: "onYearChange",
    value: function onYearChange(year) {
      var newValue = this.props.value.clone();
      newValue.year(parseInt(year, 10));
      this.props.onValueChange(newValue);
    }
  }, {
    key: "onMonthChange",
    value: function onMonthChange(month) {
      var newValue = this.props.value.clone();
      newValue.month(parseInt(month, 10));
      this.props.onValueChange(newValue);
    }
  }, {
    key: "yearSelectElement",
    value: function yearSelectElement(year) {
      var _this$props = this.props,
          yearSelectOffset = _this$props.yearSelectOffset,
          yearSelectTotal = _this$props.yearSelectTotal,
          prefixCls = _this$props.prefixCls,
          Select = _this$props.Select;
      var start = year - yearSelectOffset;
      var end = start + yearSelectTotal;
      var options = [];

      for (var index = start; index < end; index++) {
        options.push(_react["default"].createElement(Select.Option, {
          key: "".concat(index)
        }, index));
      }

      return _react["default"].createElement(Select, {
        className: "".concat(prefixCls, "-header-year-select"),
        onChange: this.onYearChange.bind(this),
        dropdownStyle: {
          zIndex: 2000
        },
        dropdownMenuStyle: {
          maxHeight: 250,
          overflow: 'auto',
          fontSize: 12
        },
        optionLabelProp: "children",
        value: String(year),
        showSearch: false
      }, options);
    }
  }, {
    key: "monthSelectElement",
    value: function monthSelectElement(month) {
      var props = this.props;
      var t = props.value.clone();
      var prefixCls = props.prefixCls;
      var options = [];
      var Select = props.Select;

      for (var index = 0; index < 12; index++) {
        t.month(index);
        options.push(_react["default"].createElement(Select.Option, {
          key: "".concat(index)
        }, (0, _util.getMonthName)(t)));
      }

      return _react["default"].createElement(Select, {
        className: "".concat(prefixCls, "-header-month-select"),
        dropdownStyle: {
          zIndex: 2000
        },
        dropdownMenuStyle: {
          maxHeight: 250,
          overflow: 'auto',
          overflowX: 'hidden',
          fontSize: 12
        },
        optionLabelProp: "children",
        value: String(month),
        showSearch: false,
        onChange: this.onMonthChange.bind(this)
      }, options);
    }
  }, {
    key: "changeTypeToDate",
    value: function changeTypeToDate() {
      this.props.onTypeChange('date');
    }
  }, {
    key: "changeTypeToMonth",
    value: function changeTypeToMonth() {
      this.props.onTypeChange('month');
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props2 = this.props,
          value = _this$props2.value,
          locale = _this$props2.locale,
          prefixCls = _this$props2.prefixCls,
          type = _this$props2.type,
          showTypeSwitch = _this$props2.showTypeSwitch,
          headerComponents = _this$props2.headerComponents;
      var year = value.year();
      var month = value.month();
      var yearSelect = this.yearSelectElement(year);
      var monthSelect = type === 'month' ? null : this.monthSelectElement(month);
      var switchCls = "".concat(prefixCls, "-header-switcher");
      var typeSwitcher = showTypeSwitch ? _react["default"].createElement("span", {
        className: switchCls
      }, type === 'date' ? _react["default"].createElement("span", {
        className: "".concat(switchCls, "-focus")
      }, locale.month) : _react["default"].createElement("span", {
        onClick: this.changeTypeToDate.bind(this),
        className: "".concat(switchCls, "-normal")
      }, locale.month), type === 'month' ? _react["default"].createElement("span", {
        className: "".concat(switchCls, "-focus")
      }, locale.year) : _react["default"].createElement("span", {
        onClick: this.changeTypeToMonth.bind(this),
        className: "".concat(switchCls, "-normal")
      }, locale.year)) : null;
      return _react["default"].createElement("div", {
        className: "".concat(prefixCls, "-header")
      }, typeSwitcher, monthSelect, yearSelect, headerComponents);
    }
  }]);
  return CalendarHeader;
}(_react.Component);

exports["default"] = CalendarHeader;
(0, _defineProperty2["default"])(CalendarHeader, "propTypes", {
  value: _propTypes["default"].object,
  locale: _propTypes["default"].object,
  yearSelectOffset: _propTypes["default"].number,
  yearSelectTotal: _propTypes["default"].number,
  onValueChange: _propTypes["default"].func,
  onTypeChange: _propTypes["default"].func,
  Select: _propTypes["default"].func,
  prefixCls: _propTypes["default"].string,
  type: _propTypes["default"].string,
  showTypeSwitch: _propTypes["default"].bool,
  headerComponents: _propTypes["default"].array
});
(0, _defineProperty2["default"])(CalendarHeader, "defaultProps", {
  yearSelectOffset: 10,
  yearSelectTotal: 20,
  onValueChange: _noop["default"],
  onTypeChange: _noop["default"]
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNhbGVuZGFySGVhZGVyLmpzeCJdLCJuYW1lcyI6WyJDYWxlbmRhckhlYWRlciIsInllYXIiLCJuZXdWYWx1ZSIsInByb3BzIiwidmFsdWUiLCJjbG9uZSIsInBhcnNlSW50Iiwib25WYWx1ZUNoYW5nZSIsIm1vbnRoIiwieWVhclNlbGVjdE9mZnNldCIsInllYXJTZWxlY3RUb3RhbCIsInByZWZpeENscyIsIlNlbGVjdCIsInN0YXJ0IiwiZW5kIiwib3B0aW9ucyIsImluZGV4IiwicHVzaCIsIm9uWWVhckNoYW5nZSIsImJpbmQiLCJ6SW5kZXgiLCJtYXhIZWlnaHQiLCJvdmVyZmxvdyIsImZvbnRTaXplIiwiU3RyaW5nIiwidCIsIm92ZXJmbG93WCIsIm9uTW9udGhDaGFuZ2UiLCJvblR5cGVDaGFuZ2UiLCJsb2NhbGUiLCJ0eXBlIiwic2hvd1R5cGVTd2l0Y2giLCJoZWFkZXJDb21wb25lbnRzIiwieWVhclNlbGVjdCIsInllYXJTZWxlY3RFbGVtZW50IiwibW9udGhTZWxlY3QiLCJtb250aFNlbGVjdEVsZW1lbnQiLCJzd2l0Y2hDbHMiLCJ0eXBlU3dpdGNoZXIiLCJjaGFuZ2VUeXBlVG9EYXRlIiwiY2hhbmdlVHlwZVRvTW9udGgiLCJDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJvYmplY3QiLCJudW1iZXIiLCJmdW5jIiwic3RyaW5nIiwiYm9vbCIsImFycmF5Iiwibm9vcCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQUVxQkEsYzs7Ozs7Ozs7Ozs7Ozs7aUNBcUJOQyxJLEVBQU07QUFDakIsVUFBTUMsUUFBUSxHQUFHLEtBQUtDLEtBQUwsQ0FBV0MsS0FBWCxDQUFpQkMsS0FBakIsRUFBakI7QUFDQUgsTUFBQUEsUUFBUSxDQUFDRCxJQUFULENBQWNLLFFBQVEsQ0FBQ0wsSUFBRCxFQUFPLEVBQVAsQ0FBdEI7QUFDQSxXQUFLRSxL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RUFBQUEsZ0JBQWdCLEVBQUVVLHNCQUFVTTtBQVhYLEM7aUNBREFoRCxjLGtCQWNHO0FBQ3BCUyxFQUFBQSxnQkFBZ0IsRUFBRSxFQURFO0FBRXBCQyxFQUFBQSxlQUFlLEVBQUUsRUFGRztBQUdwQkgsRUFBQUEsYUFBYSxFQUFFMEMsZ0JBSEs7QUFJcEJyQixFQUFBQSxZQUFZLEVBQUVxQjtBQUpNLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBub29wIGZyb20gJ2xvZGFzaC9ub29wJztcbmltcG9ydCB7IGdldE1vbnRoTmFtZSB9IGZyb20gJy4uL3V0aWwnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYWxlbmRhckhlYWRlciBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgdmFsdWU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgbG9jYWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHllYXJTZWxlY3RPZmZzZXQ6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgeWVhclNlbGVjdFRvdGFsOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIG9uVmFsdWVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uVHlwZUNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgU2VsZWN0OiBQcm9wVHlwZXMuZnVuYyxcbiAgICBwcmVmaXhDbHM6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgdHlwZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBzaG93VHlwZVN3aXRjaDogUHJvcFR5cGVzLmJvb2wsXG4gICAgaGVhZGVyQ29tcG9uZW50czogUHJvcFR5cGVzLmFycmF5LFxuICB9O1xuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHllYXJTZWxlY3RPZmZzZXQ6IDEwLFxuICAgIHllYXJTZWxlY3RUb3RhbDogMjAsXG4gICAgb25WYWx1ZUNoYW5nZTogbm9vcCxcbiAgICBvblR5cGVDaGFuZ2U6IG5vb3AsXG4gIH07XG5cbiAgb25ZZWFyQ2hhbmdlKHllYXIpIHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMucHJvcHMudmFsdWUuY2xvbmUoKTtcbiAgICBuZXdWYWx1ZS55ZWFyKHBhcnNlSW50KHllYXIsIDEwKSk7XG4gICAgdGhpcy5wcm9wcy5vblZhbHVlQ2hhbmdlKG5ld1ZhbHVlKTtcbiAgfVxuXG4gIG9uTW9udGhDaGFuZ2UobW9udGgpIHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMucHJvcHMudmFsdWUuY2xvbmUoKTtcbiAgICBuZXdWYWx1ZS5tb250aChwYXJzZUludChtb250aCwgMTApKTtcbiAgICB0aGlzLnByb3BzLm9uVmFsdWVDaGFuZ2UobmV3VmFsdWUpO1xuICB9XG5cbiAgeWVhclNlbGVjdEVsZW1lbnQoeWVhcikge1xuICAgIGNvbnN0IHsgeWVhclNlbGVjdE9mZnNldCwgeWVhclNlbGVjdFRvdGFsLCBwcmVmaXhDbHMsIFNlbGVjdCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBzdGFydCA9IHllYXIgLSB5ZWFyU2VsZWN0T2Zmc2V0O1xuICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgeWVhclNlbGVjdFRvdGFsO1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IFtdO1xuICAgIGZvciAobGV0IGluZGV4ID0gc3RhcnQ7IGluZGV4IDwgZW5kOyBpbmRleCsrKSB7XG4gICAgICBvcHRpb25zLnB1c2goPFNlbGVjdC5PcHRpb24ga2V5PXtgJHtpbmRleH1gfT57aW5kZXh9PC9TZWxlY3QuT3B0aW9uPik7XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICA8U2VsZWN0XG4gICAgICAgIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1oZWFkZXIteWVhci1zZWxlY3RgfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy5vblllYXJDaGFuZ2UuYmluZCh0aGlzKX1cbiAgICAgICAgZHJvcGRvd25TdHlsZT17eyB6SW5kZXg6IDIwMDAgfX1cbiAgICAgICAgZHJvcGRvd25NZW51U3R5bGU9e3sgbWF4SGVpZ2h0OiAyNTAsIG92ZXJmbG93OiAnYXV0bycsIGZvbnRTaXplOiAxMiB9fVxuICAgICAgICBvcHRpb25MYWJlbFByb3A9XCJjaGlsZHJlblwiXG4gICAgICAgIHZhbHVlPXtTdHJpbmcoeWVhcil9XG4gICAgICAgIHNob3dTZWFyY2g9e2ZhbHNlfVxuICAgICAgPlxuICAgICAgICB7b3B0aW9uc31cbiAgICAgIDwvU2VsZWN0PlxuICAgICk7XG4gIH1cblxuICBtb250aFNlbGVjdEVsZW1lbnQobW9udGgpIHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgdCA9IHByb3BzLnZhbHVlLmNsb25lKCk7XG4gICAgY29uc3QgeyBwcmVmaXhDbHMgfSA9IHByb3BzO1xuICAgIGNvbnN0IG9wdGlvbnMgPSBbXTtcbiAgICBjb25zdCBTZWxlY3QgPSBwcm9wcy5TZWxlY3Q7XG5cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgMTI7IGluZGV4KyspIHtcbiAgICAgIHQubW9udGgoaW5kZXgpO1xuICAgICAgb3B0aW9ucy5wdXNoKFxuICAgICAgICA8U2VsZWN0Lk9wdGlvbiBrZXk9e2Ake2luZGV4fWB9PlxuICAgICAgICAgIHtnZXRNb250aE5hbWUodCl9XG4gICAgICAgIDwvU2VsZWN0Lk9wdGlvbj4sXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8U2VsZWN0XG4gICAgICAgIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1oZWFkZXItbW9udGgtc2VsZWN0YH1cbiAgICAgICAgZHJvcGRvd25TdHlsZT17eyB6SW5kZXg6IDIwMDAgfX1cbiAgICAgICAgZHJvcGRvd25NZW51U3R5bGU9e3sgbWF4SGVpZ2h0OiAyNTAsIG92ZXJmbG93OiAnYXV0bycsIG92ZXJmbG93WDogJ2hpZGRlbicsIGZvbnRTaXplOiAxMiB9fVxuICAgICAgICBvcHRpb25MYWJlbFByb3A9XCJjaGlsZHJlblwiXG4gICAgICAgIHZhbHVlPXtTdHJpbmcobW9udGgpfVxuICAgICAgICBzaG93U2VhcmNoPXtmYWxzZX1cbiAgICAgICAgb25DaGFuZ2U9e3RoaXMub25Nb250aENoYW5nZS5iaW5kKHRoaXMpfVxuICAgICAgPlxuICAgICAgICB7b3B0aW9uc31cbiAgICAgIDwvU2VsZWN0PlxuICAgICk7XG4gIH1cblxuICBjaGFuZ2VUeXBlVG9EYXRlKCkge1xuICAgIHRoaXMucHJvcHMub25UeXBlQ2hhbmdlKCdkYXRlJyk7XG4gIH1cblxuICBjaGFuZ2VUeXBlVG9Nb250aCgpIHtcbiAgICB0aGlzLnByb3BzLm9uVHlwZUNoYW5nZSgnbW9udGgnKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHZhbHVlLCBsb2NhbGUsIHByZWZpeENscywgdHlwZSwgc2hvd1R5cGVTd2l0Y2gsIGhlYWRlckNvbXBvbmVudHMgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeWVhciA9IHZhbHVlLnllYXIoKTtcbiAgICBjb25zdCBtb250aCA9IHZhbHVlLm1vbnRoKCk7XG4gICAgY29uc3QgeWVhclNlbGVjdCA9IHRoaXMueWVhclNlbGVjdEVsZW1lbnQoeWVhcik7XG4gICAgY29uc3QgbW9udGhTZWxlY3QgPSB0eXBlID09PSAnbW9udGgnID8gbnVsbCA6IHRoaXMubW9udGhTZWxlY3RFbGVtZW50KG1vbnRoKTtcbiAgICBjb25zdCBzd2l0Y2hDbHMgPSBgJHtwcmVmaXhDbHN9LWhlYWRlci1zd2l0Y2hlcmA7XG4gICAgY29uc3QgdHlwZVN3aXRjaGVyID0gc2hvd1R5cGVTd2l0Y2ggPyAoXG4gICAgICA8c3BhbiBjbGFzc05hbWU9e3N3aXRjaENsc30+XG4gICAgICAgIHt0eXBlID09PSAnZGF0ZScgPyA8c3BhbiBjbGFzc05hbWU9e2Ake3N3aXRjaENsc30tZm9jdXNgfT57bG9jYWxlLm1vbnRofTwvc3Bhbj4gOiA8c3BhblxuICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuY2hhbmdlVHlwZVRvRGF0ZS5iaW5kKHRoaXMpfVxuICAgICAgICAgIGNsYXNzTmFtZT17YCR7c3dpdGNoQ2xzfS1ub3JtYWxgfVxuICAgICAgICA+XG4gICAgICAgICAgICB7bG9jYWxlLm1vbnRofVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgfVxuICAgICAgICB7dHlwZSA9PT0gJ21vbnRoJyA/IDxzcGFuIGNsYXNzTmFtZT17YCR7c3dpdGNoQ2xzfS1mb2N1c2B9Pntsb2NhbGUueWVhcn08L3NwYW4+IDogPHNwYW5cbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLmNoYW5nZVR5cGVUb01vbnRoLmJpbmQodGhpcyl9XG4gICAgICAgICAgY2xhc3NOYW1lPXtgJHtzd2l0Y2hDbHN9LW5vcm1hbGB9XG4gICAgICAgID5cbiAgICAgICAgICAgIHtsb2NhbGUueWVhcn1cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIH1cbiAgICAgIDwvc3Bhbj5cbiAgICApIDogbnVsbDtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1oZWFkZXJgfT5cbiAgICAgICAge3R5cGVTd2l0Y2hlcn1cbiAgICAgICAge21vbnRoU2VsZWN0fVxuICAgICAgICB7eWVhclNlbGVjdH1cbiAgICAgICAge2hlYWRlckNvbXBvbmVudHN9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG4iXX0=