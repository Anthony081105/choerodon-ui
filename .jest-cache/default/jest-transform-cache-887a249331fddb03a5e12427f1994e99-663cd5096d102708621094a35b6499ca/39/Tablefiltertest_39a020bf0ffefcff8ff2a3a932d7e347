cb98ca06750924a187c0fb16ec7a7c28
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _react = _interopRequireDefault(require("react"));

var _enzyme = require("enzyme");

var _ = _interopRequireDefault(require(".."));

describe('Table.filter', function () {
  var filterFn = function filterFn(value, record) {
    return record.name.indexOf(value) !== -1;
  };

  var column = {
    title: 'Name',
    dataIndex: 'name',
    filters: [{
      text: 'Boy',
      value: 'boy'
    }, {
      text: 'Girl',
      value: 'girl'
    }, {
      text: 'Title',
      value: 'title',
      children: [{
        text: 'Designer',
        value: 'designer'
      }, {
        text: 'Coder',
        value: 'coder'
      }]
    }],
    onFilter: filterFn
  };
  var data = [{
    key: 0,
    name: 'Jack'
  }, {
    key: 1,
    name: 'Lucy'
  }, {
    key: 2,
    name: 'Tom'
  }, {
    key: 3,
    name: 'Jerry'
  }];

  function createTable(props) {
    return _react["default"].createElement(_["default"], (0, _extends2["default"])({
      columns: [column],
      dataSource: data,
      pagination: false,
      filterBar: false
    }, props));
  }

  function renderedNames(wrapper) {
    return wrapper.find('TableRow').map(function (row) {
      return row.props().record.name;
    });
  }

  it('renders filter correctly', function () {
    var wrapper = (0, _enzyme.render)(createTable());
    expect(wrapper).toMatchSnapshot();
  });
  it('renders menu correctly', function () {
    var wrapper = (0, _enzyme.mount)(createTable());
    var dropdownWrapper = (0, _enzyme.render)(wrapper.find('Trigger').at(0).instance().getComponent());
    expect(dropdownWrapper).toMatchSnapshot();
  });
  it('renders radio filter correctly', function () {
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filterMultiple: false
      })]
    }));
    var dropdownWrapper = (0, _enzyme.render)(wrapper.find('Trigger').at(0).instance().getComponent());
    expect(dropdownWrapper).toMatchSnapshot();
  });
  it('renders custom content correctly', function () {
    var filter = _react["default"].createElement("div", {
      className: "custom-filter-dropdown"
    }, "custom filter");

    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filterDropdown: filter
      })]
    }));
    var dropdownWrapper = (0, _enzyme.render)(wrapper.find('Trigger').at(0).instance().getComponent());
    expect(dropdownWrapper).toMatchSnapshot();
  });
  it('can be controlled by filterDropdownVisible', function () {
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filterDropdownVisible: true
      })]
    }));
    var dropdown = wrapper.find('Dropdown').first();
    expect(dropdown.props().visible).toBe(true);
    wrapper.setProps({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filterDropdownVisible: false
      })]
    });
    dropdown = wrapper.find('Dropdown').first();
    expect(dropdown.props().visible).toBe(false);
  });
  it('fires change event when visible change', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        onFilterDropdownVisibleChange: handleChange
      })]
    }));
    wrapper.find('.c7n-dropdown-trigger').first().simulate('click');
    expect(handleChange).toHaveBeenCalledWith(true);
  });
  it('can be controlled by filteredValue', function () {
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filteredValue: ['Lucy']
      })]
    }));
    expect(wrapper.find('tbody tr').length).toBe(1);
    wrapper.setProps({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filteredValue: []
      })]
    });
    expect(wrapper.find('tbody tr').length).toBe(4);
  });
  it('can be controlled by filteredValue null', function () {
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filteredValue: ['Lucy']
      })]
    }));
    expect(wrapper.find('tbody tr').length).toBe(1);
    wrapper.setProps({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filteredValue: null
      })]
    });
    expect(wrapper.find('tbody tr').length).toBe(4);
  });
  it('fires change event', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(createTable({
      onChange: handleChange
    }));
    var dropdownWrapper = (0, _enzyme.mount)(wrapper.find('Trigger').at(0).instance().getComponent());
    dropdownWrapper.find('MenuItem').first().simulate('click');
    dropdownWrapper.find('.confirm').simulate('click');
    expect(handleChange).toHaveBeenCalledWith({}, {
      name: ['boy']
    }, {}, []);
  });
  it('three levels menu', function () {
    var filters = [{
      text: 'Upper',
      value: 'Upper'
    }, {
      text: 'Lower',
      value: 'Lower'
    }, {
      text: 'Level2',
      value: 'Level2',
      children: [{
        text: 'Large',
        value: 'Large'
      }, {
        text: 'Small',
        value: 'Small'
      }, {
        text: 'Level3',
        value: 'Level3',
        children: [{
          text: 'Black',
          value: 'Black'
        }, {
          text: 'White',
          value: 'White'
        }, {
          text: 'Jack',
          value: 'Jack'
        }]
      }]
    }];
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filters: filters
      })]
    }));
    jest.useFakeTimers();
    var dropdownWrapper = (0, _enzyme.mount)(wrapper.find('Trigger').at(0).instance().getComponent());
    dropdownWrapper.find('.c7n-dropdown-menu-submenu-title').at(0).simulate('mouseEnter');
    jest.runAllTimers();
    dropdownWrapper.update();
    dropdownWrapper.find('.c7n-dropdown-menu-submenu-title').at(1).simulate('mouseEnter');
    jest.runAllTimers();
    dropdownWrapper.update();
    dropdownWrapper.find('MenuItem').last().simulate('click');
    dropdownWrapper.find('.confirm').simulate('click');
    wrapper.update();
    expect(renderedNames(wrapper)).toEqual(['Jack']);
    jest.useRealTimers();
  });
  it('works with JSX in controlled mode', function () {
    var Column = _["default"].Column;

    var App =
    /*#__PURE__*/
    function (_React$Component) {
      (0, _inherits2["default"])(App, _React$Component);

      function App() {
        var _getPrototypeOf2;

        var _this;

        (0, _classCallCheck2["default"])(this, App);

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(App)).call.apply(_getPrototypeOf2, [this].concat(args)));
        (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
          filters: {}
        });
        (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "handleChange", function (pagination, filters) {
          _this.setState({
            filters: filters
          });
        });
        return _this;
      }

      (0, _createClass2["default"])(App, [{
        key: "render",
        value: function render() {
          var name = this.state.filters.name;
          return _react["default"].createElement(_["default"], {
            dataSource: data,
            onChange: this.handleChange,
            filterBar: false
          }, _react["default"].createElement(Column, {
            title: "name",
            dataIndex: "name",
            key: "name",
            filters: [{
              text: 'Jack',
              value: 'Jack'
            }, {
              text: 'Lucy',
              value: 'Lucy'
            }],
            filteredValue: name,
            onFilter: filterFn
          }));
        }
      }]);
      return App;
    }(_react["default"].Component);

    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(App, null));
    var dropdownWrapper = (0, _enzyme.mount)(wrapper.find('Trigger').at(0).instance().getComponent());
    dropdownWrapper.find('MenuItem').first().simulate('click');
    dropdownWrapper.find('.confirm').simulate('click');
    wrapper.update();
    expect(renderedNames(wrapper)).toEqual(['Jack']);
    dropdownWrapper.find('.clear').simulate('click');
    wrapper.update();
    expect(renderedNames(wrapper)).toEqual(['Jack', 'Lucy', 'Tom', 'Jerry']);
  });
  it('works with grouping columns in controlled mode', function () {
    var columns = [{
      title: 'group',
      key: 'group',
      children: [{
        title: 'Name',
        dataIndex: 'name',
        key: 'name',
        filters: [{
          text: 'Jack',
          value: 'Jack'
        }, {
          text: 'Lucy',
          value: 'Lucy'
        }],
        onFilter: filterFn,
        filteredValue: ['Jack']
      }, {
        title: 'Age',
        dataIndex: 'age',
        key: 'age'
      }]
    }];
    var testData = [{
      key: 0,
      name: 'Jack',
      age: 11
    }, {
      key: 1,
      name: 'Lucy',
      age: 20
    }, {
      key: 2,
      name: 'Tom',
      age: 21
    }, {
      key: 3,
      name: 'Jerry',
      age: 22
    }];
    var wrapper = (0, _enzyme.mount)(_react["default"].createElement(_["default"], {
      columns: columns,
      dataSource: testData,
      filterBar: false
    }));
    expect(renderedNames(wrapper)).toEqual(['Jack']);
  });
  it('confirm filter when dropdown hidden', function () {
    var handleChange = jest.fn();
    var wrapper = (0, _enzyme.mount)(createTable({
      columns: [(0, _objectSpread2["default"])({}, column, {
        filters: [{
          text: 'Jack',
          value: 'Jack'
        }, {
          text: 'Lucy',
          value: 'Lucy'
        }]
      })],
      onChange: handleChange
    }));
    wrapper.find('.c7n-dropdown-trigger').first().simulate('click');
    wrapper.find('.c7n-dropdown-menu-item').first().simulate('click');
    wrapper.find('.c7n-dropdown-trigger').first().simulate('click');
    expect(handleChange).toHaveBeenCalled();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRhYmxlLmZpbHRlci50ZXN0LmpzIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiZmlsdGVyRm4iLCJ2YWx1ZSIsInJlY29yZCIsIm5hbWUiLCJpbmRleE9mIiwiY29sdW1uIiwidGl0bGUiLCJkYXRhSW5kZXgiLCJmaWx0ZXJzIiwidGV4dCIsImNoaWxkcmVuIiwib25GaWx0ZXIiLCJkYXRhIiwia2V5IiwiY3JlYXRlVGFibGUiLCJwcm9wcyIsInJlbmRlcmVkTmFtZXMiLCJ3cmFwcGVyIiwiZmluZCIsIm1hcCIsInJvdyIsIml0IiwiZXhwZWN0IiwidG9NYXRjaFNuYXBzaG90IiwiZHJvcGRvd25XcmFwcGVyIiwiYXQiLCJpbnN0YW5jZSIsImdldENvbXBvbmVudCIsImNvbHVtbnMiLCJmaWx0ZXJNdWx0aXBsZSIsImZpbHRlciIsImZpbHRlckRyb3Bkb3duIiwiZmlsdGVyRHJvcGRvd25WaXNpYmxlIiwiZHJvcGRvd24iLCJmaXJzdCIsInZpc2libGUiLCJ0b0JlIiwic2V0UHJvcHMiLCJoYW5kbGVDaGFuZ2UiLCJqZXN0IiwiZm4iLCJvbkZpbHRlckRyb3Bkb3duVmlzaWJsZUNoYW5nZSIsInNpbXVsYXRlIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJmaWx0ZXJlZFZhbHVlIiwibGVuZ3RoIiwib25DaGFuZ2UiLCJ1c2VGYWtlVGltZXJzIiwicnVuQWxsVGltZXJzIiwidXBkYXRlIiwibGFzdCIsInRvRXF1YWwiLCJ1c2VSZWFsVGltZXJzIiwiQ29sdW1uIiwiVGFibGUiLCJBcHAiLCJwYWdpbmF0aW9uIiwic2V0U3RhdGUiLCJzdGF0ZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwidGVzdERhdGEiLCJhZ2UiLCJ0b0hhdmVCZWVuQ2FsbGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUFBLFFBQVEsQ0FBQyxjQUFELEVBQWlCLFlBQU07QUFDN0IsTUFBTUMsUUFBUSxHQUFHLFNBQVhBLFFBQVcsQ0FB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UmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgbW91bnQsIHJlbmRlciB9IGZyb20gJ2VuenltZSc7XG5pbXBvcnQgVGFibGUgZnJvbSAnLi4nO1xuXG5kZXNjcmliZSgnVGFibGUuZmlsdGVyJywgKCkgPT4ge1xuICBjb25zdCBmaWx0ZXJGbiA9ICh2YWx1ZSwgcmVjb3JkKSA9PiByZWNvcmQubmFtZS5pbmRleE9mKHZhbHVlKSAhPT0gLTE7XG4gIGNvbnN0IGNvbHVtbiA9IHtcbiAgICB0aXRsZTogJ05hbWUnLFxuICAgIGRhdGFJbmRleDogJ25hbWUnLFxuICAgIGZpbHRlcnM6IFtcbiAgICAgIHsgdGV4dDogJ0JveScsIHZhbHVlOiAnYm95JyB9LFxuICAgICAgeyB0ZXh0OiAnR2lybCcsIHZhbHVlOiAnZ2lybCcgfSxcbiAgICAgIHtcbiAgICAgICAgdGV4dDogJ1RpdGxlJyxcbiAgICAgICAgdmFsdWU6ICd0aXRsZScsXG4gICAgICAgIGNoaWxkcmVuOiBbeyB0ZXh0OiAnRGVzaWduZXInLCB2YWx1ZTogJ2Rlc2lnbmVyJyB9LCB7IHRleHQ6ICdDb2RlcicsIHZhbHVlOiAnY29kZXInIH1dLFxuICAgICAgfSxcbiAgICBdLFxuICAgIG9uRmlsdGVyOiBmaWx0ZXJGbixcbiAgfTtcblxuICBjb25zdCBkYXRhID0gW1xuICAgIHsga2V5OiAwLCBuYW1lOiAnSmFjaycgfSxcbiAgICB7IGtleTogMSwgbmFtZTogJ0x1Y3knIH0sXG4gICAgeyBrZXk6IDIsIG5hbWU6ICdUb20nIH0sXG4gICAgeyBrZXk6IDMsIG5hbWU6ICdKZXJyeScgfSxcbiAgXTtcblxuICBmdW5jdGlvbiBjcmVhdGVUYWJsZShwcm9wcykge1xuICAgIHJldHVybiAoXG4gICAgICA8VGFibGUgY29sdW1ucz17W2NvbHVtbl19IGRhdGFTb3VyY2U9e2RhdGF9IHBhZ2luYXRpb249e2ZhbHNlfSBmaWx0ZXJCYXI9e2ZhbHNlfSB7Li4ucHJvcHN9IC8+XG4gICAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlcmVkTmFtZXMod3JhcHBlcikge1xuICAgIHJldHVybiB3cmFwcGVyLmZpbmQoJ1RhYmxlUm93JykubWFwKHJvdyA9PiByb3cucHJvcHMoKS5yZWNvcmQubmFtZSk7XG4gIH1cblxuICBpdCgncmVuZGVycyBmaWx0ZXIgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSByZW5kZXIoY3JlYXRlVGFibGUoKSk7XG5cbiAgICBleHBlY3Qod3JhcHBlcikudG9NYXRjaFNuYXBzaG90KCk7XG4gIH0pO1xuXG4gIGl0KCdyZW5kZXJzIG1lbnUgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChjcmVhdGVUYWJsZSgpKTtcbiAgICBjb25zdCBkcm9wZG93bldyYXBwZXIgPSByZW5kZXIoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCdUcmlnZ2VyJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5pbnN0YW5jZSgpXG4gICAgICAgIC5nZXRDb21wb25lbnQoKSxcbiAgICApO1xuICAgIGV4cGVjdChkcm9wZG93bldyYXBwZXIpLnRvTWF0Y2hTbmFwc2hvdCgpO1xuICB9KTtcblxuICBpdCgncmVuZGVycyByYWRpbyBmaWx0ZXIgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIGNyZWF0ZVRhYmxlKHtcbiAgICAgICAgY29sdW1uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICAgIGZpbHRlck11bHRpcGxlOiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSksXG4gICAgKTtcbiAgICBjb25zdCBkcm9wZG93bldyYXBwZXIgPSByZW5kZXIoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCdUcmlnZ2VyJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5pbnN0YW5jZSgpXG4gICAgICAgIC5nZXRDb21wb25lbnQoKSxcbiAgICApO1xuICAgIGV4cGVjdChkcm9wZG93bldyYXBwZXIpLnRvTWF0Y2hTbmFwc2hvdCgpO1xuICB9KTtcblxuICBpdCgncmVuZGVycyBjdXN0b20gY29udGVudCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3QgZmlsdGVyID0gPGRpdiBjbGFzc05hbWU9XCJjdXN0b20tZmlsdGVyLWRyb3Bkb3duXCI+Y3VzdG9tIGZpbHRlcjwvZGl2PjtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoXG4gICAgICBjcmVhdGVUYWJsZSh7XG4gICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5jb2x1bW4sXG4gICAgICAgICAgICBmaWx0ZXJEcm9wZG93bjogZmlsdGVyLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgY29uc3QgZHJvcGRvd25XcmFwcGVyID0gcmVuZGVyKFxuICAgICAgd3JhcHBlclxuICAgICAgICAuZmluZCgnVHJpZ2dlcicpXG4gICAgICAgIC5hdCgwKVxuICAgICAgICAuaW5zdGFuY2UoKVxuICAgICAgICAuZ2V0Q29tcG9uZW50KCksXG4gICAgKTtcbiAgICBleHBlY3QoZHJvcGRvd25XcmFwcGVyKS50b01hdGNoU25hcHNob3QoKTtcbiAgfSk7XG5cbiAgaXQoJ2NhbiBiZSBjb250cm9sbGVkIGJ5IGZpbHRlckRyb3Bkb3duVmlzaWJsZScsICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoXG4gICAgICBjcmVhdGVUYWJsZSh7XG4gICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5jb2x1bW4sXG4gICAgICAgICAgICBmaWx0ZXJEcm9wZG93blZpc2libGU6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBsZXQgZHJvcGRvd24gPSB3cmFwcGVyLmZpbmQoJ0Ryb3Bkb3duJykuZmlyc3QoKTtcbiAgICBleHBlY3QoZHJvcGRvd24ucHJvcHMoKS52aXNpYmxlKS50b0JlKHRydWUpO1xuXG4gICAgd3JhcHBlci5zZXRQcm9wcyh7XG4gICAgICBjb2x1bW5zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5jb2x1bW4sXG4gICAgICAgICAgZmlsdGVyRHJvcGRvd25WaXNpYmxlOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBkcm9wZG93biA9IHdyYXBwZXIuZmluZCgnRHJvcGRvd24nKS5maXJzdCgpO1xuICAgIGV4cGVjdChkcm9wZG93bi5wcm9wcygpLnZpc2libGUpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICBpdCgnZmlyZXMgY2hhbmdlIGV2ZW50IHdoZW4gdmlzaWJsZSBjaGFuZ2UnLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIGNyZWF0ZVRhYmxlKHtcbiAgICAgICAgY29sdW1uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICAgIG9uRmlsdGVyRHJvcGRvd25WaXNpYmxlQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB3cmFwcGVyXG4gICAgICAuZmluZCgnLmM3bi1kcm9wZG93bi10cmlnZ2VyJylcbiAgICAgIC5maXJzdCgpXG4gICAgICAuc2ltdWxhdGUoJ2NsaWNrJyk7XG5cbiAgICBleHBlY3QoaGFuZGxlQ2hhbmdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0cnVlKTtcbiAgfSk7XG5cbiAgaXQoJ2NhbiBiZSBjb250cm9sbGVkIGJ5IGZpbHRlcmVkVmFsdWUnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgY3JlYXRlVGFibGUoe1xuICAgICAgICBjb2x1bW5zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4uY29sdW1uLFxuICAgICAgICAgICAgZmlsdGVyZWRWYWx1ZTogWydMdWN5J10sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCd0Ym9keSB0cicpLmxlbmd0aCkudG9CZSgxKTtcbiAgICB3cmFwcGVyLnNldFByb3BzKHtcbiAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICBmaWx0ZXJlZFZhbHVlOiBbXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG4gICAgZXhwZWN0KHdyYXBwZXIuZmluZCgndGJvZHkgdHInKS5sZW5ndGgpLnRvQmUoNCk7XG4gIH0pO1xuXG4gIGl0KCdjYW4gYmUgY29udHJvbGxlZCBieSBmaWx0ZXJlZFZhbHVlIG51bGwnLCAoKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFxuICAgICAgY3JlYXRlVGFibGUoe1xuICAgICAgICBjb2x1bW5zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4uY29sdW1uLFxuICAgICAgICAgICAgZmlsdGVyZWRWYWx1ZTogWydMdWN5J10sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCd0Ym9keSB0cicpLmxlbmd0aCkudG9CZSgxKTtcbiAgICB3cmFwcGVyLnNldFByb3BzKHtcbiAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICBmaWx0ZXJlZFZhbHVlOiBudWxsLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcbiAgICBleHBlY3Qod3JhcHBlci5maW5kKCd0Ym9keSB0cicpLmxlbmd0aCkudG9CZSg0KTtcbiAgfSk7XG5cbiAgaXQoJ2ZpcmVzIGNoYW5nZSBldmVudCcsICgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KGNyZWF0ZVRhYmxlKHsgb25DaGFuZ2U6IGhhbmRsZUNoYW5nZSB9KSk7XG4gICAgY29uc3QgZHJvcGRvd25XcmFwcGVyID0gbW91bnQoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCdUcmlnZ2VyJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5pbnN0YW5jZSgpXG4gICAgICAgIC5nZXRDb21wb25lbnQoKSxcbiAgICApO1xuXG4gICAgZHJvcGRvd25XcmFwcGVyXG4gICAgICAuZmluZCgnTWVudUl0ZW0nKVxuICAgICAgLmZpcnN0KClcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICBkcm9wZG93bldyYXBwZXIuZmluZCgnLmNvbmZpcm0nKS5zaW11bGF0ZSgnY2xpY2snKTtcblxuICAgIGV4cGVjdChoYW5kbGVDaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHt9LCB7IG5hbWU6IFsnYm95J10gfSwge30sIFtdKTtcbiAgfSk7XG5cbiAgaXQoJ3RocmVlIGxldmVscyBtZW51JywgKCkgPT4ge1xuICAgIGNvbnN0IGZpbHRlcnMgPSBbXG4gICAgICB7IHRleHQ6ICdVcHBlcicsIHZhbHVlOiAnVXBwZXInIH0sXG4gICAgICB7IHRleHQ6ICdMb3dlcicsIHZhbHVlOiAnTG93ZXInIH0sXG4gICAgICB7XG4gICAgICAgIHRleHQ6ICdMZXZlbDInLFxuICAgICAgICB2YWx1ZTogJ0xldmVsMicsXG4gICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgeyB0ZXh0OiAnTGFyZ2UnLCB2YWx1ZTogJ0xhcmdlJyB9LFxuICAgICAgICAgIHsgdGV4dDogJ1NtYWxsJywgdmFsdWU6ICdTbWFsbCcgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0OiAnTGV2ZWwzJyxcbiAgICAgICAgICAgIHZhbHVlOiAnTGV2ZWwzJyxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgIHsgdGV4dDogJ0JsYWNrJywgdmFsdWU6ICdCbGFjaycgfSxcbiAgICAgICAgICAgICAgeyB0ZXh0OiAnV2hpdGUnLCB2YWx1ZTogJ1doaXRlJyB9LFxuICAgICAgICAgICAgICB7IHRleHQ6ICdKYWNrJywgdmFsdWU6ICdKYWNrJyB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICBdO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIGNyZWF0ZVRhYmxlKHtcbiAgICAgICAgY29sdW1uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICAgIGZpbHRlcnMsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pLFxuICAgICk7XG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gICAgY29uc3QgZHJvcGRvd25XcmFwcGVyID0gbW91bnQoXG4gICAgICB3cmFwcGVyXG4gICAgICAgIC5maW5kKCdUcmlnZ2VyJylcbiAgICAgICAgLmF0KDApXG4gICAgICAgIC5pbnN0YW5jZSgpXG4gICAgICAgIC5nZXRDb21wb25lbnQoKSxcbiAgICApO1xuICAgIGRyb3Bkb3duV3JhcHBlclxuICAgICAgLmZpbmQoJy5jN24tZHJvcGRvd24tbWVudS1zdWJtZW51LXRpdGxlJylcbiAgICAgIC5hdCgwKVxuICAgICAgLnNpbXVsYXRlKCdtb3VzZUVudGVyJyk7XG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcbiAgICBkcm9wZG93bldyYXBwZXIudXBkYXRlKCk7XG4gICAgZHJvcGRvd25XcmFwcGVyXG4gICAgICAuZmluZCgnLmM3bi1kcm9wZG93bi1tZW51LXN1Ym1lbnUtdGl0bGUnKVxuICAgICAgLmF0KDEpXG4gICAgICAuc2ltdWxhdGUoJ21vdXNlRW50ZXInKTtcbiAgICBqZXN0LnJ1bkFsbFRpbWVycygpO1xuICAgIGRyb3Bkb3duV3JhcHBlci51cGRhdGUoKTtcbiAgICBkcm9wZG93bldyYXBwZXJcbiAgICAgIC5maW5kKCdNZW51SXRlbScpXG4gICAgICAubGFzdCgpXG4gICAgICAuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgZHJvcGRvd25XcmFwcGVyLmZpbmQoJy5jb25maXJtJykuc2ltdWxhdGUoJ2NsaWNrJyk7XG4gICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICBleHBlY3QocmVuZGVyZWROYW1lcyh3cmFwcGVyKSkudG9FcXVhbChbJ0phY2snXSk7XG4gICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gIH0pO1xuXG4gIGl0KCd3b3JrcyB3aXRoIEpTWCBpbiBjb250cm9sbGVkIG1vZGUnLCAoKSA9PiB7XG4gICAgY29uc3QgeyBDb2x1bW4gfSA9IFRhYmxlO1xuXG4gICAgY2xhc3MgQXBwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICAgIHN0YXRlID0ge1xuICAgICAgICBmaWx0ZXJzOiB7fSxcbiAgICAgIH07XG5cbiAgICAgIGhhbmRsZUNoYW5nZSA9IChwYWdpbmF0aW9uLCBmaWx0ZXJzKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBmaWx0ZXJzIH0pO1xuICAgICAgfTtcblxuICAgICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZmlsdGVyczogeyBuYW1lIH0sXG4gICAgICAgIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxUYWJsZSBkYXRhU291cmNlPXtkYXRhfSBvbkNoYW5nZT17dGhpcy5oYW5kbGVDaGFuZ2V9IGZpbHRlckJhcj17ZmFsc2V9PlxuICAgICAgICAgICAgPENvbHVtblxuICAgICAgICAgICAgICB0aXRsZT1cIm5hbWVcIlxuICAgICAgICAgICAgICBkYXRhSW5kZXg9XCJuYW1lXCJcbiAgICAgICAgICAgICAga2V5PVwibmFtZVwiXG4gICAgICAgICAgICAgIGZpbHRlcnM9e1t7IHRleHQ6ICdKYWNrJywgdmFsdWU6ICdKYWNrJyB9LCB7IHRleHQ6ICdMdWN5JywgdmFsdWU6ICdMdWN5JyB9XX1cbiAgICAgICAgICAgICAgZmlsdGVyZWRWYWx1ZT17bmFtZX1cbiAgICAgICAgICAgICAgb25GaWx0ZXI9e2ZpbHRlckZufVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L1RhYmxlPlxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudCg8QXBwIC8+KTtcbiAgICBjb25zdCBkcm9wZG93bldyYXBwZXIgPSBtb3VudChcbiAgICAgIHdyYXBwZXJcbiAgICAgICAgLmZpbmQoJ1RyaWdnZXInKVxuICAgICAgICAuYXQoMClcbiAgICAgICAgLmluc3RhbmNlKClcbiAgICAgICAgLmdldENvbXBvbmVudCgpLFxuICAgICk7XG5cbiAgICBkcm9wZG93bldyYXBwZXJcbiAgICAgIC5maW5kKCdNZW51SXRlbScpXG4gICAgICAuZmlyc3QoKVxuICAgICAgLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIGRyb3Bkb3duV3JhcHBlci5maW5kKCcuY29uZmlybScpLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgZXhwZWN0KHJlbmRlcmVkTmFtZXMod3JhcHBlcikpLnRvRXF1YWwoWydKYWNrJ10pO1xuXG4gICAgZHJvcGRvd25XcmFwcGVyLmZpbmQoJy5jbGVhcicpLnNpbXVsYXRlKCdjbGljaycpO1xuICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgZXhwZWN0KHJlbmRlcmVkTmFtZXMod3JhcHBlcikpLnRvRXF1YWwoWydKYWNrJywgJ0x1Y3knLCAnVG9tJywgJ0plcnJ5J10pO1xuICB9KTtcblxuICBpdCgnd29ya3Mgd2l0aCBncm91cGluZyBjb2x1bW5zIGluIGNvbnRyb2xsZWQgbW9kZScsICgpID0+IHtcbiAgICBjb25zdCBjb2x1bW5zID0gW1xuICAgICAge1xuICAgICAgICB0aXRsZTogJ2dyb3VwJyxcbiAgICAgICAga2V5OiAnZ3JvdXAnLFxuICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnTmFtZScsXG4gICAgICAgICAgICBkYXRhSW5kZXg6ICduYW1lJyxcbiAgICAgICAgICAgIGtleTogJ25hbWUnLFxuICAgICAgICAgICAgZmlsdGVyczogW3sgdGV4dDogJ0phY2snLCB2YWx1ZTogJ0phY2snIH0sIHsgdGV4dDogJ0x1Y3knLCB2YWx1ZTogJ0x1Y3knIH1dLFxuICAgICAgICAgICAgb25GaWx0ZXI6IGZpbHRlckZuLFxuICAgICAgICAgICAgZmlsdGVyZWRWYWx1ZTogWydKYWNrJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZTogJ0FnZScsXG4gICAgICAgICAgICBkYXRhSW5kZXg6ICdhZ2UnLFxuICAgICAgICAgICAga2V5OiAnYWdlJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICBdO1xuICAgIGNvbnN0IHRlc3REYXRhID0gW1xuICAgICAgeyBrZXk6IDAsIG5hbWU6ICdKYWNrJywgYWdlOiAxMSB9LFxuICAgICAgeyBrZXk6IDEsIG5hbWU6ICdMdWN5JywgYWdlOiAyMCB9LFxuICAgICAgeyBrZXk6IDIsIG5hbWU6ICdUb20nLCBhZ2U6IDIxIH0sXG4gICAgICB7IGtleTogMywgbmFtZTogJ0plcnJ5JywgYWdlOiAyMiB9LFxuICAgIF07XG4gICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KDxUYWJsZSBjb2x1bW5zPXtjb2x1bW5zfSBkYXRhU291cmNlPXt0ZXN0RGF0YX0gZmlsdGVyQmFyPXtmYWxzZX0gLz4pO1xuXG4gICAgZXhwZWN0KHJlbmRlcmVkTmFtZXMod3JhcHBlcikpLnRvRXF1YWwoWydKYWNrJ10pO1xuICB9KTtcblxuICBpdCgnY29uZmlybSBmaWx0ZXIgd2hlbiBkcm9wZG93biBoaWRkZW4nLCAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChcbiAgICAgIGNyZWF0ZVRhYmxlKHtcbiAgICAgICAgY29sdW1uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmNvbHVtbixcbiAgICAgICAgICAgIGZpbHRlcnM6IFt7IHRleHQ6ICdKYWNrJywgdmFsdWU6ICdKYWNrJyB9LCB7IHRleHQ6ICdMdWN5JywgdmFsdWU6ICdMdWN5JyB9XSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBvbkNoYW5nZTogaGFuZGxlQ2hhbmdlLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHdyYXBwZXJcbiAgICAgIC5maW5kKCcuYzduLWRyb3Bkb3duLXRyaWdnZXInKVxuICAgICAgLmZpcnN0KClcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICB3cmFwcGVyXG4gICAgICAuZmluZCgnLmM3bi1kcm9wZG93bi1tZW51LWl0ZW0nKVxuICAgICAgLmZpcnN0KClcbiAgICAgIC5zaW11bGF0ZSgnY2xpY2snKTtcbiAgICB3cmFwcGVyXG4gICAgICAuZmluZCgnLmM3bi1kcm9wZG93bi10cmlnZ2VyJylcbiAgICAgIC5maXJzdCgpXG4gICAgICAuc2ltdWxhdGUoJ2NsaWNrJyk7XG5cbiAgICBleHBlY3QoaGFuZGxlQ2hhbmdlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xufSk7XG4iXX0=