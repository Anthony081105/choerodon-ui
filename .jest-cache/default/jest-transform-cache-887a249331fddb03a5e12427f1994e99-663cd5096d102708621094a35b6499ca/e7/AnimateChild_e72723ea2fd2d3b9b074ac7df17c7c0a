e088ee7b034f59c4e793fc5eb7dc9cca
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _react = require("react");

var _reactDom = require("react-dom");

var _omit = _interopRequireDefault(require("lodash/omit"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _cssAnimation = _interopRequireWildcard(require("css-animation"));

var _util = _interopRequireDefault(require("./util"));

var transitionMap = {
  enter: 'transitionEnter',
  appear: 'transitionAppear',
  leave: 'transitionLeave'
};

var AnimateChild =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(AnimateChild, _Component);

  function AnimateChild() {
    (0, _classCallCheck2["default"])(this, AnimateChild);
    return (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(AnimateChild).apply(this, arguments));
  }

  (0, _createClass2["default"])(AnimateChild, [{
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.stop();
    }
  }, {
    key: "componentWillEnter",
    value: function componentWillEnter(done) {
      if (_util["default"].isEnterSupported(this.props)) {
        this.transition('enter', done);
      } else {
        done(this);
      }
    }
  }, {
    key: "componentWillAppear",
    value: function componentWillAppear(done) {
      if (_util["default"].isAppearSupported(this.props)) {
        this.transition('appear', done);
      } else {
        done(this);
      }
    }
  }, {
    key: "componentWillLeave",
    value: function componentWillLeave(done) {
      if (_util["default"].isLeaveSupported(this.props)) {
        this.transition('leave', done);
      } else {
        done(this);
      }
    }
  }, {
    key: "transition",
    value: function transition(animationType, finishCallback) {
      var _this = this;

      var node = (0, _reactDom.findDOMNode)(this);

      if (node) {
        var props = this.props;
        var transitionName = props.transitionName,
            _props$animation = props.animation,
            animation = _props$animation === void 0 ? {} : _props$animation;
        var nameIsObj = (0, _typeof2["default"])(transitionName) === 'object';
        this.stop();

        var end = function end() {
          _this.stopper = null;
          finishCallback(_this);
        };

        if ((_cssAnimation.isCssAnimationSupported || !animation[animationType]) && transitionName && props[transitionMap[animationType]]) {
          var name = nameIsObj ? transitionName[animationType] : "".concat(transitionName, "-").concat(animationType);
          var activeName = "".concat(name, "-active");

          if (nameIsObj && transitionName["".concat(animationType, "Active")]) {
            activeName = transitionName["".concat(animationType, "Active")];
          }

          this.stopper = (0, _cssAnimation["default"])(node, {
            name: name,
            active: activeName
          }, end);
        } else {
          this.stopper = animation[animationType](node, end);
        }
      }
    }
  }, {
    key: "stop",
    value: function stop() {
      var stopper = this.stopper;

      if (stopper) {
        this.stopper = null;
        stopper.stop();
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          children = _this$props.children,
          otherProps = (0, _objectWithoutProperties2["default"])(_this$props, ["children"]);

      if ((0, _react.isValidElement)(children)) {
        var props = (0, _omit["default"])(otherProps, ['animation', 'transitionName', 'transitionEnter', 'transitionAppear', 'transitionLeave']);
        var style = children.props.style;
        return (0, _react.cloneElement)(children, (0, _objectSpread2["default"])({}, props, {
          style: (0, _objectSpread2["default"])({}, props.style, {}, style)
        }));
      }

      return children;
    }
  }]);
  return AnimateChild;
}(_react.Component);

exports["default"] = AnimateChild;
AnimateChild.displayName = 'AnimateChild';
AnimateChild.propTypes = {
  children: _propTypes["default"].any,
  transitionName: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].object]),
  animation: _propTypes["default"].any
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdGUvQW5pbWF0ZUNoaWxkLmpzIl0sIm5hbWVzIjpbInRyYW5zaXRpb25NYXAiLCJlbnRlciIsImFwcGVhciIsImxlYXZlIiwiQW5pbWF0ZUNoaWxkIiwiQ29tcG9uZW50IiwiZG9uZSIsImFuaW1VdGlsIiwiYW5pbWF0aW9uVHlwZSIsImZpbmlzaENhbGxiYWNrIiwibm9kZSIsInByb3BzIiwidHJhbnNpdGlvbk5hbWUiLCJhbmltYXRpb24iLCJuYW1lSXNPYmoiLCJlbmQiLCJpc0Nzc0FuaW1hdGlvblN1cHBvcnRlZCIsIm5hbWUiLCJhY3RpdmVOYW1lIiwiYWN0aXZlIiwic3RvcHBlciIsImNoaWxkcmVuIiwib3RoZXJQcm9wcyIsInN0eWxlIiwiUHJvcFR5cGVzIiwiYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBLE1BQUEsR0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBOztBQUNBLElBQUEsU0FBQSxHQUFBLE9BQUEsQ0FBQSxXQUFBLENBQUE7O0FBQ0EsSUFBQSxLQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxVQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxhQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBLENBQUEsZUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBQSxLQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7O0FBQ0EsSUFBTUEsYUFBYSxHQUFHO0FBQ2xCQyxFQUFBQSxLQUFLLEVBRGEsaUJBQUE7QUFFbEJDLEVBQUFBLE1BQU0sRUFGWSxrQkFBQTtBQUdsQkMsRUFBQUEsS0FBSyxFQUFFO0FBSFcsQ0FBdEI7O0lBS3FCQyxZOzs7Ozs7Ozs7Ozs7MkNBQ007QUFDbkIsV0FBQSxJQUFBO0FBQ0g7Ozt1Q0FDa0JFLEksRUFBTTtBQUNyQixVQUFJQyxLQUFB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QURXLEdBQUE7QUFFckJaLEVBQUFBLGNBQWMsRUFBRVksVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBQUEsU0FBQUEsQ0FBb0IsQ0FBQ0EsVUFBQUEsQ0FBQUEsU0FBQUEsQ0FBQUEsQ0FBRCxNQUFBLEVBQW1CQSxVQUFBQSxDQUFBQSxTQUFBQSxDQUFBQSxDQUZsQyxNQUVlLENBQXBCQSxDQUZLO0FBR3JCWCxFQUFBQSxTQUFTLEVBQUVXLFVBQUFBLENBQUFBLFNBQUFBLENBQUFBLENBQVVDO0FBSEEsQ0FBekJyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNsb25lRWxlbWVudCwgQ29tcG9uZW50LCBpc1ZhbGlkRWxlbWVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGZpbmRET01Ob2RlIH0gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCBvbWl0IGZyb20gJ2xvZGFzaC9vbWl0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY3NzQW5pbWF0ZSwgeyBpc0Nzc0FuaW1hdGlvblN1cHBvcnRlZCB9IGZyb20gJ2Nzcy1hbmltYXRpb24nO1xuaW1wb3J0IGFuaW1VdGlsIGZyb20gJy4vdXRpbCc7XG5jb25zdCB0cmFuc2l0aW9uTWFwID0ge1xuICAgIGVudGVyOiAndHJhbnNpdGlvbkVudGVyJyxcbiAgICBhcHBlYXI6ICd0cmFuc2l0aW9uQXBwZWFyJyxcbiAgICBsZWF2ZTogJ3RyYW5zaXRpb25MZWF2ZScsXG59O1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQW5pbWF0ZUNoaWxkIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxFbnRlcihkb25lKSB7XG4gICAgICAgIGlmIChhbmltVXRpbC5pc0VudGVyU3VwcG9ydGVkKHRoaXMucHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zaXRpb24oJ2VudGVyJywgZG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb25lKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxBcHBlYXIoZG9uZSkge1xuICAgICAgICBpZiAoYW5pbVV0aWwuaXNBcHBlYXJTdXBwb3J0ZWQodGhpcy5wcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbignYXBwZWFyJywgZG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb25lKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxMZWF2ZShkb25lKSB7XG4gICAgICAgIGlmIChhbmltVXRpbC5pc0xlYXZlU3VwcG9ydGVkKHRoaXMucHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zaXRpb24oJ2xlYXZlJywgZG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb25lKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyYW5zaXRpb24oYW5pbWF0aW9uVHlwZSwgZmluaXNoQ2FsbGJhY2spIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IGZpbmRET01Ob2RlKHRoaXMpO1xuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgY29uc3QgeyBwcm9wcyB9ID0gdGhpcztcbiAgICAgICAgICAgIGNvbnN0IHsgdHJhbnNpdGlvbk5hbWUsIGFuaW1hdGlvbiA9IHt9IH0gPSBwcm9wcztcbiAgICAgICAgICAgIGNvbnN0IG5hbWVJc09iaiA9IHR5cGVvZiB0cmFuc2l0aW9uTmFtZSA9PT0gJ29iamVjdCc7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BwZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIGZpbmlzaENhbGxiYWNrKHRoaXMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICgoaXNDc3NBbmltYXRpb25TdXBwb3J0ZWQgfHwgIWFuaW1hdGlvblthbmltYXRpb25UeXBlXSkgJiZcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uTmFtZSAmJlxuICAgICAgICAgICAgICAgIHByb3BzW3RyYW5zaXRpb25NYXBbYW5pbWF0aW9uVHlwZV1dKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IG5hbWVJc09ialxuICAgICAgICAgICAgICAgICAgICA/IHRyYW5zaXRpb25OYW1lW2FuaW1hdGlvblR5cGVdXG4gICAgICAgICAgICAgICAgICAgIDogYCR7dHJhbnNpdGlvbk5hbWV9LSR7YW5pbWF0aW9uVHlwZX1gO1xuICAgICAgICAgICAgICAgIGxldCBhY3RpdmVOYW1lID0gYCR7bmFtZX0tYWN0aXZlYDtcbiAgICAgICAgICAgICAgICBpZiAobmFtZUlzT2JqICYmIHRyYW5zaXRpb25OYW1lW2Ake2FuaW1hdGlvblR5cGV9QWN0aXZlYF0pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlTmFtZSA9IHRyYW5zaXRpb25OYW1lW2Ake2FuaW1hdGlvblR5cGV9QWN0aXZlYF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcHBlciA9IGNzc0FuaW1hdGUobm9kZSwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IGFjdGl2ZU5hbWUsXG4gICAgICAgICAgICAgICAgfSwgZW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcHBlciA9IGFuaW1hdGlvblthbmltYXRpb25UeXBlXShub2RlLCBlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGNvbnN0IHsgc3RvcHBlciB9ID0gdGhpcztcbiAgICAgICAgaWYgKHN0b3BwZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcHBlciA9IG51bGw7XG4gICAgICAgICAgICBzdG9wcGVyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgY2hpbGRyZW4sIC4uLm90aGVyUHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmIChpc1ZhbGlkRWxlbWVudChjaGlsZHJlbikpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb3BzID0gb21pdChvdGhlclByb3BzLCBbXG4gICAgICAgICAgICAgICAgJ2FuaW1hdGlvbicsXG4gICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25OYW1lJyxcbiAgICAgICAgICAgICAgICAndHJhbnNpdGlvbkVudGVyJyxcbiAgICAgICAgICAgICAgICAndHJhbnNpdGlvbkFwcGVhcicsXG4gICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25MZWF2ZScsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIGNvbnN0IHsgc3R5bGUgfSA9IGNoaWxkcmVuLnByb3BzO1xuICAgICAgICAgICAgcmV0dXJuIGNsb25lRWxlbWVudChjaGlsZHJlbiwgeyAuLi5wcm9wcywgc3R5bGU6IHsgLi4ucHJvcHMuc3R5bGUsIC4uLnN0eWxlIH0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cbn1cbkFuaW1hdGVDaGlsZC5kaXNwbGF5TmFtZSA9ICdBbmltYXRlQ2hpbGQnO1xuQW5pbWF0ZUNoaWxkLnByb3BUeXBlcyA9IHtcbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmFueSxcbiAgICB0cmFuc2l0aW9uTmFtZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm9iamVjdF0pLFxuICAgIGFuaW1hdGlvbjogUHJvcFR5cGVzLmFueSxcbn07XG4iXX0=