8af1a2b51bb4a2e696a2df99e97614d9
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread2"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _classnames = _interopRequireDefault(require("classnames"));

var _trigger = _interopRequireDefault(require("../trigger"));

var _tree = _interopRequireWildcard(require("../../tree"));

var _util = require("./util");

var _toArray = _interopRequireDefault(require("../util/Children/toArray"));

function _createSuper(Derived) {
  function isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  return function () {
    var Super = (0, _getPrototypeOf2["default"])(Derived),
        result;

    if (isNativeReflectConstruct()) {
      var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2["default"])(this, result);
  };
}

var BUILT_IN_PLACEMENTS = {
  bottomLeft: {
    points: ['tl', 'bl'],
    offset: [0, 4],
    overflow: {
      adjustX: 0,
      adjustY: 1
    }
  },
  topLeft: {
    points: ['bl', 'tl'],
    offset: [0, -4],
    overflow: {
      adjustX: 0,
      adjustY: 1
    }
  }
};

var SelectTrigger =
/*#__PURE__*/
function (_Component) {
  (0, _inherits2["default"])(SelectTrigger, _Component);

  var _super = _createSuper(SelectTrigger);

  function SelectTrigger() {
    var _this;

    (0, _classCallCheck2["default"])(this, SelectTrigger);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
      _expandedKeys: [],
      fireOnExpand: false,
      dropdownWidth: null
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "onExpand", function (expandedKeys) {
      // rerender
      _this.setState({
        _expandedKeys: expandedKeys,
        fireOnExpand: true
      }, function () {
        if (_this.trigger && _this.trigger.forcePopupAlign) {
          _this.trigger.forcePopupAlign();
        }
      });
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "highlightTreeNode", function (treeNode) {
      var props = _this.props;
      var filterVal = treeNode.props[(0, _util.labelCompatible)(props.treeNodeFilterProp)];

      if (typeof filterVal === 'string') {
        return props.inputValue && filterVal.indexOf(props.inputValue) > -1;
      }

      return false;
    });
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "filterTreeNode", function (input, child) {
      if (!input) {
        return true;
      }

      var filterTreeNode = _this.props.filterTreeNode;

      if (!filterTreeNode) {
        return true;
      }

      if (child.props.disabled) {
        return false;
      }

      return filterTreeNode.call((0, _assertThisInitialized2["default"])(_this), input, child);
    });
    return _this;
  }

  (0, _createClass2["default"])(SelectTrigger, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setDropdownWidth();
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if (nextProps.inputValue && nextProps.inputValue !== this.props.inputValue) {
        // set autoExpandParent to true
        this.setState({
          _expandedKeys: [],
          fireOnExpand: false
        });
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      this.setDropdownWidth();
    }
  }, {
    key: "setDropdownWidth",
    value: function setDropdownWidth() {
      var width = _reactDom["default"].findDOMNode(this).offsetWidth;

      if (width !== this.state.dropdownWidth) {
        this.setState({
          dropdownWidth: width
        });
      }
    }
  }, {
    key: "getPopupEleRefs",
    value: function getPopupEleRefs() {
      return this.popupEle;
    }
  }, {
    key: "getPopupDOMNode",
    value: function getPopupDOMNode() {
      return this.trigger.getPopupDomNode();
    }
  }, {
    key: "getDropdownTransitionName",
    value: function getDropdownTransitionName() {
      var props = this.props;
      var transitionName = props.transitionName;

      if (!transitionName && props.animation) {
        transitionName = "".concat(this.getDropdownPrefixCls(), "-").concat(props.animation);
      }

      return transitionName;
    }
  }, {
    key: "getDropdownPrefixCls",
    value: function getDropdownPrefixCls() {
      return "".concat(this.props.prefixCls, "-dropdown");
    }
  }, {
    key: "processTreeNode",
    value: function processTreeNode(treeNodes) {
      var _this2 = this;

      var filterPoss = [];
      this._expandedKeys = [];
      (0, _util.loopAllChildren)(treeNodes, function (child, index, pos) {
        if (_this2.filterTreeNode(_this2.props.inputValue, child)) {
          filterPoss.push(pos);

          _this2._expandedKeys.push(child.key);
        }
      }); // Include the filtered nodes's ancestral nodes.

      var processedPoss = [];
      filterPoss.forEach(function (pos) {
        var arr = pos.split('-');
        arr.reduce(function (pre, cur) {
          var res = "".concat(pre, "-").concat(cur);

          if (processedPoss.indexOf(res) < 0) {
            processedPoss.push(res);
          }

          return res;
        });
      });
      var filterNodesPositions = [];
      (0, _util.loopAllChildren)(treeNodes, function (child, index, pos) {
        if (processedPoss.indexOf(pos) > -1) {
          filterNodesPositions.push({
            node: child,
            pos: pos
          });
        }
      });
      var hierarchyNodes = (0, _util.flatToHierarchy)(filterNodesPositions);

      var recursive = function recursive(children) {
        return children.map(function (child) {
          if (child.children) {
            return (0, _react.cloneElement)(child.node, {}, recursive(child.children));
          }

          return child.node;
        });
      };

      return recursive(hierarchyNodes);
    }
  }, {
    key: "renderTree",
    value: function renderTree(keys, halfCheckedKeys, newTreeNodes, multiple) {
      var props = this.props;
      var trProps = {
        multiple: multiple,
        prefixCls: "".concat(props.prefixCls, "-tree"),
        showIcon: props.treeIcon,
        showLine: props.treeLine,
        defaultExpandAll: props.treeDefaultExpandAll,
        defaultExpandedKeys: props.treeDefaultExpandedKeys,
        filterTreeNode: this.highlightTreeNode
      };

      if (props.treeCheckable) {
        trProps.selectable = false;
        trProps.checkable = props.treeCheckable;
        trProps.onCheck = props.onSelect;
        trProps.checkStrictly = props.treeCheckStrictly;

        if (props.inputValue) {
          // enable checkStrictly when search tree.
          trProps.checkStrictly = true;
        } else {
          trProps._treeNodesStates = props._treeNodesStates;
        }

        if (trProps.treeCheckStrictly && halfCheckedKeys.length) {
          trProps.checkedKeys = {
            checked: keys,
            halfChecked: halfCheckedKeys
          };
        } else {
          trProps.checkedKeys = keys;
        }
      } else {
        trProps.selectedKeys = keys;
        trProps.onSelect = props.onSelect;
      } // expand keys


      if (!trProps.defaultExpandAll && !trProps.defaultExpandedKeys && !props.loadData) {
        trProps.expandedKeys = keys;
      }

      trProps.autoExpandParent = true;
      trProps.onExpand = this.onExpand;

      if (this._expandedKeys && this._expandedKeys.length) {
        trProps.expandedKeys = this._expandedKeys;
      }

      if (this.state.fireOnExpand) {
        trProps.expandedKeys = this.state._expandedKeys;
        trProps.autoExpandParent = false;
      } // async loadData


      if (props.loadData) {
        trProps.loadData = props.loadData;
      }

      return _react["default"].createElement(_tree["default"], (0, _extends2["default"])({
        ref: (0, _util.saveRef)(this, 'popupEle')
      }, trProps), newTreeNodes);
    }
  }, {
    key: "render",
    value: function render() {
      var _popupClassName;

      var props = this.props;
      var multiple = props.multiple;
      var dropdownPrefixCls = this.getDropdownPrefixCls();
      var popupClassName = (_popupClassName = {}, (0, _defineProperty2["default"])(_popupClassName, props.dropdownClassName, !!props.dropdownClassName), (0, _defineProperty2["default"])(_popupClassName, "".concat(dropdownPrefixCls, "--").concat(multiple ? 'multiple' : 'single'), 1), _popupClassName);
      var visible = props.visible;
      var search = multiple || !props.showSearch ? null : _react["default"].createElement("span", {
        className: "".concat(dropdownPrefixCls, "-search")
      }, props.inputElement);

      var recursive = function recursive(children) {
        // Note: if use `React.Children.map`, the node's key will be modified.
        return (0, _toArray["default"])(children).map(function handler(child) {
          // eslint-disable-line
          if (!child) {
            return null;
          }

          if (child && child.props.children) {
            // null or String has no Prop
            return _react["default"].createElement(_tree.TreeNode, (0, _extends2["default"])({}, child.props, {
              key: child.key
            }), recursive(child.props.children));
          }

          return _react["default"].createElement(_tree.TreeNode, (0, _extends2["default"])({}, child.props, {
            key: child.key
          }));
        });
      }; // const s = Date.now();


      var treeNodes;

      if (props._cachetreeData && this.treeNodes) {
        treeNodes = this.treeNodes;
      } else {
        treeNodes = recursive(props.treeData || props.treeNodes);
        this.treeNodes = treeNodes;
      } // console.log(Date.now()-s);


      if (props.inputValue) {
        treeNodes = this.processTreeNode(treeNodes);
      }

      var keys = [];
      var halfCheckedKeys = [];
      (0, _util.loopAllChildren)(treeNodes, function (child) {
        if (props.value.some(function (item) {
          return item.value === (0, _util.getValuePropValue)(child);
        })) {
          keys.push(child.key);
        }

        if (props.halfCheckedValues && props.halfCheckedValues.some(function (item) {
          return item.value === (0, _util.getValuePropValue)(child);
        })) {
          halfCheckedKeys.push(child.key);
        }
      });
      var notFoundContent;

      if (!treeNodes.length) {
        if (props.notFoundContent) {
          notFoundContent = _react["default"].createElement("span", {
            className: "".concat(props.prefixCls, "-not-found")
          }, props.notFoundContent);
        } else if (!search) {
          visible = false;
        }
      }

      var popupElement = _react["default"].createElement("div", null, search, notFoundContent || this.renderTree(keys, halfCheckedKeys, treeNodes, multiple));

      var popupStyle = (0, _objectSpread2["default"])({}, props.dropdownStyle);
      var widthProp = props.dropdownMatchSelectWidth ? 'width' : 'minWidth';

      if (this.state.dropdownWidth) {
        popupStyle[widthProp] = "".concat(this.state.dropdownWidth, "px");
      }

      return _react["default"].createElement(_trigger["default"], {
        action: props.disabled ? [] : ['click'],
        ref: (0, _util.saveRef)(this, 'trigger'),
        popupPlacement: "bottomLeft",
        builtinPlacements: BUILT_IN_PLACEMENTS,
        popupAlign: props.dropdownPopupAlign,
        prefixCls: dropdownPrefixCls,
        popupTransitionName: this.getDropdownTransitionName(),
        onPopupVisibleChange: props.onDropdownVisibleChange,
        popup: popupElement,
        popupVisible: visible,
        getPopupContainer: props.getPopupContainer,
        popupClassName: (0, _classnames["default"])(popupClassName),
        popupStyle: popupStyle
      }, this.props.children);
    }
  }]);
  return SelectTrigger;
}(_react.Component);

(0, _defineProperty2["default"])(SelectTrigger, "propTypes", {
  dropdownMatchSelectWidth: _propTypes["default"].bool,
  dropdownPopupAlign: _propTypes["default"].object,
  visible: _propTypes["default"].bool,
  filterTreeNode: _propTypes["default"].any,
  treeNodes: _propTypes["default"].any,
  inputValue: _propTypes["default"].string,
  prefixCls: _propTypes["default"].string,
  popupClassName: _propTypes["default"].string,
  children: _propTypes["default"].any
});
var _default = SelectTrigger;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlbGVjdFRyaWdnZXIuanN4Il0sIm5hbWVzIjpbIkJVSUxUX0lOX1BMQUNFTUVOVFMiLCJib3R0b21MZWZ0IiwicG9pbnRzIiwib2Zmc2V0Iiwib3ZlcmZsb3ciLCJhZGp1c3RYIiwiYWRqdXN0WSIsInRvcExlZnQiLCJTZWxlY3RUcmlnZ2VyIiwiX2V4cGFuZGVkS2V5cyIsImZpcmVPbkV4cGFuZCIsImRyb3Bkb3duV2lkdGgiLCJleHBhbmRlZEtleXMiLCJzZXRTdGF0ZSIsInRyaWdnZXIiLCJmb3JjZVBvcHVwQWxpZ24iLCJ0cmVlTm9kZSIsInByb3BzIiwiZmlsdGVyVmFsIiwidHJlZU5vZGVGaWx0ZXJQcm9wIiwiaW5wdXRWYWx1ZSIsImluZGV4T2YiLCJpbnB1dCIsImNoaWxkIiwiZmlsdGVyVHJlZU5vZGUiLCJkaXNhYmxlZCIsImNhbGwiLCJzZXREcm9wZG93bldpZHRoIiwibmV4dFByb3BzIiwid2lkdGgiLCJSZWFjdERPTSIsImZpbmRET01Ob2RlIiwib2Zmc2V0V2lkdGgiLCJzdGF0ZSIsInBvcHVwRWxlIiwiZ2V0UG9wdXBEb21Ob2RlIiwidHJhbnNpdGlvbk5hbWUiLCJhbmltYXRpb24iLCJnZXREcm9wZG93blByZWZpeENscyIsInByZWZpeENscyIsInRyZWVOb2RlcyIsImZpbHRlclBvc3MiLCJpbmRleCIsInBvcyIsInB1c2giLCJrZXkiLCJwcm9jZXNzZWRQb3NzIiwiZm9yRWFjaCIsImFyciIsInNwbGl0IiwicmVkdWNlIiwicHJlIiwiY3VyIiwicmVzIiwiZmlsdGVyTm9kZXNQb3NpdGlvbnMiLCJub2RlIiwiaGllcmFyY2h5Tm9kZXMiLCJyZWN1cnNpdmUiLCJjaGlsZHJlbiIsIm1hcCIsImtleXMiLCJoYWxmQ2hlY2tlZEtleXMiLCJuZXdUcmVlTm9kZXMiLCJtdWx0aXBsZSIsInRyUHJvcHMiLCJzaG93SWNvbiIsInRyZWVJY29uIiwic2hvd0xpbmUiLCJ0cmVlTGluZSIsImRlZmF1bHRFeHBhbmRBbGwiLCJ0cmVlRGVmYXVsdEV4cGFuZEFsbCIsImRlZmF1bHRFeHBhbmRlZEtleXMiLCJ0cmVlRGVmYXVsdEV4cGFuZGVkS2V5cyIsImhpZ2hsaWdodFRyZWVOb2RlIiwidHJlZUNoZWNrYWJsZSIsInNlbGVjdGFibGUiLCJjaGVja2FibGUiLCJvbkNoZWNrIiwib25TZWxlY3QiLCJjaGVja1N0cmljdGx5IiwidHJlZUNoZWNrU3RyaWN0bHkiLCJfdHJlZU5vZGVzU3RhdGVzIiwibGVuZ3RoIiwiY2hlY2tlZEtleXMiLCJjaGVja2VkIiwiaGFsZkNoZWNrZWQiLCJzZWxlY3RlZEtleXMiLCJsb2FkRGF0YSIsImF1dG9FeHBhbmRQYXJlbnQiLCJvbkV4cGFuZCIsImRyb3Bkb3duUHJlZml4Q2xzIiwicG9wdXBDbGFzc05hbWUiLCJkcm9wZG93bkNsYXNzTmFtZSIsInZpc2libGUiLCJzZWFyY2giLCJzaG93U2VhcmNoIiwiaW5wdXRFbGVtZW50IiwiaGFuZGxlciIsIl9jYWNoZXRyZWVEYXRhIiwidHJlZURhdGEiLCJwcm9jZXNzVHJlZU5vZGUiLCJ2YWx1ZSIsInNvbWUiLCJpdGVtIiwiaGFsZkNoZWNrZWRWYWx1ZXMiLCJub3RGb3VuZENvbnRlbnQiLCJwb3B1cEVsZW1lbnQiLCJyZW5kZXJUcmVlIiwicG9wdXBTdHlsZSIsImRyb3Bkb3duU3R5bGUiLCJ3aWR0aFByb3AiLCJkcm9wZG93bk1hdGNoU2VsZWN0V2lkdGgiLCJkcm9wZG93blBvcHVwQWxpZ24iLCJnZXREcm9wZG93blRyYW5zaXRpb25OYW1lIiwib25Ecm9wZG93blZpc2libGVDaGFuZ2UiLCJnZXRQb3B1cENvbnRhaW5lciIsIkNvbXBvbmVudCIsIlByb3BUeXBlcyIsImJvb2wiLCJvYmplY3QiLCJhbnkiLCJzdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSxtQkFB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ZCxDQUZQO0FBR0UsUUFBQSxjQUFjLEVBQUMsWUFIakI7QUFJRSxRQUFBLGlCQUFpQixFQUFFekIsbUJBSnJCO0FBS0UsUUFBQSxVQUFVLEVBQUVpQixLQUFLLENBQUMrRixrQkFMcEI7QUFNRSxRQUFBLFNBQVMsRUFBRXRCLGlCQU5iO0FBT0UsUUFBQSxtQkFBbUIsRUFBRSxLQUFLdUIseUJBQUwsRUFQdkI7QUFRRSxRQUFBLG9CQUFvQixFQUFFaEcsS0FBSyxDQUFDaUcsdUJBUjlCO0FBU0UsUUFBQSxLQUFLLEVBQUVSLFlBVFQ7QUFVRSxRQUFBLFlBQVksRUFBRWIsT0FWaEI7QUFXRSxRQUFBLGlCQUFpQixFQUFFNUUsS0FBSyxDQUFDa0csaUJBWDNCO0FBWUUsUUFBQSxjQUFjLEVBQUUsNEJBQVd4QixjQUFYLENBWmxCO0FBYUUsUUFBQSxVQUFVLEVBQUVpQjtBQWJkLFNBZUcsS0FBSzNGLEtBQUwsQ0FBV3lDLFFBZmQsQ0FERjtBQW1CRDs7O0VBOVN5QjBELGdCOztpQ0FBdEI1RyxhLGVBQ2U7QUFDakJ1RyxFQUFBQSx3QkFBd0IsRUFBRU0sc0JBQVVDLElBRG5CO0FBRWpCTixFQUFBQSxrQkFBa0IsRUFBRUssc0JBQVVFLE1BRmI7QUFHakIxQixFQUFBQSxPQUFPLEVBQUV3QixzQkFBVUMsSUFIRjtBQUlqQjlGLEVBQUFBLGNBQWMsRUFBRTZGLHNCQUFVRyxHQUpUO0FBS2pCaEYsRUFBQUEsU0FBUyxFQUFFNkUsc0JBQVVHLEdBTEo7QUFNakJwRyxFQUFBQSxVQUFVLEVBQUVpRyxzQkFBVUksTUFOTDtBQU9qQmxGLEVBQUFBLFNBQVMsRUFBRThFLHNCQUFVSSxNQVBKO0FBUWpCOUIsRUFBQUEsY0FBYyxFQUFFMEIsc0JBQVVJLE1BUlQ7QUFTakIvRCxFQUFBQSxRQUFRLEVBQUUyRCxzQkFBVUc7QUFUSCxDO2VBZ1ROaEgsYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBjbG9uZUVsZW1lbnQsIENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IFRyaWdnZXIgZnJvbSAnLi4vdHJpZ2dlcic7XG5pbXBvcnQgVHJlZSwgeyBUcmVlTm9kZSB9IGZyb20gJy4uLy4uL3RyZWUnO1xuaW1wb3J0IHsgZmxhdFRvSGllcmFyY2h5LCBnZXRWYWx1ZVByb3BWYWx1ZSwgbGFiZWxDb21wYXRpYmxlLCBsb29wQWxsQ2hpbGRyZW4sIHNhdmVSZWYsIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB0b0FycmF5IGZyb20gJy4uL3V0aWwvQ2hpbGRyZW4vdG9BcnJheSc7XG5cbmNvbnN0IEJVSUxUX0lOX1BMQUNFTUVOVFMgPSB7XG4gIGJvdHRvbUxlZnQ6IHtcbiAgICBwb2ludHM6IFsndGwnLCAnYmwnXSxcbiAgICBvZmZzZXQ6IFswLCA0XSxcbiAgICBvdmVyZmxvdzoge1xuICAgICAgYWRqdXN0WDogMCxcbiAgICAgIGFkanVzdFk6IDEsXG4gICAgfSxcbiAgfSxcbiAgdG9wTGVmdDoge1xuICAgIHBvaW50czogWydibCcsICd0bCddLFxuICAgIG9mZnNldDogWzAsIC00XSxcbiAgICBvdmVyZmxvdzoge1xuICAgICAgYWRqdXN0WDogMCxcbiAgICAgIGFkanVzdFk6IDEsXG4gICAgfSxcbiAgfSxcbn07XG5cbmNsYXNzIFNlbGVjdFRyaWdnZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGRyb3Bkb3duTWF0Y2hTZWxlY3RXaWR0aDogUHJvcFR5cGVzLmJvb2wsXG4gICAgZHJvcGRvd25Qb3B1cEFsaWduOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHZpc2libGU6IFByb3BUeXBlcy5ib29sLFxuICAgIGZpbHRlclRyZWVOb2RlOiBQcm9wVHlwZXMuYW55LFxuICAgIHRyZWVOb2RlczogUHJvcFR5cGVzLmFueSxcbiAgICBpbnB1dFZhbHVlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHByZWZpeENsczogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBwb3B1cENsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmFueSxcbiAgfTtcblxuICBzdGF0ZSA9IHtcbiAgICBfZXhwYW5kZWRLZXlzOiBbXSxcbiAgICBmaXJlT25FeHBhbmQ6IGZhbHNlLFxuICAgIGRyb3Bkb3duV2lkdGg6IG51bGwsXG4gIH07XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5zZXREcm9wZG93bldpZHRoKCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMuaW5wdXRWYWx1ZSAmJiBuZXh0UHJvcHMuaW5wdXRWYWx1ZSAhPT0gdGhpcy5wcm9wcy5pbnB1dFZhbHVlKSB7XG4gICAgICAvLyBzZXQgYXV0b0V4cGFuZFBhcmVudCB0byB0cnVlXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgX2V4cGFuZGVkS2V5czogW10sXG4gICAgICAgIGZpcmVPbkV4cGFuZDogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgdGhpcy5zZXREcm9wZG93bldpZHRoKCk7XG4gIH1cblxuICBvbkV4cGFuZCA9IChleHBhbmRlZEtleXMpID0+IHtcbiAgICAvLyByZXJlbmRlclxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgX2V4cGFuZGVkS2V5czogZXhwYW5kZWRLZXlzLFxuICAgICAgZmlyZU9uRXhwYW5kOiB0cnVlLFxuICAgIH0sICgpID0+IHtcbiAgICAgIGlmICh0aGlzLnRyaWdnZXIgJiYgdGhpcy50cmlnZ2VyLmZvcmNlUG9wdXBBbGlnbikge1xuICAgICAgICB0aGlzLnRyaWdnZXIuZm9yY2VQb3B1cEFsaWduKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgc2V0RHJvcGRvd25XaWR0aCgpIHtcbiAgICBjb25zdCB3aWR0aCA9IFJlYWN0RE9NLmZpbmRET01Ob2RlKHRoaXMpLm9mZnNldFdpZHRoO1xuICAgIGlmICh3aWR0aCAhPT0gdGhpcy5zdGF0ZS5kcm9wZG93bldpZHRoKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgZHJvcGRvd25XaWR0aDogd2lkdGggfSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0UG9wdXBFbGVSZWZzKCkge1xuICAgIHJldHVybiB0aGlzLnBvcHVwRWxlO1xuICB9XG5cbiAgZ2V0UG9wdXBET01Ob2RlKCkge1xuICAgIHJldHVybiB0aGlzLnRyaWdnZXIuZ2V0UG9wdXBEb21Ob2RlKCk7XG4gIH1cblxuICBnZXREcm9wZG93blRyYW5zaXRpb25OYW1lKCkge1xuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wcztcbiAgICBsZXQgdHJhbnNpdGlvbk5hbWUgPSBwcm9wcy50cmFuc2l0aW9uTmFtZTtcbiAgICBpZiAoIXRyYW5zaXRpb25OYW1lICYmIHByb3BzLmFuaW1hdGlvbikge1xuICAgICAgdHJhbnNpdGlvbk5hbWUgPSBgJHt0aGlzLmdldERyb3Bkb3duUHJlZml4Q2xzKCl9LSR7cHJvcHMuYW5pbWF0aW9ufWA7XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2l0aW9uTmFtZTtcbiAgfVxuXG4gIGdldERyb3Bkb3duUHJlZml4Q2xzKCkge1xuICAgIHJldHVybiBgJHt0aGlzLnByb3BzLnByZWZpeENsc30tZHJvcGRvd25gO1xuICB9XG5cbiAgaGlnaGxpZ2h0VHJlZU5vZGUgPSAodHJlZU5vZGUpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgZmlsdGVyVmFsID0gdHJlZU5vZGUucHJvcHNbbGFiZWxDb21wYXRpYmxlKHByb3BzLnRyZWVOb2RlRmlsdGVyUHJvcCldO1xuICAgIGlmICh0eXBlb2YgZmlsdGVyVmFsID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHByb3BzLmlucHV0VmFsdWUgJiYgZmlsdGVyVmFsLmluZGV4T2YocHJvcHMuaW5wdXRWYWx1ZSkgPiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZpbHRlclRyZWVOb2RlID0gKGlucHV0LCBjaGlsZCkgPT4ge1xuICAgIGlmICghaW5wdXQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBmaWx0ZXJUcmVlTm9kZSA9IHRoaXMucHJvcHMuZmlsdGVyVHJlZU5vZGU7XG4gICAgaWYgKCFmaWx0ZXJUcmVlTm9kZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChjaGlsZC5wcm9wcy5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gZmlsdGVyVHJlZU5vZGUuY2FsbCh0aGlzLCBpbnB1dCwgY2hpbGQpO1xuICB9O1xuXG4gIHByb2Nlc3NUcmVlTm9kZSh0cmVlTm9kZXMpIHtcbiAgICBjb25zdCBmaWx0ZXJQb3NzID0gW107XG4gICAgdGhpcy5fZXhwYW5kZWRLZXlzID0gW107XG4gICAgbG9vcEFsbENoaWxkcmVuKHRyZWVOb2RlcywgKGNoaWxkLCBpbmRleCwgcG9zKSA9PiB7XG4gICAgICBpZiAodGhpcy5maWx0ZXJUcmVlTm9kZSh0aGlzLnByb3BzLmlucHV0VmFsdWUsIGNoaWxkKSkge1xuICAgICAgICBmaWx0ZXJQb3NzLnB1c2gocG9zKTtcbiAgICAgICAgdGhpcy5fZXhwYW5kZWRLZXlzLnB1c2goY2hpbGQua2V5KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEluY2x1ZGUgdGhlIGZpbHRlcmVkIG5vZGVzJ3MgYW5jZXN0cmFsIG5vZGVzLlxuICAgIGNvbnN0IHByb2Nlc3NlZFBvc3MgPSBbXTtcbiAgICBmaWx0ZXJQb3NzLmZvckVhY2gocG9zID0+IHtcbiAgICAgIGNvbnN0IGFyciA9IHBvcy5zcGxpdCgnLScpO1xuICAgICAgYXJyLnJlZHVjZSgocHJlLCBjdXIpID0+IHtcbiAgICAgICAgY29uc3QgcmVzID0gYCR7cHJlfS0ke2N1cn1gO1xuICAgICAgICBpZiAocHJvY2Vzc2VkUG9zcy5pbmRleE9mKHJlcykgPCAwKSB7XG4gICAgICAgICAgcHJvY2Vzc2VkUG9zcy5wdXNoKHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGNvbnN0IGZpbHRlck5vZGVzUG9zaXRpb25zID0gW107XG4gICAgbG9vcEFsbENoaWxkcmVuKHRyZWVOb2RlcywgKGNoaWxkLCBpbmRleCwgcG9zKSA9PiB7XG4gICAgICBpZiAocHJvY2Vzc2VkUG9zcy5pbmRleE9mKHBvcykgPiAtMSkge1xuICAgICAgICBmaWx0ZXJOb2Rlc1Bvc2l0aW9ucy5wdXNoKHsgbm9kZTogY2hpbGQsIHBvcyB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGhpZXJhcmNoeU5vZGVzID0gZmxhdFRvSGllcmFyY2h5KGZpbHRlck5vZGVzUG9zaXRpb25zKTtcblxuICAgIGNvbnN0IHJlY3Vyc2l2ZSA9IGNoaWxkcmVuID0+IHtcbiAgICAgIHJldHVybiBjaGlsZHJlbi5tYXAoY2hpbGQgPT4ge1xuICAgICAgICBpZiAoY2hpbGQuY2hpbGRyZW4pIHtcbiAgICAgICAgICByZXR1cm4gY2xvbmVFbGVtZW50KGNoaWxkLm5vZGUsIHt9LCByZWN1cnNpdmUoY2hpbGQuY2hpbGRyZW4pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGQubm9kZTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIHJlY3Vyc2l2ZShoaWVyYXJjaHlOb2Rlcyk7XG4gIH1cblxuICByZW5kZXJUcmVlKGtleXMsIGhhbGZDaGVja2VkS2V5cywgbmV3VHJlZU5vZGVzLCBtdWx0aXBsZSkge1xuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IHRyUHJvcHMgPSB7XG4gICAgICBtdWx0aXBsZSxcbiAgICAgIHByZWZpeENsczogYCR7cHJvcHMucHJlZml4Q2xzfS10cmVlYCxcbiAgICAgIHNob3dJY29uOiBwcm9wcy50cmVlSWNvbixcbiAgICAgIHNob3dMaW5lOiBwcm9wcy50cmVlTGluZSxcbiAgICAgIGRlZmF1bHRFeHBhbmRBbGw6IHByb3BzLnRyZWVEZWZhdWx0RXhwYW5kQWxsLFxuICAgICAgZGVmYXVsdEV4cGFuZGVkS2V5czogcHJvcHMudHJlZURlZmF1bHRFeHBhbmRlZEtleXMsXG4gICAgICBmaWx0ZXJUcmVlTm9kZTogdGhpcy5oaWdobGlnaHRUcmVlTm9kZSxcbiAgICB9O1xuXG4gICAgaWYgKHByb3BzLnRyZWVDaGVja2FibGUpIHtcbiAgICAgIHRyUHJvcHMuc2VsZWN0YWJsZSA9IGZhbHNlO1xuICAgICAgdHJQcm9wcy5jaGVja2FibGUgPSBwcm9wcy50cmVlQ2hlY2thYmxlO1xuICAgICAgdHJQcm9wcy5vbkNoZWNrID0gcHJvcHMub25TZWxlY3Q7XG4gICAgICB0clByb3BzLmNoZWNrU3RyaWN0bHkgPSBwcm9wcy50cmVlQ2hlY2tTdHJpY3RseTtcbiAgICAgIGlmIChwcm9wcy5pbnB1dFZhbHVlKSB7XG4gICAgICAgIC8vIGVuYWJsZSBjaGVja1N0cmljdGx5IHdoZW4gc2VhcmNoIHRyZWUuXG4gICAgICAgIHRyUHJvcHMuY2hlY2tTdHJpY3RseSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0clByb3BzLl90cmVlTm9kZXNTdGF0ZXMgPSBwcm9wcy5fdHJlZU5vZGVzU3RhdGVzO1xuICAgICAgfVxuICAgICAgaWYgKHRyUHJvcHMudHJlZUNoZWNrU3RyaWN0bHkgJiYgaGFsZkNoZWNrZWRLZXlzLmxlbmd0aCkge1xuICAgICAgICB0clByb3BzLmNoZWNrZWRLZXlzID0geyBjaGVja2VkOiBrZXlzLCBoYWxmQ2hlY2tlZDogaGFsZkNoZWNrZWRLZXlzIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0clByb3BzLmNoZWNrZWRLZXlzID0ga2V5cztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdHJQcm9wcy5zZWxlY3RlZEtleXMgPSBrZXlzO1xuICAgICAgdHJQcm9wcy5vblNlbGVjdCA9IHByb3BzLm9uU2VsZWN0O1xuICAgIH1cblxuICAgIC8vIGV4cGFuZCBrZXlzXG4gICAgaWYgKCF0clByb3BzLmRlZmF1bHRFeHBhbmRBbGwgJiYgIXRyUHJvcHMuZGVmYXVsdEV4cGFuZGVkS2V5cyAmJiAhcHJvcHMubG9hZERhdGEpIHtcbiAgICAgIHRyUHJvcHMuZXhwYW5kZWRLZXlzID0ga2V5cztcbiAgICB9XG4gICAgdHJQcm9wcy5hdXRvRXhwYW5kUGFyZW50ID0gdHJ1ZTtcbiAgICB0clByb3BzLm9uRXhwYW5kID0gdGhpcy5vbkV4cGFuZDtcbiAgICBpZiAodGhpcy5fZXhwYW5kZWRLZXlzICYmIHRoaXMuX2V4cGFuZGVkS2V5cy5sZW5ndGgpIHtcbiAgICAgIHRyUHJvcHMuZXhwYW5kZWRLZXlzID0gdGhpcy5fZXhwYW5kZWRLZXlzO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdGF0ZS5maXJlT25FeHBhbmQpIHtcbiAgICAgIHRyUHJvcHMuZXhwYW5kZWRLZXlzID0gdGhpcy5zdGF0ZS5fZXhwYW5kZWRLZXlzO1xuICAgICAgdHJQcm9wcy5hdXRvRXhwYW5kUGFyZW50ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gYXN5bmMgbG9hZERhdGFcbiAgICBpZiAocHJvcHMubG9hZERhdGEpIHtcbiAgICAgIHRyUHJvcHMubG9hZERhdGEgPSBwcm9wcy5sb2FkRGF0YTtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFRyZWUgcmVmPXtzYXZlUmVmKHRoaXMsICdwb3B1cEVsZScpfSB7Li4udHJQcm9wc30+XG4gICAgICAgIHtuZXdUcmVlTm9kZXN9XG4gICAgICA8L1RyZWU+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgbXVsdGlwbGUgPSBwcm9wcy5tdWx0aXBsZTtcbiAgICBjb25zdCBkcm9wZG93blByZWZpeENscyA9IHRoaXMuZ2V0RHJvcGRvd25QcmVmaXhDbHMoKTtcbiAgICBjb25zdCBwb3B1cENsYXNzTmFtZSA9IHtcbiAgICAgIFtwcm9wcy5kcm9wZG93bkNsYXNzTmFtZV06ICEhcHJvcHMuZHJvcGRvd25DbGFzc05hbWUsXG4gICAgICBbYCR7ZHJvcGRvd25QcmVmaXhDbHN9LS0ke211bHRpcGxlID8gJ211bHRpcGxlJyA6ICdzaW5nbGUnfWBdOiAxLFxuICAgIH07XG4gICAgbGV0IHZpc2libGUgPSBwcm9wcy52aXNpYmxlO1xuICAgIGNvbnN0IHNlYXJjaCA9IG11bHRpcGxlIHx8ICFwcm9wcy5zaG93U2VhcmNoID8gbnVsbCA6IChcbiAgICAgIDxzcGFuIGNsYXNzTmFtZT17YCR7ZHJvcGRvd25QcmVmaXhDbHN9LXNlYXJjaGB9Pntwcm9wcy5pbnB1dEVsZW1lbnR9PC9zcGFuPlxuICAgICk7XG5cbiAgICBjb25zdCByZWN1cnNpdmUgPSBjaGlsZHJlbiA9PiB7XG4gICAgICAvLyBOb3RlOiBpZiB1c2UgYFJlYWN0LkNoaWxkcmVuLm1hcGAsIHRoZSBub2RlJ3Mga2V5IHdpbGwgYmUgbW9kaWZpZWQuXG4gICAgICByZXR1cm4gdG9BcnJheShjaGlsZHJlbikubWFwKGZ1bmN0aW9uIGhhbmRsZXIoY2hpbGQpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICBpZiAoIWNoaWxkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoaWxkICYmIGNoaWxkLnByb3BzLmNoaWxkcmVuKSB7XG4gICAgICAgICAgLy8gbnVsbCBvciBTdHJpbmcgaGFzIG5vIFByb3BcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRyZWVOb2RlIHsuLi5jaGlsZC5wcm9wc30ga2V5PXtjaGlsZC5rZXl9PlxuICAgICAgICAgICAgICB7cmVjdXJzaXZlKGNoaWxkLnByb3BzLmNoaWxkcmVuKX1cbiAgICAgICAgICAgIDwvVHJlZU5vZGU+XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gPFRyZWVOb2RlIHsuLi5jaGlsZC5wcm9wc30ga2V5PXtjaGlsZC5rZXl9IC8+O1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvLyBjb25zdCBzID0gRGF0ZS5ub3coKTtcbiAgICBsZXQgdHJlZU5vZGVzO1xuICAgIGlmIChwcm9wcy5fY2FjaGV0cmVlRGF0YSAmJiB0aGlzLnRyZWVOb2Rlcykge1xuICAgICAgdHJlZU5vZGVzID0gdGhpcy50cmVlTm9kZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRyZWVOb2RlcyA9IHJlY3Vyc2l2ZShwcm9wcy50cmVlRGF0YSB8fCBwcm9wcy50cmVlTm9kZXMpO1xuICAgICAgdGhpcy50cmVlTm9kZXMgPSB0cmVlTm9kZXM7XG4gICAgfVxuICAgIC8vIGNvbnNvbGUubG9nKERhdGUubm93KCktcyk7XG5cbiAgICBpZiAocHJvcHMuaW5wdXRWYWx1ZSkge1xuICAgICAgdHJlZU5vZGVzID0gdGhpcy5wcm9jZXNzVHJlZU5vZGUodHJlZU5vZGVzKTtcbiAgICB9XG5cbiAgICBjb25zdCBrZXlzID0gW107XG4gICAgY29uc3QgaGFsZkNoZWNrZWRLZXlzID0gW107XG4gICAgbG9vcEFsbENoaWxkcmVuKHRyZWVOb2RlcywgKGNoaWxkKSA9PiB7XG4gICAgICBpZiAocHJvcHMudmFsdWUuc29tZShpdGVtID0+IGl0ZW0udmFsdWUgPT09IGdldFZhbHVlUHJvcFZhbHVlKGNoaWxkKSkpIHtcbiAgICAgICAga2V5cy5wdXNoKGNoaWxkLmtleSk7XG4gICAgICB9XG4gICAgICBpZiAocHJvcHMuaGFsZkNoZWNrZWRWYWx1ZXMgJiZcbiAgICAgICAgcHJvcHMuaGFsZkNoZWNrZWRWYWx1ZXMuc29tZShpdGVtID0+IGl0ZW0udmFsdWUgPT09IGdldFZhbHVlUHJvcFZhbHVlKGNoaWxkKSkpIHtcbiAgICAgICAgaGFsZkNoZWNrZWRLZXlzLnB1c2goY2hpbGQua2V5KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGxldCBub3RGb3VuZENvbnRlbnQ7XG4gICAgaWYgKCF0cmVlTm9kZXMubGVuZ3RoKSB7XG4gICAgICBpZiAocHJvcHMubm90Rm91bmRDb250ZW50KSB7XG4gICAgICAgIG5vdEZvdW5kQ29udGVudCA9IChcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2Ake3Byb3BzLnByZWZpeENsc30tbm90LWZvdW5kYH0+XG4gICAgICAgICAgICB7cHJvcHMubm90Rm91bmRDb250ZW50fVxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoIXNlYXJjaCkge1xuICAgICAgICB2aXNpYmxlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHBvcHVwRWxlbWVudCA9IChcbiAgICAgIDxkaXY+XG4gICAgICAgIHtzZWFyY2h9XG4gICAgICAgIHtub3RGb3VuZENvbnRlbnQgfHwgdGhpcy5yZW5kZXJUcmVlKGtleXMsIGhhbGZDaGVja2VkS2V5cywgdHJlZU5vZGVzLCBtdWx0aXBsZSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuXG4gICAgY29uc3QgcG9wdXBTdHlsZSA9IHsgLi4ucHJvcHMuZHJvcGRvd25TdHlsZSB9O1xuICAgIGNvbnN0IHdpZHRoUHJvcCA9IHByb3BzLmRyb3Bkb3duTWF0Y2hTZWxlY3RXaWR0aCA/ICd3aWR0aCcgOiAnbWluV2lkdGgnO1xuICAgIGlmICh0aGlzLnN0YXRlLmRyb3Bkb3duV2lkdGgpIHtcbiAgICAgIHBvcHVwU3R5bGVbd2lkdGhQcm9wXSA9IGAke3RoaXMuc3RhdGUuZHJvcGRvd25XaWR0aH1weGA7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxUcmlnZ2VyXG4gICAgICAgIGFjdGlvbj17cHJvcHMuZGlzYWJsZWQgPyBbXSA6IFsnY2xpY2snXX1cbiAgICAgICAgcmVmPXtzYXZlUmVmKHRoaXMsICd0cmlnZ2VyJyl9XG4gICAgICAgIHBvcHVwUGxhY2VtZW50PVwiYm90dG9tTGVmdFwiXG4gICAgICAgIGJ1aWx0aW5QbGFjZW1lbnRzPXtCVUlMVF9JTl9QTEFDRU1FTlRTfVxuICAgICAgICBwb3B1cEFsaWduPXtwcm9wcy5kcm9wZG93blBvcHVwQWxpZ259XG4gICAgICAgIHByZWZpeENscz17ZHJvcGRvd25QcmVmaXhDbHN9XG4gICAgICAgIHBvcHVwVHJhbnNpdGlvbk5hbWU9e3RoaXMuZ2V0RHJvcGRvd25UcmFuc2l0aW9uTmFtZSgpfVxuICAgICAgICBvblBvcHVwVmlzaWJsZUNoYW5nZT17cHJvcHMub25Ecm9wZG93blZpc2libGVDaGFuZ2V9XG4gICAgICAgIHBvcHVwPXtwb3B1cEVsZW1lbnR9XG4gICAgICAgIHBvcHVwVmlzaWJsZT17dmlzaWJsZX1cbiAgICAgICAgZ2V0UG9wdXBDb250YWluZXI9e3Byb3BzLmdldFBvcHVwQ29udGFpbmVyfVxuICAgICAgICBwb3B1cENsYXNzTmFtZT17Y2xhc3NuYW1lcyhwb3B1cENsYXNzTmFtZSl9XG4gICAgICAgIHBvcHVwU3R5bGU9e3BvcHVwU3R5bGV9XG4gICAgICA+XG4gICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgPC9UcmlnZ2VyPlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VsZWN0VHJpZ2dlcjtcbiJdfQ==