{"version":3,"sources":["index.test.js"],"names":["IntlList","IntlField","describe","errorSpy","jest","spyOn","console","mockImplementation","beforeEach","useFakeTimers","afterEach","mockReset","document","body","innerHTML","useRealTimers","afterAll","mockRestore","_pro","className","querySelectorAll","it","wrapper","expect","toMatchSnapshot","find","toHaveLength","simulate","runAllTimers","update","prop","toBe","setProps","readOnly","onCancel","fn","onOk","querySelector","click","mock","calls","length","handleDataSetChange","props","name","toEqual","value","ds","DataSet","lang","primaryKey","data","tlsUrl","fields","type","required","events","wrapper1","keyCode","unmount"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { mount } from 'enzyme';\nimport IntlField from '..';\nimport IntlList from '../IntlList';\nimport IntlFieldTest from './intlField';\nimport focusTest from '../../../tests/shared/focusTest';\nimport mountTest from '../../../tests/shared/mountTest';\nimport { open } from '../../modal-container/ModalContainer';\nimport DataSet from '../../data-set';\n\nmountTest(IntlList);\nmountTest(IntlField);\nfocusTest(IntlField);\n\ndescribe('IntlField-pro', () => {\n  const errorSpy = jest.spyOn(console, 'error').mockImplementation(() => {});\n\n  beforeEach(() => {\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    errorSpy.mockReset();\n    document.body.innerHTML = '';\n    jest.useRealTimers();\n  });\n\n  afterAll(() => {\n    errorSpy.mockRestore();\n  });\n\n  const _pro = className => {\n    return document.body.querySelectorAll(className);\n  };\n\n  it('renders IntlField correctly', () => {\n    const wrapper = mount(<IntlField />);\n    expect(wrapper).toMatchSnapshot();\n  });\n\n  it('should focused when the input click or mousedown', () => {\n    const wrapper = mount(<IntlField />);\n    expect(wrapper.find('.c7n-pro-input-focused')).toHaveLength(0);\n    wrapper.find('input').simulate('focus');\n    jest.runAllTimers();\n    wrapper.update();\n    expect(wrapper.find('.c7n-pro-input-focused')).toHaveLength(1);\n  });\n\n  it('input should render readOnly correctly', () => {\n    const wrapper = mount(<IntlField />);\n    expect(wrapper.prop('readOnly')).toBe(false);\n    wrapper.setProps({ readOnly: true });\n    wrapper.update();\n    expect(wrapper.prop('readOnly')).toBe(true);\n    wrapper.find('.c7n-pro-input-suffix').simulate('click');\n    jest.runAllTimers();\n    expect(_pro('.c7n-pro-modal-container')).toHaveLength(0);\n  });\n\n  it('trigger onOk once when click on ok button', () => {\n    const onCancel = jest.fn();\n    const onOk = jest.fn();\n    open({\n      onCancel,\n      onOk,\n    });\n    _pro('.c7n-pro-modal-footer')[0]\n      .querySelector('.c7n-pro-btn-primary')\n      .click();\n    expect(onCancel.mock.calls.length).toBe(0);\n    expect(onOk.mock.calls.length).toBe(1);\n  });\n\n  it('renders dataset correctly', () => {\n    const handleDataSetChange = jest.fn();\n    const wrapper = mount(<IntlFieldTest />);\n    expect(wrapper.find('IntlField').props().name).toEqual('first-name');\n    expect(wrapper.find('input').props().value).toEqual('Âê¥');\n    expect(wrapper).toMatchSnapshot();\n    const ds = new DataSet({\n      lang: 'en_GB',\n      primaryKey: 'pk',\n      data: [{}],\n      tlsUrl: '/dataset/user/languages',\n      fields: [\n        {\n          name: 'first',\n          type: 'intl',\n          required: true,\n        },\n      ],\n      events: {\n        update: handleDataSetChange,\n      },\n    });\n    const wrapper1 = mount(<IntlField dataSet={ds} name=\"first\" />);\n    expect(wrapper1.find('IntlField').props().name).toEqual('first');\n    expect(wrapper1).toMatchSnapshot();\n  });\n\n  it('{ ok, cancel } button click render correctly', () => {\n    const wrapper = mount(<IntlField />);\n    expect(_pro('.c7n-pro-modal-container')).toHaveLength(0);\n    wrapper.find('.c7n-pro-input-suffix').simulate('click');\n    jest.runAllTimers();\n    expect(_pro('.c7n-pro-modal-container')).toHaveLength(1);\n    expect(_pro('.c7n-pro-btn')).toHaveLength(2);\n    _pro('.c7n-pro-btn-primary')[0].click();\n    jest.runAllTimers();\n    wrapper.update();\n    _pro('.c7n-pro-btn-default')[0].click();\n    jest.runAllTimers();\n    wrapper.update();\n    expect(wrapper).toMatchSnapshot();\n  });\n\n  it('the input keydown event , keyCode {down}', () => {\n    const wrapper = mount(<IntlField />);\n    expect(_pro('.c7n-pro-modal-container')).toHaveLength(0);\n    wrapper.find('input').simulate('keydown', { keyCode: 40 });\n    jest.runAllTimers();\n    wrapper.update();\n    expect(_pro('.c7n-pro-modal-container')).toHaveLength(1);\n  });\n\n  it('modal should unmout', () => {\n    const wrapper = mount(<IntlField />);\n    wrapper.unmount();\n  });\n});\n"]}