import { observable, runInAction, toJS } from 'mobx';
import isObject from 'lodash/isObject';
import { categories } from 'choerodon-ui-font';
import { $l } from 'choerodon-ui/pro/lib/locale-context';
import defaultFeedback from 'choerodon-ui/pro/lib/data-set/FeedBack';
import { defaultExcludeUseColonTag } from 'choerodon-ui/pro/lib/form/utils';
const defaultRenderEmpty = (componentName) => {
    switch (componentName) {
        case 'Table':
            return $l('Table', 'empty_data');
        case 'Select':
            return $l('Select', 'no_matching_results');
        default:
    }
};
const defaultButtonProps = { color: "primary" /* primary */, funcType: "flat" /* flat */ };
const defaultSpinProps = { size: "default" /* default */, wrapperClassName: '' };
const globalConfig = observable.map([
    ['prefixCls', 'c7n'],
    ['proPrefixCls', 'c7n-pro'],
    ['iconfontPrefix', 'icon'],
    ['ripple', true],
    ['lookupCache', { maxAge: 1000 * 60 * 10, max: 100 }],
    ['lookupUrl', code => `/common/code/${code}/`],
    ['lookupAxiosMethod', 'post'],
    // [
    //   'lookupBatchAxiosConfig',
    //   codes => ({
    //     url: '/common/batch',
    //     params: codes.reduce((obj, code) => {
    //       obj[code] = code;
    //       return obj;
    //     }, {}),
    //   }),
    // ],
    ['lovDefineUrl', code => `/sys/lov/lov_define?code=${code}`],
    ['lovQueryUrl', code => `/common/lov/dataset/${code}`],
    ['lovTriggerMode', "icon" /* icon */],
    ['dataKey', 'rows'],
    ['totalKey', 'total'],
    ['statusKey', '__status'],
    ['tlsKey', '__tls'],
    [
        'status',
        { ["add" /* add */]: 'add', ["update" /* update */]: 'update', ["delete" /* delete */]: 'delete' },
    ],
    ['labelLayout', "horizontal" /* horizontal */],
    ['queryBar', "normal" /* normal */],
    ['tableBorder', true],
    ['tableHighLightRow', true],
    ['tableSelectedHighLightRow', false],
    ['tableRowHeight', 30],
    ['tableColumnResizable', true],
    ['tableSpinProps', defaultSpinProps],
    ['tableButtonProps', defaultButtonProps],
    ['tableCommandProps', defaultButtonProps],
    ['tableAlwaysShowRowBox', false],
    ['tableUseMouseBatchChoose', false],
    ['tableDefaultRenderer', ''],
    ['modalSectionBorder', true],
    ['modalOkFirst', true],
    ['buttonColor', "default" /* default */],
    ['buttonFuncType', "raised" /* raised */],
    ['feedback', defaultFeedback],
    ['renderEmpty', defaultRenderEmpty],
    ['icons', categories],
    [
        'formatter',
        {
            jsonDate: 'YYYY-MM-DD HH:mm:ss',
            date: 'YYYY-MM-DD',
            dateTime: 'YYYY-MM-DD HH:mm:ss',
            time: 'HH:mm:ss',
            year: 'YYYY',
            month: 'YYYY-MM',
            week: 'GGGG-Wo',
        },
    ],
    ['dropdownMatchSelectWidth', true],
    ['useColon', false],
    ['excludeUseColonTagList', defaultExcludeUseColonTag],
    ['lovTableProps', {}],
]);
export function getConfig(key) {
    // FIXME: observable.map把构建map时传入的key类型和value类型分别做了union，
    // 丢失了一一对应的映射关系，导致函数调用者无法使用union后的返回值类型，因此需要指定本函数返回值为any
    return globalConfig.get(key);
}
export function getPrefixCls(suffixCls, customizePrefixCls) {
    if (customizePrefixCls) {
        return customizePrefixCls;
    }
    return `${getConfig('prefixCls')}-${suffixCls}`;
}
export function getProPrefixCls(suffixCls, customizePrefixCls) {
    if (customizePrefixCls) {
        return customizePrefixCls;
    }
    return `${getConfig('proPrefixCls')}-${suffixCls}`;
}
const mergeProps = ['transport', 'feedback', 'formatter'];
export default function configure(config) {
    runInAction(() => {
        Object.keys(config).forEach((key) => {
            const value = config[key];
            if (mergeProps.includes(key) && isObject(value)) {
                globalConfig.set(key, {
                    ...toJS(globalConfig.get(key)),
                    ...value,
                });
            }
            else {
                globalConfig.set(key, config[key]);
            }
        });
    });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvY29uZmlndXJlL2luZGV4LnRzeCIsIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFpQixXQUFXLEVBQUUsSUFBSSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBR3BFLE9BQU8sUUFBUSxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUcvQyxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFlekQsT0FBTyxlQUE2QixNQUFNLHdDQUF3QyxDQUFDO0FBS25GLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBaUc1RSxNQUFNLGtCQUFrQixHQUF1QixDQUFDLGFBQXNCLEVBQWEsRUFBRTtJQUNuRixRQUFRLGFBQWEsRUFBRTtRQUNyQixLQUFLLE9BQU87WUFDVixPQUFPLEVBQUUsQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDbkMsS0FBSyxRQUFRO1lBQ1gsT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFDN0MsUUFBUTtLQUNUO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsTUFBTSxrQkFBa0IsR0FBRyxFQUFFLEtBQUsseUJBQXFCLEVBQUUsUUFBUSxtQkFBZSxFQUFFLENBQUM7QUFFbkYsTUFBTSxnQkFBZ0IsR0FBRyxFQUFFLElBQUkseUJBQWMsRUFBRSxnQkFBZ0IsRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUV0RSxNQUFNLFlBQVksR0FBa0QsVUFBVSxDQUFDLEdBQUcsQ0FHaEY7SUFDQSxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUM7SUFDcEIsQ0FBQyxjQUFjLEVBQUUsU0FBUyxDQUFDO0lBQzNCLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDO0lBQzFCLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQztJQUNoQixDQUFDLGFBQWEsRUFB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LENBQUM7S0FDM0I7SUFDRCxPQUFPLEdBQUcsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLFNBQVMsRUFBRSxDQUFDO0FBQ2xELENBQUM7QUFFRCxNQUFNLFVBQVUsZUFBZSxDQUFDLFNBQWlCLEVBQUUsa0JBQTJCO0lBQzVFLElBQUksa0JBQWtCLEVBQUU7UUFDdEIsT0FBTyxrQkFBa0IsQ0FBQztLQUMzQjtJQUNELE9BQU8sR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLElBQUksU0FBUyxFQUFFLENBQUM7QUFDckQsQ0FBQztBQUVELE1BQU0sVUFBVSxHQUFHLENBQUMsV0FBVyxFQUFFLFVBQVUsRUFBRSxXQUFXLENBQUMsQ0FBQztBQUUxRCxNQUFNLENBQUMsT0FBTyxVQUFVLFNBQVMsQ0FBQyxNQUFjO0lBQzlDLFdBQVcsQ0FBQyxHQUFHLEVBQUU7UUFDZixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQWUsRUFBRSxFQUFFO1lBQzlDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUMxQixJQUFJLFVBQVUsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUMvQyxZQUFZLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtvQkFDcEIsR0FBRyxJQUFJLENBQU0sWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDbkMsR0FBRyxLQUFLO2lCQUNULENBQUMsQ0FBQzthQUNKO2lCQUFNO2dCQUNMLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ3BDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvY29uZmlndXJlL2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvYnNlcnZhYmxlLCBPYnNlcnZhYmxlTWFwLCBydW5JbkFjdGlvbiwgdG9KUyB9IGZyb20gJ21vYngnO1xuaW1wb3J0IHsgQXhpb3NJbnN0YW5jZSwgQXhpb3NQcm9taXNlLCBBeGlvc1JlcXVlc3RDb25maWcgfSBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgaXNPYmplY3QgZnJvbSAnbG9kYXNoL2lzT2JqZWN0JztcbmltcG9ydCB7IGNhdGVnb3JpZXMgfSBmcm9tICdjaG9lcm9kb24tdWktZm9udCc7XG5pbXBvcnQgeyBMb3ZDb25maWcgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9sb3YvTG92JztcbmltcG9ydCB7IFJlY29yZFN0YXR1cyB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9wcm8vbGliL2RhdGEtc2V0L2VudW0nO1xuaW1wb3J0IHsgJGwgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9sb2NhbGUtY29udGV4dCc7XG5pbXBvcnQge1xuICBleHBhbmRJY29uUHJvcHMsXG4gIFRhYmxlUGFnaW5hdGlvbkNvbmZpZyxcbiAgVGFibGVRdWVyeUJhckhvb2ssXG4gIFRhYmxlUHJvcHMsXG59IGZyb20gJ2Nob2Vyb2Rvbi11aS9wcm8vbGliL3RhYmxlL1RhYmxlJztcbmltcG9ydCB7IFZhbGlkYXRpb25NZXNzYWdlcyB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9wcm8vbGliL3ZhbGlkYXRvci9WYWxpZGF0b3InO1xuaW1wb3J0IHsgQnV0dG9uUHJvcHMgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9idXR0b24vQnV0dG9uJztcbmltcG9ydCB7IFNwaW5Qcm9wcyB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9saWIvc3Bpbic7XG5pbXBvcnQgeyBTaXplIH0gZnJvbSAnY2hvZXJvZG9uLXVpL2xpYi9fdXRpbC9lbnVtJztcbmltcG9ydCB7IFRhYmxlUXVlcnlCYXJUeXBlIH0gZnJvbSAnY2hvZXJvZG9uLXVpL3Byby9saWIvdGFibGUvZW51bSc7XG5pbXBvcnQgeyBUcmlnZ2VyTW9kZSB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9wcm8vbGliL2xvdi9lbnVtJztcbmltcG9ydCB7IFRyYW5zcG9ydEhvb2tQcm9wcywgVHJhbnNwb3J0UHJvcHMgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9kYXRhLXNldC9UcmFuc3BvcnQnO1xuaW1wb3J0IERhdGFTZXQgZnJvbSAnY2hvZXJvZG9uLXVpL3Byby9saWIvZGF0YS1zZXQvRGF0YVNldCc7XG5pbXBvcnQgZGVmYXVsdEZlZWRiYWNrLCB7IEZlZWRCYWNrIH0gZnJvbSAnY2hvZXJvZG9uLXVpL3Byby9saWIvZGF0YS1zZXQvRmVlZEJhY2snO1xuaW1wb3J0IFJlY29yZCBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9kYXRhLXNldC9SZWNvcmQnO1xuaW1wb3J0IHsgQ2FjaGVPcHRpb25zIH0gZnJvbSAnY2hvZXJvZG9uLXVpL3Byby9saWIvX3V0aWwvQ2FjaGUnO1xuaW1wb3J0IHsgTGFiZWxMYXlvdXQgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9mb3JtL2VudW0nO1xuaW1wb3J0IHsgQnV0dG9uQ29sb3IsIEZ1bmNUeXBlIH0gZnJvbSAnY2hvZXJvZG9uLXVpL3Byby9saWIvYnV0dG9uL2VudW0nO1xuaW1wb3J0IHsgZGVmYXVsdEV4Y2x1ZGVVc2VDb2xvblRhZyB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9wcm8vbGliL2Zvcm0vdXRpbHMnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICdjaG9lcm9kb24tdWkvcHJvL2xpYi9maWVsZC9Gb3JtRmllbGQnO1xuXG5leHBvcnQgdHlwZSBTdGF0dXMgPSB7XG4gIFtSZWNvcmRTdGF0dXMuYWRkXTogc3RyaW5nO1xuICBbUmVjb3JkU3RhdHVzLnVwZGF0ZV06IHN0cmluZztcbiAgW1JlY29yZFN0YXR1cy5kZWxldGVdOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSByZW5kZXJFbXB0eUhhbmRsZXIgPSAoY29tcG9uZW50TmFtZT86IHN0cmluZykgPT4gUmVhY3ROb2RlO1xuXG5leHBvcnQgdHlwZSBGb3JtYXR0ZXIgPSB7XG4gIGpzb25EYXRlPzogc3RyaW5nIHwgbnVsbDtcbiAgZGF0ZT86IHN0cmluZztcbiAgZGF0ZVRpbWU/OiBzdHJpbmc7XG4gIHRpbWU/OiBzdHJpbmc7XG4gIHllYXI/OiBzdHJpbmc7XG4gIG1vbnRoPzogc3RyaW5nO1xuICB3ZWVrPzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgQ29uZmlnID0ge1xuICBwcmVmaXhDbHM/OiBzdHJpbmc7XG4gIHByb1ByZWZpeENscz86IHN0cmluZztcbiAgaWNvbmZvbnRQcmVmaXg/OiBzdHJpbmc7XG4gIHJpcHBsZT86IGJvb2xlYW47XG4gIGxvb2t1cENhY2hlPzogQ2FjaGVPcHRpb25zPHN0cmluZywgQXhpb3NQcm9taXNlPjtcbiAgbG9va3VwVXJsPzogc3RyaW5nIHwgKChjb2RlOiBzdHJpbmcpID0+IHN0cmluZyk7XG4gIGxvb2t1cEF4aW9zTWV0aG9kPzogc3RyaW5nO1xuICBsb29rdXBBeGlvc0NvbmZpZz86XG4gIHwgQXhpb3NSZXF1ZXN0Q29uZmlnXG4gIHwgKChwcm9wczoge1xuICAgIHBhcmFtcz86IGFueTtcbiAgICBkYXRhU2V0PzogRGF0YVNldDtcbiAgICByZWNvcmQ/OiBSZWNvcmQ7XG4gICAgbG9va3VwQ29kZT86IHN0cmluZztcbiAgfSkgPT4gQXhpb3NSZXF1ZXN0Q29uZmlnKTtcbiAgbG9va3VwQmF0Y2hBeGlvc0NvbmZpZz86IChjb2Rlczogc3RyaW5nW10pID0+IEF4aW9zUmVxdWVzdENvbmZpZztcbiAgbG92RGVmaW5lVXJsPzogc3RyaW5nIHwgKChjb2RlOiBzdHJpbmcpID0+IHN0cmluZyk7XG4gIGxvdkRlZmluZUF4aW9zQ29uZmlnPzogQXhpb3NSZXF1ZXN0Q29uZmlnIHwgKChjb2RlOiBzdHJpbmcpID0+IEF4aW9zUmVxdWVzdENvbmZpZyk7XG4gIGxvdlF1ZXJ5VXJsPzpcbiAgfCBzdHJpbmdcbiAgfCAoKGNvZGU6IHN0cmluZywgbG92Q29uZmlnOiBMb3ZDb25maWcgfCB1bmRlZmluZWQsIHByb3BzOiBUcmFuc3BvcnRIb29rUHJvcHMpID0+IHN0cmluZyk7XG4gIGxvdlF1ZXJ5QXhpb3NDb25maWc/OlxuICB8IEF4aW9zUmVxdWVzdENvbmZpZ1xuICB8ICgoXG4gICAgY29kZTogc3RyaW5nLFxuICAgIGxvdkNvbmZpZzogTG92Q29uZmlnIHwgdW5kZWZpbmVkLFxuICAgIHByb3BzOiBUcmFuc3BvcnRIb29rUHJvcHMsXG4gICkgPT4gQXhpb3NSZXF1ZXN0Q29uZmlnKTtcbiAgbG92VHJpZ2dlck1vZGU/OiBUcmlnZ2VyTW9kZTtcbiAgYXhpb3M/OiBBeGlvc0luc3RhbmNlO1xuICBmZWVkYmFjaz86IEZlZWRCYWNrO1xuICBkYXRhS2V5Pzogc3RyaW5nO1xuICB0b3RhbEtleT86IHN0cmluZztcbiAgc3RhdHVzS2V5Pzogc3RyaW5nO1xuICB0bHNLZXk/OiBzdHJpbmc7XG4gIHN0YXR1cz86IFN0YXR1cztcbiAgbGFiZWxMYXlvdXQ/OiBMYWJlbExheW91dDtcbiAgcXVlcnlCYXI/OiBUYWJsZVF1ZXJ5QmFyVHlwZSB8IFRhYmxlUXVlcnlCYXJIb29rO1xuICB0YWJsZUJvcmRlcj86IGJvb2xlYW47XG4gIHRhYmxlSGlnaExpZ2h0Um93PzogYm9vbGVhbjtcbiAgdGFibGVTZWxlY3RlZEhpZ2hMaWdodFJvdz86IGJvb2xlYW47XG4gIHRhYmxlUm93SGVpZ2h0PzogJ2F1dG8nIHwgbnVtYmVyO1xuICB0YWJsZUNvbHVtblJlc2l6YWJsZT86IGJvb2xlYW47XG4gIHRhYmxlRXhwYW5kSWNvbj86IChwcm9wczogZXhwYW5kSWNvblByb3BzKSA9PiBSZWFjdE5vZGU7XG4gIHRhYmxlU3BpblByb3BzPzogU3BpblByb3BzO1xuICB0YWJsZUJ1dHRvblByb3BzPzogQnV0dG9uUHJvcHM7XG4gIHRhYmxlQ29tbWFuZFByb3BzPzogQnV0dG9uUHJvcHM7XG4gIHRhYmxlRGVmYXVsdFJlbmRlcmVyPzogUmVuZGVyZXI7XG4gIHRhYmxlQWx3YXlzU2hvd1Jvd0JveD86IGJvb2xlYW47XG4gIHRhYmxlVXNlTW91c2VCYXRjaENob29zZT86IGJvb2xlYW47XG4gIHBhZ2luYXRpb24/OiBUYWJsZVBhZ2luYXRpb25Db25maWcgfCBmYWxzZTtcbiAgbW9kYWxTZWN0aW9uQm9yZGVyPzogYm9vbGVhbjtcbiAgbW9kYWxPa0ZpcnN0PzogYm9vbGVhbjtcbiAgbW9kYWxCdXR0b25Qcm9wcz86IEJ1dHRvblByb3BzO1xuICBidXR0b25GdW5jVHlwZT86IEZ1bmNUeXBlO1xuICBidXR0b25Db2xvcj86IEJ1dHRvbkNvbG9yO1xuICByZW5kZXJFbXB0eT86IHJlbmRlckVtcHR5SGFuZGxlcjtcbiAgZGVmYXVsdFZhbGlkYXRpb25NZXNzYWdlcz86IFZhbGlkYXRpb25NZXNzYWdlcztcbiAgdHJhbnNwb3J0PzogVHJhbnNwb3J0UHJvcHM7XG4gIGljb25zPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmdbXTsgfSB8IHN0cmluZ1tdO1xuICBnZW5lcmF0ZVBhZ2VRdWVyeT86IChwYWdlUGFyYW1zOiB7XG4gICAgcGFnZT86IG51bWJlcjtcbiAgICBwYWdlU2l6ZT86IG51bWJlcjtcbiAgICBzb3J0TmFtZT86IHN0cmluZztcbiAgICBzb3J0T3JkZXI/OiBzdHJpbmc7XG4gIH0pID0+IG9iamVjdDtcbiAgZm9ybWF0dGVyPzogRm9ybWF0dGVyO1xuICBkcm9wZG93bk1hdGNoU2VsZWN0V2lkdGg/OiBib29sZWFuO1xuICB1c2VDb2xvbj86IGJvb2xlYW47XG4gIGV4Y2x1ZGVVc2VDb2xvblRhZ0xpc3Q/OiBzdHJpbmdbXTtcbiAgbG92VGFibGVQcm9wcz86IFRhYmxlUHJvcHM7XG59O1xuXG5leHBvcnQgdHlwZSBDb25maWdLZXlzID0ga2V5b2YgQ29uZmlnO1xuXG5jb25zdCBkZWZhdWx0UmVuZGVyRW1wdHk6IHJlbmRlckVtcHR5SGFuZGxlciA9IChjb21wb25lbnROYW1lPzogc3RyaW5nKTogUmVhY3ROb2RlID0+IHtcbiAgc3dpdGNoIChjb21wb25lbnROYW1lKSB7XG4gICAgY2FzZSAnVGFibGUnOlxuICAgICAgcmV0dXJuICRsKCdUYWJsZScsICdlbXB0eV9kYXRhJyk7XG4gICAgY2FzZSAnU2VsZWN0JzpcbiAgICAgIHJldHVybiAkbCgnU2VsZWN0JywgJ25vX21hdGNoaW5nX3Jlc3VsdHMnKTtcbiAgICBkZWZhdWx0OlxuICB9XG59O1xuXG5jb25zdCBkZWZhdWx0QnV0dG9uUHJvcHMgPSB7IGNvbG9yOiBCdXR0b25Db2xvci5wcmltYXJ5LCBmdW5jVHlwZTogRnVuY1R5cGUuZmxhdCB9O1xuXG5jb25zdCBkZWZhdWx0U3BpblByb3BzID0geyBzaXplOiBTaXplLmRlZmF1bHQsIHdyYXBwZXJDbGFzc05hbWU6ICcnIH07XG5cbmNvbnN0IGdsb2JhbENvbmZpZzogT2JzZXJ2YWJsZU1hcDxDb25maWdLZXlzLCBDb25maWdbQ29uZmlnS2V5c10+ID0gb2JzZXJ2YWJsZS5tYXA8XG4gIENvbmZpZ0tleXMsXG4gIENvbmZpZ1tDb25maWdLZXlzXVxuPihbXG4gIFsncHJlZml4Q2xzJywgJ2M3biddLFxuICBbJ3Byb1ByZWZpeENscycsICdjN24tcHJvJ10sXG4gIFsnaWNvbmZvbnRQcmVmaXgnLCAnaWNvbiddLFxuICBbJ3JpcHBsZScsIHRydWVdLFxuICBbJ2xvb2t1cENhY2hlJywgeyBtYXhBZ2U6IDEwMDAgKiA2MCAqIDEwLCBtYXg6IDEwMCB9XSxcbiAgWydsb29rdXBVcmwnLCBjb2RlID0+IGAvY29tbW9uL2NvZGUvJHtjb2RlfS9gXSxcbiAgWydsb29rdXBBeGlvc01ldGhvZCcsICdwb3N0J10sXG4gIC8vIFtcbiAgLy8gICAnbG9va3VwQmF0Y2hBeGlvc0NvbmZpZycsXG4gIC8vICAgY29kZXMgPT4gKHtcbiAgLy8gICAgIHVybDogJy9jb21tb24vYmF0Y2gnLFxuICAvLyAgICAgcGFyYW1zOiBjb2Rlcy5yZWR1Y2UoKG9iaiwgY29kZSkgPT4ge1xuICAvLyAgICAgICBvYmpbY29kZV0gPSBjb2RlO1xuICAvLyAgICAgICByZXR1cm4gb2JqO1xuICAvLyAgICAgfSwge30pLFxuICAvLyAgIH0pLFxuICAvLyBdLFxuICBbJ2xvdkRlZmluZVVybCcsIGNvZGUgPT4gYC9zeXMvbG92L2xvdl9kZWZpbmU/Y29kZT0ke2NvZGV9YF0sXG4gIFsnbG92UXVlcnlVcmwnLCBjb2RlID0+IGAvY29tbW9uL2xvdi9kYXRhc2V0LyR7Y29kZX1gXSxcbiAgWydsb3ZUcmlnZ2VyTW9kZScsIFRyaWdnZXJNb2RlLmljb25dLFxuICBbJ2RhdGFLZXknLCAncm93cyddLFxuICBbJ3RvdGFsS2V5JywgJ3RvdGFsJ10sXG4gIFsnc3RhdHVzS2V5JywgJ19fc3RhdHVzJ10sXG4gIFsndGxzS2V5JywgJ19fdGxzJ10sXG4gIFtcbiAgICAnc3RhdHVzJyxcbiAgICB7IFtSZWNvcmRTdGF0dXMuYWRkXTogJ2FkZCcsIFtSZWNvcmRTdGF0dXMudXBkYXRlXTogJ3VwZGF0ZScsIFtSZWNvcmRTdGF0dXMuZGVsZXRlXTogJ2RlbGV0ZScgfSxcbiAgXSxcbiAgWydsYWJlbExheW91dCcsIExhYmVsTGF5b3V0Lmhvcml6b250YWxdLFxuICBbJ3F1ZXJ5QmFyJywgVGFibGVRdWVyeUJhclR5cGUubm9ybWFsXSxcbiAgWyd0YWJsZUJvcmRlcicsIHRydWVdLFxuICBbJ3RhYmxlSGlnaExpZ2h0Um93JywgdHJ1ZV0sXG4gIFsndGFibGVTZWxlY3RlZEhpZ2hMaWdodFJvdycsIGZhbHNlXSxcbiAgWyd0YWJsZVJvd0hlaWdodCcsIDMwXSxcbiAgWyd0YWJsZUNvbHVtblJlc2l6YWJsZScsIHRydWVdLFxuICBbJ3RhYmxlU3BpblByb3BzJywgZGVmYXVsdFNwaW5Qcm9wc10sXG4gIFsndGFibGVCdXR0b25Qcm9wcycsIGRlZmF1bHRCdXR0b25Qcm9wc10sXG4gIFsndGFibGVDb21tYW5kUHJvcHMnLCBkZWZhdWx0QnV0dG9uUHJvcHNdLFxuICBbJ3RhYmxlQWx3YXlzU2hvd1Jvd0JveCcsIGZhbHNlXSxcbiAgWyd0YWJsZVVzZU1vdXNlQmF0Y2hDaG9vc2UnLCBmYWxzZV0sXG4gIFsndGFibGVEZWZhdWx0UmVuZGVyZXInLCAnJ10sXG4gIFsnbW9kYWxTZWN0aW9uQm9yZGVyJywgdHJ1ZV0sXG4gIFsnbW9kYWxPa0ZpcnN0JywgdHJ1ZV0sXG4gIFsnYnV0dG9uQ29sb3InLCBCdXR0b25Db2xvci5kZWZhdWx0XSxcbiAgWydidXR0b25GdW5jVHlwZScsIEZ1bmNUeXBlLnJhaXNlZF0sXG4gIFsnZmVlZGJhY2snLCBkZWZhdWx0RmVlZGJhY2tdLFxuICBbJ3JlbmRlckVtcHR5JywgZGVmYXVsdFJlbmRlckVtcHR5XSxcbiAgWydpY29ucycsIGNhdGVnb3JpZXNdLFxuICBbXG4gICAgJ2Zvcm1hdHRlcicsXG4gICAge1xuICAgICAganNvbkRhdGU6ICdZWVlZLU1NLUREIEhIOm1tOnNzJyxcbiAgICAgIGRhdGU6ICdZWVlZLU1NLUREJyxcbiAgICAgIGRhdGVUaW1lOiAnWVlZWS1NTS1ERCBISDptbTpzcycsXG4gICAgICB0aW1lOiAnSEg6bW06c3MnLFxuICAgICAgeWVhcjogJ1lZWVknLFxuICAgICAgbW9udGg6ICdZWVlZLU1NJyxcbiAgICAgIHdlZWs6ICdHR0dHLVdvJyxcbiAgICB9LFxuICBdLFxuICBbJ2Ryb3Bkb3duTWF0Y2hTZWxlY3RXaWR0aCcsIHRydWVdLFxuICBbJ3VzZUNvbG9uJywgZmFsc2VdLFxuICBbJ2V4Y2x1ZGVVc2VDb2xvblRhZ0xpc3QnLCBkZWZhdWx0RXhjbHVkZVVzZUNvbG9uVGFnXSxcbiAgWydsb3ZUYWJsZVByb3BzJywge31dLFxuXSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb25maWcoa2V5OiBDb25maWdLZXlzKTogYW55IHtcbiAgLy8gRklYTUU6IG9ic2VydmFibGUubWFw5oqK5p6E5bu6bWFw5pe25Lyg5YWl55qEa2V557G75Z6L5ZKMdmFsdWXnsbvlnovliIbliKvlgZrkuoZ1bmlvbu+8jFxuICAvLyDkuKLlpLHkuobkuIDkuIDlr7nlupTnmoTmmKDlsITlhbPns7vvvIzlr7zoh7Tlh73mlbDosIPnlKjogIXml6Dms5Xkvb/nlKh1bmlvbuWQjueahOi/lOWbnuWAvOexu+Wei++8jOWboOatpOmcgOimgeaMh+WumuacrOWHveaVsOi/lOWbnuWAvOS4umFueVxuICByZXR1cm4gZ2xvYmFsQ29uZmlnLmdldChrZXkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJlZml4Q2xzKHN1ZmZpeENsczogc3RyaW5nLCBjdXN0b21pemVQcmVmaXhDbHM/OiBzdHJpbmcpOiBzdHJpbmcge1xuICBpZiAoY3VzdG9taXplUHJlZml4Q2xzKSB7XG4gICAgcmV0dXJuIGN1c3RvbWl6ZVByZWZpeENscztcbiAgfVxuICByZXR1cm4gYCR7Z2V0Q29uZmlnKCdwcmVmaXhDbHMnKX0tJHtzdWZmaXhDbHN9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb1ByZWZpeENscyhzdWZmaXhDbHM6IHN0cmluZywgY3VzdG9taXplUHJlZml4Q2xzPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKGN1c3RvbWl6ZVByZWZpeENscykge1xuICAgIHJldHVybiBjdXN0b21pemVQcmVmaXhDbHM7XG4gIH1cbiAgcmV0dXJuIGAke2dldENvbmZpZygncHJvUHJlZml4Q2xzJyl9LSR7c3VmZml4Q2xzfWA7XG59XG5cbmNvbnN0IG1lcmdlUHJvcHMgPSBbJ3RyYW5zcG9ydCcsICdmZWVkYmFjaycsICdmb3JtYXR0ZXInXTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZzogQ29uZmlnKSB7XG4gIHJ1bkluQWN0aW9uKCgpID0+IHtcbiAgICBPYmplY3Qua2V5cyhjb25maWcpLmZvckVhY2goKGtleTogQ29uZmlnS2V5cykgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb25maWdba2V5XTtcbiAgICAgIGlmIChtZXJnZVByb3BzLmluY2x1ZGVzKGtleSkgJiYgaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICAgIGdsb2JhbENvbmZpZy5zZXQoa2V5LCB7XG4gICAgICAgICAgLi4udG9KUzxhbnk+KGdsb2JhbENvbmZpZy5nZXQoa2V5KSksXG4gICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2xvYmFsQ29uZmlnLnNldChrZXksIGNvbmZpZ1trZXldKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG4iXSwidmVyc2lvbiI6M30=