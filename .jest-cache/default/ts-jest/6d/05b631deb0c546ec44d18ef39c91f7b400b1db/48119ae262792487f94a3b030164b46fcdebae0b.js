import { __decorate } from "tslib";
import React from 'react';
import PropTypes from 'prop-types';
import { action, computed, isArrayLike, runInAction } from 'mobx';
import { observer } from 'mobx-react';
import isString from 'lodash/isString';
import isNumber from 'lodash/isNumber';
import omit from 'lodash/omit';
import isPlainObject from 'lodash/isPlainObject';
import defaultTo from 'lodash/defaultTo';
import isNil from 'lodash/isNil';
import KeyCode from 'choerodon-ui/lib/_util/KeyCode';
import { getConfig } from 'choerodon-ui/lib/configure';
import { TextField } from '../text-field/TextField';
import autobind from '../_util/autobind';
import keepRunning from '../_util/keepRunning';
import Icon from '../icon';
import { getNearStepValues, getPrecision, MAX_SAFE_INTEGER, plus } from './utils';
import isEmpty from '../_util/isEmpty';
import { $l } from '../locale-context';
import defaultFormatNumber from '../formatter/formatNumber';
function getCurrentValidValue(value) {
    return Number(value.replace(/\.$/, '')) || 0;
}
export class NumberField extends TextField {
    get defaultValidationMessages() {
        const label = this.getProp('label');
        return {
            valueMissing: $l('NumberField', label ? 'value_missing' : 'value_missing_no_label', {
                label,
            }),
        };
    }
    get allowDecimal() {
        const { min, nonStrictStep } = this;
        // 非严格步距下允许输入小数
        if (nonStrictStep) {
            return true;
        }
        const step = this.getProp('step');
        return !step || step % 1 !== 0 || (!!min && min % 1 !== 0);
    }
    get nonStrictStep() {
        const nonStrictStep = this.getProp('nonStrictStep');
        if (nonStrictStep !== undefined) {
            return nonStrictStep;
        }
        const numberFieldNonStrictStep = getConfig('numberFieldNonStrictStep');
        if (numberFieldNonStrictStep !== undefined) {
            return numberFieldNonStrictStep;
        }
        return false;
    }
    get allowNegative() {
        const { min } = this;
        return isNil(min) || min < 0;
    }
    get min() {
        return this.getLimit('min');
    }
    get max() {
        return this.getLimit('max');
    }
    get value() {
        const { value } = this.observableProps;
        if (isArrayLike(value)) {
            return value;
        }
        const { range } = this;
        if (isArrayLike(range)) {
            if (isPlainObject(value)) {
                const [start, end] = range;
                return {
                    [start]: value[start],
                    [end]: value[end],
                };
            }
        }
        return value;
    }
    set value(value) {
        runInAction(() => {
            this.observableProps.value = value;
        });
    }
    isLowerRange(value1, value2) {
        return value1 < value2;
    }
    getFieldType() {
        return "number" /* number */;
    }
    getLimit(type) {
        const { record } = this;
        const limit = this.getProp(type);
        if (record && isString(limit)) {
            const num = record.get(limit);
            if (num !== undefined) {
                return num;
            }
        }
        return limit;
    }
    getValidatorProps() {
        const { min, max } = this;
        const step = this.getProp('step');
        const nonStrictStep = this.nonStrictStep;
        return {
            ...super.getValidatorProps(),
            min,
            max,
            step,
            nonStrictStep,
        };
    }
    getInnerSpanButton() {
        const { prefixCls, range } = this;
        const step = this.getProp('step');
        if (step && !range && !this.isReadOnly()) {
            return this.wrapperInnerSpanButton(React.createElement("div", null,
                React.createElement(Icon, { key: "plus", type: "keyboard_arrow_up", className: `${prefixCls}-plus`, onMouseDown: this.handlePlus }),
                React.createElement(Icon, { key: "minus", type: "keyboard_arrow_down", className: `${prefixCls}-minus`, onMouseDown: this.handleMinus })));
        }
    }
    handleEnterDown(e) {
        if (this.multiple && this.range && this.text) {
            this.prepareSetValue(this.text);
        }
        super.handleEnterDown(e);
        if (this.multiple && this.range) {
            this.setRangeTarget(0);
            this.beginRange();
        }
    }
    handleKeyDown(e) {
        if (!this.props.disabled && !this.isReadOnly()) {
            switch (e.keyCode) {
                case KeyCode.UP:
                    this.handleKeyDownUp(e);
                    break;
                case KeyCode.DOWN:
                    this.handleKeyDownDown(e);
                    break;
                default:
            }
        }
        super.handleKeyDown(e);
    }
    handleKeyDownUp(e) {
        e.preventDefault();
        if (this.getProp('step')) {
            this.step(true);
        }
    }
    handleKeyDownDown(e) {
        e.preventDefault();
        if (this.getProp('step')) {
            this.step(false);
        }
    }
    handlePlus() {
        this.step(true);
    }
    handleMinus() {
        this.step(false);
    }
    getOtherProps() {
        const otherProps = omit(super.getOtherProps(), [
            'nonStrictStep',
            'formatter',
            'formatterOptions',
        ]);
        return otherProps;
    }
    step(isPlus) {
        const min = defaultTo(this.min, -MAX_SAFE_INTEGER);
        const max = defaultTo(this.max, MAX_SAFE_INTEGER);
        const step = defaultTo(this.getProp('step'), 1);
        const nonStrictStep = this.nonStrictStep;
        // 需要处理非严格模式
        let newValue;
        const value = this.multiple || this.isFocused ? Number(this.text || this.getValue()) : this.getValue();
        if (!isNumber(value)) {
            newValue = defaultTo(this.min, 0);
        }
        else {
            const currentValue = getCurrentValidValue(String(value));
            newValue = currentValue;
            const nearStep = getNearStepValues(currentValue, step, min, max);
            if (nonStrictStep === false && nearStep) {
                switch (nearStep.length) {
                    case 1:
                        newValue = nearStep[0];
                        break;
                    case 2:
                        newValue = nearStep[isPlus ? 1 : 0];
                        break;
                    default:
                }
            }
            else {
                const nextValue = plus(currentValue, (isPlus ? step : -step));
                if (nextValue < min) {
                    newValue = min;
                }
                else if (nextValue > max) {
                    const nearMaxStep = getNearStepValues(max, step, min, max);
                    if (nearMaxStep) {
                        newValue = nearMaxStep[0];
                    }
                    else {
                        newValue = max;
                    }
                }
                else {
                    newValue = nextValue;
                }
            }
        }
        // 不要进行对比操作,在table中使用的时候,因为NumberField会作为editor使用,所以在 对第一个cell只点击一次的情况下(例如plus)
        // 此时切换到第二个cell进行编辑，无法进行上次操作(同上次的plus)
        // this.value !== newValue
        if (this.multiple) {
            this.setText(String(newValue));
        }
        else {
            this.prepareSetValue(newValue);
        }
    }
    prepareSetValue(value) {
        super.prepareSetValue(isNaN(value) || isEmpty(value) ? null : Number(value));
    }
    restrictInput(value) {
        if (value) {
            let restrict = '0-9';
            if (this.allowDecimal) {
                restrict += '.';
            }
            const isNegative = this.allowNegative && /^-/.test(value);
            value = super.restrictInput(value.replace(new RegExp(`[^${restrict}]+`, 'g'), ''));
            const values = value.split('.');
            if (values.length > 2) {
                value = `${values.shift()}.${values.join('')}`;
            }
            if (isNegative) {
                value = `-${value}`;
            }
        }
        return value;
    }
    getFormatOptions(value) {
        const precision = getPrecision(isNil(value) ? this.getValue() || 0 : value);
        const defaultOptions = {
            lang: this.lang,
            options: {
                minimumFractionDigits: precision,
                maximumFractionDigits: precision,
            },
        };
        const formatterOptions = this.getProp('formatterOptions') || {};
        const numberFieldFormatterOptions = getConfig('numberFieldFormatterOptions') || {};
        if (formatterOptions) {
            return {
                lang: formatterOptions.lang || numberFieldFormatterOptions.lang || defaultOptions.lang,
                options: {
                    ...defaultOptions.options,
                    ...numberFieldFormatterOptions.options,
                    ...formatterOptions.options,
                },
            };
        }
        return defaultOptions;
    }
    getFormatter() {
        const formatter = this.getProp('formatter');
        if (formatter !== undefined) {
            return formatter;
        }
        const numberFieldFormatter = getConfig('numberFieldFormatter');
        if (numberFieldFormatter !== undefined) {
            return numberFieldFormatter;
        }
        return defaultFormatNumber;
    }
    processText(value) {
        const formatOptions = this.getFormatOptions(Number(value));
        return this.getFormatter()(value, formatOptions.lang, formatOptions.options);
    }
}
NumberField.displayName = 'NumberField';
NumberField.propTypes = {
    /**
     * 最小值
     */
    min: PropTypes.number,
    /**
     * 最大值
     */
    max: PropTypes.number,
    /**
     * 步距
     */
    step: PropTypes.number,
    /**
     * 非严格步距
     */
    nonStrictStep: PropTypes.bool,
    /**
     * 格式器
     */
    formatter: PropTypes.func,
    /**
     * 格式器参数
     */
    formatterOptions: PropTypes.object,
    ...TextField.propTypes,
};
NumberField.defaultProps = {
    ...TextField.defaultProps,
    suffixCls: 'input-number',
};
NumberField.format = defaultFormatNumber;
__decorate([
    computed
], NumberField.prototype, "defaultValidationMessages", null);
__decorate([
    computed
], NumberField.prototype, "allowDecimal", null);
__decorate([
    computed
], NumberField.prototype, "nonStrictStep", null);
__decorate([
    computed
], NumberField.prototype, "allowNegative", null);
__decorate([
    computed
], NumberField.prototype, "min", null);
__decorate([
    computed
], NumberField.prototype, "max", null);
__decorate([
    computed
], NumberField.prototype, "value", null);
__decorate([
    action
], NumberField.prototype, "handleEnterDown", null);
__decorate([
    autobind
], NumberField.prototype, "handleKeyDown", null);
__decorate([
    keepRunning
], NumberField.prototype, "handlePlus", null);
__decorate([
    keepRunning
], NumberField.prototype, "handleMinus", null);
let ObserverNumberField = class ObserverNumberField extends NumberField {
};
ObserverNumberField.defaultProps = NumberField.defaultProps;
ObserverNumberField.format = defaultFormatNumber;
ObserverNumberField = __decorate([
    observer
], ObserverNumberField);
export default ObserverNumberField;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMtcHJvL251bWJlci1maWVsZC9OdW1iZXJGaWVsZC50c3giLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBbUMsTUFBTSxPQUFPLENBQUM7QUFDeEQsT0FBTyxTQUFTLE1BQU0sWUFBWSxDQUFDO0FBQ25DLE9BQU8sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDbEUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUN0QyxPQUFPLFFBQVEsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLFFBQVEsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLElBQUksTUFBTSxhQUFhLENBQUM7QUFDL0IsT0FBTyxhQUFhLE1BQU0sc0JBQXNCLENBQUM7QUFDakQsT0FBTyxTQUFTLE1BQU0sa0JBQWtCLENBQUM7QUFDekMsT0FBTyxLQUFLLE1BQU0sY0FBYyxDQUFDO0FBQ2pDLE9BQU8sT0FBTyxNQUFNLGdDQUFnQyxDQUFDO0FBQ3JELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsU0FBUyxFQUFrQixNQUFNLHlCQUF5QixDQUFDO0FBQ3BFLE9BQU8sUUFBUSxNQUFNLG1CQUFtQixDQUFDO0FBQ3pDLE9BQU8sV0FBVyxNQUFNLHNCQUFzQixDQUFDO0FBQy9DLE9BQU8sSUFBSSxNQUFNLFNBQVMsQ0FBQztBQUMzQixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLElBQUksRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUVsRixPQUFPLE9BQU8sTUFBTSxrQkFBa0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFHdkMsT0FBTyxtQkFBbUIsTUFBTSwyQkFBMkIsQ0FBQztBQUU1RCxTQUFTLG9CQUFvQixD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Q0FBQyxNQUFNO0lBQ2xDLEdBQUcsU0FBUyxDQUFDLFNBQVM7Q0FDdkIsQ0FBQztBQUVLLHdCQUFZLEdBQUc7SUFDcEIsR0FBRyxTQUFTLENBQUMsWUFBWTtJQUN6QixTQUFTLEVBQUUsY0FBYztDQUMxQixDQUFDO0FBRUssa0JBQU0sR0FBRyxtQkFBbUIsQ0FBQztBQUdwQztJQURDLFFBQVE7NERBUVI7QUFHRDtJQURDLFFBQVE7K0NBU1I7QUFHRDtJQURDLFFBQVE7Z0RBV1I7QUFHRDtJQURDLFFBQVE7Z0RBSVI7QUFHRDtJQURDLFFBQVE7c0NBR1I7QUFHRDtJQURDLFFBQVE7c0NBR1I7QUFHRDtJQURDLFFBQVE7d0NBaUJSO0FBa0VEO0lBREMsTUFBTTtrREFVTjtBQUdEO0lBREMsUUFBUTtnREFjUjtBQWlCRDtJQURDLFdBQVc7NkNBR1g7QUFHRDtJQURDLFdBQVc7OENBR1g7QUFtSUgsSUFBcUIsbUJBQW1CLEdBQXhDLE1BQXFCLG1CQUFvQixTQUFRLFdBQTZCO0NBSTdFLENBQUE7QUFIUSxnQ0FBWSxHQUFHLFdBQVcsQ0FBQyxZQUFZLENBQUM7QUFFeEMsMEJBQU0sR0FBRyxtQkFBbUIsQ0FBQztBQUhqQixtQkFBbUI7SUFEdkMsUUFBUTtHQUNZLG1CQUFtQixDQUl2QztlQUpvQixtQkFBbUIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMtcHJvL251bWJlci1maWVsZC9OdW1iZXJGaWVsZC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFJlYWN0SW5zdGFuY2UsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeyBhY3Rpb24sIGNvbXB1dGVkLCBpc0FycmF5TGlrZSwgcnVuSW5BY3Rpb24gfSBmcm9tICdtb2J4JztcbmltcG9ydCB7IG9ic2VydmVyIH0gZnJvbSAnbW9ieC1yZWFjdCc7XG5pbXBvcnQgaXNTdHJpbmcgZnJvbSAnbG9kYXNoL2lzU3RyaW5nJztcbmltcG9ydCBpc051bWJlciBmcm9tICdsb2Rhc2gvaXNOdW1iZXInO1xuaW1wb3J0IG9taXQgZnJvbSAnbG9kYXNoL29taXQnO1xuaW1wb3J0IGlzUGxhaW5PYmplY3QgZnJvbSAnbG9kYXNoL2lzUGxhaW5PYmplY3QnO1xuaW1wb3J0IGRlZmF1bHRUbyBmcm9tICdsb2Rhc2gvZGVmYXVsdFRvJztcbmltcG9ydCBpc05pbCBmcm9tICdsb2Rhc2gvaXNOaWwnO1xuaW1wb3J0IEtleUNvZGUgZnJvbSAnY2hvZXJvZG9uLXVpL2xpYi9fdXRpbC9LZXlDb2RlJztcbmltcG9ydCB7IGdldENvbmZpZyB9IGZyb20gJ2Nob2Vyb2Rvbi11aS9saWIvY29uZmlndXJlJztcbmltcG9ydCB7IFRleHRGaWVsZCwgVGV4dEZpZWxkUHJvcHMgfSBmcm9tICcuLi90ZXh0LWZpZWxkL1RleHRGaWVsZCc7XG5pbXBvcnQgYXV0b2JpbmQgZnJvbSAnLi4vX3V0aWwvYXV0b2JpbmQnO1xuaW1wb3J0IGtlZXBSdW5uaW5nIGZyb20gJy4uL191dGlsL2tlZXBSdW5uaW5nJztcbmltcG9ydCBJY29uIGZyb20gJy4uL2ljb24nO1xuaW1wb3J0IHsgZ2V0TmVhclN0ZXBWYWx1ZXMsIGdldFByZWNpc2lvbiwgTUFYX1NBRkVfSU5URUdFUiwgcGx1cyB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgVmFsaWRhdGlvbk1lc3NhZ2VzIH0gZnJvbSAnLi4vdmFsaWRhdG9yL1ZhbGlkYXRvcic7XG5pbXBvcnQgaXNFbXB0eSBmcm9tICcuLi9fdXRpbC9pc0VtcHR5JztcbmltcG9ydCB7ICRsIH0gZnJvbSAnLi4vbG9jYWxlLWNvbnRleHQnO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSAnLi4vZGF0YS1zZXQvZW51bSc7XG5pbXBvcnQgeyBWYWxpZGF0b3JQcm9wcyB9IGZyb20gJy4uL3ZhbGlkYXRvci9ydWxlcyc7XG5pbXBvcnQgZGVmYXVsdEZvcm1hdE51bWJlciBmcm9tICcuLi9mb3JtYXR0ZXIvZm9ybWF0TnVtYmVyJztcblxuZnVuY3Rpb24gZ2V0Q3VycmVudFZhbGlkVmFsdWUodmFsdWU6IHN0cmluZyk6IG51bWJlciB7XG4gIHJldHVybiBOdW1iZXIodmFsdWUucmVwbGFjZSgvXFwuJC8sICcnKSkgfHwgMDtcbn1cblxuZXhwb3J0IHR5cGUgRm9ybWF0TnVtYmVyRnVuYyA9ICh2YWx1ZTogc3RyaW5nLCBsYW5nOiBzdHJpbmcsIG9wdGlvbnM6IEludGwuTnVtYmVyRm9ybWF0T3B0aW9ucykgPT4gc3RyaW5nO1xuXG5leHBvcnQgdHlwZSBGb3JtYXROdW1iZXJGdW5jT3B0aW9ucyA9IHtcbiAgbGFuZz86IHN0cmluZyxcbiAgb3B0aW9ucz86IEludGwuTnVtYmVyRm9ybWF0T3B0aW9ucztcbn07XG5cblxuZXhwb3J0IGludGVyZmFjZSBOdW1iZXJGaWVsZFByb3BzIGV4dGVuZHMgVGV4dEZpZWxkUHJvcHMge1xuICAvKipcbiAgICog5pyA5bCP5YC8XG4gICAqL1xuICBtaW4/OiBudW1iZXIgfCBudWxsO1xuICAvKipcbiAgICog5pyA5aSn5YC8XG4gICAqL1xuICBtYXg/OiBudW1iZXIgfCBudWxsO1xuICAvKipcbiAgICog5q2l6LedXG4gICAqL1xuICBzdGVwPzogbnVtYmVyO1xuICAvKipcbiAgICog6Z2e5Lil5qC85q2l6LedXG4gICAqL1xuICBub25TdHJpY3RTdGVwPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIOagvOW8j+WZqFxuICAgKi9cbiAgZm9ybWF0dGVyPzogRm9ybWF0TnVtYmVyRnVuYztcbiAgLyoqXG4gICAqIOagvOW8j+WZqOWPguaVsFxuICAgKi9cbiAgZm9ybWF0dGVyT3B0aW9ucz86IEZvcm1hdE51bWJlckZ1bmNPcHRpb25zO1xuICAvKipcbiAgICog5YC85Y+Y5YyW5Zue6LCDXG4gICAqL1xuICBvbkNoYW5nZT86ICh2YWx1ZTogbnVtYmVyLCBvbGRWYWx1ZTogbnVtYmVyLCBmb3JtPzogUmVhY3RJbnN0YW5jZSkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIE51bWJlckZpZWxkPFQgZXh0ZW5kcyBOdW1iZXJGaWVsZFByb3BzPiBleHRlbmRzIFRleHRGaWVsZDxUICYgTnVtYmVyRmllbGRQcm9wcz4ge1xuICBzdGF0aWMgZGlzcGxheU5hbWUgPSAnTnVtYmVyRmllbGQnO1xuXG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLyoqXG4gICAgICog5pyA5bCP5YC8XG4gICAgICovXG4gICAgbWluOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIOacgOWkp+WAvFxuICAgICAqL1xuICAgIG1heDogUHJvcFR5cGVzLm51bWJlcixcbiAgICAvKipcbiAgICAgKiDmraXot51cbiAgICAgKi9cbiAgICBzdGVwOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIOmdnuS4peagvOatpei3nVxuICAgICAqL1xuICAgIG5vblN0cmljdFN0ZXA6IFByb3BUeXBlcy5ib29sLFxuICAgIC8qKlxuICAgICAqIOagvOW8j+WZqFxuICAgICAqL1xuICAgIGZvcm1hdHRlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICog5qC85byP5Zmo5Y+C5pWwXG4gICAgICovXG4gICAgZm9ybWF0dGVyT3B0aW9uczogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAuLi5UZXh0RmllbGQucHJvcFR5cGVzLFxuICB9O1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgLi4uVGV4dEZpZWxkLmRlZmF1bHRQcm9wcyxcbiAgICBzdWZmaXhDbHM6ICdpbnB1dC1udW1iZXInLFxuICB9O1xuXG4gIHN0YXRpYyBmb3JtYXQgPSBkZWZhdWx0Rm9ybWF0TnVtYmVyO1xuXG4gIEBjb21wdXRlZFxuICBnZXQgZGVmYXVsdFZhbGlkYXRpb25NZXNzYWdlcygpOiBWYWxpZGF0aW9uTWVzc2FnZXMge1xuICAgIGNvbnN0IGxhYmVsID0gdGhpcy5nZXRQcm9wKCdsYWJlbCcpO1xuICAgIHJldHVybiB7XG4gICAgICB2YWx1ZU1pc3Npbmc6ICRsKCdOdW1iZXJGaWVsZCcsIGxhYmVsID8gJ3ZhbHVlX21pc3NpbmcnIDogJ3ZhbHVlX21pc3Npbmdfbm9fbGFiZWwnLCB7XG4gICAgICAgIGxhYmVsLFxuICAgICAgfSksXG4gICAgfTtcbiAgfVxuXG4gIEBjb21wdXRlZFxuICBnZXQgYWxsb3dEZWNpbWFsKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgbWluLCBub25TdHJpY3RTdGVwIH0gPSB0aGlzO1xuICAgIC8vIOmdnuS4peagvOatpei3neS4i+WFgeiuuOi+k+WFpeWwj+aVsFxuICAgIGlmIChub25TdHJpY3RTdGVwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3Qgc3RlcCA9IHRoaXMuZ2V0UHJvcCgnc3RlcCcpO1xuICAgIHJldHVybiAhc3RlcCB8fCAoc3RlcCBhcyBudW1iZXIpICUgMSAhPT0gMCB8fCAoISFtaW4gJiYgKG1pbiBhcyBudW1iZXIpICUgMSAhPT0gMCk7XG4gIH1cblxuICBAY29tcHV0ZWRcbiAgZ2V0IG5vblN0cmljdFN0ZXAoKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgbm9uU3RyaWN0U3RlcCA9IHRoaXMuZ2V0UHJvcCgnbm9uU3RyaWN0U3RlcCcpO1xuICAgIGlmIChub25TdHJpY3RTdGVwICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBub25TdHJpY3RTdGVwO1xuICAgIH1cbiAgICBjb25zdCBudW1iZXJGaWVsZE5vblN0cmljdFN0ZXAgPSBnZXRDb25maWcoJ251bWJlckZpZWxkTm9uU3RyaWN0U3RlcCcpO1xuICAgIGlmIChudW1iZXJGaWVsZE5vblN0cmljdFN0ZXAgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIG51bWJlckZpZWxkTm9uU3RyaWN0U3RlcDtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgQGNvbXB1dGVkXG4gIGdldCBhbGxvd05lZ2F0aXZlKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgbWluIH0gPSB0aGlzO1xuICAgIHJldHVybiBpc05pbChtaW4pIHx8IG1pbiA8IDA7XG4gIH1cblxuICBAY29tcHV0ZWRcbiAgZ2V0IG1pbigpOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMaW1pdCgnbWluJyk7XG4gIH1cblxuICBAY29tcHV0ZWRcbiAgZ2V0IG1heCgpOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMaW1pdCgnbWF4Jyk7XG4gIH1cblxuICBAY29tcHV0ZWRcbiAgZ2V0IHZhbHVlKCk6IGFueSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgeyB2YWx1ZSB9ID0gdGhpcy5vYnNlcnZhYmxlUHJvcHM7XG4gICAgaWYgKGlzQXJyYXlMaWtlKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjb25zdCB7IHJhbmdlIH0gPSB0aGlzO1xuICAgIGlmIChpc0FycmF5TGlrZShyYW5nZSkpIHtcbiAgICAgIGlmIChpc1BsYWluT2JqZWN0KHZhbHVlKSkge1xuICAgICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSByYW5nZTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBbc3RhcnRdOiB2YWx1ZVtzdGFydF0sXG4gICAgICAgICAgW2VuZF06IHZhbHVlW2VuZF0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHNldCB2YWx1ZSh2YWx1ZTogYW55IHwgdW5kZWZpbmVkKSB7XG4gICAgcnVuSW5BY3Rpb24oKCkgPT4ge1xuICAgICAgdGhpcy5vYnNlcnZhYmxlUHJvcHMudmFsdWUgPSB2YWx1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIGlzTG93ZXJSYW5nZSh2YWx1ZTE6IG51bWJlciwgdmFsdWUyOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdmFsdWUxIDwgdmFsdWUyO1xuICB9XG5cbiAgZ2V0RmllbGRUeXBlKCk6IEZpZWxkVHlwZSB7XG4gICAgcmV0dXJuIEZpZWxkVHlwZS5udW1iZXI7XG4gIH1cblxuICBnZXRMaW1pdCh0eXBlOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsIHtcbiAgICBjb25zdCB7IHJlY29yZCB9ID0gdGhpcztcbiAgICBjb25zdCBsaW1pdCA9IHRoaXMuZ2V0UHJvcCh0eXBlKTtcbiAgICBpZiAocmVjb3JkICYmIGlzU3RyaW5nKGxpbWl0KSkge1xuICAgICAgY29uc3QgbnVtID0gcmVjb3JkLmdldChsaW1pdCk7XG4gICAgICBpZiAobnVtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG51bTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxpbWl0O1xuICB9XG5cbiAgZ2V0VmFsaWRhdG9yUHJvcHMoKTogVmFsaWRhdG9yUHJvcHMge1xuICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXM7XG4gICAgY29uc3Qgc3RlcCA9IHRoaXMuZ2V0UHJvcCgnc3RlcCcpO1xuICAgIGNvbnN0IG5vblN0cmljdFN0ZXAgPSB0aGlzLm5vblN0cmljdFN0ZXA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uc3VwZXIuZ2V0VmFsaWRhdG9yUHJvcHMoKSxcbiAgICAgIG1pbixcbiAgICAgIG1heCxcbiAgICAgIHN0ZXAsXG4gICAgICBub25TdHJpY3RTdGVwLFxuICAgIH07XG4gIH1cblxuICBnZXRJbm5lclNwYW5CdXR0b24oKTogUmVhY3ROb2RlIHtcbiAgICBjb25zdCB7IHByZWZpeENscywgcmFuZ2UgfSA9IHRoaXM7XG4gICAgY29uc3Qgc3RlcCA9IHRoaXMuZ2V0UHJvcCgnc3RlcCcpO1xuICAgIGlmIChzdGVwICYmICFyYW5nZSAmJiAhdGhpcy5pc1JlYWRPbmx5KCkpIHtcbiAgICAgIHJldHVybiB0aGlzLndyYXBwZXJJbm5lclNwYW5CdXR0b24oXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPEljb25cbiAgICAgICAgICAgIGtleT1cInBsdXNcIlxuICAgICAgICAgICAgdHlwZT1cImtleWJvYXJkX2Fycm93X3VwXCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1wbHVzYH1cbiAgICAgICAgICAgIG9uTW91c2VEb3duPXt0aGlzLmhhbmRsZVBsdXN9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8SWNvblxuICAgICAgICAgICAga2V5PVwibWludXNcIlxuICAgICAgICAgICAgdHlwZT1cImtleWJvYXJkX2Fycm93X2Rvd25cIlxuICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LW1pbnVzYH1cbiAgICAgICAgICAgIG9uTW91c2VEb3duPXt0aGlzLmhhbmRsZU1pbnVzfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvZGl2PixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgQGFjdGlvblxuICBoYW5kbGVFbnRlckRvd24oZSkge1xuICAgIGlmICh0aGlzLm11bHRpcGxlICYmIHRoaXMucmFuZ2UgJiYgdGhpcy50ZXh0KSB7XG4gICAgICB0aGlzLnByZXBhcmVTZXRWYWx1ZSh0aGlzLnRleHQpO1xuICAgIH1cbiAgICBzdXBlci5oYW5kbGVFbnRlckRvd24oZSk7XG4gICAgaWYgKHRoaXMubXVsdGlwbGUgJiYgdGhpcy5yYW5nZSkge1xuICAgICAgdGhpcy5zZXRSYW5nZVRhcmdldCgwKTtcbiAgICAgIHRoaXMuYmVnaW5SYW5nZSgpO1xuICAgIH1cbiAgfVxuXG4gIEBhdXRvYmluZFxuICBoYW5kbGVLZXlEb3duKGUpIHtcbiAgICBpZiAoIXRoaXMucHJvcHMuZGlzYWJsZWQgJiYgIXRoaXMuaXNSZWFkT25seSgpKSB7XG4gICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICBjYXNlIEtleUNvZGUuVVA6XG4gICAgICAgICAgdGhpcy5oYW5kbGVLZXlEb3duVXAoZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgS2V5Q29kZS5ET1dOOlxuICAgICAgICAgIHRoaXMuaGFuZGxlS2V5RG93bkRvd24oZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfVxuICAgIHN1cGVyLmhhbmRsZUtleURvd24oZSk7XG4gIH1cblxuICBoYW5kbGVLZXlEb3duVXAoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAodGhpcy5nZXRQcm9wKCdzdGVwJykpIHtcbiAgICAgIHRoaXMuc3RlcCh0cnVlKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVLZXlEb3duRG93bihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmICh0aGlzLmdldFByb3AoJ3N0ZXAnKSkge1xuICAgICAgdGhpcy5zdGVwKGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBAa2VlcFJ1bm5pbmdcbiAgaGFuZGxlUGx1cygpIHtcbiAgICB0aGlzLnN0ZXAodHJ1ZSk7XG4gIH1cblxuICBAa2VlcFJ1bm5pbmdcbiAgaGFuZGxlTWludXMoKSB7XG4gICAgdGhpcy5zdGVwKGZhbHNlKTtcbiAgfVxuXG4gIGdldE90aGVyUHJvcHMoKSB7XG4gICAgY29uc3Qgb3RoZXJQcm9wcyA9IG9taXQoc3VwZXIuZ2V0T3RoZXJQcm9wcygpLCBbXG4gICAgICAnbm9uU3RyaWN0U3RlcCcsXG4gICAgICAnZm9ybWF0dGVyJyxcbiAgICAgICdmb3JtYXR0ZXJPcHRpb25zJyxcbiAgICBdKTtcbiAgICByZXR1cm4gb3RoZXJQcm9wcztcbiAgfVxuXG4gIHN0ZXAoaXNQbHVzOiBib29sZWFuKSB7XG4gICAgY29uc3QgbWluID0gZGVmYXVsdFRvKHRoaXMubWluLCAtTUFYX1NBRkVfSU5URUdFUik7XG4gICAgY29uc3QgbWF4ID0gZGVmYXVsdFRvKHRoaXMubWF4LCBNQVhfU0FGRV9JTlRFR0VSKTtcbiAgICBjb25zdCBzdGVwID0gZGVmYXVsdFRvKHRoaXMuZ2V0UHJvcCgnc3RlcCcpLCAxKTtcbiAgICBjb25zdCBub25TdHJpY3RTdGVwID0gdGhpcy5ub25TdHJpY3RTdGVwO1xuICAgIC8vIOmcgOimgeWkhOeQhumdnuS4peagvOaooeW8j1xuICAgIGxldCBuZXdWYWx1ZTtcbiAgICBjb25zdCB2YWx1ZSA9XG4gICAgICB0aGlzLm11bHRpcGxlIHx8IHRoaXMuaXNGb2N1c2VkID8gTnVtYmVyKHRoaXMudGV4dCB8fCB0aGlzLmdldFZhbHVlKCkpIDogdGhpcy5nZXRWYWx1ZSgpO1xuICAgIGlmICghaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICBuZXdWYWx1ZSA9IGRlZmF1bHRUbyh0aGlzLm1pbiwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGdldEN1cnJlbnRWYWxpZFZhbHVlKFN0cmluZyh2YWx1ZSkpO1xuICAgICAgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWU7XG4gICAgICBjb25zdCBuZWFyU3RlcCA9IGdldE5lYXJTdGVwVmFsdWVzKGN1cnJlbnRWYWx1ZSwgc3RlcCBhcyBudW1iZXIsIG1pbiwgbWF4KTtcbiAgICAgIGlmIChub25TdHJpY3RTdGVwID09PSBmYWxzZSAmJiBuZWFyU3RlcCkge1xuICAgICAgICBzd2l0Y2ggKG5lYXJTdGVwLmxlbmd0aCkge1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gbmVhclN0ZXBbMF07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IG5lYXJTdGVwW2lzUGx1cyA/IDEgOiAwXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IHBsdXMoY3VycmVudFZhbHVlLCAoaXNQbHVzID8gc3RlcCA6IC1zdGVwKSBhcyBudW1iZXIpO1xuICAgICAgICBpZiAobmV4dFZhbHVlIDwgbWluKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBtaW47XG4gICAgICAgIH0gZWxzZSBpZiAobmV4dFZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgY29uc3QgbmVhck1heFN0ZXAgPSBnZXROZWFyU3RlcFZhbHVlcyhtYXggYXMgbnVtYmVyLCBzdGVwIGFzIG51bWJlciwgbWluLCBtYXggYXMgbnVtYmVyKTtcblxuICAgICAgICAgIGlmIChuZWFyTWF4U3RlcCkge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSBuZWFyTWF4U3RlcFswXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSBtYXg7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1ZhbHVlID0gbmV4dFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vIOS4jeimgei/m+ihjOWvueavlOaTjeS9nCzlnKh0YWJsZeS4reS9v+eUqOeahOaXtuWAmSzlm6DkuLpOdW1iZXJGaWVsZOS8muS9nOS4umVkaXRvcuS9v+eUqCzmiYDku6XlnKgg5a+556ys5LiA5LiqY2VsbOWPqueCueWHu+S4gOasoeeahOaDheWGteS4iyjkvovlpoJwbHVzKVxuICAgIC8vIOatpOaXtuWIh+aNouWIsOesrOS6jOS4qmNlbGzov5vooYznvJbovpHvvIzml6Dms5Xov5vooYzkuIrmrKHmk43kvZwo5ZCM5LiK5qyh55qEcGx1cylcbiAgICAvLyB0aGlzLnZhbHVlICE9PSBuZXdWYWx1ZVxuICAgIGlmICh0aGlzLm11bHRpcGxlKSB7XG4gICAgICB0aGlzLnNldFRleHQoU3RyaW5nKG5ld1ZhbHVlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJlcGFyZVNldFZhbHVlKG5ld1ZhbHVlKTtcbiAgICB9XG5cbiAgfVxuXG4gIHByZXBhcmVTZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XG4gICAgc3VwZXIucHJlcGFyZVNldFZhbHVlKGlzTmFOKHZhbHVlKSB8fCBpc0VtcHR5KHZhbHVlKSA/IG51bGwgOiBOdW1iZXIodmFsdWUpKTtcbiAgfVxuXG4gIHJlc3RyaWN0SW5wdXQodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBsZXQgcmVzdHJpY3QgPSAnMC05JztcbiAgICAgIGlmICh0aGlzLmFsbG93RGVjaW1hbCkge1xuICAgICAgICByZXN0cmljdCArPSAnLic7XG4gICAgICB9XG4gICAgICBjb25zdCBpc05lZ2F0aXZlID0gdGhpcy5hbGxvd05lZ2F0aXZlICYmIC9eLS8udGVzdCh2YWx1ZSk7XG4gICAgICB2YWx1ZSA9IHN1cGVyLnJlc3RyaWN0SW5wdXQodmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKGBbXiR7cmVzdHJpY3R9XStgLCAnZycpLCAnJykpO1xuICAgICAgY29uc3QgdmFsdWVzID0gdmFsdWUuc3BsaXQoJy4nKTtcbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID4gMikge1xuICAgICAgICB2YWx1ZSA9IGAke3ZhbHVlcy5zaGlmdCgpfS4ke3ZhbHVlcy5qb2luKCcnKX1gO1xuICAgICAgfVxuICAgICAgaWYgKGlzTmVnYXRpdmUpIHtcbiAgICAgICAgdmFsdWUgPSBgLSR7dmFsdWV9YDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgZ2V0Rm9ybWF0T3B0aW9ucyh2YWx1ZT86IG51bWJlcik6IEZvcm1hdE51bWJlckZ1bmNPcHRpb25zIHtcbiAgICBjb25zdCBwcmVjaXNpb24gPSBnZXRQcmVjaXNpb24oaXNOaWwodmFsdWUpID8gdGhpcy5nZXRWYWx1ZSgpIHx8IDAgOiB2YWx1ZSk7XG4gICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICBsYW5nOiB0aGlzLmxhbmcsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogcHJlY2lzaW9uLFxuICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IHByZWNpc2lvbixcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IGZvcm1hdHRlck9wdGlvbnM6IEZvcm1hdE51bWJlckZ1bmNPcHRpb25zID0gdGhpcy5nZXRQcm9wKCdmb3JtYXR0ZXJPcHRpb25zJykgfHwge307XG4gICAgY29uc3QgbnVtYmVyRmllbGRGb3JtYXR0ZXJPcHRpb25zOiBGb3JtYXROdW1iZXJGdW5jT3B0aW9ucyA9IGdldENvbmZpZygnbnVtYmVyRmllbGRGb3JtYXR0ZXJPcHRpb25zJykgfHwge307XG4gICAgaWYgKGZvcm1hdHRlck9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxhbmc6IGZvcm1hdHRlck9wdGlvbnMubGFuZyB8fCBudW1iZXJGaWVsZEZvcm1hdHRlck9wdGlvbnMubGFuZyB8fCBkZWZhdWx0T3B0aW9ucy5sYW5nLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgLi4uZGVmYXVsdE9wdGlvbnMub3B0aW9ucyxcbiAgICAgICAgICAuLi5udW1iZXJGaWVsZEZvcm1hdHRlck9wdGlvbnMub3B0aW9ucyxcbiAgICAgICAgICAuLi5mb3JtYXR0ZXJPcHRpb25zLm9wdGlvbnMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gIH1cblxuICBnZXRGb3JtYXR0ZXIoKSB7XG4gICAgY29uc3QgZm9ybWF0dGVyID0gdGhpcy5nZXRQcm9wKCdmb3JtYXR0ZXInKTtcbiAgICBpZiAoZm9ybWF0dGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBmb3JtYXR0ZXI7XG4gICAgfVxuICAgIGNvbnN0IG51bWJlckZpZWxkRm9ybWF0dGVyID0gZ2V0Q29uZmlnKCdudW1iZXJGaWVsZEZvcm1hdHRlcicpO1xuICAgIGlmIChudW1iZXJGaWVsZEZvcm1hdHRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gbnVtYmVyRmllbGRGb3JtYXR0ZXI7XG4gICAgfVxuICAgIHJldHVybiBkZWZhdWx0Rm9ybWF0TnVtYmVyO1xuICB9XG5cbiAgcHJvY2Vzc1RleHQodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZm9ybWF0T3B0aW9ucyA9IHRoaXMuZ2V0Rm9ybWF0T3B0aW9ucyhOdW1iZXIodmFsdWUpKTtcbiAgICByZXR1cm4gdGhpcy5nZXRGb3JtYXR0ZXIoKSh2YWx1ZSwgZm9ybWF0T3B0aW9ucy5sYW5nLCBmb3JtYXRPcHRpb25zLm9wdGlvbnMpO1xuICB9XG59XG5cbkBvYnNlcnZlclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JzZXJ2ZXJOdW1iZXJGaWVsZCBleHRlbmRzIE51bWJlckZpZWxkPE51bWJlckZpZWxkUHJvcHM+IHtcbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IE51bWJlckZpZWxkLmRlZmF1bHRQcm9wcztcblxuICBzdGF0aWMgZm9ybWF0ID0gZGVmYXVsdEZvcm1hdE51bWJlcjtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==