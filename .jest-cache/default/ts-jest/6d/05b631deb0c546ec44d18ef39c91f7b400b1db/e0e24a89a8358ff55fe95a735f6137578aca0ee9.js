import { __decorate } from "tslib";
import React, { Component } from 'react';
import { action, observable } from 'mobx';
import { observer } from 'mobx-react';
import Menu, { Item } from 'choerodon-ui/lib/rc-components/menu/index';
import Button from '../../button/Button';
import Dropdown from '../../dropdown/Dropdown';
import TableContext from '../TableContext';
import { getColumnKey, getHeader } from '../utils';
import { stopEvent, stopPropagation } from '../../_util/EventManager';
import autobind from '../../_util/autobind';
function handleMenuClick({ domEvent }) {
    domEvent.preventDefault();
}
let ColumnFilter = class ColumnFilter extends Component {
    constructor(props, context) {
        super(props, context);
        this.setDropDownHidden(true);
    }
    saveMenu(node) {
        this.menu = node;
    }
    handleHiddenChange(hidden) {
        this.setDropDownHidden(hidden);
    }
    handleKeyDown(e) {
        if (this.menu && this.menu.onKeyDown(e)) {
            stopEvent(e);
        }
    }
    setDropDownHidden(hidden) {
        this.hidden = hidden;
    }
    render() {
        const { prefixCls: rootPrefixCls } = this.props;
        const prefixCls = `${rootPrefixCls}-columns-chooser`;
        return (React.createElement("div", { className: prefixCls, onFocus: stopPropagation, onMouseDown: stopPropagation, tabIndex: -1 },
            React.createElement(Dropdown, { placement: "bottomRight" /* bottomRight */, overlay: this.getMenu(prefixCls), hidden: this.hidden, onHiddenChange: this.handleHiddenChange },
                React.createElement(Button, { funcType: "flat" /* flat */, icon: "view_column", size: "small" /* small */, onKeyDown: this.handleKeyDown }))));
    }
    handleMenuSelect({ item: { props: { value }, }, }) {
        value.hidden = false;
    }
    handleMenuUnSelect({ item: { props: { value }, }, }) {
        value.hidden = true;
    }
    getMenu(prefixCls) {
        const { tableStore: { leafColumns, dataSet }, } = this.context;
        const selectedKeys = [];
        const columns = [];
        leafColumns.forEach(column => {
            if (column.hideable) {
                const header = getHeader(column, dataSet);
                if (header) {
                    const key = getColumnKey(column);
                    if (!column.hidden) {
                        selectedKeys.push(key);
                    }
                    columns.push([column, header, key]);
                }
            }
        });
        return (React.createElement(Menu, { ref: this.saveMenu, multiple: true, defaultActiveFirst: true, prefixCls: `${prefixCls}-dropdown-menu`, selectedKeys: selectedKeys, onSelect: this.handleMenuSelect, onDeselect: this.handleMenuUnSelect, onClick: handleMenuClick }, this.getOptions(columns)));
    }
    getOptions(columns) {
        return columns.map(([column, header, key]) => (React.createElement(Item, { key: key, value: column },
            React.createElement("span", null, header))));
    }
};
ColumnFilter.displayName = 'ColumnFilter';
ColumnFilter.contextType = TableContext;
__decorate([
    observable
], ColumnFilter.prototype, "hidden", void 0);
__decorate([
    autobind
], ColumnFilter.prototype, "saveMenu", null);
__decorate([
    autobind
], ColumnFilter.prototype, "handleHiddenChange", null);
__decorate([
    autobind
], ColumnFilter.prototype, "handleKeyDown", null);
__decorate([
    action
], ColumnFilter.prototype, "setDropDownHidden", null);
__decorate([
    action
], ColumnFilter.prototype, "handleMenuSelect", null);
__decorate([
    action
], ColumnFilter.prototype, "handleMenuUnSelect", null);
ColumnFilter = __decorate([
    observer
], ColumnFilter);
export default ColumnFilter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMtcHJvL3RhYmxlL3F1ZXJ5LWJhci9Db2x1bW5GaWx0ZXIudHN4IiwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEtBQUssRUFBRSxFQUFFLFNBQVMsRUFBZ0MsTUFBTSxPQUFPLENBQUM7QUFDdkUsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUN0QyxPQUFPLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLDJDQUEyQyxDQUFDO0FBQ3ZFLE9BQU8sTUFBTSxNQUFNLHFCQUFxQixDQUFDO0FBQ3pDLE9BQU8sUUFBUSxNQUFNLHlCQUF5QixDQUFDO0FBRy9DLE9BQU8sWUFBWSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBR25ELE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdEUsT0FBTyxRQUFRLE1BQU0sc0JBQXNCLENBQUM7QUFFNUMsU0FBUyxlQUFlLENBQUMsRUFBRSxRQUFRLEVBQUU7SUFDbkMsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDO0FBQzVCLENBQUM7QUFTRCxJQUFxQixZQUFZLEdBQWpDLE1BQXFCLFlBQWEsU0FBUSxTQUE0QjtJQVNwRSxZQUFZLEtBQUssRUFBRSxPQUFPO1FBQ3hCLEtBQUssQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFHRCxRQUFRLENBQUMsSUFBSTtRQUNYLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ25CLENBQUM7SUFHRCxrQkFBa0IsQ0FBQyxNQUFNO1FBQ3ZCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBR0QsYUFBYSxDQUFDLENBQUM7UUFDYixJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDdkMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2Q7SUFDSCxDQUFDO0lBR0QsaUJBQWlCLENBQUMsTUFBTTtRQUN0QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztRQUNoRCxNQUFNLFNBQVMsR0FBRyxHQUFHLGFBQWEsa0JBQWtCLENBQUM7UUFDckQsT0FBTyxDQUNMLDZCQUNFLFNBQVMsRUFBRSxTQUFTLEVBQ3BCLE9BQU8sRUFBRSxlQUFlLEVBQ3hCLFdBQVcsRUFBRSxlQUFlLEVBQzVCLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFFWixvQkFBQyxRQUFRLElBQ1AsU0FBUyxtQ0FDVCxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsRUFDaEMsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQ25CLGNBQWMsRUFBRSxJQUFJLENBQUMsa0JBQWtCO2dCQUV2QyxvQkFBQyxNQUFNLElBQ0wsUUFBUSxxQkFDUixJQUFJLEVBQUMsYUFBYSxFQUNsQixJQUFJLHVCQUNKLFNBQVMsRUFBRSxJQUFJLENBQUMsYUFBYSxHQUM3QixDQUNPLENBQ1AsQ0FDUCxDQUFDO0lBQ0osQ0FBQztJQUdELGdCQUFnQixDQUFDLEVBQ2YsSUFBSSxFQUFFLEVBQ0osS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQ2pCLEdBQ0Y7UUFDQyxLQUFLLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztJQUN2QixDQUFDO0lBR0Qsa0JBQWtCLENBQUMsRUFDakIsSUFBSSxFQUFFLEVBQ0osS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQ2pCLEdBQ0Y7UUFDQyxLQUFLLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztJQUN0QixDQUFDO0lBRUQsT0FBTyxDQUFDLFNBQVM7UUFDZixNQUFNLEVBQ0osVUFBVSxFQUFFLEVBQUUsV0FBVyxFQUFFLE9BQU8sRUFBRSxHQUNyQyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDakIsTUFBTSxZQUFZLEdBQVUsRUFBRSxDQUFDO1FBQy9CLE1BQU0sT0FBTyxHQUFvQyxFQUFFLENBQUM7UUFDcEQsV0FBVyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUMzQixJQUFJLE1BQU0sQ0FBQyxRQUFRLEVBQUU7Z0JBQ25CLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7Z0JBQzFDLElBQUksTUFBTSxFQUFFO29CQUNWLE1BQU0sR0FBRyxHQUFRLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUU7d0JBQ2xCLFlBQVksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7cUJBQ3hCO29CQUNELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7aUJBQ3JDO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sQ0FDTCxvQkFBQyxJQUFJLElBQ0gsR0FBRyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQ2xCLFFBQVEsUUFDUixrQkFBa0IsUUFDbEIsU0FBUyxFQUFFLEdBQUcsU0FBUyxnQkFBZ0IsRUFDdkMsWUFBWSxFQUFFLFlBQVksRUFDMUIsUUFBUSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsRUFDL0IsVUFBVSxFQUFFLElBQUksQ0FBQyxrQkFBa0IsRUFDbkMsT0FBTyxFQUFFLGVBQWUsSUFFdkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FDcEIsQ0FDUixDQUFDO0lBQ0osQ0FBQztJQUVELFVBQVUsQ0FBQyxPQUF3QztRQUNqRCxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQzVDLG9CQUFDLElBQUksSUFBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNO1lBQzNCLGtDQUFPLE1BQU0sQ0FBUSxDQUNoQixDQUNSLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRixDQUFBO0FBekhRLHdCQUFXLEdBQUcsY0FBYyxDQUFDO0FBRTdCLHdCQUFXLEdBQUcsWUFBWSxDQUFDO0FBRXRCO0lBQVgsVUFBVTs0Q0FBUTtBQVVuQjtJQURDLFFBQVE7NENBR1I7QUFHRDtJQURDLFFBQVE7c0RBR1I7QUFHRDtJQURDLFFBQVE7aURBS1I7QUFHRDtJQURDLE1BQU07cURBR047QUE4QkQ7SUFEQyxNQUFNO29EQU9OO0FBR0Q7SUFEQyxNQUFNO3NEQU9OO0FBL0VrQixZQUFZO0lBRGhDLFFBQVE7R0FDWSxZQUFZLENBMEhoQztlQTFIb0IsWUFBWSIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaHVpaHVhd2svRG9jdW1lbnRzL29wdC9jaG9lcm9kb24tdWkvY29tcG9uZW50cy1wcm8vdGFibGUvcXVlcnktYmFyL0NvbHVtbkZpbHRlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCwgS2V5LCBSZWFjdEVsZW1lbnQsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGFjdGlvbiwgb2JzZXJ2YWJsZSB9IGZyb20gJ21vYngnO1xuaW1wb3J0IHsgb2JzZXJ2ZXIgfSBmcm9tICdtb2J4LXJlYWN0JztcbmltcG9ydCBNZW51LCB7IEl0ZW0gfSBmcm9tICdjaG9lcm9kb24tdWkvbGliL3JjLWNvbXBvbmVudHMvbWVudS9pbmRleCc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4uLy4uL2J1dHRvbi9CdXR0b24nO1xuaW1wb3J0IERyb3Bkb3duIGZyb20gJy4uLy4uL2Ryb3Bkb3duL0Ryb3Bkb3duJztcbmltcG9ydCB7IFNpemUgfSBmcm9tICcuLi8uLi9jb3JlL2VudW0nO1xuaW1wb3J0IHsgRnVuY1R5cGUgfSBmcm9tICcuLi8uLi9idXR0b24vZW51bSc7XG5pbXBvcnQgVGFibGVDb250ZXh0IGZyb20gJy4uL1RhYmxlQ29udGV4dCc7XG5pbXBvcnQgeyBnZXRDb2x1bW5LZXksIGdldEhlYWRlciB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IFBsYWNlbWVudHMgfSBmcm9tICcuLi8uLi9kcm9wZG93bi9lbnVtJztcbmltcG9ydCB7IENvbHVtblByb3BzIH0gZnJvbSAnLi4vQ29sdW1uJztcbmltcG9ydCB7IHN0b3BFdmVudCwgc3RvcFByb3BhZ2F0aW9uIH0gZnJvbSAnLi4vLi4vX3V0aWwvRXZlbnRNYW5hZ2VyJztcbmltcG9ydCBhdXRvYmluZCBmcm9tICcuLi8uLi9fdXRpbC9hdXRvYmluZCc7XG5cbmZ1bmN0aW9uIGhhbmRsZU1lbnVDbGljayh7IGRvbUV2ZW50IH0pIHtcbiAgZG9tRXZlbnQucHJldmVudERlZmF1bHQoKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb2x1bW5GaWx0ZXJQcm9wcyB7XG4gIHByZWZpeENscz86IHN0cmluZztcbiAgb25Db2x1bW5GaWx0ZXJDaGFuZ2U/OiAoaXRlbT86IGFueSkgPT4gdm9pZDtcbiAgZ2V0UG9wdXBDb250YWluZXI/OiAodHJpZ2dlck5vZGU/OiBFbGVtZW50KSA9PiBIVE1MRWxlbWVudDtcbn1cblxuQG9ic2VydmVyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb2x1bW5GaWx0ZXIgZXh0ZW5kcyBDb21wb25lbnQ8Q29sdW1uRmlsdGVyUHJvcHM+IHtcbiAgc3RhdGljIGRpc3BsYXlOYW1lID0gJ0NvbHVtbkZpbHRlcic7XG5cbiAgc3RhdGljIGNvbnRleHRUeXBlID0gVGFibGVDb250ZXh0O1xuXG4gIEBvYnNlcnZhYmxlIGhpZGRlbjtcblxuICBtZW51PzogTWVudSB8IG51bGw7XG5cbiAgY29uc3RydWN0b3IocHJvcHMsIGNvbnRleHQpIHtcbiAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XG4gICAgdGhpcy5zZXREcm9wRG93bkhpZGRlbih0cnVlKTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBzYXZlTWVudShub2RlKSB7XG4gICAgdGhpcy5tZW51ID0gbm9kZTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBoYW5kbGVIaWRkZW5DaGFuZ2UoaGlkZGVuKSB7XG4gICAgdGhpcy5zZXREcm9wRG93bkhpZGRlbihoaWRkZW4pO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGhhbmRsZUtleURvd24oZSkge1xuICAgIGlmICh0aGlzLm1lbnUgJiYgdGhpcy5tZW51Lm9uS2V5RG93bihlKSkge1xuICAgICAgc3RvcEV2ZW50KGUpO1xuICAgIH1cbiAgfVxuXG4gIEBhY3Rpb25cbiAgc2V0RHJvcERvd25IaWRkZW4oaGlkZGVuKSB7XG4gICAgdGhpcy5oaWRkZW4gPSBoaWRkZW47XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBwcmVmaXhDbHM6IHJvb3RQcmVmaXhDbHMgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcHJlZml4Q2xzID0gYCR7cm9vdFByZWZpeENsc30tY29sdW1ucy1jaG9vc2VyYDtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdlxuICAgICAgICBjbGFzc05hbWU9e3ByZWZpeENsc31cbiAgICAgICAgb25Gb2N1cz17c3RvcFByb3BhZ2F0aW9ufVxuICAgICAgICBvbk1vdXNlRG93bj17c3RvcFByb3BhZ2F0aW9ufVxuICAgICAgICB0YWJJbmRleD17LTF9XG4gICAgICA+XG4gICAgICAgIDxEcm9wZG93blxuICAgICAgICAgIHBsYWNlbWVudD17UGxhY2VtZW50cy5ib3R0b21SaWdodH1cbiAgICAgICAgICBvdmVybGF5PXt0aGlzLmdldE1lbnUocHJlZml4Q2xzKX1cbiAgICAgICAgICBoaWRkZW49e3RoaXMuaGlkZGVufVxuICAgICAgICAgIG9uSGlkZGVuQ2hhbmdlPXt0aGlzLmhhbmRsZUhpZGRlbkNoYW5nZX1cbiAgICAgICAgPlxuICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgIGZ1bmNUeXBlPXtGdW5jVHlwZS5mbGF0fVxuICAgICAgICAgICAgaWNvbj1cInZpZXdfY29sdW1uXCJcbiAgICAgICAgICAgIHNpemU9e1NpemUuc21hbGx9XG4gICAgICAgICAgICBvbktleURvd249e3RoaXMuaGFuZGxlS2V5RG93bn1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0Ryb3Bkb3duPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIEBhY3Rpb25cbiAgaGFuZGxlTWVudVNlbGVjdCh7XG4gICAgaXRlbToge1xuICAgICAgcHJvcHM6IHsgdmFsdWUgfSxcbiAgICB9LFxuICB9KSB7XG4gICAgdmFsdWUuaGlkZGVuID0gZmFsc2U7XG4gIH1cblxuICBAYWN0aW9uXG4gIGhhbmRsZU1lbnVVblNlbGVjdCh7XG4gICAgaXRlbToge1xuICAgICAgcHJvcHM6IHsgdmFsdWUgfSxcbiAgICB9LFxuICB9KSB7XG4gICAgdmFsdWUuaGlkZGVuID0gdHJ1ZTtcbiAgfVxuXG4gIGdldE1lbnUocHJlZml4Q2xzKSB7XG4gICAgY29uc3Qge1xuICAgICAgdGFibGVTdG9yZTogeyBsZWFmQ29sdW1ucywgZGF0YVNldCB9LFxuICAgIH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgY29uc3Qgc2VsZWN0ZWRLZXlzOiBLZXlbXSA9IFtdO1xuICAgIGNvbnN0IGNvbHVtbnM6IFtDb2x1bW5Qcm9wcywgUmVhY3ROb2RlLCBLZXldW10gPSBbXTtcbiAgICBsZWFmQ29sdW1ucy5mb3JFYWNoKGNvbHVtbiA9PiB7XG4gICAgICBpZiAoY29sdW1uLmhpZGVhYmxlKSB7XG4gICAgICAgIGNvbnN0IGhlYWRlciA9IGdldEhlYWRlcihjb2x1bW4sIGRhdGFTZXQpO1xuICAgICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgICAgY29uc3Qga2V5OiBLZXkgPSBnZXRDb2x1bW5LZXkoY29sdW1uKTtcbiAgICAgICAgICBpZiAoIWNvbHVtbi5oaWRkZW4pIHtcbiAgICAgICAgICAgIHNlbGVjdGVkS2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbHVtbnMucHVzaChbY29sdW1uLCBoZWFkZXIsIGtleV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNZW51XG4gICAgICAgIHJlZj17dGhpcy5zYXZlTWVudX1cbiAgICAgICAgbXVsdGlwbGVcbiAgICAgICAgZGVmYXVsdEFjdGl2ZUZpcnN0XG4gICAgICAgIHByZWZpeENscz17YCR7cHJlZml4Q2xzfS1kcm9wZG93bi1tZW51YH1cbiAgICAgICAgc2VsZWN0ZWRLZXlzPXtzZWxlY3RlZEtleXN9XG4gICAgICAgIG9uU2VsZWN0PXt0aGlzLmhhbmRsZU1lbnVTZWxlY3R9XG4gICAgICAgIG9uRGVzZWxlY3Q9e3RoaXMuaGFuZGxlTWVudVVuU2VsZWN0fVxuICAgICAgICBvbkNsaWNrPXtoYW5kbGVNZW51Q2xpY2t9XG4gICAgICA+XG4gICAgICAgIHt0aGlzLmdldE9wdGlvbnMoY29sdW1ucyl9XG4gICAgICA8L01lbnU+XG4gICAgKTtcbiAgfVxuXG4gIGdldE9wdGlvbnMoY29sdW1uczogW0NvbHVtblByb3BzLCBSZWFjdE5vZGUsIEtleV1bXSk6IFJlYWN0RWxlbWVudDxhbnk+W10ge1xuICAgIHJldHVybiBjb2x1bW5zLm1hcCgoW2NvbHVtbiwgaGVhZGVyLCBrZXldKSA9PiAoXG4gICAgICA8SXRlbSBrZXk9e2tleX0gdmFsdWU9e2NvbHVtbn0+XG4gICAgICAgIDxzcGFuPntoZWFkZXJ9PC9zcGFuPlxuICAgICAgPC9JdGVtPlxuICAgICkpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=