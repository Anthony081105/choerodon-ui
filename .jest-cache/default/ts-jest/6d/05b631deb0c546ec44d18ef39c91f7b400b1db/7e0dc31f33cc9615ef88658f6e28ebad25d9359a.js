/* tslint:disable jsx-no-multiline-js */
import React, { Component } from 'react';
import moment from 'moment';
import classNames from 'classnames';
import Button from '../button';
import Icon from '../icon';
import warning from '../_util/warning';
import interopDefault from '../_util/interopDefault';
import RangeCalendar from '../rc-components/calendar/RangeCalendar';
import RcDatePicker from '../rc-components/calendar/Picker';
import { getPrefixCls } from '../configure';
function getShowDateFromValue(value) {
    const [start, end] = value;
    // value could be an empty array, then we should not reset showDate
    if (!start && !end) {
        return;
    }
    const newEnd = end && end.isSame(start, 'month') ? end.clone().add(1, 'month') : end;
    return [start, newEnd];
}
function formatValue(value, format) {
    return (value && value.format(format)) || '';
}
function pickerValueAdapter(value) {
    if (!value) {
        return;
    }
    if (Array.isArray(value)) {
        return value;
    }
    return [value, value.clone().add(1, 'month')];
}
function isEmptyArray(arr) {
    if (Array.isArray(arr)) {
        return arr.length === 0 || arr.every(i => !i);
    }
    return false;
}
function fixLocale(value, localeCode) {
    if (!localeCode) {
        return;
    }
    if (!value || value.length === 0) {
        return;
    }
    if (value[0]) {
        value[0].locale(localeCode);
    }
    if (value[1]) {
        value[1].locale(localeCode);
    }
}
export default class RangePicker extends Component {
    constructor(props) {
        super(props);
        this.clearSelection = e => {
            e.preventDefault();
            e.stopPropagation();
            this.setState({ value: [] });
            this.handleChange([]);
        };
        this.clearHoverValue = () => this.setState({ hoverValue: [] });
        this.handleChange = (value) => {
            const props = this.props;
            if (!('value' in props)) {
                this.setState(({ showDate }) => ({
                    value,
                    showDate: getShowDateFromValue(value) || showDate,
                }));
            }
            props.onChange(value, [
                formatValue(value[0], props.format),
                formatValue(value[1], props.format),
            ]);
        };
        this.handleOpenChange = (open) => {
            if (!('open' in this.props)) {
                this.setState({ open });
            }
            if (open === false) {
                this.clearHoverValue();
            }
            const { onOpenChange } = this.props;
            if (onOpenChange) {
                onOpenChange(open);
            }
        };
        this.handleShowDateChange = (showDate) => this.setState({ showDate });
        this.handleHoverChange = (hoverValue) => this.setState({ hoverValue });
        this.handleRangeMouseLeave = () => {
            const { open } = this.state;
            if (open) {
                this.clearHoverValue();
            }
        };
        this.handleCalendarInputSelect = (value) => {
            if (!value[0]) {
                return;
            }
            this.setState(({ showDate }) => ({
                value,
                showDate: getShowDateFromValue(value) || showDate,
            }));
        };
        this.handleRangeClick = (value) => {
            if (typeof value === 'function') {
                value = value();
            }
            this.setValue(value, true);
            const { onOk } = this.props;
            if (onOk) {
                onOk(value);
            }
        };
        this.savePicker = (node) => {
            this.picker = node;
        };
        this.renderFooter = (...args) => {
            const { ranges, renderExtraFooter } = this.props;
            const prefixCls = this.getPrefixCls();
            if (!ranges && !renderExtraFooter) {
                return null;
            }
            const customFooter = renderExtraFooter ? (React.createElement("div", { className: `${prefixCls}-footer-extra`, key: "extra" }, renderExtraFooter(...args))) : null;
            const operations = Object.keys(ranges || {}).map(range => {
                const value = ranges[range];
                return (React.createElement("a", { key: range, onClick: () => this.handleRangeClick(value), onMouseEnter: () => this.setState({ hoverValue: value }), onMouseLeave: this.handleRangeMouseLeave }, range));
            });
            const rangeNode = (React.createElement("div", { className: `${prefixCls}-footer-extra ${prefixCls}-range-quick-selector`, key: "range" }, operations));
            return [rangeNode, customFooter];
        };
        const value = props.value || props.defaultValue || [];
        if ((value[0] && !interopDefault(moment).isMoment(value[0])) ||
            (value[1] && !interopDefault(moment).isMoment(value[1]))) {
            throw new Error('The value/defaultValue of RangePicker must be a moment object array');
        }
        const pickerValue = !value || isEmptyArray(value) ? props.defaultPickerValue : value;
        this.state = {
            value,
            showDate: pickerValueAdapter(pickerValue || interopDefault(moment)()),
            open: props.open,
            hoverValue: [],
        };
    }
    componentWillReceiveProps(nextProps) {
        if ('value' in nextProps) {
            const { showDate } = this.state;
            const value = nextProps.value || [];
            this.setState({
                value,
                showDate: getShowDateFromValue(value) || showDate,
            });
        }
        if ('open' in nextProps) {
            this.setState({
                open: nextProps.open,
            });
        }
    }
    setValue(value, hidePanel) {
        this.handleChange(value);
        const { props } = this;
        if ((hidePanel || !props.showTime) && !('open' in props)) {
            this.setState({ open: false });
        }
    }
    focus() {
        this.picker.focus();
    }
    blur() {
        this.picker.blur();
    }
    getPrefixCls() {
        const { prefixCls } = this.props;
        return getPrefixCls('calendar', prefixCls);
    }
    render() {
        const { state, props } = this;
        const { value, showDate, hoverValue, open } = state;
        const { popupStyle, style, disabledDate, disabledTime, showTime, showToday, ranges, onOk, locale, localeCode, format, dateRender, onCalendarChange, } = props;
        fixLocale(value, localeCode);
        fixLocale(showDate, localeCode);
        warning(!('onOK' in props), 'It should be `RangePicker[onOk]`, instead of `onOK`!');
        const prefixCls = this.getPrefixCls();
        const calendarClassName = classNames({
            [`${prefixCls}-time`]: showTime,
            [`${prefixCls}-range-with-ranges`]: ranges,
        });
        // 需要选择时间时，点击 ok 时才触发 onChange
        const pickerChangeHandler = {
            onChange: this.handleChange,
        };
        let calendarProps = {
            onOk: this.handleChange,
        };
        if (props.timePicker) {
            pickerChangeHandler.onChange = changedValue => this.handleChange(changedValue);
        }
        else {
            calendarProps = {};
        }
        if ('mode' in props) {
            calendarProps.mode = props.mode;
        }
        const startPlaceholder = 'placeholder' in props ? props.placeholder[0] : locale.lang.rangePlaceholder[0];
        const endPlaceholder = 'placeholder' in props ? props.placeholder[1] : locale.lang.rangePlaceholder[1];
        const calendar = (React.createElement(RangeCalendar, Object.assign({}, calendarProps, { onChange: onCalendarChange, format: format, prefixCls: prefixCls, className: calendarClassName, renderFooter: this.renderFooter, timePicker: props.timePicker, disabledDate: disabledDate, disabledTime: disabledTime, dateInputPlaceholder: [startPlaceholder, endPlaceholder], locale: locale.lang, onOk: onOk, dateRender: dateRender, value: showDate, onValueChange: this.handleShowDateChange, hoverValue: hoverValue, onHoverChange: this.handleHoverChange, onPanelChange: props.onPanelChange, showToday: showToday, onInputSelect: this.handleCalendarInputSelect })));
        // default width for showTime
        const pickerStyle = {};
        if (props.showTime) {
            pickerStyle.width = (style && style.width) || 350;
        }
        const clearIcon = !props.disabled && props.allowClear && value && (value[0] || value[1]) ? (React.createElement(Button, { shape: "circle", size: "small" /* small */, onClick: this.clearSelection, className: `${prefixCls}-picker-clear`, icon: "close" })) : null;
        const input = ({ value: inputValue }) => {
            const start = inputValue[0];
            const end = inputValue[1];
            return (React.createElement("span", { className: `${prefixCls}-range-picker ${props.pickerWrapperInputClass}` },
                React.createElement("span", { className: props.pickerInputClass },
                    React.createElement("input", { disabled: props.disabled, readOnly: true, value: (start && start.format(props.format)) || '', placeholder: startPlaceholder, className: `${prefixCls}-range-picker-input`, tabIndex: -1 }),
                    React.createElement("span", { className: `${prefixCls}-range-picker-separator` }, " ~ "),
                    React.createElement("input", { disabled: props.disabled, readOnly: true, value: (end && end.format(props.format)) || '', placeholder: endPlaceholder, className: `${prefixCls}-range-picker-input`, tabIndex: -1 }),
                    clearIcon,
                    React.createElement("span", { className: `${props.inputPrefixCls}-suffix` },
                        React.createElement(Icon, { type: "date_range", className: `${prefixCls}-picker-icon` })))));
        };
        return (React.createElement("span", { ref: this.savePicker, id: props.id, className: classNames(props.className, props.pickerClass), style: { ...style, ...pickerStyle }, tabIndex: props.disabled ? -1 : 0, onFocus: props.onFocus, onBlur: props.onBlur },
            React.createElement(RcDatePicker, Object.assign({}, props, pickerChangeHandler, { calendar: calendar, value: value, open: open, onOpenChange: this.handleOpenChange, prefixCls: `${prefixCls}-picker-container`, style: popupStyle }), input)));
    }
}
RangePicker.displayName = 'RangePicker';
RangePicker.defaultProps = {
    allowClear: true,
    showToday: false,
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvZGF0ZS1waWNrZXIvUmFuZ2VQaWNrZXIudHN4IiwibWFwcGluZ3MiOiJBQUFBLHdDQUF3QztBQUN4QyxPQUFPLEtBQUssRUFBRSxFQUFFLFNBQVMsRUFBcUIsTUFBTSxPQUFPLENBQUM7QUFDNUQsT0FBTyxNQUFrQixNQUFNLFFBQVEsQ0FBQztBQUN4QyxPQUFPLFVBQVUsTUFBTSxZQUFZLENBQUM7QUFDcEMsT0FBTyxNQUFNLE1BQU0sV0FBVyxDQUFDO0FBQy9CLE9BQU8sSUFBSSxNQUFNLFNBQVMsQ0FBQztBQUMzQixPQUFPLE9BQU8sTUFBTSxrQkFBa0IsQ0FBQztBQUN2QyxPQUFPLGNBQWMsTUFBTSx5QkFBeUIsQ0FBQztBQUVyRCxPQUFPLGFBQWEsTUFBTSx5Q0FBeUMsQ0FBQztBQUNwRSxPQUFPLFlBQVksTUFBTSxrQ0FBa0MsQ0FBQztBQUU1RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBUzVDLFNBQVMsb0JBQW9CLENBQUMsS0FBdUI7SUFDbkQsTUFBTSxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUM7SUFDM0IsbUVBQW1FO0lBQ25FLElBQUksQ0FBQyxLQUFLLElBQUksQ0FBQyxHQUFHLEVBQUU7UUFDbEIsT0FBTztLQUNSO0lBQ0QsTUFBTSxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO0lBQ3JGLE9BQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFxQixDQUFDO0FBQzdDLENBQUM7QUFFRCxTQUFTLFdBQVcsQ0FBQyxLQUF5QixFQUFFLE1BQWM7SUFDNUQsT0FBTyxDQUFDLEtBQUssSUFBSSxLQUFL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Q0FBQyxDQUFDLEVBQ2pDLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUN0QixNQUFNLEVBQUUsS0FBSyxDQUFDLE1BQU07WUFFcEIsb0JBQUMsWUFBWSxvQkFDUCxLQUFLLEVBQ0wsbUJBQW1CLElBQ3ZCLFFBQVEsRUFBRSxRQUFRLEVBQ2xCLEtBQUssRUFBRSxLQUFLLEVBQ1osSUFBSSxFQUFFLElBQUksRUFDVixZQUFZLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixFQUNuQyxTQUFTLEVBQUUsR0FBRyxTQUFTLG1CQUFtQixFQUMxQyxLQUFLLEVBQUUsVUFBVSxLQUVoQixLQUFLLENBQ08sQ0FDVixDQUNSLENBQUM7SUFDSixDQUFDOztBQWpVTSx1QkFBVyxHQUFHLGFBQWEsQ0FBQztBQUU1Qix3QkFBWSxHQUFHO0lBQ3BCLFVBQVUsRUFBRSxJQUFJO0lBQ2hCLFNBQVMsRUFBRSxLQUFLO0NBQ2pCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvZGF0ZS1waWNrZXIvUmFuZ2VQaWNrZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIHRzbGludDpkaXNhYmxlIGpzeC1uby1tdWx0aWxpbmUtanMgKi9cbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIE1vdXNlRXZlbnRIYW5kbGVyIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IG1vbWVudCwgeyBNb21lbnQgfSBmcm9tICdtb21lbnQnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4uL2J1dHRvbic7XG5pbXBvcnQgSWNvbiBmcm9tICcuLi9pY29uJztcbmltcG9ydCB3YXJuaW5nIGZyb20gJy4uL191dGlsL3dhcm5pbmcnO1xuaW1wb3J0IGludGVyb3BEZWZhdWx0IGZyb20gJy4uL191dGlsL2ludGVyb3BEZWZhdWx0JztcbmltcG9ydCB7IFJhbmdlUGlja2VyUHJlc2V0UmFuZ2UsIFJhbmdlUGlja2VyVmFsdWUgfSBmcm9tICcuL2ludGVyZmFjZSc7XG5pbXBvcnQgUmFuZ2VDYWxlbmRhciBmcm9tICcuLi9yYy1jb21wb25lbnRzL2NhbGVuZGFyL1JhbmdlQ2FsZW5kYXInO1xuaW1wb3J0IFJjRGF0ZVBpY2tlciBmcm9tICcuLi9yYy1jb21wb25lbnRzL2NhbGVuZGFyL1BpY2tlcic7XG5pbXBvcnQgeyBTaXplIH0gZnJvbSAnLi4vX3V0aWwvZW51bSc7XG5pbXBvcnQgeyBnZXRQcmVmaXhDbHMgfSBmcm9tICcuLi9jb25maWd1cmUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJhbmdlUGlja2VyU3RhdGUge1xuICB2YWx1ZT86IFJhbmdlUGlja2VyVmFsdWU7XG4gIHNob3dEYXRlPzogUmFuZ2VQaWNrZXJWYWx1ZTtcbiAgb3Blbj86IGJvb2xlYW47XG4gIGhvdmVyVmFsdWU/OiBSYW5nZVBpY2tlclZhbHVlO1xufVxuXG5mdW5jdGlvbiBnZXRTaG93RGF0ZUZyb21WYWx1ZSh2YWx1ZTogUmFuZ2VQaWNrZXJWYWx1ZSkge1xuICBjb25zdCBbc3RhcnQsIGVuZF0gPSB2YWx1ZTtcbiAgLy8gdmFsdWUgY291bGQgYmUgYW4gZW1wdHkgYXJyYXksIHRoZW4gd2Ugc2hvdWxkIG5vdCByZXNldCBzaG93RGF0ZVxuICBpZiAoIXN0YXJ0ICYmICFlbmQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgbmV3RW5kID0gZW5kICYmIGVuZC5pc1NhbWUoc3RhcnQsICdtb250aCcpID8gZW5kLmNsb25lKCkuYWRkKDEsICdtb250aCcpIDogZW5kO1xuICByZXR1cm4gW3N0YXJ0LCBuZXdFbmRdIGFzIFJhbmdlUGlja2VyVmFsdWU7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdFZhbHVlKHZhbHVlOiBNb21lbnQgfCB1bmRlZmluZWQsIGZvcm1hdDogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuICh2YWx1ZSAmJiB2YWx1ZS5mb3JtYXQoZm9ybWF0KSkgfHwgJyc7XG59XG5cbmZ1bmN0aW9uIHBpY2tlclZhbHVlQWRhcHRlcih2YWx1ZT86IE1vbWVudCB8IFJhbmdlUGlja2VyVmFsdWUpOiBSYW5nZVBpY2tlclZhbHVlIHwgdW5kZWZpbmVkIHtcbiAgaWYgKCF2YWx1ZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIFt2YWx1ZSwgdmFsdWUuY2xvbmUoKS5hZGQoMSwgJ21vbnRoJyldO1xufVxuXG5mdW5jdGlvbiBpc0VtcHR5QXJyYXkoYXJyOiBhbnkpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkge1xuICAgIHJldHVybiBhcnIubGVuZ3RoID09PSAwIHx8IGFyci5ldmVyeShpID0+ICFpKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGZpeExvY2FsZSh2YWx1ZTogUmFuZ2VQaWNrZXJWYWx1ZSB8IHVuZGVmaW5lZCwgbG9jYWxlQ29kZTogc3RyaW5nKSB7XG4gIGlmICghbG9jYWxlQ29kZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoIXZhbHVlIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAodmFsdWVbMF0pIHtcbiAgICB2YWx1ZVswXSEubG9jYWxlKGxvY2FsZUNvZGUpO1xuICB9XG4gIGlmICh2YWx1ZVsxXSkge1xuICAgIHZhbHVlWzFdIS5sb2NhbGUobG9jYWxlQ29kZSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmFuZ2VQaWNrZXIgZXh0ZW5kcyBDb21wb25lbnQ8YW55LCBSYW5nZVBpY2tlclN0YXRlPiB7XG4gIHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdSYW5nZVBpY2tlcic7XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBhbGxvd0NsZWFyOiB0cnVlLFxuICAgIHNob3dUb2RheTogZmFsc2UsXG4gIH07XG5cbiAgcHJpdmF0ZSBwaWNrZXI6IEhUTUxTcGFuRWxlbWVudDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogYW55KSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIGNvbnN0IHZhbHVlID0gcHJvcHMudmFsdWUgfHwgcHJvcHMuZGVmYXVsdFZhbHVlIHx8IFtdO1xuICAgIGlmIChcbiAgICAgICh2YWx1ZVswXSAmJiAhaW50ZXJvcERlZmF1bHQobW9tZW50KS5pc01vbWVudCh2YWx1ZVswXSkpIHx8XG4gICAgICAodmFsdWVbMV0gJiYgIWludGVyb3BEZWZhdWx0KG1vbWVudCkuaXNNb21lbnQodmFsdWVbMV0pKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgdmFsdWUvZGVmYXVsdFZhbHVlIG9mIFJhbmdlUGlja2VyIG11c3QgYmUgYSBtb21lbnQgb2JqZWN0IGFycmF5Jyk7XG4gICAgfVxuICAgIGNvbnN0IHBpY2tlclZhbHVlID0gIXZhbHVlIHx8IGlzRW1wdHlBcnJheSh2YWx1ZSkgPyBwcm9wcy5kZWZhdWx0UGlja2VyVmFsdWUgOiB2YWx1ZTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdmFsdWUsXG4gICAgICBzaG93RGF0ZTogcGlja2VyVmFsdWVBZGFwdGVyKHBpY2tlclZhbHVlIHx8IGludGVyb3BEZWZhdWx0KG1vbWVudCkoKSksXG4gICAgICBvcGVuOiBwcm9wcy5vcGVuLFxuICAgICAgaG92ZXJWYWx1ZTogW10sXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBhbnkpIHtcbiAgICBpZiAoJ3ZhbHVlJyBpbiBuZXh0UHJvcHMpIHtcbiAgICAgIGNvbnN0IHsgc2hvd0RhdGUgfSA9IHRoaXMuc3RhdGU7XG4gICAgICBjb25zdCB2YWx1ZSA9IG5leHRQcm9wcy52YWx1ZSB8fCBbXTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB2YWx1ZSxcbiAgICAgICAgc2hvd0RhdGU6IGdldFNob3dEYXRlRnJvbVZhbHVlKHZhbHVlKSB8fCBzaG93RGF0ZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoJ29wZW4nIGluIG5leHRQcm9wcykge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIG9wZW46IG5leHRQcm9wcy5vcGVuLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJTZWxlY3Rpb246IE1vdXNlRXZlbnRIYW5kbGVyPEhUTUxFbGVtZW50PiA9IGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuc2V0U3RhdGUoeyB2YWx1ZTogW10gfSk7XG4gICAgdGhpcy5oYW5kbGVDaGFuZ2UoW10pO1xuICB9O1xuXG4gIGNsZWFySG92ZXJWYWx1ZSA9ICgpID0+IHRoaXMuc2V0U3RhdGUoeyBob3ZlclZhbHVlOiBbXSB9KTtcblxuICBoYW5kbGVDaGFuZ2UgPSAodmFsdWU6IFJhbmdlUGlja2VyVmFsdWUpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgaWYgKCEoJ3ZhbHVlJyBpbiBwcm9wcykpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHsgc2hvd0RhdGUgfSkgPT4gKHtcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIHNob3dEYXRlOiBnZXRTaG93RGF0ZUZyb21WYWx1ZSh2YWx1ZSkgfHwgc2hvd0RhdGUsXG4gICAgICB9KSk7XG4gICAgfVxuICAgIHByb3BzLm9uQ2hhbmdlKHZhbHVlLCBbXG4gICAgICBmb3JtYXRWYWx1ZSh2YWx1ZVswXSwgcHJvcHMuZm9ybWF0KSxcbiAgICAgIGZvcm1hdFZhbHVlKHZhbHVlWzFdLCBwcm9wcy5mb3JtYXQpLFxuICAgIF0pO1xuICB9O1xuXG4gIGhhbmRsZU9wZW5DaGFuZ2UgPSAob3BlbjogYm9vbGVhbikgPT4ge1xuICAgIGlmICghKCdvcGVuJyBpbiB0aGlzLnByb3BzKSkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW4gfSk7XG4gICAgfVxuXG4gICAgaWYgKG9wZW4gPT09IGZhbHNlKSB7XG4gICAgICB0aGlzLmNsZWFySG92ZXJWYWx1ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgb25PcGVuQ2hhbmdlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmIChvbk9wZW5DaGFuZ2UpIHtcbiAgICAgIG9uT3BlbkNoYW5nZShvcGVuKTtcbiAgICB9XG4gIH07XG5cbiAgaGFuZGxlU2hvd0RhdGVDaGFuZ2UgPSAoc2hvd0RhdGU6IFJhbmdlUGlja2VyVmFsdWUpID0+IHRoaXMuc2V0U3RhdGUoeyBzaG93RGF0ZSB9KTtcblxuICBoYW5kbGVIb3ZlckNoYW5nZSA9IChob3ZlclZhbHVlOiBhbnkpID0+IHRoaXMuc2V0U3RhdGUoeyBob3ZlclZhbHVlIH0pO1xuXG4gIGhhbmRsZVJhbmdlTW91c2VMZWF2ZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IG9wZW4gfSA9IHRoaXMuc3RhdGU7XG4gICAgaWYgKG9wZW4pIHtcbiAgICAgIHRoaXMuY2xlYXJIb3ZlclZhbHVlKCk7XG4gICAgfVxuICB9O1xuXG4gIGhhbmRsZUNhbGVuZGFySW5wdXRTZWxlY3QgPSAodmFsdWU6IFJhbmdlUGlja2VyVmFsdWUpID0+IHtcbiAgICBpZiAoIXZhbHVlWzBdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoKHsgc2hvd0RhdGUgfSkgPT4gKHtcbiAgICAgIHZhbHVlLFxuICAgICAgc2hvd0RhdGU6IGdldFNob3dEYXRlRnJvbVZhbHVlKHZhbHVlKSB8fCBzaG93RGF0ZSxcbiAgICB9KSk7XG4gIH07XG5cbiAgaGFuZGxlUmFuZ2VDbGljayA9ICh2YWx1ZTogUmFuZ2VQaWNrZXJQcmVzZXRSYW5nZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHZhbHVlID0gdmFsdWUoKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFZhbHVlKHZhbHVlLCB0cnVlKTtcblxuICAgIGNvbnN0IHsgb25PayB9ID0gdGhpcy5wcm9wcztcbiAgICBpZiAob25Paykge1xuICAgICAgb25Payh2YWx1ZSk7XG4gICAgfVxuICB9O1xuXG4gIHNldFZhbHVlKHZhbHVlOiBSYW5nZVBpY2tlclZhbHVlLCBoaWRlUGFuZWw/OiBib29sZWFuKSB7XG4gICAgdGhpcy5oYW5kbGVDaGFuZ2UodmFsdWUpO1xuICAgIGNvbnN0IHsgcHJvcHMgfSA9IHRoaXM7XG4gICAgaWYgKChoaWRlUGFuZWwgfHwgIXByb3BzLnNob3dUaW1lKSAmJiAhKCdvcGVuJyBpbiBwcm9wcykpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuOiBmYWxzZSB9KTtcbiAgICB9XG4gIH1cblxuICBmb2N1cygpIHtcbiAgICB0aGlzLnBpY2tlci5mb2N1cygpO1xuICB9XG5cbiAgYmx1cigpIHtcbiAgICB0aGlzLnBpY2tlci5ibHVyKCk7XG4gIH1cblxuICBzYXZlUGlja2VyID0gKG5vZGU6IEhUTUxTcGFuRWxlbWVudCkgPT4ge1xuICAgIHRoaXMucGlja2VyID0gbm9kZTtcbiAgfTtcblxuICByZW5kZXJGb290ZXIgPSAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICBjb25zdCB7IHJhbmdlcywgcmVuZGVyRXh0cmFGb290ZXIgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcHJlZml4Q2xzID0gdGhpcy5nZXRQcmVmaXhDbHMoKTtcbiAgICBpZiAoIXJhbmdlcyAmJiAhcmVuZGVyRXh0cmFGb290ZXIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBjdXN0b21Gb290ZXIgPSByZW5kZXJFeHRyYUZvb3RlciA/IChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LWZvb3Rlci1leHRyYWB9IGtleT1cImV4dHJhXCI+XG4gICAgICAgIHtyZW5kZXJFeHRyYUZvb3RlciguLi5hcmdzKX1cbiAgICAgIDwvZGl2PlxuICAgICkgOiBudWxsO1xuICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBPYmplY3Qua2V5cyhyYW5nZXMgfHwge30pLm1hcChyYW5nZSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJhbmdlc1tyYW5nZV07XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8YVxuICAgICAgICAgIGtleT17cmFuZ2V9XG4gICAgICAgICAgb25DbGljaz17KCkgPT4gdGhpcy5oYW5kbGVSYW5nZUNsaWNrKHZhbHVlKX1cbiAgICAgICAgICBvbk1vdXNlRW50ZXI9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBob3ZlclZhbHVlOiB2YWx1ZSB9KX1cbiAgICAgICAgICBvbk1vdXNlTGVhdmU9e3RoaXMuaGFuZGxlUmFuZ2VNb3VzZUxlYXZlfVxuICAgICAgICA+XG4gICAgICAgICAge3JhbmdlfVxuICAgICAgICA8L2E+XG4gICAgICApO1xuICAgIH0pO1xuICAgIGNvbnN0IHJhbmdlTm9kZSA9IChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LWZvb3Rlci1leHRyYSAke3ByZWZpeENsc30tcmFuZ2UtcXVpY2stc2VsZWN0b3JgfSBrZXk9XCJyYW5nZVwiPlxuICAgICAgICB7b3BlcmF0aW9uc31cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gICAgcmV0dXJuIFtyYW5nZU5vZGUsIGN1c3RvbUZvb3Rlcl07XG4gIH07XG5cbiAgZ2V0UHJlZml4Q2xzKCkge1xuICAgIGNvbnN0IHsgcHJlZml4Q2xzIH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiBnZXRQcmVmaXhDbHMoJ2NhbGVuZGFyJywgcHJlZml4Q2xzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHN0YXRlLCBwcm9wcyB9ID0gdGhpcztcbiAgICBjb25zdCB7IHZhbHVlLCBzaG93RGF0ZSwgaG92ZXJWYWx1ZSwgb3BlbiB9ID0gc3RhdGU7XG4gICAgY29uc3Qge1xuICAgICAgcG9wdXBTdHlsZSxcbiAgICAgIHN0eWxlLFxuICAgICAgZGlzYWJsZWREYXRlLFxuICAgICAgZGlzYWJsZWRUaW1lLFxuICAgICAgc2hvd1RpbWUsXG4gICAgICBzaG93VG9kYXksXG4gICAgICByYW5nZXMsXG4gICAgICBvbk9rLFxuICAgICAgbG9jYWxlLFxuICAgICAgbG9jYWxlQ29kZSxcbiAgICAgIGZvcm1hdCxcbiAgICAgIGRhdGVSZW5kZXIsXG4gICAgICBvbkNhbGVuZGFyQ2hhbmdlLFxuICAgIH0gPSBwcm9wcztcblxuICAgIGZpeExvY2FsZSh2YWx1ZSwgbG9jYWxlQ29kZSk7XG4gICAgZml4TG9jYWxlKHNob3dEYXRlLCBsb2NhbGVDb2RlKTtcblxuICAgIHdhcm5pbmcoISgnb25PSycgaW4gcHJvcHMpLCAnSXQgc2hvdWxkIGJlIGBSYW5nZVBpY2tlcltvbk9rXWAsIGluc3RlYWQgb2YgYG9uT0tgIScpO1xuXG4gICAgY29uc3QgcHJlZml4Q2xzID0gdGhpcy5nZXRQcmVmaXhDbHMoKTtcbiAgICBjb25zdCBjYWxlbmRhckNsYXNzTmFtZSA9IGNsYXNzTmFtZXMoe1xuICAgICAgW2Ake3ByZWZpeENsc30tdGltZWBdOiBzaG93VGltZSxcbiAgICAgIFtgJHtwcmVmaXhDbHN9LXJhbmdlLXdpdGgtcmFuZ2VzYF06IHJhbmdlcyxcbiAgICB9KTtcblxuICAgIC8vIOmcgOimgemAieaLqeaXtumXtOaXtu+8jOeCueWHuyBvayDml7bmiY3op6blj5Egb25DaGFuZ2VcbiAgICBjb25zdCBwaWNrZXJDaGFuZ2VIYW5kbGVyID0ge1xuICAgICAgb25DaGFuZ2U6IHRoaXMuaGFuZGxlQ2hhbmdlLFxuICAgIH07XG4gICAgbGV0IGNhbGVuZGFyUHJvcHM6IGFueSA9IHtcbiAgICAgIG9uT2s6IHRoaXMuaGFuZGxlQ2hhbmdlLFxuICAgIH07XG4gICAgaWYgKHByb3BzLnRpbWVQaWNrZXIpIHtcbiAgICAgIHBpY2tlckNoYW5nZUhhbmRsZXIub25DaGFuZ2UgPSBjaGFuZ2VkVmFsdWUgPT4gdGhpcy5oYW5kbGVDaGFuZ2UoY2hhbmdlZFZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsZW5kYXJQcm9wcyA9IHt9O1xuICAgIH1cbiAgICBpZiAoJ21vZGUnIGluIHByb3BzKSB7XG4gICAgICBjYWxlbmRhclByb3BzLm1vZGUgPSBwcm9wcy5tb2RlO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0UGxhY2Vob2xkZXIgPVxuICAgICAgJ3BsYWNlaG9sZGVyJyBpbiBwcm9wcyA/IHByb3BzLnBsYWNlaG9sZGVyWzBdIDogbG9jYWxlLmxhbmcucmFuZ2VQbGFjZWhvbGRlclswXTtcbiAgICBjb25zdCBlbmRQbGFjZWhvbGRlciA9XG4gICAgICAncGxhY2Vob2xkZXInIGluIHByb3BzID8gcHJvcHMucGxhY2Vob2xkZXJbMV0gOiBsb2NhbGUubGFuZy5yYW5nZVBsYWNlaG9sZGVyWzFdO1xuXG4gICAgY29uc3QgY2FsZW5kYXIgPSAoXG4gICAgICA8UmFuZ2VDYWxlbmRhclxuICAgICAgICB7Li4uY2FsZW5kYXJQcm9wc31cbiAgICAgICAgb25DaGFuZ2U9e29uQ2FsZW5kYXJDaGFuZ2V9XG4gICAgICAgIGZvcm1hdD17Zm9ybWF0fVxuICAgICAgICBwcmVmaXhDbHM9e3ByZWZpeENsc31cbiAgICAgICAgY2xhc3NOYW1lPXtjYWxlbmRhckNsYXNzTmFtZX1cbiAgICAgICAgcmVuZGVyRm9vdGVyPXt0aGlzLnJlbmRlckZvb3Rlcn1cbiAgICAgICAgdGltZVBpY2tlcj17cHJvcHMudGltZVBpY2tlcn1cbiAgICAgICAgZGlzYWJsZWREYXRlPXtkaXNhYmxlZERhdGV9XG4gICAgICAgIGRpc2FibGVkVGltZT17ZGlzYWJsZWRUaW1lfVxuICAgICAgICBkYXRlSW5wdXRQbGFjZWhvbGRlcj17W3N0YXJ0UGxhY2Vob2xkZXIsIGVuZFBsYWNlaG9sZGVyXX1cbiAgICAgICAgbG9jYWxlPXtsb2NhbGUubGFuZ31cbiAgICAgICAgb25Paz17b25Pa31cbiAgICAgICAgZGF0ZVJlbmRlcj17ZGF0ZVJlbmRlcn1cbiAgICAgICAgdmFsdWU9e3Nob3dEYXRlfVxuICAgICAgICBvblZhbHVlQ2hhbmdlPXt0aGlzLmhhbmRsZVNob3dEYXRlQ2hhbmdlfVxuICAgICAgICBob3ZlclZhbHVlPXtob3ZlclZhbHVlfVxuICAgICAgICBvbkhvdmVyQ2hhbmdlPXt0aGlzLmhhbmRsZUhvdmVyQ2hhbmdlfVxuICAgICAgICBvblBhbmVsQ2hhbmdlPXtwcm9wcy5vblBhbmVsQ2hhbmdlfVxuICAgICAgICBzaG93VG9kYXk9e3Nob3dUb2RheX1cbiAgICAgICAgb25JbnB1dFNlbGVjdD17dGhpcy5oYW5kbGVDYWxlbmRhcklucHV0U2VsZWN0fVxuICAgICAgLz5cbiAgICApO1xuXG4gICAgLy8gZGVmYXVsdCB3aWR0aCBmb3Igc2hvd1RpbWVcbiAgICBjb25zdCBwaWNrZXJTdHlsZSA9IHt9IGFzIGFueTtcbiAgICBpZiAocHJvcHMuc2hvd1RpbWUpIHtcbiAgICAgIHBpY2tlclN0eWxlLndpZHRoID0gKHN0eWxlICYmIHN0eWxlLndpZHRoKSB8fCAzNTA7XG4gICAgfVxuXG4gICAgY29uc3QgY2xlYXJJY29uID1cbiAgICAgICFwcm9wcy5kaXNhYmxlZCAmJiBwcm9wcy5hbGxvd0NsZWFyICYmIHZhbHVlICYmICh2YWx1ZVswXSB8fCB2YWx1ZVsxXSkgPyAoXG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBzaGFwZT1cImNpcmNsZVwiXG4gICAgICAgICAgc2l6ZT17U2l6ZS5zbWFsbH1cbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLmNsZWFyU2VsZWN0aW9ufVxuICAgICAgICAgIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1waWNrZXItY2xlYXJgfVxuICAgICAgICAgIGljb249XCJjbG9zZVwiXG4gICAgICAgIC8+XG4gICAgICApIDogbnVsbDtcblxuICAgIGNvbnN0IGlucHV0ID0gKHsgdmFsdWU6IGlucHV0VmFsdWUgfTogeyB2YWx1ZTogYW55IH0pID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gaW5wdXRWYWx1ZVswXTtcbiAgICAgIGNvbnN0IGVuZCA9IGlucHV0VmFsdWVbMV07XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tcmFuZ2UtcGlja2VyICR7cHJvcHMucGlja2VyV3JhcHBlcklucHV0Q2xhc3N9YH0+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtwcm9wcy5waWNrZXJJbnB1dENsYXNzfT5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkaXNhYmxlZD17cHJvcHMuZGlzYWJsZWR9XG4gICAgICAgICAgICAgIHJlYWRPbmx5XG4gICAgICAgICAgICAgIHZhbHVlPXsoc3RhcnQgJiYgc3RhcnQuZm9ybWF0KHByb3BzLmZvcm1hdCkpIHx8ICcnfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17c3RhcnRQbGFjZWhvbGRlcn1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXJhbmdlLXBpY2tlci1pbnB1dGB9XG4gICAgICAgICAgICAgIHRhYkluZGV4PXstMX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tcmFuZ2UtcGlja2VyLXNlcGFyYXRvcmB9PiB+IDwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICBkaXNhYmxlZD17cHJvcHMuZGlzYWJsZWR9XG4gICAgICAgICAgICAgIHJlYWRPbmx5XG4gICAgICAgICAgICAgIHZhbHVlPXsoZW5kICYmIGVuZC5mb3JtYXQocHJvcHMuZm9ybWF0KSkgfHwgJyd9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtlbmRQbGFjZWhvbGRlcn1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXJhbmdlLXBpY2tlci1pbnB1dGB9XG4gICAgICAgICAgICAgIHRhYkluZGV4PXstMX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB7Y2xlYXJJY29ufVxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtgJHtwcm9wcy5pbnB1dFByZWZpeENsc30tc3VmZml4YH0+XG4gICAgICAgICAgICAgIDxJY29uIHR5cGU9XCJkYXRlX3JhbmdlXCIgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXBpY2tlci1pY29uYH0gLz5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICk7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8c3BhblxuICAgICAgICByZWY9e3RoaXMuc2F2ZVBpY2tlcn1cbiAgICAgICAgaWQ9e3Byb3BzLmlkfVxuICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMocHJvcHMuY2xhc3NOYW1lLCBwcm9wcy5waWNrZXJDbGFzcyl9XG4gICAgICAgIHN0eWxlPXt7IC4uLnN0eWxlLCAuLi5waWNrZXJTdHlsZSB9fVxuICAgICAgICB0YWJJbmRleD17cHJvcHMuZGlzYWJsZWQgPyAtMSA6IDB9XG4gICAgICAgIG9uRm9jdXM9e3Byb3BzLm9uRm9jdXN9XG4gICAgICAgIG9uQmx1cj17cHJvcHMub25CbHVyfVxuICAgICAgPlxuICAgICAgICA8UmNEYXRlUGlja2VyXG4gICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgIHsuLi5waWNrZXJDaGFuZ2VIYW5kbGVyfVxuICAgICAgICAgIGNhbGVuZGFyPXtjYWxlbmRhcn1cbiAgICAgICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICAgICAgb3Blbj17b3Blbn1cbiAgICAgICAgICBvbk9wZW5DaGFuZ2U9e3RoaXMuaGFuZGxlT3BlbkNoYW5nZX1cbiAgICAgICAgICBwcmVmaXhDbHM9e2Ake3ByZWZpeENsc30tcGlja2VyLWNvbnRhaW5lcmB9XG4gICAgICAgICAgc3R5bGU9e3BvcHVwU3R5bGV9XG4gICAgICAgID5cbiAgICAgICAgICB7aW5wdXR9XG4gICAgICAgIDwvUmNEYXRlUGlja2VyPlxuICAgICAgPC9zcGFuPlxuICAgICk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==