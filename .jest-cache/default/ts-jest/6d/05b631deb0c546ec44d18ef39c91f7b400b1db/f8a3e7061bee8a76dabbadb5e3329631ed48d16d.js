import { __decorate } from "tslib";
import React from 'react';
import classNames from 'classnames';
import autobind from '../_util/autobind';
import Icon from '../icon';
import DaysView, { alwaysValidDate } from './DaysView';
import { stopEvent } from '../_util/EventManager';
export default class DecadeYearsView extends DaysView {
    handlePrevYearClick() {
        this.changeSelectedDate(this.getCloneDate().subtract(100, 'y'));
    }
    handleNextYearClick() {
        this.changeSelectedDate(this.getCloneDate().add(100, 'y'));
    }
    handleKeyDownHome(e) {
        stopEvent(e);
        const date = this.getCloneDate();
        this.changeSelectedDate(date.subtract(date.year() % 100, 'y'));
    }
    handleKeyDownEnd(e) {
        stopEvent(e);
        const date = this.getCloneDate();
        this.changeSelectedDate(date.add(90 - (date.year() % 100), 'y'));
    }
    handleKeyDownLeft(e) {
        stopEvent(e);
        if (!e.altKey) {
            this.changeSelectedDate(this.getCloneDate().subtract(10, 'y'));
        }
    }
    handleKeyDownRight(e) {
        stopEvent(e);
        if (e.altKey) {
            this.changeViewMode("year" /* year */);
        }
        else {
            this.changeSelectedDate(this.getCloneDate().add(10, 'y'));
        }
    }
    handleKeyDownUp(e) {
        stopEvent(e);
        this.changeSelectedDate(this.getCloneDate().subtract(30, 'y'));
    }
    handleKeyDownDown(e) {
        stopEvent(e);
        this.changeSelectedDate(this.getCloneDate().add(30, 'y'));
    }
    handleKeyDownPageUp(e) {
        stopEvent(e);
        this.changeSelectedDate(this.getCloneDate().subtract(100, 'y'));
    }
    handleKeyDownPageDown(e) {
        stopEvent(e);
        this.changeSelectedDate(this.getCloneDate().add(100, 'y'));
    }
    renderHeader() {
        const { prefixCls, props: { date }, } = this;
        const year = date.year() % 100;
        const from = date.clone().subtract(year, 'y');
        const to = from.clone().add(99, 'y');
        return (React.createElement("div", { className: `${prefixCls}-header` },
            React.createElement("a", { className: `${prefixCls}-prev-year`, onClick: this.handlePrevYearClick },
                React.createElement(Icon, { type: "first_page" })),
            React.createElement("span", { className: `${prefixCls}-view-select` },
                from.year(),
                " - ",
                to.year()),
            React.createElement("a", { className: `${prefixCls}-next-year` },
                React.createElement(Icon, { type: "last_page", onClick: this.handleNextYearClick }))));
    }
    renderPanelHead() {
        return undefined;
    }
    renderPanelBody() {
        const { prefixCls, props: { date, renderer = this.renderCell, isValidDate = alwaysValidDate }, } = this;
        const selected = date.clone().subtract(date.year() % 10, 'y');
        const from = date
            .clone()
            .startOf('y')
            .subtract(date.year() % 100, 'y');
        const to = from.clone().add(100, 'y');
        const prevYear = from.clone().subtract(10, 'y');
        const lastYear = to.clone().add(10, 'y');
        const rows = [];
        let cells = [];
        while (prevYear.isBefore(lastYear)) {
            const currentYear = prevYear.clone();
            const isDisabled = !isValidDate(currentYear, selected);
            const className = classNames(`${prefixCls}-cell`, {
                [`${prefixCls}-old`]: currentYear.isBefore(from, 'y'),
                [`${prefixCls}-new`]: currentYear.isSame(to, 'y'),
                [`${prefixCls}-selected`]: prevYear.isSame(selected, 'y'),
                [`${prefixCls}-disabled`]: isDisabled,
            });
            const text = `${prevYear.year()}-${prevYear
                .clone()
                .add(9, 'y')
                .year()}`;
            const decadeProps = {
                key: text,
                className,
            };
            if (!isDisabled) {
                decadeProps.onClick = this.handleCellClick.bind(this, currentYear);
            }
            cells.push(renderer(decadeProps, text, currentYear, selected));
            if (cells.length === 3) {
                rows.push(React.createElement("tr", { key: text }, cells));
                cells = [];
            }
            prevYear.add(10, 'y');
        }
        return rows;
    }
    renderFooter() {
        return undefined;
    }
    getPanelClass() {
        return `${this.prefixCls}-year-panel`;
    }
    choose(date) {
        this.changeSelectedDate(date);
        this.changeViewMode("year" /* year */);
    }
}
DecadeYearsView.displayName = 'DecadeYearView';
__decorate([
    autobind
], DecadeYearsView.prototype, "handlePrevYearClick", null);
__decorate([
    autobind
], DecadeYearsView.prototype, "handleNextYearClick", null);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMtcHJvL2RhdGUtcGlja2VyL0RlY2FkZVllYXJzVmlldy50c3giLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBb0IsTUFBTSxPQUFPLENBQUM7QUFFekMsT0FBTyxVQUFVLE1BQU0sWUFBWSxDQUFDO0FBQ3BDLE9BQU8sUUFBUSxNQUFNLG1CQUFtQixDQUFDO0FBQ3pDLE9BQU8sSUFBSSxNQUFNLFNBQVMsQ0FBQztBQUMzQixPQUFPLFFBQVEsRUFBRSxFQUFFLGVBQWUsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUV2RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFbEQsTUFBTSxDQUFDLE9BQU8sT0FBTyxlQUFnQixTQUFRLFFBQVE7SUFJbkQsbUJBQW1CO1FBQ2pCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2xFLENBQUM7SUFHRCxtQkFBbUI7UUFDakIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQUVELGlCQUFpQixDQUFDLENBQUM7UUFDakIsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsR0FBRyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsZ0JBQWdCLENBQUMsQ0FBQztRQUNoQixTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDYixNQUFNLElBQUksR0FBRyxJQUFJLENB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QUFLLENBQU0sQ0FBQyxDQUFDO2dCQUN2QyxLQUFLLEdBQUcsRUFBRSxDQUFDO2FBQ1o7WUFFRCxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztTQUN2QjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELFlBQVk7UUFDVixPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBRUQsYUFBYTtRQUNYLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxhQUFhLENBQUM7SUFDeEMsQ0FBQztJQUVELE1BQU0sQ0FBQyxJQUFZO1FBQ2pCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM5QixJQUFJLENBQUMsY0FBYyxtQkFBZSxDQUFDO0lBQ3JDLENBQUM7O0FBckpNLDJCQUFXLEdBQUcsZ0JBQWdCLENBQUM7QUFHdEM7SUFEQyxRQUFROzBEQUdSO0FBR0Q7SUFEQyxRQUFROzBEQUdSIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9odWlodWF3ay9Eb2N1bWVudHMvb3B0L2Nob2Vyb2Rvbi11aS9jb21wb25lbnRzLXByby9kYXRlLXBpY2tlci9EZWNhZGVZZWFyc1ZpZXcudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBNb21lbnQgfSBmcm9tICdtb21lbnQnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgYXV0b2JpbmQgZnJvbSAnLi4vX3V0aWwvYXV0b2JpbmQnO1xuaW1wb3J0IEljb24gZnJvbSAnLi4vaWNvbic7XG5pbXBvcnQgRGF5c1ZpZXcsIHsgYWx3YXlzVmFsaWREYXRlIH0gZnJvbSAnLi9EYXlzVmlldyc7XG5pbXBvcnQgeyBWaWV3TW9kZSB9IGZyb20gJy4vZW51bSc7XG5pbXBvcnQgeyBzdG9wRXZlbnQgfSBmcm9tICcuLi9fdXRpbC9FdmVudE1hbmFnZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEZWNhZGVZZWFyc1ZpZXcgZXh0ZW5kcyBEYXlzVmlldyB7XG4gIHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdEZWNhZGVZZWFyVmlldyc7XG5cbiAgQGF1dG9iaW5kXG4gIGhhbmRsZVByZXZZZWFyQ2xpY2soKSB7XG4gICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUodGhpcy5nZXRDbG9uZURhdGUoKS5zdWJ0cmFjdCgxMDAsICd5JykpO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGhhbmRsZU5leHRZZWFyQ2xpY2soKSB7XG4gICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUodGhpcy5nZXRDbG9uZURhdGUoKS5hZGQoMTAwLCAneScpKTtcbiAgfVxuXG4gIGhhbmRsZUtleURvd25Ib21lKGUpIHtcbiAgICBzdG9wRXZlbnQoZSk7XG4gICAgY29uc3QgZGF0ZSA9IHRoaXMuZ2V0Q2xvbmVEYXRlKCk7XG4gICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUoZGF0ZS5zdWJ0cmFjdChkYXRlLnllYXIoKSAlIDEwMCwgJ3knKSk7XG4gIH1cblxuICBoYW5kbGVLZXlEb3duRW5kKGUpIHtcbiAgICBzdG9wRXZlbnQoZSk7XG4gICAgY29uc3QgZGF0ZSA9IHRoaXMuZ2V0Q2xvbmVEYXRlKCk7XG4gICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUoZGF0ZS5hZGQoOTAgLSAoZGF0ZS55ZWFyKCkgJSAxMDApLCAneScpKTtcbiAgfVxuXG4gIGhhbmRsZUtleURvd25MZWZ0KGUpIHtcbiAgICBzdG9wRXZlbnQoZSk7XG4gICAgaWYgKCFlLmFsdEtleSkge1xuICAgICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUodGhpcy5nZXRDbG9uZURhdGUoKS5zdWJ0cmFjdCgxMCwgJ3knKSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlS2V5RG93blJpZ2h0KGUpIHtcbiAgICBzdG9wRXZlbnQoZSk7XG4gICAgaWYgKGUuYWx0S2V5KSB7XG4gICAgICB0aGlzLmNoYW5nZVZpZXdNb2RlKFZpZXdNb2RlLnllYXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNoYW5nZVNlbGVjdGVkRGF0ZSh0aGlzLmdldENsb25lRGF0ZSgpLmFkZCgxMCwgJ3knKSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlS2V5RG93blVwKGUpIHtcbiAgICBzdG9wRXZlbnQoZSk7XG4gICAgdGhpcy5jaGFuZ2VTZWxlY3RlZERhdGUodGhpcy5nZXRDbG9uZURhdGUoKS5zdWJ0cmFjdCgzMCwgJ3knKSk7XG4gIH1cblxuICBoYW5kbGVLZXlEb3duRG93bihlKSB7XG4gICAgc3RvcEV2ZW50KGUpO1xuICAgIHRoaXMuY2hhbmdlU2VsZWN0ZWREYXRlKHRoaXMuZ2V0Q2xvbmVEYXRlKCkuYWRkKDMwLCAneScpKTtcbiAgfVxuXG4gIGhhbmRsZUtleURvd25QYWdlVXAoZSkge1xuICAgIHN0b3BFdmVudChlKTtcbiAgICB0aGlzLmNoYW5nZVNlbGVjdGVkRGF0ZSh0aGlzLmdldENsb25lRGF0ZSgpLnN1YnRyYWN0KDEwMCwgJ3knKSk7XG4gIH1cblxuICBoYW5kbGVLZXlEb3duUGFnZURvd24oZSkge1xuICAgIHN0b3BFdmVudChlKTtcbiAgICB0aGlzLmNoYW5nZVNlbGVjdGVkRGF0ZSh0aGlzLmdldENsb25lRGF0ZSgpLmFkZCgxMDAsICd5JykpO1xuICB9XG5cbiAgcmVuZGVySGVhZGVyKCk6IFJlYWN0Tm9kZSB7XG4gICAgY29uc3Qge1xuICAgICAgcHJlZml4Q2xzLFxuICAgICAgcHJvcHM6IHsgZGF0ZSB9LFxuICAgIH0gPSB0aGlzO1xuICAgIGNvbnN0IHllYXIgPSBkYXRlLnllYXIoKSAlIDEwMDtcbiAgICBjb25zdCBmcm9tID0gZGF0ZS5jbG9uZSgpLnN1YnRyYWN0KHllYXIsICd5Jyk7XG4gICAgY29uc3QgdG8gPSBmcm9tLmNsb25lKCkuYWRkKDk5LCAneScpO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1oZWFkZXJgfT5cbiAgICAgICAgPGEgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXByZXYteWVhcmB9IG9uQ2xpY2s9e3RoaXMuaGFuZGxlUHJldlllYXJDbGlja30+XG4gICAgICAgICAgPEljb24gdHlwZT1cImZpcnN0X3BhZ2VcIiAvPlxuICAgICAgICA8L2E+XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS12aWV3LXNlbGVjdGB9PlxuICAgICAgICAgIHtmcm9tLnllYXIoKX0gLSB7dG8ueWVhcigpfVxuICAgICAgICA8L3NwYW4+XG4gICAgICAgIDxhIGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfS1uZXh0LXllYXJgfT5cbiAgICAgICAgICA8SWNvbiB0eXBlPVwibGFzdF9wYWdlXCIgb25DbGljaz17dGhpcy5oYW5kbGVOZXh0WWVhckNsaWNrfSAvPlxuICAgICAgICA8L2E+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyUGFuZWxIZWFkKCk6IFJlYWN0Tm9kZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHJlbmRlclBhbmVsQm9keSgpOiBSZWFjdE5vZGUge1xuICAgIGNvbnN0IHtcbiAgICAgIHByZWZpeENscyxcbiAgICAgIHByb3BzOiB7IGRhdGUsIHJlbmRlcmVyID0gdGhpcy5yZW5kZXJDZWxsLCBpc1ZhbGlkRGF0ZSA9IGFsd2F5c1ZhbGlkRGF0ZSB9LFxuICAgIH0gPSB0aGlzO1xuICAgIGNvbnN0IHNlbGVjdGVkID0gZGF0ZS5jbG9uZSgpLnN1YnRyYWN0KGRhdGUueWVhcigpICUgMTAsICd5Jyk7XG4gICAgY29uc3QgZnJvbSA9IGRhdGVcbiAgICAgIC5jbG9uZSgpXG4gICAgICAuc3RhcnRPZigneScpXG4gICAgICAuc3VidHJhY3QoZGF0ZS55ZWFyKCkgJSAxMDAsICd5Jyk7XG4gICAgY29uc3QgdG8gPSBmcm9tLmNsb25lKCkuYWRkKDEwMCwgJ3knKTtcbiAgICBjb25zdCBwcmV2WWVhciA9IGZyb20uY2xvbmUoKS5zdWJ0cmFjdCgxMCwgJ3knKTtcbiAgICBjb25zdCBsYXN0WWVhciA9IHRvLmNsb25lKCkuYWRkKDEwLCAneScpO1xuICAgIGNvbnN0IHJvd3M6IFJlYWN0Tm9kZVtdID0gW107XG4gICAgbGV0IGNlbGxzOiBSZWFjdE5vZGVbXSA9IFtdO1xuXG4gICAgd2hpbGUgKHByZXZZZWFyLmlzQmVmb3JlKGxhc3RZZWFyKSkge1xuICAgICAgY29uc3QgY3VycmVudFllYXIgPSBwcmV2WWVhci5jbG9uZSgpO1xuICAgICAgY29uc3QgaXNEaXNhYmxlZCA9ICFpc1ZhbGlkRGF0ZShjdXJyZW50WWVhciwgc2VsZWN0ZWQpO1xuICAgICAgY29uc3QgY2xhc3NOYW1lID0gY2xhc3NOYW1lcyhgJHtwcmVmaXhDbHN9LWNlbGxgLCB7XG4gICAgICAgIFtgJHtwcmVmaXhDbHN9LW9sZGBdOiBjdXJyZW50WWVhci5pc0JlZm9yZShmcm9tLCAneScpLFxuICAgICAgICBbYCR7cHJlZml4Q2xzfS1uZXdgXTogY3VycmVudFllYXIuaXNTYW1lKHRvLCAneScpLFxuICAgICAgICBbYCR7cHJlZml4Q2xzfS1zZWxlY3RlZGBdOiBwcmV2WWVhci5pc1NhbWUoc2VsZWN0ZWQsICd5JyksXG4gICAgICAgIFtgJHtwcmVmaXhDbHN9LWRpc2FibGVkYF06IGlzRGlzYWJsZWQsXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHRleHQgPSBgJHtwcmV2WWVhci55ZWFyKCl9LSR7cHJldlllYXJcbiAgICAgICAgLmNsb25lKClcbiAgICAgICAgLmFkZCg5LCAneScpXG4gICAgICAgIC55ZWFyKCl9YDtcblxuICAgICAgY29uc3QgZGVjYWRlUHJvcHM6IGFueSA9IHtcbiAgICAgICAga2V5OiB0ZXh0LFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICB9O1xuICAgICAgaWYgKCFpc0Rpc2FibGVkKSB7XG4gICAgICAgIGRlY2FkZVByb3BzLm9uQ2xpY2sgPSB0aGlzLmhhbmRsZUNlbGxDbGljay5iaW5kKHRoaXMsIGN1cnJlbnRZZWFyKTtcbiAgICAgIH1cblxuICAgICAgY2VsbHMucHVzaChyZW5kZXJlcihkZWNhZGVQcm9wcywgdGV4dCwgY3VycmVudFllYXIsIHNlbGVjdGVkKSk7XG5cbiAgICAgIGlmIChjZWxscy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgcm93cy5wdXNoKDx0ciBrZXk9e3RleHR9PntjZWxsc308L3RyPik7XG4gICAgICAgIGNlbGxzID0gW107XG4gICAgICB9XG5cbiAgICAgIHByZXZZZWFyLmFkZCgxMCwgJ3knKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm93cztcbiAgfVxuXG4gIHJlbmRlckZvb3RlcigpOiBSZWFjdE5vZGUge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBnZXRQYW5lbENsYXNzKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke3RoaXMucHJlZml4Q2xzfS15ZWFyLXBhbmVsYDtcbiAgfVxuXG4gIGNob29zZShkYXRlOiBNb21lbnQpOiB2b2lkIHtcbiAgICB0aGlzLmNoYW5nZVNlbGVjdGVkRGF0ZShkYXRlKTtcbiAgICB0aGlzLmNoYW5nZVZpZXdNb2RlKFZpZXdNb2RlLnllYXIpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=