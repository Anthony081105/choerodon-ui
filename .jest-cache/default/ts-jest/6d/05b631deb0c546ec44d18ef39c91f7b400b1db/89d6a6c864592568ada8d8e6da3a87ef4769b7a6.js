import React, { Children, Component } from 'react';
import PropTypes from 'prop-types';
import classNames from 'classnames';
import shallowEqual from 'lodash/isEqual';
import Radio from './radio';
import { getPrefixCls } from '../configure';
function getCheckedValue(children) {
    let value = null;
    let matched = false;
    Children.forEach(children, (radio) => {
        if (radio && radio.props && radio.props.checked) {
            value = radio.props.value;
            matched = true;
        }
    });
    return matched ? { value } : undefined;
}
export default class RadioGroup extends Component {
    constructor(props) {
        super(props);
        this.onRadioChange = (ev) => {
            const { value: lastValue } = this.state;
            const { value } = ev.target;
            if (!('value' in this.props)) {
                this.setState({
                    value,
                });
            }
            const { onChange } = this.props;
            if (onChange && value !== lastValue) {
                onChange(ev);
            }
        };
        let value;
        if ('value' in props) {
            value = props.value;
        }
        else if ('defaultValue' in props) {
            value = props.defaultValue;
        }
        else {
            const checkedValue = getCheckedValue(props.children);
            value = checkedValue && checkedValue.value;
        }
        this.state = {
            value,
        };
    }
    getChildContext() {
        const { disabled, name } = this.props;
        const { value } = this.state;
        return {
            radioGroup: {
                onChange: this.onRadioChange,
                value,
                disabled,
                name,
            },
        };
    }
    componentWillReceiveProps(nextProps) {
        if ('value' in nextProps) {
            this.setState({
                value: nextProps.value,
            });
        }
        else {
            const checkedValue = getCheckedValue(nextProps.children);
            if (checkedValue) {
                this.setState({
                    value: checkedValue.value,
                });
            }
        }
    }
    shouldComponentUpdate(nextProps, nextState) {
        return !shallowEqual(this.props, nextProps) || !shallowEqual(this.state, nextState);
    }
    render() {
        const { props } = this;
        const { prefixCls: customizePrefixCls, className = '', options, size, label, disabled } = props;
        const { value } = this.state;
        const prefixCls = getPrefixCls('radio-group', customizePrefixCls);
        const classString = classNames(prefixCls, {
            [`${prefixCls}-${size}`]: size,
        }, className);
        const wrapperClassString = classNames({
            [`${prefixCls}-wrapper`]: true,
            [`${prefixCls}-has-label`]: label,
        });
        const labelClassString = classNames(`${prefixCls}-label`, {
            'label-disabled': disabled,
        });
        let { children } = props;
        // 如果存在 options, 优先使用
        if (options && options.length > 0) {
            children = options.map((option, index) => {
                if (typeof option === 'string') {
                    // 此处类型自动推导为 string
                    return (React.createElement(Radio, { key: String(index), disabled: disabled, value: option, checked: value === option }, option));
                }
                // 此处类型自动推导为 { label: string value: string }
                return (React.createElement(Radio, { key: String(index), disabled: option.disabled || disabled, value: option.value, checked: value === option.value }, option.label));
            });
        }
        return (React.createElement("div", { className: wrapperClassString },
            props.label ? React.createElement("span", { className: labelClassString }, props.label) : null,
            React.createElement("div", { className: classString, style: props.style, onMouseEnter: props.onMouseEnter, onMouseLeave: props.onMouseLeave, id: props.id }, children)));
    }
}
RadioGroup.displayName = 'RadioGroup';
RadioGroup.defaultProps = {
    disabled: false,
};
RadioGroup.childContextTypes = {
    radioGroup: PropTypes.any,
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvcmFkaW8vZ3JvdXAudHN4IiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBYSxNQUFNLE9BQU8sQ0FBQztBQUM5RCxPQUFPLFNBQVMsTUFBTSxZQUFZLENBQUM7QUFDbkMsT0FBTyxVQUFVLE1BQU0sWUFBWSxDQUFDO0FBQ3BDLE9BQU8sWUFBWSxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sS0FBSyxNQUFNLFNBQVMsQ0FBQztBQUU1QixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTVDLFNBQVMsZUFBZSxDQUFDLFFBQW1CO0lBQzFDLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQztJQUNqQixJQUFJLE9BQU8sR0FBRyxLQUFLLENBQUM7SUFDcEIsUUFBUSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFVLEVBQUUsRUFBRTtRQUN4QyxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFO1lBQy9DLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztZQUMxQixPQUFPLEdBQUcsSUFBSSxDQUFDO1NBQ2hCO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxNQUFNLENBQUMsT0FBTyxPQUFPLFVBQVcsU0FBUSxTQUEyQztJQVdqRixZQUFZLEtBQXNCO1FBQ2hDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQStDZixrQkFBYSxHQUFHLENBQUMsRUFBb0IsRUFBRSxFQUFFO1lBQ3ZDLE1BQU0sRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FB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LENBQUMsS0FBSyxDQUFRLENBQUMsQ0FBQyxDQUFDLElBQUk7WUFDN0UsNkJBQ0UsU0FBUyxFQUFFLFdBQVcsRUFDdEIsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQ2xCLFlBQVksRUFBRSxLQUFLLENBQUMsWUFBWSxFQUNoQyxZQUFZLEVBQUUsS0FBSyxDQUFDLFlBQVksRUFDaEMsRUFBRSxFQUFFLEtBQUssQ0FBQyxFQUFFLElBRVgsUUFBUSxDQUNMLENBQ0YsQ0FDUCxDQUFDO0lBQ0osQ0FBQzs7QUExSU0sc0JBQVcsR0FBRyxZQUFZLENBQUM7QUFFM0IsdUJBQVksR0FBRztJQUNwQixRQUFRLEVBQUUsS0FBSztDQUNoQixDQUFDO0FBRUssNEJBQWlCLEdBQUc7SUFDekIsVUFBVSxFQUFFLFNBQVMsQ0FBQyxHQUFHO0NBQzFCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2h1aWh1YXdrL0RvY3VtZW50cy9vcHQvY2hvZXJvZG9uLXVpL2NvbXBvbmVudHMvcmFkaW8vZ3JvdXAudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDaGlsZHJlbiwgQ29tcG9uZW50LCBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgc2hhbGxvd0VxdWFsIGZyb20gJ2xvZGFzaC9pc0VxdWFsJztcbmltcG9ydCBSYWRpbyBmcm9tICcuL3JhZGlvJztcbmltcG9ydCB7IFJhZGlvQ2hhbmdlRXZlbnQsIFJhZGlvR3JvdXBQcm9wcywgUmFkaW9Hcm91cFN0YXRlIH0gZnJvbSAnLi9pbnRlcmZhY2UnO1xuaW1wb3J0IHsgZ2V0UHJlZml4Q2xzIH0gZnJvbSAnLi4vY29uZmlndXJlJztcblxuZnVuY3Rpb24gZ2V0Q2hlY2tlZFZhbHVlKGNoaWxkcmVuOiBSZWFjdE5vZGUpIHtcbiAgbGV0IHZhbHVlID0gbnVsbDtcbiAgbGV0IG1hdGNoZWQgPSBmYWxzZTtcbiAgQ2hpbGRyZW4uZm9yRWFjaChjaGlsZHJlbiwgKHJhZGlvOiBhbnkpID0+IHtcbiAgICBpZiAocmFkaW8gJiYgcmFkaW8ucHJvcHMgJiYgcmFkaW8ucHJvcHMuY2hlY2tlZCkge1xuICAgICAgdmFsdWUgPSByYWRpby5wcm9wcy52YWx1ZTtcbiAgICAgIG1hdGNoZWQgPSB0cnVlO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBtYXRjaGVkID8geyB2YWx1ZSB9IDogdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSYWRpb0dyb3VwIGV4dGVuZHMgQ29tcG9uZW50PFJhZGlvR3JvdXBQcm9wcywgUmFkaW9Hcm91cFN0YXRlPiB7XG4gIHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdSYWRpb0dyb3VwJztcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgfTtcblxuICBzdGF0aWMgY2hpbGRDb250ZXh0VHlwZXMgPSB7XG4gICAgcmFkaW9Hcm91cDogUHJvcFR5cGVzLmFueSxcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUmFkaW9Hcm91cFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIGxldCB2YWx1ZTtcbiAgICBpZiAoJ3ZhbHVlJyBpbiBwcm9wcykge1xuICAgICAgdmFsdWUgPSBwcm9wcy52YWx1ZTtcbiAgICB9IGVsc2UgaWYgKCdkZWZhdWx0VmFsdWUnIGluIHByb3BzKSB7XG4gICAgICB2YWx1ZSA9IHByb3BzLmRlZmF1bHRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY2hlY2tlZFZhbHVlID0gZ2V0Q2hlY2tlZFZhbHVlKHByb3BzLmNoaWxkcmVuKTtcbiAgICAgIHZhbHVlID0gY2hlY2tlZFZhbHVlICYmIGNoZWNrZWRWYWx1ZS52YWx1ZTtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHZhbHVlLFxuICAgIH07XG4gIH1cblxuICBnZXRDaGlsZENvbnRleHQoKSB7XG4gICAgY29uc3QgeyBkaXNhYmxlZCwgbmFtZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IHZhbHVlIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiB7XG4gICAgICByYWRpb0dyb3VwOiB7XG4gICAgICAgIG9uQ2hhbmdlOiB0aGlzLm9uUmFkaW9DaGFuZ2UsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBkaXNhYmxlZCxcbiAgICAgICAgbmFtZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBSYWRpb0dyb3VwUHJvcHMpIHtcbiAgICBpZiAoJ3ZhbHVlJyBpbiBuZXh0UHJvcHMpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB2YWx1ZTogbmV4dFByb3BzLnZhbHVlLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNoZWNrZWRWYWx1ZSA9IGdldENoZWNrZWRWYWx1ZShuZXh0UHJvcHMuY2hpbGRyZW4pO1xuICAgICAgaWYgKGNoZWNrZWRWYWx1ZSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICB2YWx1ZTogY2hlY2tlZFZhbHVlLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzOiBSYWRpb0dyb3VwUHJvcHMsIG5leHRTdGF0ZTogUmFkaW9Hcm91cFN0YXRlKSB7XG4gICAgcmV0dXJuICFzaGFsbG93RXF1YWwodGhpcy5wcm9wcywgbmV4dFByb3BzKSB8fCAhc2hhbGxvd0VxdWFsKHRoaXMuc3RhdGUsIG5leHRTdGF0ZSk7XG4gIH1cblxuICBvblJhZGlvQ2hhbmdlID0gKGV2OiBSYWRpb0NoYW5nZUV2ZW50KSA9PiB7XG4gICAgY29uc3QgeyB2YWx1ZTogbGFzdFZhbHVlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHsgdmFsdWUgfSA9IGV2LnRhcmdldDtcbiAgICBpZiAoISgndmFsdWUnIGluIHRoaXMucHJvcHMpKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdmFsdWUsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB7IG9uQ2hhbmdlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmIChvbkNoYW5nZSAmJiB2YWx1ZSAhPT0gbGFzdFZhbHVlKSB7XG4gICAgICBvbkNoYW5nZShldik7XG4gICAgfVxuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHByb3BzIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgcHJlZml4Q2xzOiBjdXN0b21pemVQcmVmaXhDbHMsIGNsYXNzTmFtZSA9ICcnLCBvcHRpb25zLCBzaXplLCBsYWJlbCwgZGlzYWJsZWQgfSA9IHByb3BzO1xuICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcHJlZml4Q2xzID0gZ2V0UHJlZml4Q2xzKCdyYWRpby1ncm91cCcsIGN1c3RvbWl6ZVByZWZpeENscyk7XG4gICAgY29uc3QgY2xhc3NTdHJpbmcgPSBjbGFzc05hbWVzKFxuICAgICAgcHJlZml4Q2xzLFxuICAgICAge1xuICAgICAgICBbYCR7cHJlZml4Q2xzfS0ke3NpemV9YF06IHNpemUsXG4gICAgICB9LFxuICAgICAgY2xhc3NOYW1lLFxuICAgICk7XG4gICAgY29uc3Qgd3JhcHBlckNsYXNzU3RyaW5nID0gY2xhc3NOYW1lcyh7XG4gICAgICBbYCR7cHJlZml4Q2xzfS13cmFwcGVyYF06IHRydWUsXG4gICAgICBbYCR7cHJlZml4Q2xzfS1oYXMtbGFiZWxgXTogbGFiZWwsXG4gICAgfSk7XG4gICAgY29uc3QgbGFiZWxDbGFzc1N0cmluZyA9IGNsYXNzTmFtZXMoYCR7cHJlZml4Q2xzfS1sYWJlbGAsIHtcbiAgICAgICdsYWJlbC1kaXNhYmxlZCc6IGRpc2FibGVkLFxuICAgIH0pO1xuICAgIGxldCB7IGNoaWxkcmVuIH0gPSBwcm9wcztcblxuICAgIC8vIOWmguaenOWtmOWcqCBvcHRpb25zLCDkvJjlhYjkvb/nlKhcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGNoaWxkcmVuID0gb3B0aW9ucy5tYXAoKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgLy8g5q2k5aSE57G75Z6L6Ieq5Yqo5o6o5a+85Li6IHN0cmluZ1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgICAga2V5PXtTdHJpbmcoaW5kZXgpfVxuICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgIHZhbHVlPXtvcHRpb259XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3ZhbHVlID09PSBvcHRpb259XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtvcHRpb259XG4gICAgICAgICAgICA8L1JhZGlvPlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgLy8g5q2k5aSE57G75Z6L6Ieq5Yqo5o6o5a+85Li6IHsgbGFiZWw6IHN0cmluZyB2YWx1ZTogc3RyaW5nIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8UmFkaW9cbiAgICAgICAgICAgIGtleT17U3RyaW5nKGluZGV4KX1cbiAgICAgICAgICAgIGRpc2FibGVkPXtvcHRpb24uZGlzYWJsZWQgfHwgZGlzYWJsZWR9XG4gICAgICAgICAgICB2YWx1ZT17b3B0aW9uLnZhbHVlfVxuICAgICAgICAgICAgY2hlY2tlZD17dmFsdWUgPT09IG9wdGlvbi52YWx1ZX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7b3B0aW9uLmxhYmVsfVxuICAgICAgICAgIDwvUmFkaW8+XG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9e3dyYXBwZXJDbGFzc1N0cmluZ30+XG4gICAgICAgIHtwcm9wcy5sYWJlbCA/IDxzcGFuIGNsYXNzTmFtZT17bGFiZWxDbGFzc1N0cmluZ30+e3Byb3BzLmxhYmVsfTwvc3Bhbj4gOiBudWxsfVxuICAgICAgICA8ZGl2XG4gICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc1N0cmluZ31cbiAgICAgICAgICBzdHlsZT17cHJvcHMuc3R5bGV9XG4gICAgICAgICAgb25Nb3VzZUVudGVyPXtwcm9wcy5vbk1vdXNlRW50ZXJ9XG4gICAgICAgICAgb25Nb3VzZUxlYXZlPXtwcm9wcy5vbk1vdXNlTGVhdmV9XG4gICAgICAgICAgaWQ9e3Byb3BzLmlkfVxuICAgICAgICA+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==